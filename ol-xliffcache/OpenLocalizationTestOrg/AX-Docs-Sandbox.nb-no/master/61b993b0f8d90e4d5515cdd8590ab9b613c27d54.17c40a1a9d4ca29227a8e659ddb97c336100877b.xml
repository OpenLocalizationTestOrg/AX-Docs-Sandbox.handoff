{"content":"---\n# required metadata\n\ntitle: Build and consume data entities\ndescription: This tutorial shows how to build an entity in Fleet Management in Microsoft Visual Studio, and also how to consume some out-of-band (OOB) entities in an integration scenario. You will see how Microsoft Dynamics 365 for Operations simplifies the development of data entities in the Visual Studio development environment. You will also preview how these data entities will be consumed in various integrations scenarios, such as data import and export, integration, and OData services.\nauthor: RobinARH\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: RobinARH\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 77523\nms.assetid: 1de997fb-d5c4-4668-9759-0758d141a3eb\nms.search.region: Global\n# ms.search.industry: \nms.author: kuntalme\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Build and consume data entities\n\n[!include[banner](../includes/banner.md)]\n\n\nThis tutorial shows how to build an entity in Fleet Management in Microsoft Visual Studio, and also how to consume some out-of-band (OOB) entities in an integration scenario. You will see how Microsoft Dynamics 365 for Operations simplifies the development of data entities in the Visual Studio development environment. You will also preview how these data entities will be consumed in various integrations scenarios, such as data import and export, integration, and OData services.\n\nPrerequisites\n-------------\n\n-   This tutorial requires that you access the Microsoft Dynamics 365 for Operations environment by using Remote Desktop, and that you be provisioned as an administrator on the Dynamics 365 for Operations instance. For more information, see the \"Access Microsoft Dynamics 365 for Operations instances\" document.\n-   Throughout this tutorial, baseUrl refers to the base URL of the Dynamics 365 for Operations instance.\n    -   In the cloud environment, the base URL is obtained from Microsoft Dynamics Lifecycle Services (LCS).\n    -   On a local virtual machine (VM), the base URL is https://usnconeboxax1aos.cloud.onebox.dynamics.com.\n\n## Key concepts\n-   Developing a data entity in Microsoft Visual Studio\n-   Enabling a data entity for data management and OData services\n-   Consuming a data entity in integration scenarios\n\n## Business problem\nFleet Management stores customer data in the FMCustomer table and address data in the FMAddressTable table. To access or update customer information, users must access multiple tables. Instead, you can create a business object that functionally represents customer information, and that you can use to build integration solutions.\n\n## Building the FMLabCustomer entity\nIn this section, you must create a data entity for FMLabCustomer in the Fleet Management model. This entity will be used to manage master data through import/export and integration services. The primary data source is FMCustomer, and the secondary data source is FMAddressTable.\n\n### Data entity\n\nFMLabCustomerEntity\n\n#### Data entity fields\n\n| Name          | Mapping                     |\n|---------------|-----------------------------|\n| CellPhone     | FMCustomer.CellPhone        |\n| DriverLicense | FMCustomer.DriverLicense    |\n| Email         | FMCustomer.Email            |\n| FirstName     | FMCustomer.FirstName        |\n| LastName      | FMCustomer.LastName         |\n| CustomerGroup | FMCustomer.CustGroup        |\n| AddressLine1  | FMAddressTable.AddressLine1 |\n| AddressLine2  | FMAddressTable.AddressLine2 |\n| City          | FMAddressTable.City         |\n| State         | FMAddressTable.State        |\n| ZipCode       | FMAddressTable.ZipCode      |\n| Country       | FMAddressTable.Country      |\n\n#### Corresponding staging table\n\nStaging tables are used in import/export scenarios to provide intermediary storage during file parsing and transformation. These tables are also used in connector integration scenarios. In many cases, staging table are mapped 1:1 to an entity. The staging table that corresponds to the **FMLabCustomerEntity** entity is named FMLabCustomerStaging.\n\n### Create a new Dynamics 365 for Operations project\n\n1.  In Visual Studio click **File** &gt; **New** &gt; **Project**, and then select **Dynamics 365 for Operations Project**.\n2.  Right-click the project, click **Properties**, and verify that the project is in the Fleet Management model. If it isn't, set the **Model** property to **Fleet Management**.\n\n### Add a new data entity to your project\n\n1.  Create a new entity that is named **FMLabCustomerEntity**. Right-click you project, and then click **Add** &gt; **New item**. The **Add New Item** dialog box opens.\n2.  Select **Data Entity**, and then set the **Name** property to **FMLabCustomerEntity**. For more information about best practices for entity naming, see \"Data entity concepts guide.\"\n3.  Click **Add**.\n4.  In the **Data entity** wizard, specify the properties for the data entity that you're creating. Use the values that are shown in the following screen shot. \n\n[![Data Entity Wizard](./media/data-entity-wizard.png)](./media/data-entity-wizard.png)\n\n5.  Click **Next**. For more information about the function of each property, see \"Data entity concepts guide.\"\n6.  Add fields to the new entity from your data source, as shown in the following screen shot. You can add fields from the primary data source, **FMCustomer**. For this entity, clear the check box for the **Image** and **LicenseImage** container types to simplify testing.\n7.  Rename the data entity fields to reflect public data contract standards, or click **Convert labels to field names** to generate names from the existing labels.\n8.  On the line for the **DriverLicense** field, select the **Is mandatory** check box. This field will be used as the natural key for the entity. [![Data Entity Wizard 2](./media/data-entity-wizard-2.png)](./media/data-entity-wizard-2.png)\n9.  In the **Data source** field, select **PrimaryAddress**. Notice that the **PrimaryAddress** data source is automatically added because of automatic expansion or the surrogate foreign key replacement of **AddressID**. [![Steps and add fields](./media/steps-and-add-fields.png)](./media/steps-and-add-fields.png)\n10. Select the fields from the **PrimaryAddress** data source that you want to be part of your entity. Additionally, rename the following fields to reflect proper public data contract naming:\n    -   PrimaryAddress \\_AddressLine1 &gt; AddressLine1\n    -   PrimaryAddress \\_AddressLine2 &gt; AddressLine2\n    -   PrimaryAddress \\_City &gt; City\n    -   PrimaryAddress \\_State &gt; State\n    -   PrimaryAddress \\_ZipCode &gt; ZipCode\n    -   PrimaryAddress \\_Country &gt; Country\n\n    [ ](./media/data-entity-wizard-3.png)\n    \n11. Click **Finish**. A data entity item and staging table are added to the project.\n\n[![Solution explorer](./media/solution-explorer.png)](./media/solution-explorer.png)\n\n### Build your project\n\n1.  In Solution Explorer, right-click your project, and then click **Properties**.\n2.  Change the value of the **Synchronize database on build** property to **True**, and then click **OK**. This property must be set only one time per project. **Note:** Entities are created as views in Microsoft SQL Server, and staging tables are also added. Therefore, you must sync a database when you build entities. ![Property pages](./media/property-pages.png)\n3.  On the Visual Studio toolbar, click **Build** &gt; **Build Solution** to build the project.\n4.  Verify that the build doesn't contain any errors. At this point in the tutorial, warnings are allowed.\n\n### Visually validate and customize an entity\n\n1.  In Solution Explorer, right-click the **FMLabCustomerEntity** node, and then click **Open**. The designer for the entity opens in the middle pane.\n2.  Validate the properties of the **FMLabCustomerEntity** entity. Select the entity in Solution Explorer, and compare the **Properties** pane values to the following screen shot.\n3.  Set the **Label** property to **Fleet Lab Customers**. [![FMLabCustomerEntity - Properties](./media/fmlabcustomerentity-properties.png)](./media/fmlabcustomerentity-properties.png)\n4.  In the left pane, click **Data Sources** &gt; **FMCustomer** &gt; **Data Sources** &gt; **FMAddressTable**.\n5.  Change the **Is Read Only** property to **No**. This is a known issue. Eventually, the value will be set to **Yes** or **No** automatically, based on the type of join. The value should be **Yes** for composition scenarios, and **No** for associations (surrogate foreign key expansions). This property enables the data source to be read/write. [![FMLabCustomerEntity - Properties2](./media/fmlabcustomerentity-properties2.png)](./media/fmlabcustomerentity-properties2.png)\n6.  In the **FMLabCustomerEntity** designer, click **Keys** &gt; **EntityKey**, and then expand the **Fields** node. Verify that the list of fields matches the following screen shot. \n\n[![FMLabCustomerEntity](./media/fmlabcustomerentity.png)](./media/fmlabcustomerentity.png)\n\n7.  To visually validate the staging table that will be used for import/export, open the **FMLabCustomerStaging** table in the designer, and then select the **FMLabCustomerStaging** node. \n\n[![fMLabCustomerStaging - Properties](./media/fmlabcustomerstaging-properties.png)](./media/fmlabcustomerstaging-properties.png)\n\n8.  Click **FMLabCustomerStaging** &gt; **Fields**. In the following screen shot, the standard fields of the staging tables are selected. All entity staging tables have these standard fields. The screen shot also shows the data fields that belong on this data entity. \n[![FMLabCustomerStaging](./media/fmlabcustomerstaging.png)](./media/fmlabcustomerstaging.png)\n\n9.  In Solution Explorer, right-click your project, and then select **Rebuild** to rebuild and synchronize the project.\n\n## Testing data entities\nEntities can be tested by using various methods in X++, through data import/export, or through integrations. In this section, we'll explore scenarios for validating entities.\n\n### Test the entity by using X++ code\n\nOne of the most common ways of interacting with data entities is through X++, by using a unit test or a runnable job to validate that the entities have been built. In this example, we will use a runnable job.\n\n1.  In Solution Explorer, click **Add** &gt; **New item** &gt; **Runnable class** to add a runnable class to your project.\n2.  Copy and paste the following code into the class to test your data entity.\n\n        public static void main(Args _args)\n            {\n                FMLabCustomerEntity customer;\n                str license = \"License\";\n                Random r = new Random();\n                int rand = r.nextInt();\n                license = license + int2str(rand);\n                \n                //Create a new record in FM lab customer entity\n                customer.clear();\n                customer.FirstName = \"Bob\";\n                customer.LastName = \"Smith\";\n                customer.DriverLicense = license;\n                customer.insert();\n                \n                info(strfmt(\"Tried to insert customer '%1 %2' with license %3\", \n        customer.FirstName, customer.LastName, customer.DriverLicense));\n                \n                //Display newly created record\n                select forupdate customer where customer.DriverLicense==license;\n                info(strfmt(\"Found newly created customer '%1 %2' with license %3\", \n        customer.FirstName, customer.LastName, customer.DriverLicense));\n                \n                //Now delete the record from the entity\n                customer.delete();\n                \n                select customer where customer.DriverLicense==license ;\n                info(strfmt(\"Deleted customer does not exist: license- %1\", customer.DriverLicense));\n            }\n\n3.  Run the code in debugger to set it as a startup object.\n4.  To validate the entity, view the Infolog in the debugger window or in notifications on the website. You will see that three successful messages are logged. You will also see the actions that were taken.\n\n## Importing data by using entities\nData entities that have the **Data Management Enabled** property can be used to import and export data in various file formats. In this section, you will import data in a CSV file format for the **FMLabCustomer** entity.\n\n### File import\n\nAfter you create your data entity, you can validate import/export.\n\n1.  Create a sample CSV file that you can import. Copy the following text, and save it as **FM Lab Customer Import.csv**.\n    \nCELLPHONE,DRIVERSLICENSE,EMAIL,FIRSTNAME,LASTNAME,CUSTOMERGROUP,ADDRESSLINE1,ADDRESSLINE2,CITY,STATE,ZIPCODE,COUNTRY(999) 555-0100,S615-3939-2349,chris.spencer@adatum.com,Chris,Spencer,adv\\_mem\\_1,444 Main Street,,Orlando,FL,77899,US(188) 555-0101,S615-3939-2350,Ichiro.lannin@blueyonderairlines.com,Ichiro,Lannin,non\\_mem\\_1,12 Long Street,,New York City,NY,99087,US(777) 555-0102,S615-3939-2351,josh.smith@fourthcoffee.com,Josh,Smith,adv\\_mem\\_1,9606 122th Avenue,,Sydney,TX,99874,US(456) 555-0103,S615-3939-2352,Vince@fabrikam.us,Vince,Ahmed,non\\_mem\\_1,123 Microsoft Way,Unit 87,Seattle,WA,90001,US(345) 555-0104,S615-3939-2353,tony.parker@lucernepublishing.com,Tony,Parker,non\\_mem\\_1,12012 11th PLNE,Apt 160,San Francisco,CA,75645,US(312) 555-0105,S615-3939-2354,Julia@fineartschool.net,Julia,Natarajan,exec\\_mem\\_1,449 Long Street,Apt 160,Bruxelles,ID,34213,US\n\n\n2.  Click **User Dashboard** &gt; **Data management**.\n\n3.  In the **Data Management** workspace, click the **Import** tile.\n4.  On the **Import** page, enter the import details, as shown in the following screen shot.![Import new record](./media/import-new-record.png)\n5.  Click the **Upload data** button next to the **Upload file for entity** field, and select the CSV file that you created.\n6.  After the file is uploaded, you will notice that the entity is added to the middle section. You will also receive an error that states that the mapping isn't valid. A few fields aren't mapped correctly between the source file and the target entity.\n7.  In the entities list, click **View map**.\n8.  **AddressLine1** and **AddressLine2** are two fields in the source that aren't mapped to target fields. In the visual mapper, or details view, map these fields as follows, and then click **Save**:\n    -   AddressLine1 – Address1\n    -   AddressLine2 – Address2\n\n    [![Map source to staging](./media/map-source-to-staging.png)](./media/map-source-to-staging.png)\n9.  Click the **Back** button in your browser to go back to the **Import job** page. The check mark in the entities list indicates that the entity is now ready for import. [![Import new record 2](./media/import-new-record-2.png)](./media/import-new-record-2.png)\n10. Click **Import Now**. After the import is completed, the job status page opens.\n\n## Consuming entities by using OData\nIn this section, you will learn how to expose and consume an entity for OData. Before you begin, verify that the Fleet demo data is loaded from the Microsoft Dynamics 365 for Operations client: \\[baseURL\\]/?f=FMSetup\n\n### Review the FleetRental entity and add a navigation property for OData\n\nYou will review the existing **FleetRental** entity and then create a relationship from one data entity to another. This relationship will be used as a navigation property for OData entities.\n\n1.  In Solution Explorer, verify that you're in the **FMEntityLab** project.\n2.  In Application Explorer, search for **FMRentalEntity**, right-click it, and then select **Add to Project**.\n3.  In Application Explorer, search for **FMCustomerEntity**, right-click it, and then select **Add to project**.\n4.  In Solution Explorer, right-click **FMRentalEntity**, and then select **Open**.\n5.  In the view designer, select the root node, **FMRentalEntity**, and review the following properties.\n\n    | Property               | Value        | Description                                                                                                             |\n    |------------------------|--------------|-------------------------------------------------------------------------------------------------------------------------|\n    | IsPublic               | Yes          | When this property is set to **Yes**, the entity is visible by using the OData application programming interface (API). |\n    | Public Entity Name     | FleetRental  | The name that will be used in the OData APIs for **EntityType**.                                                        |\n    | Public Collection Name | FleetRentals | The name that will be used for the OData collection entity.                                                             |\n\n6.  In the view designer, expand the **Relations** node.\n7.  Select **Customer Relation**, and then click **Delete**.\n8.  Right-click **Relations**, and then select **New** &gt; **Relation**.\n9.  Select **Relation1**, and set the following properties.\n\n    | Property                        | Value            |\n    |---------------------------------|------------------|\n    | Cardinality                     | ZeroMore         |\n    | Name                            | CustomerRelation |\n    | Related Data Entity             | FMCustomerEntity |\n    | Related Data Entity Cardinality | ExactlyOne       |\n    | Related Data Entity Role        | CustomerRole     |\n    | Relationship Type               | Association      |\n    | Role                            | Rental           |\n\n10. In the view designer, right-click the **CustomerRelation** node, and then select **New** &gt; **Normal**.\n11. Right-click the new node under **CustomerRelation**, and then select **Properties**.\n12. Set the following properties.\n\n    | Property      | Value                                                                         |\n    |---------------|-------------------------------------------------------------------------------|\n    | Field         | **CustomerDriverLicense**This is the foreign key field on **FMRentalEntity**. |\n    | Related Field | **DriverLicense**This is the unique key on **FMCustomerEntity**.              |\n\n    The following screen shot shows the relation in Visual Studio.[![FMRentalEntity - Solution explorer](./media/fmrentalentity-solution-explorer.png)](./media/fmrentalentity-solution-explorer.png)\n13. On the **BUILD** menu, click **Build Solution** to save your changes and build the project. You can view the build progress in the **Output** window.\n14. To update the OData endpoint with the changes, you must run an **iisreset** command. Open a **Command Prompt **windows as an administrator, and enter **iisreset**.\n\nYou've now created a navigation property between **FMRentalEntity** and **FMCustomerEntity**.\n\n### Use standard OData syntax to retrieve data\n\nIn this section, you will use some of the standard OData syntax to navigate and query the OData entities that are exposed in the Fleet Management model. First, follow these steps the enable Internet Explorer to view JSON formatted data.\n\n1.  Close all Internet Explorer windows.\n2.  Go to C:FMLab, and select and double-click the json.ie.reg file.\n3.  In the **Registry Editor** dialog box, click **Yes**.\n4.  Click **OK**.\n\nYou can now use Internet Explorer to explore some OData URIs.\n\n1.  Start Internet Explorer, and enter the following URL in the address bar: \\[baseURL\\]/data/$metadata You will see all the metadata that is associated with OData entities. **Note:** The metadata might take a few minutes to appear the first time that you access it. In the XML, you can see all of the properties and navigation properties associated with the OData entities.\n2.  In the browser, find **FleetRental**. The following screen shot shows the metadata of the **FleetRental** entity, together with the new relationship, **NavigationProperty**. [![FleetRental metadata](./media/fleetrental-metadata.png)](./media/fleetrental-metadata.png)\n3.  To view all the customers in the Fleet Management application in JSON format, enter the following URL into the address bar of your browser: \\[baseURL\\]/data/FleetCustomer **Note:** Entity names are case-sensitive.\n4.  If you don't want to retrieve all properties for the customers, you can retrieve just selected properties. For example, to retrieve only **FirstName** and **LastName**, enter the following URL: \\[baseURL\\]/data/FleetCustomers?$filter=FirstName.LastName\n5.  You can also apply filters. For example, to filter on all customers where **FirstName**=**Phil**, enter the following URL: \\[baseUrl\\]/data/FleetCustomers?$filter=FirstName%20eq%20'Phil' **Note:** These URLs won't work if you copy and paste them. You must manually enter them in the address bar.\n6.  To retrieve all the **Rental** records, together with all details of the customers, enter the following URL: \\[baseURL\\]/data/FleetRentals?$expand=CustomerRole The following example shows a **Rental** record, together with details of the linked customer, in JSON format.\n\n        \"@odata.context\":\"https://testax32aos.cloud.test.dynamics.com/en/data/$metadata#FleetRentals\",\"value\":\n        {  \n        { \n            \"@odata.etag\":\"W/\"JzEsNTYzNzE0NDU3NjsxLDU2MzcxNDQ1NzY7MTc4NjA2OTg1Niw1NjM3MTQ0NjA1Jw==\"\",\n        \"Comments\":\"\",\"StartMileage\":0,\"VehicleRatePerDay\":40,\"CustomerDriverLicense\":\n        \"S468-3184-6541\",\"VehicleRateTotal\":280,\"VehicleId\":\"Litware_LitwareFour_1\",\n        \"RentalId\":\"000001\",\n        \"StartFuelLevel\":\"Full\",\"StartDate\":\"2010-04-09T00:00:00Z\",\"CustomerLastName\":\"Spencer\",\n        \"EndMileage\":0,\"VehicleVIN\":\"2J4FY19P0NJ710529\",\n        \"RecId\":5637144576,\"EndDate\":\"2010-04-16T00:00:00Z\",\n        \"VehicleRatePerWeek\":270,\"CustomerFirstName\":\"Phil\",\"State\":3,\n        \"EndFuelLevel\":\"\",\"CustomerRole\":\n\n        {\"@odata.etag\":\"W/\"JzEsNTYzNzE0NDU3NjsxLDU2MzcxNDQ1NzYn\"\",\n        \"CellPhone\":\"(999) 555-0100\",\n        \"DriverLicense\":\"S468-3184-6541\",\"AddressLine2\":\"\",\n        \"State\":\"FL\",\"Country\":\"US\",\"FirstName\":\"Phil\",\n        \"Email\":\"phil.spencer@adatum.com\",\"CustomerGroup\":\n        \"adv_mem_1\",\"AddressLine1\":\"167 BBN Way\",\"City\":\"Orlando\",\n        \"ZipCode\":77899,\"RecId\":5637144576,\"LastName\":\"Spencer\"\n        }  \n         }\n\n### Add an action to OData entity\n\nActions provide a way to inject behaviors into the data model. In Dynamics 'AX 7,' you add actions by adding a method to the data entity and then decorating the method with specific attributes. In this section, we'll walk through the steps for adding an action.\n\n1.  In Solution Explorer, right-click **FMRentalEntity**, and then select **View code**.\n2.  Copy the following code lines, and paste them into the **Code** window.\n\n        public class FMRentalEntity extends common\n        {\n        [SysODataActionAttribute(\"ReturnRental\", true)]\n        public str ReturnRental()\n            {\n                //do something\n        return \"Rental was successfully returned. Thanks for your business\";\n            }\n        }\n\n3.  On the **BUILD** menu, click **Rebuild Solution** to save your changes and build the project. You can view the build progress in the **Output** window.\n4.  To update the OData endpoint with the changes, you must run an **iisreset** command. Open a **Command Prompt** window as an administrator, and enter **iisreset**.\n\nThe action that you just added can be invoked through code, as you will see in the next section.\n\n### Consume the Dynamics 365 for Operations OData API from an external console application\n\nIn this section, you will use a console application to consume the OData endpoints that are exposed in the Fleet Management application. The console application first creates a new customer and then creates a new reservation for that customer. This tutorial shows how easy it is to use OData together with standard .NET Windows Communication Foundation (WCF) data service libraries to integrate with Dynamics AX.\n\n1.  Start a new instance of Visual Studio.\n2.  On the **File** menu, click **Open** &gt; **Project/Solution**.\n3.  In the **Open Project** dialog box, browse to **C:FMLabOdata4ConsoleApplication**, and then select **Odata4ConsoleApplication.csproj**.\n4.  Click **Open**. The **Odata4ConsoleApplication** project appears in Solution Explorer.\n5.  In Solution Explorer, double-click **OdataProxyGenerator.tt**.\n6.  In the code editor, replace the following string with your organization's Dynamics 365 for Operations URL.\n\n        <baseURL> public const string MetadataDocumentUri = \"<baseURL>/data/\"\n\n7.  Save the OdataProxyGenerator.tt file.\n8.  In the **Save of Read-only file** dialog box, click **Overwrite**. The proxy class for the OData metadata endpoint is generated. This operation might take a few minutes.\n9.  In Solution Explorer, double-click **Program.cs**.\n10. Replace the value of the **dynamicsBaseUri** variable with your organization's Dynamics 365 for Operations URL.\n11. Verify that there is a final closing slash (/) in the URL, and then click **Save**.\n12. In the **Save of Read-only file** dialog box, click **Overwrite**.\n13. Press F5 to run the application, and then follow the instructions in the output console window. The application might prompt you for your Dynamics AX credentials. After the application has run, the new customer and the corresponding reservation are created in Dynamics 365 for Operations.\n14. Follow these steps to verify that the new reservation appears on the **Rental** page:\n    1.  Start Internet Explorer, and enter the following URL in the address bar: \\[baseURL\\]/?mi=FMRental The **FMRental** page shows the list of rentals.[![Rental list](./media/rental-list.png)](./media/rental-list.png)\n    2.  At the bottom of the list, click **Next** to view the next page. On this page, you can see that the reservation was created for the new customer that you added.[![customer reservation](./media/customer-reservation.png)](./media/customer-reservation.png)\n\nThis completes the walkthrough, where you've seen an external client interacting with the Fleet Management model by using OData endpoint.\n\nSee also\n--------\n\n[Developing an entity and using it for data migration](develop-entity-for-data-migration.md)\n\n\n\n","nodes":[{"pos":[32,63],"content":"Build and consume data entities","needQuote":true,"needEscape":true,"nodes":[{"content":"Build and consume data entities","pos":[0,31]}]},{"pos":[77,559],"content":"This tutorial shows how to build an entity in Fleet Management in Microsoft Visual Studio, and also how to consume some out-of-band (OOB) entities in an integration scenario. You will see how Microsoft Dynamics 365 for Operations simplifies the development of data entities in the Visual Studio development environment. You will also preview how these data entities will be consumed in various integrations scenarios, such as data import and export, integration, and OData services.","needQuote":true,"needEscape":true,"nodes":[{"content":"This tutorial shows how to build an entity in Fleet Management in Microsoft Visual Studio, and also how to consume some out-of-band (OOB) entities in an integration scenario. You will see how Microsoft Dynamics 365 for Operations simplifies the development of data entities in the Visual Studio development environment. You will also preview how these data entities will be consumed in various integrations scenarios, such as data import and export, integration, and OData services.","pos":[0,482],"nodes":[{"content":"This tutorial shows how to build an entity in Fleet Management in Microsoft Visual Studio, and also how to consume some out-of-band (OOB) entities in an integration scenario.","pos":[0,174]},{"content":"You will see how Microsoft Dynamics 365 for Operations simplifies the development of data entities in the Visual Studio development environment.","pos":[175,319]},{"content":"You will also preview how these data entities will be consumed in various integrations scenarios, such as data import and export, integration, and OData services.","pos":[320,482]}]}]},{"pos":[1061,1092],"content":"Build and consume data entities","linkify":"Build and consume data entities","nodes":[{"content":"Build and consume data entities","pos":[0,31]}]},{"content":"This tutorial shows how to build an entity in Fleet Management in Microsoft Visual Studio, and also how to consume some out-of-band (OOB) entities in an integration scenario.","pos":[1138,1312]},{"content":"You will see how Microsoft Dynamics 365 for Operations simplifies the development of data entities in the Visual Studio development environment.","pos":[1313,1457]},{"content":"You will also preview how these data entities will be consumed in various integrations scenarios, such as data import and export, integration, and OData services.","pos":[1458,1620]},{"pos":[1622,1635],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"This tutorial requires that you access the Microsoft Dynamics 365 for Operations environment by using Remote Desktop, and that you be provisioned as an administrator on the Dynamics 365 for Operations instance.","pos":[1655,1865]},{"content":"For more information, see the \"Access Microsoft Dynamics 365 for Operations instances\" document.","pos":[1866,1962]},{"content":"Throughout this tutorial, baseUrl refers to the base URL of the Dynamics 365 for Operations instance.","pos":[1967,2068]},{"content":"In the cloud environment, the base URL is obtained from Microsoft Dynamics Lifecycle Services (LCS).","pos":[2077,2177]},{"content":"On a local virtual machine (VM), the base URL is https://usnconeboxax1aos.cloud.onebox.dynamics.com.","pos":[2186,2286]},{"pos":[2291,2303],"content":"Key concepts","linkify":"Key concepts","nodes":[{"content":"Key concepts","pos":[0,12]}]},{"content":"Developing a data entity in Microsoft Visual Studio","pos":[2308,2359]},{"content":"Enabling a data entity for data management and OData services","pos":[2364,2425]},{"content":"Consuming a data entity in integration scenarios","pos":[2430,2478]},{"pos":[2483,2499],"content":"Business problem","linkify":"Business problem","nodes":[{"content":"Business problem","pos":[0,16]}]},{"content":"Fleet Management stores customer data in the FMCustomer table and address data in the FMAddressTable table.","pos":[2500,2607]},{"content":"To access or update customer information, users must access multiple tables.","pos":[2608,2684]},{"content":"Instead, you can create a business object that functionally represents customer information, and that you can use to build integration solutions.","pos":[2685,2830]},{"pos":[2835,2868],"content":"Building the FMLabCustomer entity","linkify":"Building the FMLabCustomer entity","nodes":[{"content":"Building the FMLabCustomer entity","pos":[0,33]}]},{"content":"In this section, you must create a data entity for FMLabCustomer in the Fleet Management model.","pos":[2869,2964]},{"content":"This entity will be used to manage master data through import/export and integration services.","pos":[2965,3059]},{"content":"The primary data source is FMCustomer, and the secondary data source is FMAddressTable.","pos":[3060,3147]},{"pos":[3153,3164],"content":"Data entity","linkify":"Data entity","nodes":[{"content":"Data entity","pos":[0,11]}]},{"content":"FMLabCustomerEntity","pos":[3166,3185]},{"pos":[3192,3210],"content":"Data entity fields","linkify":"Data entity fields","nodes":[{"content":"Data entity fields","pos":[0,18]}]},{"content":"Name","pos":[3214,3218]},{"content":"Mapping","pos":[3230,3237]},{"content":"CellPhone","pos":[3310,3319]},{"content":"FMCustomer.CellPhone","pos":[3326,3346]},{"content":"DriverLicense","pos":[3358,3371]},{"content":"FMCustomer.DriverLicense","pos":[3374,3398]},{"content":"Email","pos":[3406,3411]},{"content":"FMCustomer.Email","pos":[3422,3438]},{"content":"FirstName","pos":[3454,3463]},{"content":"FMCustomer.FirstName","pos":[3470,3490]},{"content":"LastName","pos":[3502,3510]},{"content":"FMCustomer.LastName","pos":[3518,3537]},{"content":"CustomerGroup","pos":[3550,3563]},{"content":"FMCustomer.CustGroup","pos":[3566,3586]},{"content":"AddressLine1","pos":[3598,3610]},{"content":"FMAddressTable.AddressLine1","pos":[3614,3641]},{"content":"AddressLine2","pos":[3646,3658]},{"content":"FMAddressTable.AddressLine2","pos":[3662,3689]},{"content":"City","pos":[3694,3698]},{"content":"FMAddressTable.City","pos":[3710,3729]},{"content":"State","pos":[3742,3747]},{"content":"FMAddressTable.State","pos":[3758,3778]},{"content":"ZipCode","pos":[3790,3797]},{"content":"FMAddressTable.ZipCode","pos":[3806,3828]},{"content":"Country","pos":[3838,3845]},{"content":"FMAddressTable.Country","pos":[3854,3876]},{"pos":[3890,3917],"content":"Corresponding staging table","linkify":"Corresponding staging table","nodes":[{"content":"Corresponding staging table","pos":[0,27]}]},{"content":"Staging tables are used in import/export scenarios to provide intermediary storage during file parsing and transformation.","pos":[3919,4041]},{"content":"These tables are also used in connector integration scenarios.","pos":[4042,4104]},{"content":"In many cases, staging table are mapped 1:1 to an entity.","pos":[4105,4162]},{"content":"The staging table that corresponds to the <bpt id=\"p1\">**</bpt>FMLabCustomerEntity<ept id=\"p1\">**</ept> entity is named FMLabCustomerStaging.","pos":[4163,4266],"source":" The staging table that corresponds to the **FMLabCustomerEntity** entity is named FMLabCustomerStaging."},{"pos":[4272,4320],"content":"Create a new Dynamics 365 for Operations project","linkify":"Create a new Dynamics 365 for Operations project","nodes":[{"content":"Create a new Dynamics 365 for Operations project","pos":[0,48]}]},{"pos":[4326,4445],"content":"In Visual Studio click <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept>, and then select <bpt id=\"p4\">**</bpt>Dynamics 365 for Operations Project<ept id=\"p4\">**</ept>.","source":"In Visual Studio click **File** &gt; **New** &gt; **Project**, and then select **Dynamics 365 for Operations Project**."},{"content":"Right-click the project, click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>, and verify that the project is in the Fleet Management model.","pos":[4450,4558],"source":"Right-click the project, click **Properties**, and verify that the project is in the Fleet Management model."},{"content":"If it isn't, set the <bpt id=\"p1\">**</bpt>Model<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>Fleet Management<ept id=\"p2\">**</ept>.","pos":[4559,4623],"source":" If it isn't, set the **Model** property to **Fleet Management**."},{"pos":[4629,4666],"content":"Add a new data entity to your project","linkify":"Add a new data entity to your project","nodes":[{"content":"Add a new data entity to your project","pos":[0,37]}]},{"content":"Create a new entity that is named <bpt id=\"p1\">**</bpt>FMLabCustomerEntity<ept id=\"p1\">**</ept>.","pos":[4672,4730],"source":"Create a new entity that is named **FMLabCustomerEntity**."},{"content":"Right-click you project, and then click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>New item<ept id=\"p2\">**</ept>.","pos":[4731,4797],"source":" Right-click you project, and then click **Add** &gt; **New item**."},{"content":"The <bpt id=\"p1\">**</bpt>Add New Item<ept id=\"p1\">**</ept> dialog box opens.","pos":[4798,4836],"source":" The **Add New Item** dialog box opens."},{"content":"Select <bpt id=\"p1\">**</bpt>Data Entity<ept id=\"p1\">**</ept>, and then set the <bpt id=\"p2\">**</bpt>Name<ept id=\"p2\">**</ept> property to <bpt id=\"p3\">**</bpt>FMLabCustomerEntity<ept id=\"p3\">**</ept>.","pos":[4841,4927],"source":"Select **Data Entity**, and then set the **Name** property to **FMLabCustomerEntity**."},{"content":"For more information about best practices for entity naming, see \"Data entity concepts guide.\"","pos":[4928,5022]},{"pos":[5027,5041],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"content":"In the <bpt id=\"p1\">**</bpt>Data entity<ept id=\"p1\">**</ept> wizard, specify the properties for the data entity that you're creating.","pos":[5046,5141],"source":"In the **Data entity** wizard, specify the properties for the data entity that you're creating."},{"content":"Use the values that are shown in the following screen shot.","pos":[5142,5201]},{"pos":[5204,5291],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Data Entity Wizard<ept id=\"p1\">](./media/data-entity-wizard.png)](./media/data-entity-wizard.png)</ept>","source":"[![Data Entity Wizard](./media/data-entity-wizard.png)](./media/data-entity-wizard.png)"},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[5297,5312],"source":"Click **Next**."},{"content":"For more information about the function of each property, see \"Data entity concepts guide.\"","pos":[5313,5404]},{"content":"Add fields to the new entity from your data source, as shown in the following screen shot.","pos":[5409,5499]},{"content":"You can add fields from the primary data source, <bpt id=\"p1\">**</bpt>FMCustomer<ept id=\"p1\">**</ept>.","pos":[5500,5564],"source":" You can add fields from the primary data source, **FMCustomer**."},{"content":"For this entity, clear the check box for the <bpt id=\"p1\">**</bpt>Image<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>LicenseImage<ept id=\"p2\">**</ept> container types to simplify testing.","pos":[5565,5677],"source":" For this entity, clear the check box for the **Image** and **LicenseImage** container types to simplify testing."},{"pos":[5682,5841],"content":"Rename the data entity fields to reflect public data contract standards, or click <bpt id=\"p1\">**</bpt>Convert labels to field names<ept id=\"p1\">**</ept> to generate names from the existing labels.","source":"Rename the data entity fields to reflect public data contract standards, or click **Convert labels to field names** to generate names from the existing labels."},{"content":"On the line for the <bpt id=\"p1\">**</bpt>DriverLicense<ept id=\"p1\">**</ept> field, select the <bpt id=\"p2\">**</bpt>Is mandatory<ept id=\"p2\">**</ept> check box.","pos":[5846,5929],"source":"On the line for the **DriverLicense** field, select the **Is mandatory** check box."},{"content":"This field will be used as the natural key for the entity.","pos":[5930,5988]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Data Entity Wizard 2<ept id=\"p1\">](./media/data-entity-wizard-2.png)](./media/data-entity-wizard-2.png)</ept>","pos":[5989,6082],"source":"[![Data Entity Wizard 2](./media/data-entity-wizard-2.png)](./media/data-entity-wizard-2.png)"},{"content":"In the <bpt id=\"p1\">**</bpt>Data source<ept id=\"p1\">**</ept> field, select <bpt id=\"p2\">**</bpt>PrimaryAddress<ept id=\"p2\">**</ept>.","pos":[6087,6143],"source":"In the **Data source** field, select **PrimaryAddress**."},{"content":"Notice that the <bpt id=\"p1\">**</bpt>PrimaryAddress<ept id=\"p1\">**</ept> data source is automatically added because of automatic expansion or the surrogate foreign key replacement of <bpt id=\"p2\">**</bpt>AddressID<ept id=\"p2\">**</ept>.","pos":[6144,6303],"source":" Notice that the **PrimaryAddress** data source is automatically added because of automatic expansion or the surrogate foreign key replacement of **AddressID**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Steps and add fields<ept id=\"p1\">](./media/steps-and-add-fields.png)](./media/steps-and-add-fields.png)</ept>","pos":[6304,6397],"source":"[![Steps and add fields](./media/steps-and-add-fields.png)](./media/steps-and-add-fields.png)"},{"content":"Select the fields from the <bpt id=\"p1\">**</bpt>PrimaryAddress<ept id=\"p1\">**</ept> data source that you want to be part of your entity.","pos":[6402,6500],"source":"Select the fields from the **PrimaryAddress** data source that you want to be part of your entity."},{"content":"Additionally, rename the following fields to reflect proper public data contract naming:","pos":[6501,6589]},{"content":"PrimaryAddress <ph id=\"ph1\">\\_</ph>AddressLine1 <ph id=\"ph2\">&amp;gt;</ph> AddressLine1","pos":[6598,6645],"source":"PrimaryAddress \\_AddressLine1 &gt; AddressLine1"},{"content":"PrimaryAddress <ph id=\"ph1\">\\_</ph>AddressLine2 <ph id=\"ph2\">&amp;gt;</ph> AddressLine2","pos":[6654,6701],"source":"PrimaryAddress \\_AddressLine2 &gt; AddressLine2"},{"content":"PrimaryAddress <ph id=\"ph1\">\\_</ph>City <ph id=\"ph2\">&amp;gt;</ph> City","pos":[6710,6741],"source":"PrimaryAddress \\_City &gt; City"},{"content":"PrimaryAddress <ph id=\"ph1\">\\_</ph>State <ph id=\"ph2\">&amp;gt;</ph> State","pos":[6750,6783],"source":"PrimaryAddress \\_State &gt; State"},{"content":"PrimaryAddress <ph id=\"ph1\">\\_</ph>ZipCode <ph id=\"ph2\">&amp;gt;</ph> ZipCode","pos":[6792,6829],"source":"PrimaryAddress \\_ZipCode &gt; ZipCode"},{"content":"PrimaryAddress <ph id=\"ph1\">\\_</ph>Country <ph id=\"ph2\">&amp;gt;</ph> Country","pos":[6838,6875],"source":"PrimaryAddress \\_Country &gt; Country"},{"pos":[6881,6918],"content":"<bpt id=\"p1\">[</bpt> <ept id=\"p1\">](./media/data-entity-wizard-3.png)</ept>","source":"[ ](./media/data-entity-wizard-3.png)"},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","pos":[6928,6945],"source":"Click **Finish**."},{"content":"A data entity item and staging table are added to the project.","pos":[6946,7008]},{"pos":[7010,7094],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Solution explorer<ept id=\"p1\">](./media/solution-explorer.png)](./media/solution-explorer.png)</ept>","source":"[![Solution explorer](./media/solution-explorer.png)](./media/solution-explorer.png)"},{"pos":[7100,7118],"content":"Build your project","linkify":"Build your project","nodes":[{"content":"Build your project","pos":[0,18]}]},{"pos":[7124,7202],"content":"In Solution Explorer, right-click your project, and then click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","source":"In Solution Explorer, right-click your project, and then click **Properties**."},{"content":"Change the value of the <bpt id=\"p1\">**</bpt>Synchronize database on build<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>True<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[7207,7309],"source":"Change the value of the **Synchronize database on build** property to **True**, and then click **OK**."},{"content":"This property must be set only one time per project.","pos":[7310,7362]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Entities are created as views in Microsoft SQL Server, and staging tables are also added.","pos":[7363,7462],"source":"**Note:** Entities are created as views in Microsoft SQL Server, and staging tables are also added."},{"content":"Therefore, you must sync a database when you build entities.","pos":[7463,7523]},{"content":"<ph id=\"ph1\">![</ph>Property pages<ph id=\"ph2\">](./media/property-pages.png)</ph>","pos":[7524,7569],"source":"![Property pages](./media/property-pages.png)"},{"pos":[7574,7665],"content":"On the Visual Studio toolbar, click <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept> to build the project.","source":"On the Visual Studio toolbar, click **Build** &gt; **Build Solution** to build the project."},{"content":"Verify that the build doesn't contain any errors.","pos":[7670,7719]},{"content":"At this point in the tutorial, warnings are allowed.","pos":[7720,7772]},{"pos":[7778,7819],"content":"Visually validate and customize an entity","linkify":"Visually validate and customize an entity","nodes":[{"content":"Visually validate and customize an entity","pos":[0,41]}]},{"content":"In Solution Explorer, right-click the <bpt id=\"p1\">**</bpt>FMLabCustomerEntity<ept id=\"p1\">**</ept> node, and then click <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","pos":[7825,7917],"source":"In Solution Explorer, right-click the **FMLabCustomerEntity** node, and then click **Open**."},{"content":"The designer for the entity opens in the middle pane.","pos":[7918,7971]},{"content":"Validate the properties of the <bpt id=\"p1\">**</bpt>FMLabCustomerEntity<ept id=\"p1\">**</ept> entity.","pos":[7976,8038],"source":"Validate the properties of the **FMLabCustomerEntity** entity."},{"content":"Select the entity in Solution Explorer, and compare the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> pane values to the following screen shot.","pos":[8039,8151],"source":" Select the entity in Solution Explorer, and compare the **Properties** pane values to the following screen shot."},{"content":"Set the <bpt id=\"p1\">**</bpt>Label<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>Fleet Lab Customers<ept id=\"p2\">**</ept>.","pos":[8156,8210],"source":"Set the **Label** property to **Fleet Lab Customers**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMLabCustomerEntity - Properties<ept id=\"p1\">](./media/fmlabcustomerentity-properties.png)](./media/fmlabcustomerentity-properties.png)</ept>","pos":[8211,8336],"source":"[![FMLabCustomerEntity - Properties](./media/fmlabcustomerentity-properties.png)](./media/fmlabcustomerentity-properties.png)"},{"pos":[8341,8448],"content":"In the left pane, click <bpt id=\"p1\">**</bpt>Data Sources<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>FMCustomer<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Data Sources<ept id=\"p3\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>FMAddressTable<ept id=\"p4\">**</ept>.","source":"In the left pane, click **Data Sources** &gt; **FMCustomer** &gt; **Data Sources** &gt; **FMAddressTable**."},{"content":"Change the <bpt id=\"p1\">**</bpt>Is Read Only<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>No<ept id=\"p2\">**</ept>.","pos":[8453,8500],"source":"Change the **Is Read Only** property to **No**."},{"content":"This is a known issue.","pos":[8501,8523]},{"content":"Eventually, the value will be set to <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>No<ept id=\"p2\">**</ept> automatically, based on the type of join.","pos":[8524,8620],"source":" Eventually, the value will be set to **Yes** or **No** automatically, based on the type of join."},{"content":"The value should be <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> for composition scenarios, and <bpt id=\"p2\">**</bpt>No<ept id=\"p2\">**</ept> for associations (surrogate foreign key expansions).","pos":[8621,8739],"source":" The value should be **Yes** for composition scenarios, and **No** for associations (surrogate foreign key expansions)."},{"content":"This property enables the data source to be read/write.","pos":[8740,8795]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMLabCustomerEntity - Properties2<ept id=\"p1\">](./media/fmlabcustomerentity-properties2.png)](./media/fmlabcustomerentity-properties2.png)</ept>","pos":[8796,8924],"source":"[![FMLabCustomerEntity - Properties2](./media/fmlabcustomerentity-properties2.png)](./media/fmlabcustomerentity-properties2.png)"},{"content":"In the <bpt id=\"p1\">**</bpt>FMLabCustomerEntity<ept id=\"p1\">**</ept> designer, click <bpt id=\"p2\">**</bpt>Keys<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>EntityKey<ept id=\"p3\">**</ept>, and then expand the <bpt id=\"p4\">**</bpt>Fields<ept id=\"p4\">**</ept> node.","pos":[8929,9041],"source":"In the **FMLabCustomerEntity** designer, click **Keys** &gt; **EntityKey**, and then expand the **Fields** node."},{"content":"Verify that the list of fields matches the following screen shot.","pos":[9042,9107]},{"pos":[9110,9200],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMLabCustomerEntity<ept id=\"p1\">](./media/fmlabcustomerentity.png)](./media/fmlabcustomerentity.png)</ept>","source":"[![FMLabCustomerEntity](./media/fmlabcustomerentity.png)](./media/fmlabcustomerentity.png)"},{"pos":[9206,9389],"content":"To visually validate the staging table that will be used for import/export, open the <bpt id=\"p1\">**</bpt>FMLabCustomerStaging<ept id=\"p1\">**</ept> table in the designer, and then select the <bpt id=\"p2\">**</bpt>FMLabCustomerStaging<ept id=\"p2\">**</ept> node.","source":"To visually validate the staging table that will be used for import/export, open the **FMLabCustomerStaging** table in the designer, and then select the **FMLabCustomerStaging** node."},{"pos":[9392,9520],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>fMLabCustomerStaging - Properties<ept id=\"p1\">](./media/fmlabcustomerstaging-properties.png)](./media/fmlabcustomerstaging-properties.png)</ept>","source":"[![fMLabCustomerStaging - Properties](./media/fmlabcustomerstaging-properties.png)](./media/fmlabcustomerstaging-properties.png)"},{"content":"Click <bpt id=\"p1\">**</bpt>FMLabCustomerStaging<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Fields<ept id=\"p2\">**</ept>.","pos":[9526,9573],"source":"Click **FMLabCustomerStaging** &gt; **Fields**."},{"content":"In the following screen shot, the standard fields of the staging tables are selected.","pos":[9574,9659]},{"content":"All entity staging tables have these standard fields.","pos":[9660,9713]},{"content":"The screen shot also shows the data fields that belong on this data entity.","pos":[9714,9789]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMLabCustomerStaging<ept id=\"p1\">](./media/fmlabcustomerstaging.png)](./media/fmlabcustomerstaging.png)</ept>","pos":[9791,9884],"source":"[![FMLabCustomerStaging](./media/fmlabcustomerstaging.png)](./media/fmlabcustomerstaging.png)"},{"pos":[9890,10005],"content":"In Solution Explorer, right-click your project, and then select <bpt id=\"p1\">**</bpt>Rebuild<ept id=\"p1\">**</ept> to rebuild and synchronize the project.","source":"In Solution Explorer, right-click your project, and then select **Rebuild** to rebuild and synchronize the project."},{"pos":[10010,10031],"content":"Testing data entities","linkify":"Testing data entities","nodes":[{"content":"Testing data entities","pos":[0,21]}]},{"content":"Entities can be tested by using various methods in X++, through data import/export, or through integrations.","pos":[10032,10140]},{"content":"In this section, we'll explore scenarios for validating entities.","pos":[10141,10206]},{"pos":[10212,10245],"content":"Test the entity by using X++ code","linkify":"Test the entity by using X++ code","nodes":[{"content":"Test the entity by using X++ code","pos":[0,33]}]},{"content":"One of the most common ways of interacting with data entities is through X++, by using a unit test or a runnable job to validate that the entities have been built.","pos":[10247,10410]},{"content":"In this example, we will use a runnable job.","pos":[10411,10455]},{"pos":[10461,10579],"content":"In Solution Explorer, click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>New item<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Runnable class<ept id=\"p3\">**</ept> to add a runnable class to your project.","source":"In Solution Explorer, click **Add** &gt; **New item** &gt; **Runnable class** to add a runnable class to your project."},{"content":"Copy and paste the following code into the class to test your data entity.","pos":[10584,10658]},{"content":"Run the code in debugger to set it as a startup object.","pos":[12018,12073]},{"content":"To validate the entity, view the Infolog in the debugger window or in notifications on the website.","pos":[12078,12177]},{"content":"You will see that three successful messages are logged.","pos":[12178,12233]},{"content":"You will also see the actions that were taken.","pos":[12234,12280]},{"pos":[12285,12317],"content":"Importing data by using entities","linkify":"Importing data by using entities","nodes":[{"content":"Importing data by using entities","pos":[0,32]}]},{"content":"Data entities that have the <bpt id=\"p1\">**</bpt>Data Management Enabled<ept id=\"p1\">**</ept> property can be used to import and export data in various file formats.","pos":[12318,12445],"source":"Data entities that have the **Data Management Enabled** property can be used to import and export data in various file formats."},{"content":"In this section, you will import data in a CSV file format for the <bpt id=\"p1\">**</bpt>FMLabCustomer<ept id=\"p1\">**</ept> entity.","pos":[12446,12538],"source":" In this section, you will import data in a CSV file format for the **FMLabCustomer** entity."},{"pos":[12544,12555],"content":"File import","linkify":"File import","nodes":[{"content":"File import","pos":[0,11]}]},{"content":"After you create your data entity, you can validate import/export.","pos":[12557,12623]},{"content":"Create a sample CSV file that you can import.","pos":[12629,12674]},{"content":"Copy the following text, and save it as <bpt id=\"p1\">**</bpt>FM Lab Customer Import.csv<ept id=\"p1\">**</ept>.","pos":[12675,12746],"source":" Copy the following text, and save it as **FM Lab Customer Import.csv**."},{"content":"CELLPHONE,DRIVERSLICENSE,EMAIL,FIRSTNAME,LASTNAME,CUSTOMERGROUP,ADDRESSLINE1,ADDRESSLINE2,CITY,STATE,ZIPCODE,COUNTRY(999) 555-0100,S615-3939-2349,<ph id=\"ph1\">chris.spencer@adatum.com</ph>,Chris,Spencer,adv<ph id=\"ph2\">\\_</ph>mem<ph id=\"ph3\">\\_</ph>1,444 Main Street,,Orlando,FL,77899,US(188) 555-0101,S615-3939-2350,<ph id=\"ph4\">Ichiro.lannin@blueyonderairlines.com</ph>,Ichiro,Lannin,non<ph id=\"ph5\">\\_</ph>mem<ph id=\"ph6\">\\_</ph>1,12 Long Street,,New York City,NY,99087,US(777) 555-0102,S615-3939-2351,<ph id=\"ph7\">josh.smith@fourthcoffee.com</ph>,Josh,Smith,adv<ph id=\"ph8\">\\_</ph>mem<ph id=\"ph9\">\\_</ph>1,9606 122th Avenue,,Sydney,TX,99874,US(456) 555-0103,S615-3939-2352,<ph id=\"ph10\">Vince@fabrikam.us</ph>,Vince,Ahmed,non<ph id=\"ph11\">\\_</ph>mem<ph id=\"ph12\">\\_</ph>1,123 Microsoft Way,Unit 87,Seattle,WA,90001,US(345) 555-0104,S615-3939-2353,<ph id=\"ph13\">tony.parker@lucernepublishing.com</ph>,Tony,Parker,non<ph id=\"ph14\">\\_</ph>mem<ph id=\"ph15\">\\_</ph>1,12012 11th PLNE,Apt 160,San Francisco,CA,75645,US(312) 555-0105,S615-3939-2354,<ph id=\"ph16\">Julia@fineartschool.net</ph>,Julia,Natarajan,exec<ph id=\"ph17\">\\_</ph>mem<ph id=\"ph18\">\\_</ph>1,449 Long Street,Apt 160,Bruxelles,ID,34213,US","pos":[12752,13619],"source":"CELLPHONE,DRIVERSLICENSE,EMAIL,FIRSTNAME,LASTNAME,CUSTOMERGROUP,ADDRESSLINE1,ADDRESSLINE2,CITY,STATE,ZIPCODE,COUNTRY(999) 555-0100,S615-3939-2349,chris.spencer@adatum.com,Chris,Spencer,adv\\_mem\\_1,444 Main Street,,Orlando,FL,77899,US(188) 555-0101,S615-3939-2350,Ichiro.lannin@blueyonderairlines.com,Ichiro,Lannin,non\\_mem\\_1,12 Long Street,,New York City,NY,99087,US(777) 555-0102,S615-3939-2351,josh.smith@fourthcoffee.com,Josh,Smith,adv\\_mem\\_1,9606 122th Avenue,,Sydney,TX,99874,US(456) 555-0103,S615-3939-2352,Vince@fabrikam.us,Vince,Ahmed,non\\_mem\\_1,123 Microsoft Way,Unit 87,Seattle,WA,90001,US(345) 555-0104,S615-3939-2353,tony.parker@lucernepublishing.com,Tony,Parker,non\\_mem\\_1,12012 11th PLNE,Apt 160,San Francisco,CA,75645,US(312) 555-0105,S615-3939-2354,Julia@fineartschool.net,Julia,Natarajan,exec\\_mem\\_1,449 Long Street,Apt 160,Bruxelles,ID,34213,US"},{"pos":[13626,13676],"content":"Click <bpt id=\"p1\">**</bpt>User Dashboard<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Data management<ept id=\"p2\">**</ept>.","source":"Click **User Dashboard** &gt; **Data management**."},{"pos":[13682,13746],"content":"In the <bpt id=\"p1\">**</bpt>Data Management<ept id=\"p1\">**</ept> workspace, click the <bpt id=\"p2\">**</bpt>Import<ept id=\"p2\">**</ept> tile.","source":"In the **Data Management** workspace, click the **Import** tile."},{"pos":[13751,13890],"content":"On the <bpt id=\"p1\">**</bpt>Import<ept id=\"p1\">**</ept> page, enter the import details, as shown in the following screen shot.<ph id=\"ph1\">![</ph>Import new record<ph id=\"ph2\">](./media/import-new-record.png)</ph>","source":"On the **Import** page, enter the import details, as shown in the following screen shot.![Import new record](./media/import-new-record.png)"},{"pos":[13895,14015],"content":"Click the <bpt id=\"p1\">**</bpt>Upload data<ept id=\"p1\">**</ept> button next to the <bpt id=\"p2\">**</bpt>Upload file for entity<ept id=\"p2\">**</ept> field, and select the CSV file that you created.","source":"Click the **Upload data** button next to the **Upload file for entity** field, and select the CSV file that you created."},{"content":"After the file is uploaded, you will notice that the entity is added to the middle section.","pos":[14020,14111]},{"content":"You will also receive an error that states that the mapping isn't valid.","pos":[14112,14184]},{"content":"A few fields aren't mapped correctly between the source file and the target entity.","pos":[14185,14268]},{"pos":[14273,14314],"content":"In the entities list, click <bpt id=\"p1\">**</bpt>View map<ept id=\"p1\">**</ept>.","source":"In the entities list, click **View map**."},{"content":"<bpt id=\"p1\">**</bpt>AddressLine1<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>AddressLine2<ept id=\"p2\">**</ept> are two fields in the source that aren't mapped to target fields.","pos":[14319,14422],"source":"**AddressLine1** and **AddressLine2** are two fields in the source that aren't mapped to target fields."},{"content":"In the visual mapper, or details view, map these fields as follows, and then click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept>:","pos":[14423,14515],"source":" In the visual mapper, or details view, map these fields as follows, and then click **Save**:"},{"content":"AddressLine1 – Address1","pos":[14524,14547]},{"content":"AddressLine2 – Address2","pos":[14556,14579]},{"pos":[14585,14681],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Map source to staging<ept id=\"p1\">](./media/map-source-to-staging.png)](./media/map-source-to-staging.png)</ept>","source":"[![Map source to staging](./media/map-source-to-staging.png)](./media/map-source-to-staging.png)"},{"content":"Click the <bpt id=\"p1\">**</bpt>Back<ept id=\"p1\">**</ept> button in your browser to go back to the <bpt id=\"p2\">**</bpt>Import job<ept id=\"p2\">**</ept> page.","pos":[14686,14766],"source":"Click the **Back** button in your browser to go back to the **Import job** page."},{"content":"The check mark in the entities list indicates that the entity is now ready for import.","pos":[14767,14853]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Import new record 2<ept id=\"p1\">](./media/import-new-record-2.png)](./media/import-new-record-2.png)</ept>","pos":[14854,14944],"source":"[![Import new record 2](./media/import-new-record-2.png)](./media/import-new-record-2.png)"},{"content":"Click <bpt id=\"p1\">**</bpt>Import Now<ept id=\"p1\">**</ept>.","pos":[14949,14970],"source":"Click **Import Now**."},{"content":"After the import is completed, the job status page opens.","pos":[14971,15028]},{"pos":[15033,15066],"content":"Consuming entities by using OData","linkify":"Consuming entities by using OData","nodes":[{"content":"Consuming entities by using OData","pos":[0,33]}]},{"content":"In this section, you will learn how to expose and consume an entity for OData.","pos":[15067,15145]},{"content":"Before you begin, verify that the Fleet demo data is loaded from the Microsoft Dynamics 365 for Operations client: <ph id=\"ph1\">\\[</ph>baseURL<ph id=\"ph2\">\\]</ph>/?f=FMSetup","pos":[15146,15283],"source":" Before you begin, verify that the Fleet demo data is loaded from the Microsoft Dynamics 365 for Operations client: \\[baseURL\\]/?f=FMSetup"},{"pos":[15289,15358],"content":"Review the FleetRental entity and add a navigation property for OData","linkify":"Review the FleetRental entity and add a navigation property for OData","nodes":[{"content":"Review the FleetRental entity and add a navigation property for OData","pos":[0,69]}]},{"content":"You will review the existing <bpt id=\"p1\">**</bpt>FleetRental<ept id=\"p1\">**</ept> entity and then create a relationship from one data entity to another.","pos":[15360,15475],"source":"You will review the existing **FleetRental** entity and then create a relationship from one data entity to another."},{"content":"This relationship will be used as a navigation property for OData entities.","pos":[15476,15551]},{"pos":[15557,15629],"content":"In Solution Explorer, verify that you're in the <bpt id=\"p1\">**</bpt>FMEntityLab<ept id=\"p1\">**</ept> project.","source":"In Solution Explorer, verify that you're in the **FMEntityLab** project."},{"pos":[15634,15741],"content":"In Application Explorer, search for <bpt id=\"p1\">**</bpt>FMRentalEntity<ept id=\"p1\">**</ept>, right-click it, and then select <bpt id=\"p2\">**</bpt>Add to Project<ept id=\"p2\">**</ept>.","source":"In Application Explorer, search for **FMRentalEntity**, right-click it, and then select **Add to Project**."},{"pos":[15746,15855],"content":"In Application Explorer, search for <bpt id=\"p1\">**</bpt>FMCustomerEntity<ept id=\"p1\">**</ept>, right-click it, and then select <bpt id=\"p2\">**</bpt>Add to project<ept id=\"p2\">**</ept>.","source":"In Application Explorer, search for **FMCustomerEntity**, right-click it, and then select **Add to project**."},{"pos":[15860,15939],"content":"In Solution Explorer, right-click <bpt id=\"p1\">**</bpt>FMRentalEntity<ept id=\"p1\">**</ept>, and then select <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","source":"In Solution Explorer, right-click **FMRentalEntity**, and then select **Open**."},{"pos":[15944,16044],"content":"In the view designer, select the root node, <bpt id=\"p1\">**</bpt>FMRentalEntity<ept id=\"p1\">**</ept>, and review the following properties.","source":"In the view designer, select the root node, **FMRentalEntity**, and review the following properties."},{"content":"Property","pos":[16052,16060]},{"content":"Value","pos":[16077,16082]},{"content":"Description","pos":[16092,16103]},{"content":"IsPublic","pos":[16388,16396]},{"content":"Yes","pos":[16413,16416]},{"pos":[16428,16547],"content":"When this property is set to <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept>, the entity is visible by using the OData application programming interface (API).","source":"When this property is set to **Yes**, the entity is visible by using the OData application programming interface (API)."},{"content":"Public Entity Name","pos":[16556,16574]},{"content":"FleetRental","pos":[16581,16592]},{"pos":[16596,16660],"content":"The name that will be used in the OData APIs for <bpt id=\"p1\">**</bpt>EntityType<ept id=\"p1\">**</ept>.","source":"The name that will be used in the OData APIs for **EntityType**."},{"content":"Public Collection Name","pos":[16724,16746]},{"content":"FleetRentals","pos":[16749,16761]},{"content":"The name that will be used for the OData collection entity.","pos":[16764,16823]},{"pos":[16891,16943],"content":"In the view designer, expand the <bpt id=\"p1\">**</bpt>Relations<ept id=\"p1\">**</ept> node.","source":"In the view designer, expand the **Relations** node."},{"pos":[16948,17004],"content":"Select <bpt id=\"p1\">**</bpt>Customer Relation<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Delete<ept id=\"p2\">**</ept>.","source":"Select **Customer Relation**, and then click **Delete**."},{"pos":[17009,17078],"content":"Right-click <bpt id=\"p1\">**</bpt>Relations<ept id=\"p1\">**</ept>, and then select <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Relation<ept id=\"p3\">**</ept>.","source":"Right-click **Relations**, and then select **New** &gt; **Relation**."},{"pos":[17083,17138],"content":"Select <bpt id=\"p1\">**</bpt>Relation1<ept id=\"p1\">**</ept>, and set the following properties.","source":"Select **Relation1**, and set the following properties."},{"content":"Property","pos":[17146,17154]},{"content":"Value","pos":[17180,17185]},{"content":"Cardinality","pos":[17264,17275]},{"content":"ZeroMore","pos":[17298,17306]},{"content":"Name","pos":[17323,17327]},{"content":"CustomerRelation","pos":[17357,17373]},{"content":"Related Data Entity","pos":[17382,17401]},{"content":"FMCustomerEntity","pos":[17416,17432]},{"content":"Related Data Entity Cardinality","pos":[17441,17472]},{"content":"ExactlyOne","pos":[17475,17485]},{"content":"Related Data Entity Role","pos":[17500,17524]},{"content":"CustomerRole","pos":[17534,17546]},{"content":"Relationship Type","pos":[17559,17576]},{"content":"Association","pos":[17593,17604]},{"content":"Role","pos":[17618,17622]},{"content":"Rental","pos":[17652,17658]},{"pos":[17676,17781],"content":"In the view designer, right-click the <bpt id=\"p1\">**</bpt>CustomerRelation<ept id=\"p1\">**</ept> node, and then select <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Normal<ept id=\"p3\">**</ept>.","source":"In the view designer, right-click the **CustomerRelation** node, and then select **New** &gt; **Normal**."},{"pos":[17786,17870],"content":"Right-click the new node under <bpt id=\"p1\">**</bpt>CustomerRelation<ept id=\"p1\">**</ept>, and then select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","source":"Right-click the new node under **CustomerRelation**, and then select **Properties**."},{"content":"Set the following properties.","pos":[17875,17904]},{"content":"Property","pos":[17912,17920]},{"content":"Value","pos":[17928,17933]},{"content":"Field","pos":[18116,18121]},{"pos":[18132,18209],"content":"<bpt id=\"p1\">**</bpt>CustomerDriverLicense<ept id=\"p1\">**</ept>This is the foreign key field on <bpt id=\"p2\">**</bpt>FMRentalEntity<ept id=\"p2\">**</ept>.","source":"**CustomerDriverLicense**This is the foreign key field on **FMRentalEntity**."},{"content":"Related Field","pos":[18218,18231]},{"pos":[18234,18298],"content":"<bpt id=\"p1\">**</bpt>DriverLicense<ept id=\"p1\">**</ept>This is the unique key on <bpt id=\"p2\">**</bpt>FMCustomerEntity<ept id=\"p2\">**</ept>.","source":"**DriverLicense**This is the unique key on **FMCustomerEntity**."},{"pos":[18319,18512],"content":"The following screen shot shows the relation in Visual Studio.<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FMRentalEntity - Solution explorer<ept id=\"p1\">](./media/fmrentalentity-solution-explorer.png)](./media/fmrentalentity-solution-explorer.png)</ept>","source":"The following screen shot shows the relation in Visual Studio.[![FMRentalEntity - Solution explorer](./media/fmrentalentity-solution-explorer.png)](./media/fmrentalentity-solution-explorer.png)"},{"content":"On the <bpt id=\"p1\">**</bpt>BUILD<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept> to save your changes and build the project.","pos":[18517,18608],"source":"On the **BUILD** menu, click **Build Solution** to save your changes and build the project."},{"content":"You can view the build progress in the <bpt id=\"p1\">**</bpt>Output<ept id=\"p1\">**</ept> window.","pos":[18609,18666],"source":" You can view the build progress in the **Output** window."},{"content":"To update the OData endpoint with the changes, you must run an <bpt id=\"p1\">**</bpt>iisreset<ept id=\"p1\">**</ept> command.","pos":[18671,18755],"source":"To update the OData endpoint with the changes, you must run an **iisreset** command."},{"content":"Open a **Command Prompt **windows as an administrator, and enter <bpt id=\"p1\">**</bpt>iisreset<ept id=\"p1\">**</ept>.","pos":[18756,18834],"source":" Open a **Command Prompt **windows as an administrator, and enter **iisreset**."},{"pos":[18836,18929],"content":"You've now created a navigation property between <bpt id=\"p1\">**</bpt>FMRentalEntity<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>FMCustomerEntity<ept id=\"p2\">**</ept>.","source":"You've now created a navigation property between **FMRentalEntity** and **FMCustomerEntity**."},{"pos":[18935,18977],"content":"Use standard OData syntax to retrieve data","linkify":"Use standard OData syntax to retrieve data","nodes":[{"content":"Use standard OData syntax to retrieve data","pos":[0,42]}]},{"content":"In this section, you will use some of the standard OData syntax to navigate and query the OData entities that are exposed in the Fleet Management model.","pos":[18979,19131]},{"content":"First, follow these steps the enable Internet Explorer to view JSON formatted data.","pos":[19132,19215]},{"content":"Close all Internet Explorer windows.","pos":[19221,19257]},{"content":"Go to C:FMLab, and select and double-click the json.ie.reg file.","pos":[19262,19326]},{"pos":[19331,19384],"content":"In the <bpt id=\"p1\">**</bpt>Registry Editor<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>.","source":"In the **Registry Editor** dialog box, click **Yes**."},{"pos":[19389,19402],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"Click **OK**."},{"content":"You can now use Internet Explorer to explore some OData URIs.","pos":[19404,19465]},{"content":"Start Internet Explorer, and enter the following URL in the address bar: <ph id=\"ph1\">\\[</ph>baseURL<ph id=\"ph2\">\\]</ph>/data/$metadata You will see all the metadata that is associated with OData entities.","pos":[19471,19640],"source":"Start Internet Explorer, and enter the following URL in the address bar: \\[baseURL\\]/data/$metadata You will see all the metadata that is associated with OData entities."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> The metadata might take a few minutes to appear the first time that you access it.","pos":[19641,19733],"source":"**Note:** The metadata might take a few minutes to appear the first time that you access it."},{"content":"In the XML, you can see all of the properties and navigation properties associated with the OData entities.","pos":[19734,19841]},{"content":"In the browser, find <bpt id=\"p1\">**</bpt>FleetRental<ept id=\"p1\">**</ept>.","pos":[19846,19883],"source":"In the browser, find **FleetRental**."},{"content":"The following screen shot shows the metadata of the <bpt id=\"p1\">**</bpt>FleetRental<ept id=\"p1\">**</ept> entity, together with the new relationship, <bpt id=\"p2\">**</bpt>NavigationProperty<ept id=\"p2\">**</ept>.","pos":[19884,20019],"source":" The following screen shot shows the metadata of the **FleetRental** entity, together with the new relationship, **NavigationProperty**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>FleetRental metadata<ept id=\"p1\">](./media/fleetrental-metadata.png)](./media/fleetrental-metadata.png)</ept>","pos":[20020,20113],"source":"[![FleetRental metadata](./media/fleetrental-metadata.png)](./media/fleetrental-metadata.png)"},{"pos":[20118,20331],"content":"To view all the customers in the Fleet Management application in JSON format, enter the following URL into the address bar of your browser: <ph id=\"ph1\">\\[</ph>baseURL<ph id=\"ph2\">\\]</ph>/data/FleetCustomer <bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Entity names are case-sensitive.","source":"To view all the customers in the Fleet Management application in JSON format, enter the following URL into the address bar of your browser: \\[baseURL\\]/data/FleetCustomer **Note:** Entity names are case-sensitive."},{"content":"If you don't want to retrieve all properties for the customers, you can retrieve just selected properties.","pos":[20336,20442]},{"content":"For example, to retrieve only <bpt id=\"p1\">**</bpt>FirstName<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>LastName<ept id=\"p2\">**</ept>, enter the following URL: <ph id=\"ph1\">\\[</ph>baseURL<ph id=\"ph2\">\\]</ph>/data/FleetCustomers?$filter=FirstName.LastName","pos":[20443,20588],"source":" For example, to retrieve only **FirstName** and **LastName**, enter the following URL: \\[baseURL\\]/data/FleetCustomers?$filter=FirstName.LastName"},{"content":"You can also apply filters.","pos":[20593,20620]},{"content":"For example, to filter on all customers where <bpt id=\"p1\">**</bpt>FirstName<ept id=\"p1\">**</ept><ph id=\"ph1\">=</ph><bpt id=\"p2\">**</bpt>Phil<ept id=\"p2\">**</ept>, enter the following URL: <ph id=\"ph2\">\\[</ph>baseUrl<ph id=\"ph3\">\\]</ph>/data/FleetCustomers?$filter=FirstName%20eq%20'Phil' <bpt id=\"p3\">**</bpt>Note:<ept id=\"p3\">**</ept> These URLs won't work if you copy and paste them.","pos":[20621,20839],"source":" For example, to filter on all customers where **FirstName**=**Phil**, enter the following URL: \\[baseUrl\\]/data/FleetCustomers?$filter=FirstName%20eq%20'Phil' **Note:** These URLs won't work if you copy and paste them."},{"content":"You must manually enter them in the address bar.","pos":[20840,20888]},{"pos":[20893,21163],"content":"To retrieve all the <bpt id=\"p1\">**</bpt>Rental<ept id=\"p1\">**</ept> records, together with all details of the customers, enter the following URL: <ph id=\"ph1\">\\[</ph>baseURL<ph id=\"ph2\">\\]</ph>/data/FleetRentals?$expand=CustomerRole The following example shows a <bpt id=\"p2\">**</bpt>Rental<ept id=\"p2\">**</ept> record, together with details of the linked customer, in JSON format.","source":"To retrieve all the **Rental** records, together with all details of the customers, enter the following URL: \\[baseURL\\]/data/FleetRentals?$expand=CustomerRole The following example shows a **Rental** record, together with details of the linked customer, in JSON format."},{"pos":[22370,22399],"content":"Add an action to OData entity","linkify":"Add an action to OData entity","nodes":[{"content":"Add an action to OData entity","pos":[0,29]}]},{"content":"Actions provide a way to inject behaviors into the data model.","pos":[22401,22463]},{"content":"In Dynamics 'AX 7,' you add actions by adding a method to the data entity and then decorating the method with specific attributes.","pos":[22464,22594]},{"content":"In this section, we'll walk through the steps for adding an action.","pos":[22595,22662]},{"pos":[22668,22752],"content":"In Solution Explorer, right-click <bpt id=\"p1\">**</bpt>FMRentalEntity<ept id=\"p1\">**</ept>, and then select <bpt id=\"p2\">**</bpt>View code<ept id=\"p2\">**</ept>.","source":"In Solution Explorer, right-click **FMRentalEntity**, and then select **View code**."},{"pos":[22757,22828],"content":"Copy the following code lines, and paste them into the <bpt id=\"p1\">**</bpt>Code<ept id=\"p1\">**</ept> window.","source":"Copy the following code lines, and paste them into the **Code** window."},{"content":"On the <bpt id=\"p1\">**</bpt>BUILD<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Rebuild Solution<ept id=\"p2\">**</ept> to save your changes and build the project.","pos":[23132,23225],"source":"On the **BUILD** menu, click **Rebuild Solution** to save your changes and build the project."},{"content":"You can view the build progress in the <bpt id=\"p1\">**</bpt>Output<ept id=\"p1\">**</ept> window.","pos":[23226,23283],"source":" You can view the build progress in the **Output** window."},{"content":"To update the OData endpoint with the changes, you must run an <bpt id=\"p1\">**</bpt>iisreset<ept id=\"p1\">**</ept> command.","pos":[23288,23372],"source":"To update the OData endpoint with the changes, you must run an **iisreset** command."},{"content":"Open a <bpt id=\"p1\">**</bpt>Command Prompt<ept id=\"p1\">**</ept> window as an administrator, and enter <bpt id=\"p2\">**</bpt>iisreset<ept id=\"p2\">**</ept>.","pos":[23373,23450],"source":" Open a **Command Prompt** window as an administrator, and enter **iisreset**."},{"content":"The action that you just added can be invoked through code, as you will see in the next section.","pos":[23452,23548]},{"pos":[23554,23640],"content":"Consume the Dynamics 365 for Operations OData API from an external console application","linkify":"Consume the Dynamics 365 for Operations OData API from an external console application","nodes":[{"content":"Consume the Dynamics 365 for Operations OData API from an external console application","pos":[0,86]}]},{"content":"In this section, you will use a console application to consume the OData endpoints that are exposed in the Fleet Management application.","pos":[23642,23778]},{"content":"The console application first creates a new customer and then creates a new reservation for that customer.","pos":[23779,23885]},{"content":"This tutorial shows how easy it is to use OData together with standard .NET Windows Communication Foundation (WCF) data service libraries to integrate with Dynamics AX.","pos":[23886,24054]},{"content":"Start a new instance of Visual Studio.","pos":[24060,24098]},{"pos":[24103,24166],"content":"On the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> menu, click <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Project/Solution<ept id=\"p3\">**</ept>.","source":"On the **File** menu, click **Open** &gt; **Project/Solution**."},{"pos":[24171,24306],"content":"In the <bpt id=\"p1\">**</bpt>Open Project<ept id=\"p1\">**</ept> dialog box, browse to <bpt id=\"p2\">**</bpt>C:FMLabOdata4ConsoleApplication<ept id=\"p2\">**</ept>, and then select <bpt id=\"p3\">**</bpt>Odata4ConsoleApplication.csproj<ept id=\"p3\">**</ept>.","source":"In the **Open Project** dialog box, browse to **C:FMLabOdata4ConsoleApplication**, and then select **Odata4ConsoleApplication.csproj**."},{"content":"Click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>.","pos":[24311,24326],"source":"Click **Open**."},{"content":"The <bpt id=\"p1\">**</bpt>Odata4ConsoleApplication<ept id=\"p1\">**</ept> project appears in Solution Explorer.","pos":[24327,24397],"source":" The **Odata4ConsoleApplication** project appears in Solution Explorer."},{"pos":[24402,24464],"content":"In Solution Explorer, double-click <bpt id=\"p1\">**</bpt>OdataProxyGenerator.tt<ept id=\"p1\">**</ept>.","source":"In Solution Explorer, double-click **OdataProxyGenerator.tt**."},{"content":"In the code editor, replace the following string with your organization's Dynamics 365 for Operations URL.","pos":[24469,24575]},{"content":"Save the OdataProxyGenerator.tt file.","pos":[24660,24697]},{"content":"In the <bpt id=\"p1\">**</bpt>Save of Read-only file<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Overwrite<ept id=\"p2\">**</ept>.","pos":[24702,24768],"source":"In the **Save of Read-only file** dialog box, click **Overwrite**."},{"content":"The proxy class for the OData metadata endpoint is generated.","pos":[24769,24830]},{"content":"This operation might take a few minutes.","pos":[24831,24871]},{"pos":[24876,24926],"content":"In Solution Explorer, double-click <bpt id=\"p1\">**</bpt>Program.cs<ept id=\"p1\">**</ept>.","source":"In Solution Explorer, double-click **Program.cs**."},{"pos":[24931,25042],"content":"Replace the value of the <bpt id=\"p1\">**</bpt>dynamicsBaseUri<ept id=\"p1\">**</ept> variable with your organization's Dynamics 365 for Operations URL.","source":"Replace the value of the **dynamicsBaseUri** variable with your organization's Dynamics 365 for Operations URL."},{"pos":[25047,25130],"content":"Verify that there is a final closing slash (/) in the URL, and then click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept>.","source":"Verify that there is a final closing slash (/) in the URL, and then click **Save**."},{"pos":[25135,25201],"content":"In the <bpt id=\"p1\">**</bpt>Save of Read-only file<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Overwrite<ept id=\"p2\">**</ept>.","source":"In the **Save of Read-only file** dialog box, click **Overwrite**."},{"content":"Press F5 to run the application, and then follow the instructions in the output console window.","pos":[25206,25301]},{"content":"The application might prompt you for your Dynamics AX credentials.","pos":[25302,25368]},{"content":"After the application has run, the new customer and the corresponding reservation are created in Dynamics 365 for Operations.","pos":[25369,25494]},{"pos":[25499,25584],"content":"Follow these steps to verify that the new reservation appears on the <bpt id=\"p1\">**</bpt>Rental<ept id=\"p1\">**</ept> page:","source":"Follow these steps to verify that the new reservation appears on the **Rental** page:"},{"pos":[25593,25805],"content":"Start Internet Explorer, and enter the following URL in the address bar: <ph id=\"ph1\">\\[</ph>baseURL<ph id=\"ph2\">\\]</ph>/?mi=FMRental The <bpt id=\"p1\">**</bpt>FMRental<ept id=\"p1\">**</ept> page shows the list of rentals.<bpt id=\"p2\">[</bpt><ph id=\"ph3\">![</ph>Rental list<ept id=\"p2\">](./media/rental-list.png)](./media/rental-list.png)</ept>","source":"Start Internet Explorer, and enter the following URL in the address bar: \\[baseURL\\]/?mi=FMRental The **FMRental** page shows the list of rentals.[![Rental list](./media/rental-list.png)](./media/rental-list.png)"},{"content":"At the bottom of the list, click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> to view the next page.","pos":[25814,25878],"source":"At the bottom of the list, click **Next** to view the next page."},{"content":"On this page, you can see that the reservation was created for the new customer that you added.<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>customer reservation<ept id=\"p1\">](./media/customer-reservation.png)](./media/customer-reservation.png)</ept>","pos":[25879,26067],"source":" On this page, you can see that the reservation was created for the new customer that you added.[![customer reservation](./media/customer-reservation.png)](./media/customer-reservation.png)"},{"content":"This completes the walkthrough, where you've seen an external client interacting with the Fleet Management model by using OData endpoint.","pos":[26069,26206]},{"pos":[26208,26216],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[26227,26319],"content":"<bpt id=\"p1\">[</bpt>Developing an entity and using it for data migration<ept id=\"p1\">](develop-entity-for-data-migration.md)</ept>","source":"[Developing an entity and using it for data migration](develop-entity-for-data-migration.md)"}]}