{"nodes":[{"pos":[32,88],"content":"Intelligent Data Management Framework overview (AX 2012)","needQuote":true,"needEscape":true,"nodes":[{"content":"Intelligent Data Management Framework overview (AX 2012)","pos":[0,56]}]},{"pos":[102,453],"content":"This topic describes the administration and use of the Microsoft Dynamics AX Intelligent Data Management Framework (IDMF). IDMF lets system administrators optimize the performance of Microsoft Dynamics AX installations. IDMF assesses the health of the Microsoft Dynamics AX application, analyzes current usage patterns, and helps reduce database size.","needQuote":true,"needEscape":true,"nodes":[{"content":"This topic describes the administration and use of the Microsoft Dynamics AX Intelligent Data Management Framework (IDMF). IDMF lets system administrators optimize the performance of Microsoft Dynamics AX installations. IDMF assesses the health of the Microsoft Dynamics AX application, analyzes current usage patterns, and helps reduce database size.","pos":[0,351],"nodes":[{"content":"This topic describes the administration and use of the Microsoft Dynamics AX Intelligent Data Management Framework (IDMF).","pos":[0,122]},{"content":"IDMF lets system administrators optimize the performance of Microsoft Dynamics AX installations.","pos":[123,219]},{"content":"IDMF assesses the health of the Microsoft Dynamics AX application, analyzes current usage patterns, and helps reduce database size.","pos":[220,351]}]}]},{"pos":[923,979],"content":"Intelligent Data Management Framework overview (AX 2012)","linkify":"Intelligent Data Management Framework overview (AX 2012)","nodes":[{"content":"Intelligent Data Management Framework overview (AX 2012)","pos":[0,56]}]},{"content":"This topic describes the administration and use of the Microsoft Dynamics AX Intelligent Data Management Framework (IDMF).","pos":[981,1103]},{"content":"IDMF lets system administrators optimize the performance of Microsoft Dynamics AX installations.","pos":[1104,1200]},{"content":"IDMF assesses the health of the Microsoft Dynamics AX application, analyzes current usage patterns, and helps reduce database size.","pos":[1201,1332]},{"content":"The Microsoft Dynamics AX Intelligent Data Management Framework (IDMF) lets you analyze the database and maintain an optimal database size.","pos":[1334,1473]},{"content":"To maintain the database size, IDMF provides the purge and archive functions.","pos":[1474,1551]},{"content":"The purge function removes or deletes data from a set of related entities, or tables, from the production database.","pos":[1552,1667]},{"content":"The archive function moves data from all related tables from the production database to a standby database called the archive database.","pos":[1668,1803]},{"content":"Users can use the archive database for reporting purposes but cannot update it.","pos":[1804,1883]},{"content":"IDMF and this topic use the term offlining interchangeably with the term archiving, and purge or recycling interchangeably with deleting.","pos":[1884,2021]},{"content":"Both the purge and archive operations depend on a carefully determined hierarchical relationship tree of related tables based on the Microsoft Dynamics AX metadata.","pos":[2022,2186]},{"content":"To create a hierarchical relationship, you select a parent table and discover all related tables based on the Microsoft Dynamics AX metadata.","pos":[2187,2328]},{"content":"The parent table in the relationship is put at the root level of the tree.","pos":[2329,2403]},{"content":"The discovery process creates a nested relationship tree from a parent entity to a child entity, until there are no relationships left at the lowest level.","pos":[2404,2559]},{"content":"The relationship tree that is created based on the driver table is called either a Purge Object or an Archive Object.","pos":[2560,2677]},{"content":"A Purge Object is used to remove selected records from all tables in the relationship tree from the Microsoft Dynamics AX database.","pos":[2678,2809]},{"content":"Similarly, an Archive Object is used to move selected records from all tables in the relationship tree from the Microsoft Dynamics AX database to the archive database.","pos":[2810,2977]},{"content":"After creating a Purge Object or an Archive Object, you can apply business rules and selection criteria to entities and transactions to determine which records are deleted or moved from the production database.","pos":[2978,3188]},{"content":"Finally, you create a scheduled task to purge or archive the database.","pos":[3189,3259]},{"content":"At run time, a purge task selects matching records from all the tables in the Purge Object and deletes them from the production database.","pos":[3260,3397]},{"content":"Similarly, an archive task selects matching records from all the tables in the Archive Object and moves them from the production database to the archive database.","pos":[3398,3560]},{"content":"With careful planning and system testing, the purge and archive tasks delete or move records from the production database while maintaining the consistency and integrity of your database.","pos":[3561,3748]},{"pos":[3754,3762],"content":"Audience","linkify":"Audience","nodes":[{"content":"Audience","pos":[0,8]}]},{"content":"This topic is designed for database and system administrators who are responsible for the administration and maintenance of the Microsoft Dynamics AX application and the Microsoft SQL Server database.","pos":[3764,3964]},{"pos":[3970,3983],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"To benefit from this topic, you must have knowledge in the following areas:","pos":[3985,4060]},{"content":"Microsoft Dynamics AX application and system administration","pos":[4066,4125]},{"content":"SQL Server database administration, backup, recovery, and performance tuning","pos":[4130,4206]},{"content":"Windows Server administration, backup, recovery, and performance tuning","pos":[4211,4282]},{"pos":[4286,4297],"content":"<bpt id=\"p1\">**</bpt>Caution<ept id=\"p1\">**</ept>","source":"**Caution**"},{"content":"To use this topic, you must have experience in the maintenance and administration of the Microsoft Dynamics AX application and database.","pos":[5700,5836]},{"content":"IDMF lets you create or modify Purge Objects and Archive Objects.","pos":[5837,5902]},{"content":"A Purge Object or an Archive Object defines a hierarchical relationship tree among the Microsoft Dynamics AX application tables.","pos":[5903,6031]},{"content":"You can then apply rules to select records based on specific criteria.","pos":[6032,6102]},{"content":"A scheduled purge task selects records that match the criteria in the Purge Object, and deletes them from all the tables in the relationship tree.","pos":[6103,6249]},{"content":"A scheduled archive task selects and moves records from the production database to the archive database that matches the criteria in the Archive Object.","pos":[6250,6402]},{"pos":[6409,6428],"content":"System architecture","linkify":"System architecture","nodes":[{"content":"System architecture","pos":[0,19]}]},{"content":"This section provides a high-level overview of the system architecture of IDMF.","pos":[6429,6508]},{"content":"IDMF was created using the Microsoft .NET development environment and provides a single document interface (SDI).","pos":[6509,6622]},{"content":"IDMF uses a database, called the management database, for the storage and retrieval of data, and communicates with an Application Object Server (AOS) instance through the .NET Business Connector.","pos":[6623,6818]},{"content":"The AOS processes all the business logic and database queries to access the Microsoft Dynamics AX application database.","pos":[6819,6938]},{"content":"You must install the business connector on the computer where you install IDMF.","pos":[6939,7018]},{"content":"During installation, IDMF installs a Windows service called the Microsoft Dynamics AX Intelligent Data Management Framework service.","pos":[7019,7151]},{"content":"This service is used to run scheduled jobs and is referred to as the scheduler service for IDMF.","pos":[7152,7248]},{"content":"In the post-installation stage, IDMF uses the Microsoft Dynamics AX client to import and compile two X++ projects (XPOs).","pos":[7249,7370]},{"content":"One XPO is used to create the application entities that are required by IDMF, such as classes, tables, and a job.","pos":[7371,7484]},{"content":"The Microsoft Dynamics AX Windows client is used to import and synchronize the metadata from Microsoft Dynamics AX with IDMF.","pos":[7485,7610]},{"content":"The following diagram provides a high-level overview of IDMF system architecture.","pos":[7611,7692]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>IDMF01<ept id=\"p1\">](./media/idmf01.jpg)](./media/idmf01.jpg)</ept>","pos":[7694,7745],"source":"[![IDMF01](./media/idmf01.jpg)](./media/idmf01.jpg)"},{"pos":[7750,7783],"content":"<bpt id=\"p1\">**</bpt>Figure 1. System architecture<ept id=\"p1\">**</ept>","source":"**Figure 1. System architecture**"},{"pos":[7787,7795],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>","source":"**Note**"},{"content":"The system architecture diagram shows a single SQL Server computer with different databases, for ease of illustration.","pos":[8217,8335]},{"content":"You can deploy these databases on a single database server or on multiple database servers.","pos":[8336,8427]},{"pos":[8434,8454],"content":"Deployment scenarios","linkify":"Deployment scenarios","nodes":[{"content":"Deployment scenarios","pos":[0,20]}]},{"content":"This section describes the deployment scenarios for IDMF.","pos":[8455,8512]},{"content":"As shown in the following sections, the system topology can range from a single-server environment to a multi-server deployment.","pos":[8513,8641]},{"pos":[8646,8670],"content":"Single-server deployment","linkify":"Single-server deployment","nodes":[{"content":"Single-server deployment","pos":[0,24]}]},{"content":"The following diagram shows the deployment of all components on a single server.","pos":[8672,8752]},{"content":"This topology is not recommended for the production environment.","pos":[8753,8817]},{"pos":[8820,8871],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>IDMF02<ept id=\"p1\">](./media/idmf02.jpg)](./media/idmf02.jpg)</ept>","source":"[![IDMF02](./media/idmf02.jpg)](./media/idmf02.jpg)"},{"pos":[8876,8914],"content":"<bpt id=\"p1\">**</bpt>Figure 2. Single-server deployment<ept id=\"p1\">**</ept>","source":"**Figure 2. Single-server deployment**"},{"pos":[8920,8943],"content":"Multi-server deployment","linkify":"Multi-server deployment","nodes":[{"content":"Multi-server deployment","pos":[0,23]}]},{"content":"The following diagram shows a multi-server deployment, where the AOS instance, the database server, and IDMF are deployed on dedicated servers.","pos":[8945,9088]},{"pos":[9091,9142],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>IDMF03<ept id=\"p1\">](./media/idmf03.jpg)](./media/idmf03.jpg)</ept>","source":"[![IDMF03](./media/idmf03.jpg)](./media/idmf03.jpg)"},{"pos":[9147,9184],"content":"<bpt id=\"p1\">**</bpt>Figure 3. Multi-server deployment<ept id=\"p1\">**</ept>","source":"**Figure 3. Multi-server deployment**"},{"pos":[9190,9212],"content":"Distributed deployment","linkify":"Distributed deployment","nodes":[{"content":"Distributed deployment","pos":[0,22]}]},{"content":"The following diagram shows a distributed deployment that extends the multi-server topology by putting each database on a dedicated database server.","pos":[9214,9362]},{"content":"Optionally, you can combine the management database and the production replica database on a single server.","pos":[9363,9470]},{"pos":[9473,9524],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>IDMF04<ept id=\"p1\">](./media/idmf04.jpg)](./media/idmf04.jpg)</ept>","source":"[![IDMF04](./media/idmf04.jpg)](./media/idmf04.jpg)"},{"pos":[9527,9563],"content":"<bpt id=\"p1\">**</bpt>Figure 4. Distributed deployment<ept id=\"p1\">**</ept>","source":"**Figure 4. Distributed deployment**"},{"pos":[9568,9584],"content":"Before you begin","linkify":"Before you begin","nodes":[{"content":"Before you begin","pos":[0,16]}]},{"content":"When you start IDMF for the first time, you are prompted to create a baseline snapshot of the database and the application.","pos":[9585,9708]},{"content":"The baseline process takes a snapshot of the production database and determines the health of the Microsoft Dynamics AX application.","pos":[9709,9841]},{"content":"You must create a baseline snapshot before you can use IDMF.","pos":[9842,9902]},{"content":"Before working with IDMF, be aware of the following considerations:","pos":[9903,9970]},{"content":"The archive and purge operations are resource intensive and affect hardware resources, such as memory, processors, disk drives or storage, and the network.","pos":[9975,10130]},{"content":"Schedule these operations during a maintenance window, when users are offline.","pos":[10131,10209]},{"content":"Work with the purge and archive tasks in the test environment to understand their effect on the hardware and software resources, and to understand the time required for successful completion.","pos":[10214,10405]},{"content":"Use the results of the tests performed in the test environment to determine your maintenance window in the production environment.","pos":[10406,10536]},{"content":"Verify that the initial database size of the production and archive databases provides sufficient room for future growth with a large volume of data.","pos":[10541,10690]},{"content":"Ensure that database files in the production and archive databases have sufficient room to complete the purge and archive operations without using the automatic growth option.","pos":[10691,10866]},{"content":"We recommend that you consider the automatic growth option a safety mechanism that enables the database files to grow when absolutely necessary, and that therefore prevents errors.","pos":[10867,11047]},{"content":"For more information about the database configuration checklist for SQL Server, see <bpt id=\"p1\">[</bpt>Planning database configuration for Microsoft Dynamics AX<ept id=\"p1\">](http://www.microsoft.com/downloads/details.aspx?FamilyID=ab4cd401-b366-4c1c-9a73-88c945ae8191)</ept>.","pos":[11048,11287],"source":" For more information about the database configuration checklist for SQL Server, see [Planning database configuration for Microsoft Dynamics AX](http://www.microsoft.com/downloads/details.aspx?FamilyID=ab4cd401-b366-4c1c-9a73-88c945ae8191)."},{"content":"Carefully plan archive tasks for tables with a data type of blob and memo, because of their large storage requirements.","pos":[11292,11411]},{"content":"For each archive and purge task, follow these steps:","pos":[11416,11468]},{"content":"Estimate the number of records that must be purged or archived.","pos":[11477,11540]},{"content":"Calculate the size of the affected records, in megabytes.","pos":[11549,11606]},{"content":"For a purge operation, verify that the available space in the production database is at least twice as much as the size you calculated in the previous step.","pos":[11615,11771]},{"content":"For an archive operation, verify that the available space in the production and archive databases is at least twice as much as the size you calculated in the previous step.","pos":[11772,11944]},{"content":"Determine the time that is required to successfully complete the purge or archive task.","pos":[11953,12040]},{"content":"Run the task during a maintenance window to minimize the effect on online users.","pos":[12041,12121]},{"content":"A purge operation makes database changes in the production database.","pos":[12126,12194]},{"content":"An archive operation makes database changes in the production and archive databases.","pos":[12195,12279]},{"content":"Select the full recovery model for the production database.","pos":[12280,12339]},{"content":"Carefully determine the recovery model for the archive database.","pos":[12340,12404]},{"content":"The simple recovery model provides better performance for the archive operation, but you risk significant work-loss exposure if the database is damaged.","pos":[12405,12557]},{"content":"Data is recoverable only to the most recent backup of the lost data.","pos":[12558,12626]},{"content":"The full recovery model provides better protection for data than the simple recovery model.","pos":[12627,12718]},{"content":"The full recovery model relies on backing up the transaction log to provide full recoverability and prevent work loss in the broadest range of failure scenarios.","pos":[12719,12880]},{"content":"However, the archive task takes longer to be completed with a full recover model than a simple recovery model.","pos":[12881,12991]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Choosing the Recovery Model for a Database<ept id=\"p1\">](http://technet.microsoft.com/en-us/library/ms175987.aspx)</ept>.","pos":[12992,13121],"source":" For more information, see [Choosing the Recovery Model for a Database](http://technet.microsoft.com/en-us/library/ms175987.aspx)."},{"content":"Perform a complete database backup of the production and archive databases immediately before running a purge or archive task.","pos":[13126,13252]},{"content":"Back up the transaction logs of the production database before and after each purge and archive operation.","pos":[13253,13359]},{"content":"Back up the transaction log of the archive database immediately after each archive operation when using the full recovery model.","pos":[13360,13488]},{"content":"Perform a complete database backup of the archive database immediately after each archive operation when using the simple recovery model.","pos":[13489,13626]},{"content":"You can configure an AOS instance to connect to an archive database to view archived records.","pos":[13631,13724]},{"content":"However, this connection must be read-only.","pos":[13725,13768]},{"content":"Any attempt to update the data in the archive database, or to perform operations such as database synchronization from the Application Object Tree (AOT), cause data and application corruption.","pos":[13769,13961]},{"pos":[13966,13977],"content":"Terminology","linkify":"Terminology","nodes":[{"content":"Terminology","pos":[0,11]}]},{"content":"This section explains the terminology and concepts used in IDMF.","pos":[13978,14042]},{"content":"Term","pos":[14046,14050]},{"content":"Description","pos":[14102,14113]},{"content":"Analysis snapshot","pos":[15002,15019]},{"content":"A task that captures database analysis information, such as the data size, index size, and index usage.","pos":[15058,15161]},{"content":"Archive","pos":[15480,15487]},{"content":"Archive the records that match selection criteria from all tables in the relationship tree of an Archive Object.","pos":[15536,15648]},{"content":"The archiving process moves records from the production database to the archive database.","pos":[15649,15738]},{"content":"The terms archive and offline are used interchangeably in this topic.","pos":[15739,15808]},{"content":"Archive Object","pos":[15958,15972]},{"content":"A relationship tree that you create by selecting a driver table and related tables.","pos":[16014,16097]},{"content":"Archive template","pos":[16436,16452]},{"content":"An Archive Object that is included with IDMF.","pos":[16492,16537]},{"content":"You must review and save the archive template before you can use it to archive data.","pos":[16538,16622]},{"content":"A saved archive template becomes an Archive Object.","pos":[16623,16674]},{"content":"Baseline","pos":[16914,16922]},{"content":"A snapshot of the database or the application that is captured through specific queries.","pos":[16970,17058]},{"content":"Discovery","pos":[17392,17401]},{"content":"The discovery process begins with the driver table and searches through the Microsoft Dynamics AX application metadata to capture all tables in the relationship tree.","pos":[17448,17614]},{"content":"Driver table","pos":[17870,17882]},{"content":"A parent table in the parent-child relationship of related tables.","pos":[17926,17992]},{"content":"The driver table is the root parent.","pos":[17993,18029]},{"content":"Entity","pos":[18348,18354]},{"content":"A database table.","pos":[18404,18421]},{"content":"Exception","pos":[18826,18835]},{"content":"A list of tables, table groups, and configuration keys with a defined restriction from use in a Purge Object or an Archive Object.","pos":[18882,19012]},{"content":"An exception parameter can be a table, a table group, or a configuration key.","pos":[19013,19090]},{"content":"Expression","pos":[19304,19314]},{"content":"A condition that you put in a rule in a Purge Object or an Archive Object.","pos":[19360,19434]},{"content":"When you have multiple expressions, they form the \"or\" clauses in a query.","pos":[19435,19509]},{"content":"Level","pos":[19782,19787]},{"content":"A grouping of tables in a Purge Object or an Archive Object.","pos":[19838,19898]},{"content":"The driver table starts at level 0, which is the root level.","pos":[19899,19959]},{"content":"All the tables related to the driver table are put in level 1.","pos":[19960,20022]},{"content":"All the tables related to a table in level 1 are put in level 2, and so on.","pos":[20023,20098]},{"content":"The levels form the parent-child hierarchy in a relationship tree.","pos":[20099,20165]},{"content":"Management database","pos":[20260,20279]},{"content":"The database that is used by IDMF.","pos":[20316,20350]},{"content":"Master data synchronization","pos":[20738,20765]},{"content":"The process of replicating master data tables from the production database to the archive database.","pos":[20794,20893]},{"content":"This process copies the master data tables from the production database to the archive database to keep them synchronized.","pos":[20894,21016]},{"content":"Master data tables","pos":[21216,21234]},{"content":"The master data synchronization task copies the master data tables from the production database to the archive database.","pos":[21272,21392]},{"content":"These tables are not archived, meaning they retain their data in the production database after the records are copied to the archive database.","pos":[21393,21535]},{"content":"Measure","pos":[21694,21701]},{"content":"A measure captures aggregated statistics for key business processes by company and by year in the Microsoft Dynamics AX application.","pos":[21750,21882]},{"content":"Metadata synchronization","pos":[22172,22196]},{"content":"The process of synchronizing database schemas and database objects from the production database to the archive database.","pos":[22228,22348]},{"content":"Offline or offlining","pos":[22650,22670]},{"content":"The same as archive.","pos":[22706,22726]},{"content":"Performance dashboard","pos":[23128,23149]},{"content":"The performance dashboard displays the database configuration details for all databases used by IDMF, and table statistics and query statistics for the production and archive databases.","pos":[23184,23369]},{"content":"Purge","pos":[23606,23611]},{"content":"Delete the records that match selection criteria from all tables in the relationship tree of a Purge Object.","pos":[23662,23770]},{"content":"Purge and recycle are used interchangeably in this topic.","pos":[23771,23828]},{"content":"Purge Object","pos":[24084,24096]},{"content":"A relationship tree that you create by selecting a driver table and related tables.","pos":[24140,24223]},{"content":"Purge task","pos":[24562,24572]},{"content":"A purge task recycles all the records from the database by using a Purge Object, based on values set for the rules of the Purge Object.","pos":[24618,24753]},{"content":"Purge template","pos":[25040,25054]},{"content":"A Purge Object that is included with IDMF.","pos":[25096,25138]},{"content":"You must review and save the purge template before you can use it for recycling.","pos":[25139,25219]},{"content":"A saved purge template becomes a Purge Object.","pos":[25220,25266]},{"content":"Recycle","pos":[25518,25525]},{"content":"The same as purge.","pos":[25574,25592]},{"content":"Relation","pos":[25996,26004]},{"content":"A child table that you add to a Purge Object or an Archive Object.","pos":[26052,26118]},{"content":"All tables in a relationship tree have a parent table, except the driver table.","pos":[26119,26198]},{"content":"Relationship tree","pos":[26474,26491]},{"content":"A parent-child relationship that starts with the driver table.","pos":[26530,26592]},{"content":"The driver table is put in level 0, or the root level, of the relationship tree.","pos":[26593,26673]},{"content":"All the tables that refer to the driver table as a parent are put in level 1.","pos":[26674,26751]},{"content":"All the tables that refer to a table in level 1 as a parent are put in level 2.","pos":[26752,26831]},{"content":"The child-parent relationship keeps going deeper until all the related tables are grouped in the relationship tree.","pos":[26832,26947]},{"content":"Restore","pos":[26952,26959]},{"content":"The process of restoring archived data from the archive database to the production database.","pos":[27008,27100]},{"content":"The restore process moves qualifying data from the archive database to the production database.","pos":[27101,27196]},{"content":"Rule","pos":[27430,27434]},{"content":"A condition that you put on a field in one of the entities in a Purge Object or an Archive Object.","pos":[27486,27584]},{"content":"When you have multiple rules, they form the \"and\" clauses in a query.","pos":[27585,27654]},{"content":"System health, also referred to as application health","pos":[27908,27961]},{"content":"System health provides analysis for selected measures from the Inventory management, Accounts receivable, Accounts payable, General ledger, and Administration modules of Microsoft Dynamics AX.","pos":[27964,28156]}],"content":"---\n# required metadata\n\ntitle: Intelligent Data Management Framework overview (AX 2012)\ndescription: This topic describes the administration and use of the Microsoft Dynamics AX Intelligent Data Management Framework (IDMF). IDMF lets system administrators optimize the performance of Microsoft Dynamics AX installations. IDMF assesses the health of the Microsoft Dynamics AX application, analyzes current usage patterns, and helps reduce database size.\nauthor: kfend\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: Lifecycle Services\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \n# ms.reviewer: 51\nms.search.scope: AX 2012\n# ms.tgt_pltfrm: \nms.custom: 18551\nms.assetid: 5dac88bb-39a4-4d0c-a426-3d30bbaae357\nms.search.region: Global\n# ms.search.industry: \nms.author: kfend\nms.search.validFrom: \nms.dyn365.ops.version: 2012\n\n---\n\n# Intelligent Data Management Framework overview (AX 2012)\n\nThis topic describes the administration and use of the Microsoft Dynamics AX Intelligent Data Management Framework (IDMF). IDMF lets system administrators optimize the performance of Microsoft Dynamics AX installations. IDMF assesses the health of the Microsoft Dynamics AX application, analyzes current usage patterns, and helps reduce database size.\n\nThe Microsoft Dynamics AX Intelligent Data Management Framework (IDMF) lets you analyze the database and maintain an optimal database size. To maintain the database size, IDMF provides the purge and archive functions. The purge function removes or deletes data from a set of related entities, or tables, from the production database. The archive function moves data from all related tables from the production database to a standby database called the archive database. Users can use the archive database for reporting purposes but cannot update it. IDMF and this topic use the term offlining interchangeably with the term archiving, and purge or recycling interchangeably with deleting. Both the purge and archive operations depend on a carefully determined hierarchical relationship tree of related tables based on the Microsoft Dynamics AX metadata. To create a hierarchical relationship, you select a parent table and discover all related tables based on the Microsoft Dynamics AX metadata. The parent table in the relationship is put at the root level of the tree. The discovery process creates a nested relationship tree from a parent entity to a child entity, until there are no relationships left at the lowest level. The relationship tree that is created based on the driver table is called either a Purge Object or an Archive Object. A Purge Object is used to remove selected records from all tables in the relationship tree from the Microsoft Dynamics AX database. Similarly, an Archive Object is used to move selected records from all tables in the relationship tree from the Microsoft Dynamics AX database to the archive database. After creating a Purge Object or an Archive Object, you can apply business rules and selection criteria to entities and transactions to determine which records are deleted or moved from the production database. Finally, you create a scheduled task to purge or archive the database. At run time, a purge task selects matching records from all the tables in the Purge Object and deletes them from the production database. Similarly, an archive task selects matching records from all the tables in the Archive Object and moves them from the production database to the archive database. With careful planning and system testing, the purge and archive tasks delete or move records from the production database while maintaining the consistency and integrity of your database.\n\n### Audience\n\nThis topic is designed for database and system administrators who are responsible for the administration and maintenance of the Microsoft Dynamics AX application and the Microsoft SQL Server database.\n\n### Prerequisites\n\nTo benefit from this topic, you must have knowledge in the following areas:\n\n-   Microsoft Dynamics AX application and system administration\n-   SQL Server database administration, backup, recovery, and performance tuning\n-   Windows Server administration, backup, recovery, and performance tuning\n\n| **Caution**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |\n|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| To use this topic, you must have experience in the maintenance and administration of the Microsoft Dynamics AX application and database. IDMF lets you create or modify Purge Objects and Archive Objects. A Purge Object or an Archive Object defines a hierarchical relationship tree among the Microsoft Dynamics AX application tables. You can then apply rules to select records based on specific criteria. A scheduled purge task selects records that match the criteria in the Purge Object, and deletes them from all the tables in the relationship tree. A scheduled archive task selects and moves records from the production database to the archive database that matches the criteria in the Archive Object. |\n\n## System architecture\nThis section provides a high-level overview of the system architecture of IDMF. IDMF was created using the Microsoft .NET development environment and provides a single document interface (SDI). IDMF uses a database, called the management database, for the storage and retrieval of data, and communicates with an Application Object Server (AOS) instance through the .NET Business Connector. The AOS processes all the business logic and database queries to access the Microsoft Dynamics AX application database. You must install the business connector on the computer where you install IDMF. During installation, IDMF installs a Windows service called the Microsoft Dynamics AX Intelligent Data Management Framework service. This service is used to run scheduled jobs and is referred to as the scheduler service for IDMF. In the post-installation stage, IDMF uses the Microsoft Dynamics AX client to import and compile two X++ projects (XPOs). One XPO is used to create the application entities that are required by IDMF, such as classes, tables, and a job. The Microsoft Dynamics AX Windows client is used to import and synchronize the metadata from Microsoft Dynamics AX with IDMF. The following diagram provides a high-level overview of IDMF system architecture. \n[![IDMF01](./media/idmf01.jpg)](./media/idmf01.jpg)   \n\n**Figure 1. System architecture**\n\n| **Note**                                                                                                                                                                                                           |\n|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| The system architecture diagram shows a single SQL Server computer with different databases, for ease of illustration. You can deploy these databases on a single database server or on multiple database servers. |\n\n## Deployment scenarios\nThis section describes the deployment scenarios for IDMF. As shown in the following sections, the system topology can range from a single-server environment to a multi-server deployment.\n### Single-server deployment\n\nThe following diagram shows the deployment of all components on a single server. This topology is not recommended for the production environment. \n\n[![IDMF02](./media/idmf02.jpg)](./media/idmf02.jpg)   \n\n**Figure 2. Single-server deployment**\n\n### Multi-server deployment\n\nThe following diagram shows a multi-server deployment, where the AOS instance, the database server, and IDMF are deployed on dedicated servers. \n\n[![IDMF03](./media/idmf03.jpg)](./media/idmf03.jpg)   \n\n**Figure 3. Multi-server deployment**\n\n### Distributed deployment\n\nThe following diagram shows a distributed deployment that extends the multi-server topology by putting each database on a dedicated database server. Optionally, you can combine the management database and the production replica database on a single server. \n\n[![IDMF04](./media/idmf04.jpg)](./media/idmf04.jpg) \n\n**Figure 4. Distributed deployment**\n\n## Before you begin\nWhen you start IDMF for the first time, you are prompted to create a baseline snapshot of the database and the application. The baseline process takes a snapshot of the production database and determines the health of the Microsoft Dynamics AX application. You must create a baseline snapshot before you can use IDMF. Before working with IDMF, be aware of the following considerations:\n-   The archive and purge operations are resource intensive and affect hardware resources, such as memory, processors, disk drives or storage, and the network. Schedule these operations during a maintenance window, when users are offline.\n-   Work with the purge and archive tasks in the test environment to understand their effect on the hardware and software resources, and to understand the time required for successful completion. Use the results of the tests performed in the test environment to determine your maintenance window in the production environment.\n-   Verify that the initial database size of the production and archive databases provides sufficient room for future growth with a large volume of data. Ensure that database files in the production and archive databases have sufficient room to complete the purge and archive operations without using the automatic growth option. We recommend that you consider the automatic growth option a safety mechanism that enables the database files to grow when absolutely necessary, and that therefore prevents errors. For more information about the database configuration checklist for SQL Server, see [Planning database configuration for Microsoft Dynamics AX](http://www.microsoft.com/downloads/details.aspx?FamilyID=ab4cd401-b366-4c1c-9a73-88c945ae8191).\n-   Carefully plan archive tasks for tables with a data type of blob and memo, because of their large storage requirements.\n-   For each archive and purge task, follow these steps:\n    1.  Estimate the number of records that must be purged or archived.\n    2.  Calculate the size of the affected records, in megabytes.\n    3.  For a purge operation, verify that the available space in the production database is at least twice as much as the size you calculated in the previous step. For an archive operation, verify that the available space in the production and archive databases is at least twice as much as the size you calculated in the previous step.\n    4.  Determine the time that is required to successfully complete the purge or archive task. Run the task during a maintenance window to minimize the effect on online users.\n-   A purge operation makes database changes in the production database. An archive operation makes database changes in the production and archive databases. Select the full recovery model for the production database. Carefully determine the recovery model for the archive database. The simple recovery model provides better performance for the archive operation, but you risk significant work-loss exposure if the database is damaged. Data is recoverable only to the most recent backup of the lost data. The full recovery model provides better protection for data than the simple recovery model. The full recovery model relies on backing up the transaction log to provide full recoverability and prevent work loss in the broadest range of failure scenarios. However, the archive task takes longer to be completed with a full recover model than a simple recovery model. For more information, see [Choosing the Recovery Model for a Database](http://technet.microsoft.com/en-us/library/ms175987.aspx).\n-   Perform a complete database backup of the production and archive databases immediately before running a purge or archive task. Back up the transaction logs of the production database before and after each purge and archive operation. Back up the transaction log of the archive database immediately after each archive operation when using the full recovery model. Perform a complete database backup of the archive database immediately after each archive operation when using the simple recovery model.\n-   You can configure an AOS instance to connect to an archive database to view archived records. However, this connection must be read-only. Any attempt to update the data in the archive database, or to perform operations such as database synchronization from the Application Object Tree (AOT), cause data and application corruption.\n\n## Terminology\nThis section explains the terminology and concepts used in IDMF.\n\n| Term                                                  | Description                                                                                                                                                                                                                                                                                                                                                                                                                       |\n|-------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Analysis snapshot                                     | A task that captures database analysis information, such as the data size, index size, and index usage.                                                                                                                                                                                                                                                                                                                           |\n| Archive                                               | Archive the records that match selection criteria from all tables in the relationship tree of an Archive Object. The archiving process moves records from the production database to the archive database. The terms archive and offline are used interchangeably in this topic.                                                                                                                                                  |\n| Archive Object                                        | A relationship tree that you create by selecting a driver table and related tables.                                                                                                                                                                                                                                                                                                                                               |\n| Archive template                                      | An Archive Object that is included with IDMF. You must review and save the archive template before you can use it to archive data. A saved archive template becomes an Archive Object.                                                                                                                                                                                                                                            |\n| Baseline                                              | A snapshot of the database or the application that is captured through specific queries.                                                                                                                                                                                                                                                                                                                                          |\n| Discovery                                             | The discovery process begins with the driver table and searches through the Microsoft Dynamics AX application metadata to capture all tables in the relationship tree.                                                                                                                                                                                                                                                            |\n| Driver table                                          | A parent table in the parent-child relationship of related tables. The driver table is the root parent.                                                                                                                                                                                                                                                                                                                           |\n| Entity                                                | A database table.                                                                                                                                                                                                                                                                                                                                                                                                                 |\n| Exception                                             | A list of tables, table groups, and configuration keys with a defined restriction from use in a Purge Object or an Archive Object. An exception parameter can be a table, a table group, or a configuration key.                                                                                                                                                                                                                  |\n| Expression                                            | A condition that you put in a rule in a Purge Object or an Archive Object. When you have multiple expressions, they form the \"or\" clauses in a query.                                                                                                                                                                                                                                                                             |\n| Level                                                 | A grouping of tables in a Purge Object or an Archive Object. The driver table starts at level 0, which is the root level. All the tables related to the driver table are put in level 1. All the tables related to a table in level 1 are put in level 2, and so on. The levels form the parent-child hierarchy in a relationship tree.                                                                                           |\n| Management database                                   | The database that is used by IDMF.                                                                                                                                                                                                                                                                                                                                                                                                |\n| Master data synchronization                           | The process of replicating master data tables from the production database to the archive database. This process copies the master data tables from the production database to the archive database to keep them synchronized.                                                                                                                                                                                                    |\n| Master data tables                                    | The master data synchronization task copies the master data tables from the production database to the archive database. These tables are not archived, meaning they retain their data in the production database after the records are copied to the archive database.                                                                                                                                                           |\n| Measure                                               | A measure captures aggregated statistics for key business processes by company and by year in the Microsoft Dynamics AX application.                                                                                                                                                                                                                                                                                              |\n| Metadata synchronization                              | The process of synchronizing database schemas and database objects from the production database to the archive database.                                                                                                                                                                                                                                                                                                          |\n| Offline or offlining                                  | The same as archive.                                                                                                                                                                                                                                                                                                                                                                                                              |\n| Performance dashboard                                 | The performance dashboard displays the database configuration details for all databases used by IDMF, and table statistics and query statistics for the production and archive databases.                                                                                                                                                                                                                                         |\n| Purge                                                 | Delete the records that match selection criteria from all tables in the relationship tree of a Purge Object. Purge and recycle are used interchangeably in this topic.                                                                                                                                                                                                                                                            |\n| Purge Object                                          | A relationship tree that you create by selecting a driver table and related tables.                                                                                                                                                                                                                                                                                                                                               |\n| Purge task                                            | A purge task recycles all the records from the database by using a Purge Object, based on values set for the rules of the Purge Object.                                                                                                                                                                                                                                                                                           |\n| Purge template                                        | A Purge Object that is included with IDMF. You must review and save the purge template before you can use it for recycling. A saved purge template becomes a Purge Object.                                                                                                                                                                                                                                                        |\n| Recycle                                               | The same as purge.                                                                                                                                                                                                                                                                                                                                                                                                                |\n| Relation                                              | A child table that you add to a Purge Object or an Archive Object. All tables in a relationship tree have a parent table, except the driver table.                                                                                                                                                                                                                                                                                |\n| Relationship tree                                     | A parent-child relationship that starts with the driver table. The driver table is put in level 0, or the root level, of the relationship tree. All the tables that refer to the driver table as a parent are put in level 1. All the tables that refer to a table in level 1 as a parent are put in level 2. The child-parent relationship keeps going deeper until all the related tables are grouped in the relationship tree. |\n| Restore                                               | The process of restoring archived data from the archive database to the production database. The restore process moves qualifying data from the archive database to the production database.                                                                                                                                                                                                                                      |\n| Rule                                                  | A condition that you put on a field in one of the entities in a Purge Object or an Archive Object. When you have multiple rules, they form the \"and\" clauses in a query.                                                                                                                                                                                                                                                          |\n| System health, also referred to as application health | System health provides analysis for selected measures from the Inventory management, Accounts receivable, Accounts payable, General ledger, and Administration modules of Microsoft Dynamics AX.                                                                                                                                                                                                                                  |\n\n\n\n"}