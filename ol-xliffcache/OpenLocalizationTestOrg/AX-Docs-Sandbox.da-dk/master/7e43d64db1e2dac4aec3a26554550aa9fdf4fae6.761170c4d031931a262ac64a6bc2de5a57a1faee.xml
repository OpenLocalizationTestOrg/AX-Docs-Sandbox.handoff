{"nodes":[{"pos":[32,67],"content":"Budget planning templates for Excel","needQuote":true,"needEscape":true,"nodes":[{"content":"Budget planning templates for Excel","pos":[0,35]}]},{"pos":[81,177],"content":"This topic describes how to create Microsoft Excel templates that can be used with budget plans.","needQuote":true,"needEscape":true,"nodes":[{"content":"This topic describes how to create Microsoft Excel templates that can be used with budget plans.","pos":[0,96]}]},{"pos":[691,726],"content":"Budget planning templates for Excel","linkify":"Budget planning templates for Excel","nodes":[{"content":"Budget planning templates for Excel","pos":[0,35]}]},{"content":"This topic describes how to create Microsoft Excel templates that can be used with budget plans.","pos":[728,824]},{"content":"This topic shows how to create Excel templates that will be used with budget plans using the standard demo data set and the Admin user login.","pos":[826,967]},{"content":"For more information about budget planning, see <bpt id=\"p1\">[</bpt>Budget planning overview.<ept id=\"p1\">](budget-planning-overview-configuration.md)</ept>","pos":[968,1086],"source":" For more information about budget planning, see [Budget planning overview.](budget-planning-overview-configuration.md)"},{"content":"You can also follow the <bpt id=\"p1\">[</bpt>Budget planning 101<ept id=\"p1\">](budget-plan.md)</ept> tutorial to learn basic module configuration and usage principles.","pos":[1087,1215],"source":" You can also follow the [Budget planning 101](budget-plan.md) tutorial to learn basic module configuration and usage principles."},{"pos":[1220,1274],"content":"Generate a worksheet using budget plan document layout","linkify":"Generate a worksheet using budget plan document layout","nodes":[{"content":"Generate a worksheet using budget plan document layout","pos":[0,54]}]},{"content":"Budget plan documents can be viewed and edited using one or more layouts.","pos":[1275,1348]},{"content":"Each layout can have an associated budget plan document template to view and edit the budget plan data in an Excel worksheet.","pos":[1349,1474]},{"content":"In this topic, a budget plan document template will be generated using an existing layout configuration.","pos":[1475,1579]},{"content":"Open the <bpt id=\"p1\">**</bpt>Budget plans list<ept id=\"p1\">**</ept> (<bpt id=\"p2\">**</bpt>Budgeting<ept id=\"p2\">**</ept><ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Budget plans<ept id=\"p3\">**</ept>).","pos":[1580,1648],"source":" Open the **Budget plans list** (**Budgeting**&gt; **Budget plans**)."},{"content":"Click <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept> to create a new budget plan document.","pos":[1649,1700],"source":" Click **New** to create a new budget plan document."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt1<ept id=\"p1\">](./media/bpt11-1024x552.png)](./media/bpt11.png)</ept> Use the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> line option to add lines.","pos":[1701,1799],"source":"[![bpt1](./media/bpt11-1024x552.png)](./media/bpt11.png) Use the **Add** line option to add lines."},{"content":"Click <bpt id=\"p1\">**</bpt>Layouts<ept id=\"p1\">**</ept> to view the budget plan document layout configuration.","pos":[1800,1872],"source":" Click **Layouts** to view the budget plan document layout configuration."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt2<ept id=\"p1\">](./media/bpt2-1024x274.png)](./media/bpt2.png)</ept> You can review the layout configuration and adjust it as needed.","pos":[1873,1992],"source":"[![bpt2](./media/bpt2-1024x274.png)](./media/bpt2.png) You can review the layout configuration and adjust it as needed."},{"content":"Go to <bpt id=\"p1\">**</bpt>Template<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Generate<ept id=\"p2\">**</ept> to create an Excel file for this layout.","pos":[1993,2070],"source":" Go to **Template** &gt; **Generate** to create an Excel file for this layout."},{"content":"After the template is generated, go to <bpt id=\"p1\">**</bpt>Template<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>View<ept id=\"p2\">**</ept> to open and review the budget plan document template.","pos":[2071,2190],"source":" After the template is generated, go to **Template** &gt; **View** to open and review the budget plan document template."},{"content":"You can save the Excel file to your local drive.","pos":[2191,2239]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt3<ept id=\"p1\">](./media/bpt3-1024x545.png)](./media/bpt3.png)</ept> <bpt id=\"p2\">**</bpt>Note:<ept id=\"p2\">**</ept> The Budget plan document layout cannot be edited after an Excel template is associated with it.","pos":[2240,2400],"source":"[![bpt3](./media/bpt3-1024x545.png)](./media/bpt3.png) **Note:** The Budget plan document layout cannot be edited after an Excel template is associated with it."},{"content":"To modify the layout, delete the associated Excel template file and regenerate it.","pos":[2401,2483]},{"content":"This is required to keep the fields in the layout and the worksheet synchronized.","pos":[2484,2565]},{"content":"The Excel template will contain all of the elements from the budget plan document layout, where the <bpt id=\"p1\">**</bpt>Available in Worksheet<ept id=\"p1\">**</ept> column is set to True.","pos":[2566,2715],"source":" The Excel template will contain all of the elements from the budget plan document layout, where the **Available in Worksheet** column is set to True."},{"content":"Overlapping elements are not allowed in the Excel template.","pos":[2716,2775]},{"content":"For example, if the layout contains Request Q1, Request Q2, Request Q3, and Request Q4 columns, and a total request column that represents a sum of all 4 quarterly columns, only the quarterly columns or total column is available to be used in the Excel template.","pos":[2776,3038]},{"content":"The Excel file cannot update overlapping columns during the update because data in the table could become out of date and inaccurate.","pos":[3039,3172]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt4<ept id=\"p1\">](./media/bpt4-1024x615.png)](./media/bpt4.png)</ept><bpt id=\"p2\">**</bpt>Note:<ept id=\"p2\">**</ept> To avoid potential issues with viewing and editing budget plan data using Excel, the same user should be logged into both Dynamics 365 for Operations and the Microsoft Dynamics Office Add-in Data Connector.","pos":[3173,3443],"source":"[![bpt4](./media/bpt4-1024x615.png)](./media/bpt4.png)**Note:** To avoid potential issues with viewing and editing budget plan data using Excel, the same user should be logged into both Dynamics 365 for Operations and the Microsoft Dynamics Office Add-in Data Connector."},{"pos":[3448,3493],"content":"Add a header to budget plan document template","linkify":"Add a header to budget plan document template","nodes":[{"content":"Add a header to budget plan document template","pos":[0,45]}]},{"content":"To add header information, select the top row in the Excel file and insert empty rows.","pos":[3494,3580]},{"content":"Click <bpt id=\"p1\">**</bpt>Design<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Data Connector<ept id=\"p2\">**</ept> to add header fields to the Excel file.","pos":[3581,3663],"source":" Click **Design** in the **Data Connector** to add header fields to the Excel file."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt5<ept id=\"p1\">](./media/bpt5-1024x615.png)](./media/bpt5.png)</ept> In the <bpt id=\"p2\">**</bpt>Design<ept id=\"p2\">**</ept> tab,<bpt id=\"p3\">**</bpt> <ept id=\"p3\">**</ept>click <bpt id=\"p4\">**</bpt>Add<ept id=\"p4\">**</ept> fields, and then select <bpt id=\"p5\">**</bpt>BudgetPlanHeader<ept id=\"p5\">**</ept> as the entity data source.","pos":[3664,3831],"source":"[![bpt5](./media/bpt5-1024x615.png)](./media/bpt5.png) In the **Design** tab,** **click **Add** fields, and then select **BudgetPlanHeader** as the entity data source."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt6<ept id=\"p1\">](./media/bpt6-1024x615.png)](./media/bpt6.png)</ept>Point the cursor to the desired location in the Excel file.","pos":[3832,3945],"source":"[![bpt6](./media/bpt6-1024x615.png)](./media/bpt6.png)Point the cursor to the desired location in the Excel file."},{"content":"Click <bpt id=\"p1\">**</bpt>Add label<ept id=\"p1\">**</ept> to add the field label to the selected location.","pos":[3946,4014],"source":" Click **Add label** to add the field label to the selected location."},{"content":"Select <bpt id=\"p1\">**</bpt>Add Value<ept id=\"p1\">**</ept> to add the value field to the selected place.","pos":[4015,4081],"source":" Select **Add Value** to add the value field to the selected place."},{"content":"Click <bpt id=\"p1\">**</bpt>Done<ept id=\"p1\">**</ept> to close the designer.","pos":[4082,4119],"source":" Click **Done** to close the designer."},{"pos":[4124,4177],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt7<ept id=\"p1\">](./media/bpt71024x615.png)](./media/bpt7.png)</ept>","linkify":"[![bpt7](./media/bpt71024x615.png)](./media/bpt7.png)","source":"[![bpt7](./media/bpt71024x615.png)](./media/bpt7.png)"},{"pos":[4178,4240],"content":"Add a calculated column to budget plan document template table","linkify":"Add a calculated column to budget plan document template table","nodes":[{"content":"Add a calculated column to budget plan document template table","pos":[0,62]}]},{"content":"Next, calculated columns will be added to generated budget plan document template.","pos":[4305,4387]},{"content":"A <bpt id=\"p1\">**</bpt>Total request<ept id=\"p1\">**</ept> column, which summarizes Request Q1: Request Q4 columns, and an <bpt id=\"p2\">**</bpt>Adjustment<ept id=\"p2\">**</ept> column, which recalculates the <bpt id=\"p3\">**</bpt>Total Request<ept id=\"p3\">**</ept> column by a predefined factor.","pos":[4388,4566],"source":" A **Total request** column, which summarizes Request Q1: Request Q4 columns, and an **Adjustment** column, which recalculates the **Total Request** column by a predefined factor."},{"content":"Click <bpt id=\"p1\">**</bpt>Design<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Data connector<ept id=\"p2\">**</ept> to add columns to the table.","pos":[4567,4638],"source":" Click **Design** in the **Data connector** to add columns to the table."},{"content":"Click <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept> next to <bpt id=\"p2\">**</bpt>BudgetPlanWorksheet<ept id=\"p2\">**</ept> data source to start adding columns.","pos":[4639,4722],"source":" Click **Edit** next to **BudgetPlanWorksheet** data source to start adding columns."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt8<ept id=\"p1\">](./media/bpt8-1024x301.png)](./media/bpt8.png)</ept> The selected field group displays the columns that are available in the template.","pos":[4723,4859],"source":"[![bpt8](./media/bpt8-1024x301.png)](./media/bpt8.png) The selected field group displays the columns that are available in the template."},{"content":"Click <bpt id=\"p1\">**</bpt>Formula<ept id=\"p1\">**</ept> to add a new column.","pos":[4860,4898],"source":" Click **Formula** to add a new column."},{"content":"Name the new column and then paste the formula into the <bpt id=\"p1\">**</bpt>Formula<ept id=\"p1\">**</ept> field.","pos":[4899,4973],"source":" Name the new column and then paste the formula into the **Formula** field."},{"content":"Click <bpt id=\"p1\">**</bpt>Update<ept id=\"p1\">**</ept> to insert the column.","pos":[4974,5012],"source":" Click **Update** to insert the column."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt12<ept id=\"p1\">](./media/bpt12-1024x565.png)](./media/bpt12.png)</ept> <bpt id=\"p2\">**</bpt>Tip:<ept id=\"p2\">**</ept> To define the formula, create the formula in the spreadsheet, and then copy it to the <bpt id=\"p3\">**</bpt>Design<ept id=\"p3\">**</ept> window.","pos":[5013,5184],"source":"[![bpt12](./media/bpt12-1024x565.png)](./media/bpt12.png) **Tip:** To define the formula, create the formula in the spreadsheet, and then copy it to the **Design** window."},{"content":"A Dynamics 365 for Operations bound table will typically be named \"AXTable1\".","pos":[5185,5262]},{"content":"For example, to summarize Request Q1 : Request Q4 columns in the spreadsheet, the formula = AxTable1<ph id=\"ph1\">\\[</ph>Request Q1<ph id=\"ph2\">\\]</ph>+AxTable1<ph id=\"ph3\">\\[</ph>Request Q2<ph id=\"ph4\">\\]</ph>+AxTable1<ph id=\"ph5\">\\[</ph>Request Q3<ph id=\"ph6\">\\]</ph>+AxTable1<ph id=\"ph7\">\\[</ph>Request Q4<ph id=\"ph8\">\\]</ph>.","pos":[5263,5447],"source":" For example, to summarize Request Q1 : Request Q4 columns in the spreadsheet, the formula = AxTable1\\[Request Q1\\]+AxTable1\\[Request Q2\\]+AxTable1\\[Request Q3\\]+AxTable1\\[Request Q4\\]."},{"content":"Repeat these steps to insert the <bpt id=\"p1\">**</bpt>Adjustment<ept id=\"p1\">**</ept> column.","pos":[5448,5503],"source":" Repeat these steps to insert the **Adjustment** column."},{"content":"Use formula = AxTable1<ph id=\"ph1\">\\[</ph>Total request<ph id=\"ph2\">\\]</ph><ph id=\"ph3\">\\*</ph>$I$1 for this column.","pos":[5504,5566],"source":" Use formula = AxTable1\\[Total request\\]\\*$I$1 for this column."},{"content":"This will take the value in cell I1 and multiply the values in the <bpt id=\"p1\">**</bpt>Total request<ept id=\"p1\">**</ept> column to calculate adjustment amounts.","pos":[5567,5691],"source":" This will take the value in cell I1 and multiply the values in the **Total request** column to calculate adjustment amounts."},{"content":"Save and close the Excel file.","pos":[5692,5722]},{"content":"Return to Dynamics 365 for Operations, and in <bpt id=\"p1\">**</bpt>Layouts<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Template <ph id=\"ph1\">&amp;gt;</ph> Upload<ept id=\"p2\">**</ept> to upload the saved Excel template to be used for the budget plan.","pos":[5723,5879],"source":" Return to Dynamics 365 for Operations, and in **Layouts**, click **Template &gt; Upload** to upload the saved Excel template to be used for the budget plan."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt10<ept id=\"p1\">](./media/bpt10-1024x352.png)](./media/bpt10.png)</ept> Close the <bpt id=\"p2\">**</bpt>Layouts<ept id=\"p2\">**</ept> slider.","pos":[5880,5967],"source":"[![bpt10](./media/bpt10-1024x352.png)](./media/bpt10.png) Close the **Layouts** slider."},{"content":"In <bpt id=\"p1\">**</bpt>Budget plan<ept id=\"p1\">**</ept> document, click <bpt id=\"p2\">**</bpt>Worksheet<ept id=\"p2\">**</ept> to view and edit the document in Excel.","pos":[5968,6056],"source":" In **Budget plan** document, click **Worksheet** to view and edit the document in Excel."},{"content":"Note that the adjusted Excel template was used to create this budget plan worksheet and calculated columns are updated using the formulas that were defined in the previous steps.","pos":[6057,6235]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt11<ept id=\"p1\">](./media/bpt111-1024x431.png)](./media/bpt111.png)</ept>","pos":[6236,6295],"source":"[![bpt11](./media/bpt111-1024x431.png)](./media/bpt111.png)"},{"pos":[6300,6348],"content":"Tips & tricks for creating budget plan templates","linkify":"Tips & tricks for creating budget plan templates","nodes":[{"content":"Tips &amp; tricks for creating budget plan templates","pos":[0,48],"source":"Tips & tricks for creating budget plan templates"}]},{"pos":[6353,6421],"content":"Can I add and use additional data sources to a budget plan template?","linkify":"Can I add and use additional data sources to a budget plan template?","nodes":[{"content":"Can I add and use additional data sources to a budget plan template?","pos":[0,68]}]},{"content":"Yes, you can use the <bpt id=\"p1\">**</bpt>Design<ept id=\"p1\">**</ept> menu to add additional entities to the same or other sheets in the Excel template.","pos":[6423,6537],"source":"Yes, you can use the **Design** menu to add additional entities to the same or other sheets in the Excel template."},{"content":"For example, you can add the <bpt id=\"p1\">**</bpt>BudgetPlanProposedProject<ept id=\"p1\">**</ept> data source to create and maintain a list of proposed projects at the same time when working with budget plan data in Excel.","pos":[6538,6721],"source":" For example, you can add the **BudgetPlanProposedProject** data source to create and maintain a list of proposed projects at the same time when working with budget plan data in Excel."},{"content":"Note that including high-volume data sources might impact performance of the Excel workbook.","pos":[6722,6814]},{"content":"You can use the <bpt id=\"p1\">**</bpt>Filter<ept id=\"p1\">**</ept> option in the <bpt id=\"p2\">**</bpt>Data Connector<ept id=\"p2\">**</ept> to add desired filters to additional data sources.","pos":[6815,6925],"source":" You can use the **Filter** option in the **Data Connector** to add desired filters to additional data sources."},{"pos":[6931,6998],"content":"Can I hide the Design option in the Data connector for other users?","linkify":"Can I hide the Design option in the Data connector for other users?","nodes":[{"content":"Can I hide the Design option in the Data connector for other users?","pos":[0,67]}]},{"content":"Yes, open the <bpt id=\"p1\">**</bpt>Data Connector<ept id=\"p1\">**</ept> options to hide the <bpt id=\"p2\">**</bpt>Design<ept id=\"p2\">**</ept> option from other users.","pos":[7000,7088],"source":"Yes, open the **Data Connector** options to hide the **Design** option from other users."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt13<ept id=\"p1\">](./media/bpt13-1024x565.png)](./media/bpt13.png)</ept> Expand <bpt id=\"p2\">**</bpt>Data connector options<ept id=\"p2\">**</ept> and clear the <bpt id=\"p3\">**</bpt>Enable design<ept id=\"p3\">**</ept> check box.","pos":[7089,7223],"source":"[![bpt13](./media/bpt13-1024x565.png)](./media/bpt13.png) Expand **Data connector options** and clear the **Enable design** check box."},{"content":"This will hide the <bpt id=\"p1\">**</bpt>Design<ept id=\"p1\">**</ept> option from the <bpt id=\"p2\">**</bpt>Data connector<ept id=\"p2\">**</ept>.<bpt id=\"p3\">[</bpt><ph id=\"ph1\">![</ph>bpt14<ept id=\"p3\">](./media/bpt14-1024x592.png)](./media/bpt14.png)</ept>","pos":[7224,7346],"source":" This will hide the **Design** option from the **Data connector**.[![bpt14](./media/bpt14-1024x592.png)](./media/bpt14.png)"},{"pos":[7352,7439],"content":"Can I prevent users from accidently closing the Data connector while working with data?","linkify":"Can I prevent users from accidently closing the Data connector while working with data?","nodes":[{"content":"Can I prevent users from accidently closing the Data connector while working with data?","pos":[0,87]}]},{"content":"We recommend locking the template to prevent users from closing it.","pos":[7441,7508]},{"content":"To turn on the lock, click the <bpt id=\"p1\">**</bpt>Data connector<ept id=\"p1\">**</ept>, in the top right corner an arrow appears.","pos":[7509,7601],"source":" To turn on the lock, click the **Data connector**, in the top right corner an arrow appears."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt15<ept id=\"p1\">](./media/bpt15-1024x285.png)](./media/bpt15.png)</ept> Click the arrow for an additional menu.","pos":[7602,7699],"source":"[![bpt15](./media/bpt15-1024x285.png)](./media/bpt15.png) Click the arrow for an additional menu."},{"content":"Select <bpt id=\"p1\">**</bpt>Lock<ept id=\"p1\">**</ept>.","pos":[7700,7716],"source":" Select **Lock**."},{"pos":[7722,7779],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt16<ept id=\"p1\">](./media/bpt16-1024x614.png)](./media/bpt16.png)</ept>","linkify":"[![bpt16](./media/bpt16-1024x614.png)](./media/bpt16.png)","source":"[![bpt16](./media/bpt16-1024x614.png)](./media/bpt16.png)"},{"pos":[7785,7912],"content":"Can I use other Excel features, like cell formatting, colors, conditional formatting, and charts with my budget plan templates?","linkify":"Can I use other Excel features, like cell formatting, colors, conditional formatting, and charts with my budget plan templates?","nodes":[{"content":"Can I use other Excel features, like cell formatting, colors, conditional formatting, and charts with my budget plan templates?","pos":[0,127]}]},{"content":"Yes, most of the standard Excel capabilities will work in budget plan templates.","pos":[7914,7994]},{"content":"We recommend using color-coding for users to distinguish between read-only and editable columns.","pos":[7995,8091]},{"content":"Conditional formatting can be used to highlight problematic areas of the budget.","pos":[8092,8172]},{"content":"Column totals can easily be presented by using standard Excel formulas above the table.","pos":[8173,8260]},{"content":"You can also create and use pivot tables and charts for additional groupings and visualizations of budget data.","pos":[8261,8372]},{"content":"On the <bpt id=\"p1\">**</bpt>Data<ept id=\"p1\">**</ept> tab, in the <bpt id=\"p2\">**</bpt>Connections<ept id=\"p2\">**</ept> group, click <bpt id=\"p3\">**</bpt>Refresh All<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>Connection Properties<ept id=\"p4\">**</ept>.","pos":[8373,8488],"source":" On the **Data** tab, in the **Connections** group, click **Refresh All**, and then click **Connection Properties**."},{"content":"Click the <bpt id=\"p1\">**</bpt>Usage<ept id=\"p1\">**</ept> tab.","pos":[8489,8513],"source":" Click the **Usage** tab."},{"content":"Under <bpt id=\"p1\">**</bpt>Refresh<ept id=\"p1\">**</ept>, select the <bpt id=\"p2\">**</bpt>Refresh data when opening the file<ept id=\"p2\">**</ept> check box.","pos":[8514,8593],"source":" Under **Refresh**, select the **Refresh data when opening the file** check box."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>bpt17<ept id=\"p1\">](./media/bpt17-1024x614.png)](./media/bpt17.png)</ept>","pos":[8594,8651],"source":"[![bpt17](./media/bpt17-1024x614.png)](./media/bpt17.png)"}],"content":"---\n# required metadata\n\ntitle: Budget planning templates for Excel\ndescription: This topic describes how to create Microsoft Excel templates that can be used with budget plans.\nauthor: twheeloc\nmanager: AnnBe\nms.date: 2016-12-08 15 - 46 - 58\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Application User\n# ms.devlang: \n# ms.reviewer: 2231\nms.search.scope: Operations\n# ms.tgt_pltfrm: \nms.custom: 261794\nms.assetid: 1d8e99c1-b70d-41ba-991e-ab50b16797e0\nms.search.region: Global\n# ms.search.industry: \nms.author: sigitac\nms.dyn365.ops.intro: 01-11-2016\nms.dyn365.ops.version: Version 1611\n\n---\n\n# Budget planning templates for Excel\n\nThis topic describes how to create Microsoft Excel templates that can be used with budget plans.\n\nThis topic shows how to create Excel templates that will be used with budget plans using the standard demo data set and the Admin user login. For more information about budget planning, see [Budget planning overview.](budget-planning-overview-configuration.md) You can also follow the [Budget planning 101](budget-plan.md) tutorial to learn basic module configuration and usage principles.\n\n## Generate a worksheet using budget plan document layout\nBudget plan documents can be viewed and edited using one or more layouts. Each layout can have an associated budget plan document template to view and edit the budget plan data in an Excel worksheet. In this topic, a budget plan document template will be generated using an existing layout configuration. Open the **Budget plans list** (**Budgeting**&gt; **Budget plans**). Click **New** to create a new budget plan document. [![bpt1](./media/bpt11-1024x552.png)](./media/bpt11.png) Use the **Add** line option to add lines. Click **Layouts** to view the budget plan document layout configuration. [![bpt2](./media/bpt2-1024x274.png)](./media/bpt2.png) You can review the layout configuration and adjust it as needed. Go to **Template** &gt; **Generate** to create an Excel file for this layout. After the template is generated, go to **Template** &gt; **View** to open and review the budget plan document template. You can save the Excel file to your local drive. [![bpt3](./media/bpt3-1024x545.png)](./media/bpt3.png) **Note:** The Budget plan document layout cannot be edited after an Excel template is associated with it. To modify the layout, delete the associated Excel template file and regenerate it. This is required to keep the fields in the layout and the worksheet synchronized. The Excel template will contain all of the elements from the budget plan document layout, where the **Available in Worksheet** column is set to True. Overlapping elements are not allowed in the Excel template. For example, if the layout contains Request Q1, Request Q2, Request Q3, and Request Q4 columns, and a total request column that represents a sum of all 4 quarterly columns, only the quarterly columns or total column is available to be used in the Excel template. The Excel file cannot update overlapping columns during the update because data in the table could become out of date and inaccurate. [![bpt4](./media/bpt4-1024x615.png)](./media/bpt4.png)**Note:** To avoid potential issues with viewing and editing budget plan data using Excel, the same user should be logged into both Dynamics 365 for Operations and the Microsoft Dynamics Office Add-in Data Connector.\n\n## Add a header to budget plan document template\nTo add header information, select the top row in the Excel file and insert empty rows. Click **Design** in the **Data Connector** to add header fields to the Excel file. [![bpt5](./media/bpt5-1024x615.png)](./media/bpt5.png) In the **Design** tab,** **click **Add** fields, and then select **BudgetPlanHeader** as the entity data source. [![bpt6](./media/bpt6-1024x615.png)](./media/bpt6.png)Point the cursor to the desired location in the Excel file. Click **Add label** to add the field label to the selected location. Select **Add Value** to add the value field to the selected place. Click **Done** to close the designer.\n\n## [![bpt7](./media/bpt71024x615.png)](./media/bpt7.png)\nAdd a calculated column to budget plan document template table\n--------------------------------------------------------------\n\nNext, calculated columns will be added to generated budget plan document template. A **Total request** column, which summarizes Request Q1: Request Q4 columns, and an **Adjustment** column, which recalculates the **Total Request** column by a predefined factor. Click **Design** in the **Data connector** to add columns to the table. Click **Edit** next to **BudgetPlanWorksheet** data source to start adding columns. [![bpt8](./media/bpt8-1024x301.png)](./media/bpt8.png) The selected field group displays the columns that are available in the template. Click **Formula** to add a new column. Name the new column and then paste the formula into the **Formula** field. Click **Update** to insert the column. [![bpt12](./media/bpt12-1024x565.png)](./media/bpt12.png) **Tip:** To define the formula, create the formula in the spreadsheet, and then copy it to the **Design** window. A Dynamics 365 for Operations bound table will typically be named \"AXTable1\". For example, to summarize Request Q1 : Request Q4 columns in the spreadsheet, the formula = AxTable1\\[Request Q1\\]+AxTable1\\[Request Q2\\]+AxTable1\\[Request Q3\\]+AxTable1\\[Request Q4\\]. Repeat these steps to insert the **Adjustment** column. Use formula = AxTable1\\[Total request\\]\\*$I$1 for this column. This will take the value in cell I1 and multiply the values in the **Total request** column to calculate adjustment amounts. Save and close the Excel file. Return to Dynamics 365 for Operations, and in **Layouts**, click **Template &gt; Upload** to upload the saved Excel template to be used for the budget plan. [![bpt10](./media/bpt10-1024x352.png)](./media/bpt10.png) Close the **Layouts** slider. In **Budget plan** document, click **Worksheet** to view and edit the document in Excel. Note that the adjusted Excel template was used to create this budget plan worksheet and calculated columns are updated using the formulas that were defined in the previous steps. [![bpt11](./media/bpt111-1024x431.png)](./media/bpt111.png)\n\n## Tips & tricks for creating budget plan templates\n### Can I add and use additional data sources to a budget plan template?\n\nYes, you can use the **Design** menu to add additional entities to the same or other sheets in the Excel template. For example, you can add the **BudgetPlanProposedProject** data source to create and maintain a list of proposed projects at the same time when working with budget plan data in Excel. Note that including high-volume data sources might impact performance of the Excel workbook. You can use the **Filter** option in the **Data Connector** to add desired filters to additional data sources.\n\n### Can I hide the Design option in the Data connector for other users?\n\nYes, open the **Data Connector** options to hide the **Design** option from other users. [![bpt13](./media/bpt13-1024x565.png)](./media/bpt13.png) Expand **Data connector options** and clear the **Enable design** check box. This will hide the **Design** option from the **Data connector**.[![bpt14](./media/bpt14-1024x592.png)](./media/bpt14.png)\n\n### Can I prevent users from accidently closing the Data connector while working with data?\n\nWe recommend locking the template to prevent users from closing it. To turn on the lock, click the **Data connector**, in the top right corner an arrow appears. [![bpt15](./media/bpt15-1024x285.png)](./media/bpt15.png) Click the arrow for an additional menu. Select **Lock**.\n\n### [![bpt16](./media/bpt16-1024x614.png)](./media/bpt16.png)\n\n### Can I use other Excel features, like cell formatting, colors, conditional formatting, and charts with my budget plan templates?\n\nYes, most of the standard Excel capabilities will work in budget plan templates. We recommend using color-coding for users to distinguish between read-only and editable columns. Conditional formatting can be used to highlight problematic areas of the budget. Column totals can easily be presented by using standard Excel formulas above the table. You can also create and use pivot tables and charts for additional groupings and visualizations of budget data. On the **Data** tab, in the **Connections** group, click **Refresh All**, and then click **Connection Properties**. Click the **Usage** tab. Under **Refresh**, select the **Refresh data when opening the file** check box. [![bpt17](./media/bpt17-1024x614.png)](./media/bpt17.png)\n\n"}