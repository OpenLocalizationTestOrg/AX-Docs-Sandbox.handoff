{"nodes":[{"pos":[32,108],"content":"Create a custom target entity for the Data import/export framework (AX 2012)","needQuote":true,"needEscape":true,"nodes":[{"content":"Create a custom target entity for the Data import/export framework (AX 2012)","pos":[0,76]}]},{"pos":[122,322],"content":"This topic describes how to create a custom entity, so that you can use the Microsoft Dynamics AX Data Import/Export Framework to import, export, or migrate data that does not fit a predefined entity.","needQuote":true,"needEscape":true,"nodes":[{"content":"This topic describes how to create a custom entity, so that you can use the Microsoft Dynamics AX Data Import/Export Framework to import, export, or migrate data that does not fit a predefined entity.","pos":[0,200]}]},{"pos":[805,881],"content":"Create a custom target entity for the Data import/export framework (AX 2012)","linkify":"Create a custom target entity for the Data import/export framework (AX 2012)","nodes":[{"content":"Create a custom target entity for the Data import/export framework (AX 2012)","pos":[0,76]}]},{"content":"This topic describes how to create a custom entity, so that you can use the Microsoft Dynamics AX Data Import/Export Framework to import, export, or migrate data that does not fit a predefined entity.","pos":[883,1083]},{"content":"A custom entity requires a staging table, a project, a query, a class, and functions.","pos":[1085,1170]},{"content":"You can use the <bpt id=\"p1\">**</bpt>Create a custom entity for data import/export Wizard<ept id=\"p1\">**</ept> to create these elements for you, or you can create them manually.","pos":[1171,1310],"source":" You can use the **Create a custom entity for data import/export Wizard** to create these elements for you, or you can create them manually."},{"pos":[1315,1328],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"Before you begin, you must know which table in Microsoft Dynamics AX maps to the entity that you are creating.","pos":[1329,1439]},{"content":"This table is either the source of the data that you are exporting or the target of the data that you are importing.","pos":[1440,1556]},{"content":"If you have to create a new table, follow the instructions in <bpt id=\"p1\">[</bpt>How to: Create Tables<ept id=\"p1\">](create-tables.md)</ept>.","pos":[1557,1661],"source":" If you have to create a new table, follow the instructions in [How to: Create Tables](create-tables.md)."},{"pos":[1666,1754],"content":"Create a custom entity by using the Create a custom entity for data import/export Wizard","linkify":"Create a custom entity by using the Create a custom entity for data import/export Wizard","nodes":[{"content":"Create a custom entity by using the Create a custom entity for data import/export Wizard","pos":[0,88]}]},{"pos":[1755,1856],"content":"The <bpt id=\"p1\">**</bpt>Create a custom entity for data import/export Wizard<ept id=\"p1\">**</ept> lets you quickly create a custom entity.","source":"The **Create a custom entity for data import/export Wizard** lets you quickly create a custom entity."},{"pos":[1862,1972],"content":"Go to <bpt id=\"p1\">**</bpt>Data Import/Export Framework<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Common<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Create a custom entity for data import/export<ept id=\"p3\">**</ept>.","source":"Go to **Data Import/Export Framework** &gt; **Common** &gt; **Create a custom entity for data import/export**."},{"pos":[1977,2231],"content":"Select the table that is related to the entity that you want to migrate, and then click **Next**.\n**Caution**: The wizard can be used to create custom entities that are associated only with tables that do not inherit data structures from other tables.","leadings":["","   "],"nodes":[{"content":"Select the table that is related to the entity that you want to migrate, and then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[0,97],"source":"Select the table that is related to the entity that you want to migrate, and then click **Next**."},{"content":"<bpt id=\"p1\">**</bpt>Caution<ept id=\"p1\">**</ept>: The wizard can be used to create custom entities that are associated only with tables that do not inherit data structures from other tables.","pos":[98,251],"source":"**Caution**: The wizard can be used to create custom entities that are associated only with tables that do not inherit data structures from other tables."}]},{"pos":[2236,2306],"content":"On the <bpt id=\"p1\">**</bpt>Select code generation parameters<ept id=\"p1\">**</ept> page, follow these steps:","source":"On the **Select code generation parameters** page, follow these steps:"},{"content":"The wizard suggests names for the staging table, query, and class.","pos":[2315,2381]},{"content":"You can accept these names or change them.","pos":[2382,2424]},{"content":"Select a display menu item for the entity.","pos":[2433,2475]},{"content":"If you have to create a new display menu item, follow the instructions in <bpt id=\"p1\">[</bpt>How to: Create Menus and Menu Items<ept id=\"p1\">](https://msdn.microsoft.com/library/5277205c-edb9-498e-b927-406237806217(AX.60).aspx)</ept>.","pos":[2476,2673],"source":" If you have to create a new display menu item, follow the instructions in [How to: Create Menus and Menu Items](https://msdn.microsoft.com/library/5277205c-edb9-498e-b927-406237806217(AX.60).aspx)."},{"content":"Select whether to use a method or a query to generate data for any foreign keys in the table.","pos":[2682,2775]},{"content":"Depending on your selection, either a <bpt id=\"p1\">**</bpt>generate<ept id=\"p1\">**</ept> method is added to the class, or the source tables for the foreign keys are added to the query for the entity.","pos":[2776,2937],"source":" Depending on your selection, either a **generate** method is added to the class, or the source tables for the foreign keys are added to the query for the entity."},{"content":"If the entity will be used with a data source that contains related data from two tables, select composite entity.","pos":[2946,3060]},{"content":"The <bpt id=\"p1\">**</bpt>RowID<ept id=\"p1\">**</ept> field is then created in the staging table.","pos":[3061,3118],"source":" The **RowID** field is then created in the staging table."},{"content":"This field is used to map the rows of related data to each other.","pos":[3119,3184]},{"pos":[3193,3285],"content":"When you have finished setting the values that are required for your entity, click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","source":"When you have finished setting the values that are required for your entity, click **Next**."},{"content":"On the <bpt id=\"p1\">**</bpt>Fields in the target table<ept id=\"p1\">**</ept> page, select the fields for the target table.","pos":[3291,3374],"source":"On the **Fields in the target table** page, select the fields for the target table."},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[3375,3390],"source":" Click **Next**."},{"content":"On the <bpt id=\"p1\">**</bpt>Wizard complete<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>.","pos":[3395,3445],"source":"On the **Wizard complete** page, click **Finish**."},{"content":"The Data Import/Export Framework opens the Microsoft Dynamics AX Application Object Tree (AOT) and creates a project for the custom entity in the current layer.","pos":[3446,3606]},{"content":"If the table that you selected uses an extended data type (EDT), you are asked two times whether you want to add the ForeignKey relation from the EDT to the new staging table.","pos":[3611,3786]},{"content":"Click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> each time to create the ForeignKey relationship.","pos":[3787,3849],"source":" Click **Yes** each time to create the ForeignKey relationship."},{"content":"Add the custom entity as a new target entity.","pos":[3854,3899]},{"content":"Depending on the entity, some manual steps might be required.","pos":[3900,3961]},{"content":"For more information about how to create a target entity, see <bpt id=\"p1\">[</bpt>Migrating data using the Data import/export framework (DIXF, DMF)<ept id=\"p1\">](migrate-data-dixf.md)</ept>.","pos":[3962,4114],"source":" For more information about how to create a target entity, see [Migrating data using the Data import/export framework (DIXF, DMF)](migrate-data-dixf.md)."},{"pos":[4119,4150],"content":"Manually create a custom entity","linkify":"Manually create a custom entity","nodes":[{"content":"Manually create a custom entity","pos":[0,31]}]},{"content":"This section describes how to manually create a custom entity.","pos":[4151,4213]},{"pos":[4219,4256],"content":"Create a staging table for the entity","linkify":"Create a staging table for the entity","nodes":[{"content":"Create a staging table for the entity","pos":[0,37]}]},{"content":"In Microsoft Dynamics AX, in the AOT, create a staging table for the entity.","pos":[4262,4338]},{"content":"Use the following information to set up the table properties for the staging table.","pos":[4343,4426]},{"content":"Property name","pos":[4434,4447]},{"content":"Value","pos":[4464,4469]},{"pos":[4526,4548],"content":"<bpt id=\"p1\">**</bpt>SaveDataPerCompany<ept id=\"p1\">**</ept>","source":"**SaveDataPerCompany**"},{"content":"No","pos":[4556,4558]},{"pos":[4572,4594],"content":"<bpt id=\"p1\">**</bpt>SupportInheritance<ept id=\"p1\">**</ept>","source":"**SupportInheritance**"},{"content":"No","pos":[4602,4604]},{"pos":[4618,4631],"content":"<bpt id=\"p1\">**</bpt>TableType<ept id=\"p1\">**</ept>","source":"**TableType**"},{"content":"Regular","pos":[4648,4655]},{"pos":[4664,4684],"content":"<bpt id=\"p1\">**</bpt>ConfigurationKey<ept id=\"p1\">**</ept>","source":"**ConfigurationKey**"},{"content":"DMF","pos":[4694,4697]},{"pos":[4710,4737],"content":"<bpt id=\"p1\">**</bpt>ValidTimeStateFieldType<ept id=\"p1\">**</ept>","source":"**ValidTimeStateFieldType**"},{"content":"None","pos":[4740,4744]},{"content":"Create fields that have the following properties.","pos":[4755,4804]},{"content":"Field name","pos":[4812,4822]},{"content":"Extended data type","pos":[4834,4852]},{"content":"Enum","pos":[4859,4863]},{"pos":[4958,4977],"content":"<bpt id=\"p1\">**</bpt>DefinitionGroup<ept id=\"p1\">**</ept>","source":"**DefinitionGroup**"},{"content":"DMFDefinitionGroupName","pos":[4980,5002]},{"pos":[5031,5045],"content":"<bpt id=\"p1\">**</bpt>IsSelected<ept id=\"p1\">**</ept>","source":"**IsSelected**"},{"content":"DMFIsSelected","pos":[5053,5066]},{"content":"NoYes","pos":[5078,5083]},{"pos":[5104,5122],"content":"<bpt id=\"p1\">**</bpt>TransferStatus<ept id=\"p1\">**</ept>","source":"**TransferStatus**"},{"content":"DMFTransferStatus","pos":[5151,5168]},{"pos":[5177,5192],"content":"<bpt id=\"p1\">**</bpt>ExecutionId<ept id=\"p1\">**</ept>","source":"**ExecutionId**"},{"content":"DMFExecutionId","pos":[5199,5213]},{"content":"Create field groups that have the following properties.","pos":[5249,5304]},{"content":"Field group name","pos":[5312,5328]},{"content":"Label","pos":[5387,5392]},{"content":"Field","pos":[5467,5472]},{"pos":[5824,5841],"content":"<bpt id=\"p1\">**</bpt>ExclusionList<ept id=\"p1\">**</ept>","source":"**ExclusionList**"},{"pos":[5899,5917],"content":"<bpt id=\"p1\">**</bpt>Exclusion List<ept id=\"p1\">**</ept>","source":"**Exclusion List**"},{"pos":[5979,5998],"content":"<bpt id=\"p1\">**</bpt>DefinitionGroup<ept id=\"p1\">**</ept>","source":"**DefinitionGroup**"},{"pos":[6080,6085],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[6155,6160],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[6235,6249],"content":"<bpt id=\"p1\">**</bpt>IsSelected<ept id=\"p1\">**</ept>","source":"**IsSelected**"},{"pos":[6336,6341],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[6411,6416],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[6491,6509],"content":"<bpt id=\"p1\">**</bpt>TransferStatus<ept id=\"p1\">**</ept>","source":"**TransferStatus**"},{"pos":[6592,6597],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[6667,6672],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[6747,6762],"content":"<bpt id=\"p1\">**</bpt>ExecutionId<ept id=\"p1\">**</ept>","source":"**ExecutionId**"},{"pos":[6848,6859],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>","source":"**Enabled**"},{"pos":[6923,6934],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>","source":"**Enabled**"},{"content":"Optional: Fields from the staging table that you want to include in the template by default.","pos":[7003,7095]},{"content":"<ph id=\"ph1\">&amp;lt;</ph><ph id=\"ph2\">&amp;lt;</ph>FunctionName<ph id=\"ph3\">\\_</ph>Sequence<ph id=\"ph4\">&amp;gt;</ph><ph id=\"ph5\">&amp;gt;</ph>Example – GeneratePostalAddress<ph id=\"ph6\">\\_</ph>2","pos":[7104,7176],"source":"&lt;&lt;FunctionName\\_Sequence&gt;&gt;Example – GeneratePostalAddress\\_2"},{"content":"<ph id=\"ph1\">&amp;lt;</ph><ph id=\"ph2\">&amp;lt;</ph> Description of function <ph id=\"ph3\">&amp;gt;</ph><ph id=\"ph4\">&amp;gt;</ph>Function to generate postal address.","pos":[7179,7256],"source":"&lt;&lt; Description of function &gt;&gt;Function to generate postal address."},{"content":"The fields from the staging table that are the source for the specified method.","pos":[7259,7338]},{"pos":[7515,7534],"content":"<bpt id=\"p1\">**</bpt>CountryRegionId<ept id=\"p1\">**</ept>","source":"**CountryRegionId**"},{"pos":[7616,7621],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[7691,7696],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[7771,7780],"content":"<bpt id=\"p1\">**</bpt>State<ept id=\"p1\">**</ept>","source":"**State**"},{"pos":[7872,7877],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[7947,7952],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"pos":[8027,8035],"content":"<bpt id=\"p1\">**</bpt>City<ept id=\"p1\">**</ept>","source":"**City**"},{"pos":[8128,8133],"content":"<bpt id=\"p1\">**</bpt> <ept id=\"p1\">**</ept>","source":"** **"},{"content":"..","pos":[8283,8285]},{"content":"Create a primary index for the table.","pos":[8383,8420]},{"content":"Index name","pos":[8428,8438]},{"content":"Properties","pos":[8470,8480]},{"content":"Fields","pos":[8511,8517]},{"content":"<ph id=\"ph1\">&amp;lt;</ph><ph id=\"ph2\">&amp;lt;</ph>any name<ph id=\"ph3\">&amp;gt;</ph><ph id=\"ph4\">&amp;gt;</ph>.","pos":[8720,8745],"source":"&lt;&lt;any name&gt;&gt;."},{"content":"Example – Idx","pos":[8746,8759]},{"content":"AllowDuplicates – NoAlternateKey - Yes","pos":[8762,8800]},{"pos":[8803,8822],"content":"<bpt id=\"p1\">**</bpt>DefinitionGroup<ept id=\"p1\">**</ept>","source":"**DefinitionGroup**"},{"pos":[8949,8964],"content":"<bpt id=\"p1\">**</bpt>ExecutionId<ept id=\"p1\">**</ept>","source":"**ExecutionId**"},{"pos":[9095,9149],"content":"<bpt id=\"p1\">**</bpt>Fields from the staging table to define uniqueness<ept id=\"p1\">**</ept>","source":"**Fields from the staging table to define uniqueness**"},{"content":"..","pos":[9241,9243]},{"content":"Specify the relationship between the staging table and the target table.","pos":[9303,9375]},{"content":"This relation is used to automatically link a particular staging record with the related target entity.","pos":[9376,9479]},{"content":"If you cannot define the relationship by using the relation node, you should define it by using the addStagingLink() method in the entity class.","pos":[9480,9624]},{"content":"Index name","pos":[9632,9642]},{"content":"Relation properties","pos":[9680,9699]},{"content":"Relation fields","pos":[9719,9734]},{"content":"<ph id=\"ph1\">&amp;lt;</ph><ph id=\"ph2\">&amp;lt;</ph>Target Table<ph id=\"ph3\">&amp;gt;</ph><ph id=\"ph4\">&amp;gt;</ph>.","pos":[9884,9913],"source":"&lt;&lt;Target Table&gt;&gt;."},{"content":"Example -Target","pos":[9914,9929]},{"content":"Table - <ph id=\"ph1\">&amp;lt;</ph><ph id=\"ph2\">&amp;lt;</ph>Target Table<ph id=\"ph3\">&amp;gt;</ph><ph id=\"ph4\">&amp;gt;</ph>","pos":[9932,9968],"source":"Table - &lt;&lt;Target Table&gt;&gt;"},{"content":"Staging.Field1 = Target.Field1","pos":[9971,10001]},{"content":"..","pos":[10097,10099]},{"content":"..","pos":[10223,10225]},{"pos":[10261,10277],"content":"Create a project","linkify":"Create a project","nodes":[{"content":"Create a project","pos":[0,16]}]},{"content":"In Microsoft Dynamics AX, in the AOT, create a project.","pos":[10279,10334]},{"pos":[10340,10369],"content":"Create a class for the entity","linkify":"Create a class for the entity","nodes":[{"content":"Create a class for the entity","pos":[0,29]}]},{"content":"In Microsoft Dynamics AX, in the AOT, create a class for the entity.","pos":[10375,10443]},{"content":"In the class declaration, include the following properties:","pos":[10448,10507]},{"content":"Specify “<ph id=\"ph1\">\\[</ph>DMFAttribute(true)<ph id=\"ph2\">\\]</ph>”.","pos":[10517,10550],"source":"Specify “\\[DMFAttribute(true)\\]”."},{"content":"Specify “DMFClassName extends DMFEntityBase”.","pos":[10559,10604]},{"pos":[10613,10683],"content":"Declare the object for the staging table that has the name <bpt id=\"p1\">**</bpt>entity<ept id=\"p1\">**</ept>.","source":"Declare the object for the staging table that has the name **entity**."},{"pos":[10692,10777],"content":"Declare the object for the main table for the target entity with the name <bpt id=\"p1\">**</bpt>target<ept id=\"p1\">**</ept>.","source":"Declare the object for the main table for the target entity with the name **target**."},{"pos":[10783,10864],"content":"The following example shows how the <bpt id=\"p1\">**</bpt>DMFCustomerEntityClass<ept id=\"p1\">**</ept> class is declared.","source":"The following example shows how the **DMFCustomerEntityClass** class is declared."},{"pos":[11042,11079],"content":"Create the <bpt id=\"p1\">**</bpt>new<ept id=\"p1\">**</ept> method as follows:","source":"Create the **new** method as follows:"},{"content":"The method must take the staging table as a parameter.","pos":[11089,11143]},{"content":"The value entity should be initialized from a parameter.","pos":[11152,11208]},{"pos":[11214,11287],"content":"The following example shows the <bpt id=\"p1\">**</bpt>new<ept id=\"p1\">**</ept> method for <bpt id=\"p2\">**</bpt>DMFCustomerEntity<ept id=\"p2\">**</ept>.","source":"The following example shows the **new** method for **DMFCustomerEntity**."},{"pos":[11391,11434],"content":"Create the <bpt id=\"p1\">**</bpt>construct<ept id=\"p1\">**</ept> method as follows:","source":"Create the **construct** method as follows:"},{"content":"The method must take the staging table as a parameter.","pos":[11444,11498]},{"content":"The method must create and return the object of the current class by using a parameter.","pos":[11507,11594]},{"pos":[11600,11679],"content":"The following example shows the <bpt id=\"p1\">**</bpt>construct<ept id=\"p1\">**</ept> method for <bpt id=\"p2\">**</bpt>DMFCustomerEntity<ept id=\"p2\">**</ept>.","source":"The following example shows the **construct** method for **DMFCustomerEntity**."},{"pos":[11899,11948],"content":"Create the <bpt id=\"p1\">**</bpt>setTargetBuffer<ept id=\"p1\">**</ept> method as follows:","source":"Create the **setTargetBuffer** method as follows:"},{"content":"A target entity can have multiple data sources.","pos":[11958,12005]},{"content":"One data source is the main table that represents the entity.","pos":[12006,12067]},{"content":"In the <bpt id=\"p1\">**</bpt>setTargetBuffer<ept id=\"p1\">**</ept> method, the <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\_</ph>dataSourceName<ept id=\"p2\">**</ept> parameter represents the data sources that are present in the target entity query.","pos":[12068,12210],"source":" In the **setTargetBuffer** method, the **\\_dataSourceName** parameter represents the data sources that are present in the target entity query."},{"content":"Depending on the data source, you might have to initialize a local instance of the table for the data source.","pos":[12219,12328]},{"content":"The local instance can then be used in the functions that are required for data migration.","pos":[12329,12419]},{"content":"The target should be initialized by the main table that represents the target entity.","pos":[12420,12505]},{"pos":[12511,12570],"content":"The following example shows the <bpt id=\"p1\">**</bpt>setTargetBuffer<ept id=\"p1\">**</ept> method.","source":"The following example shows the **setTargetBuffer** method."},{"pos":[12806,12878],"content":"Set the value of the <bpt id=\"p1\">**</bpt>RunOn<ept id=\"p1\">**</ept> property for the class to <bpt id=\"p2\">**</bpt>CalledFrom<ept id=\"p2\">**</ept>.","source":"Set the value of the **RunOn** property for the class to **CalledFrom**."},{"pos":[12884,12925],"content":"Write functions to import and export data","linkify":"Write functions to import and export data","nodes":[{"content":"Write functions to import and export data","pos":[0,41]}]},{"content":"You can map data from the staging to the target entity in two ways:","pos":[12927,12994]},{"content":"Assign a field in the staging entity directly to a field in the target entity.","pos":[12999,13077]},{"content":"In this case, the data types for the staging and target fields must be same.","pos":[13078,13154]},{"content":"Write an X++ function to transform the field values from staging to target.","pos":[13159,13234]},{"content":"Data import and export functions that you define must perform the following actions:","pos":[13236,13320]},{"content":"<bpt id=\"p1\">**</bpt>Input/Source<ept id=\"p1\">**</ept> – The whole staging record is available to the class as a local variable.","pos":[13325,13415],"source":"**Input/Source** – The whole staging record is available to the class as a local variable."},{"content":"Therefore, you do not have to pass any parameters to this class.","pos":[13416,13480]},{"content":"<bpt id=\"p1\">**</bpt>Output/Target<ept id=\"p1\">**</ept> – After the function is run, zero or multiple fields in the target entity are set.","pos":[13485,13585],"source":"**Output/Target** – After the function is run, zero or multiple fields in the target entity are set."},{"content":"The return type of the function is a container that can hold zero or more values that should be set on the target.","pos":[13586,13700]},{"pos":[13702,13818],"content":"The sequence of values that are returned by a particular function must be defined in the <bpt id=\"p1\">**</bpt>getReturnFields<ept id=\"p1\">**</ept> method.","source":"The sequence of values that are returned by a particular function must be defined in the **getReturnFields** method."},{"pos":[13824,13855],"content":"Create a getReturnFields method","linkify":"Create a getReturnFields method","nodes":[{"content":"Create a getReturnFields method","pos":[0,31]}]},{"content":"The <bpt id=\"p1\">**</bpt>getReturnFields<ept id=\"p1\">**</ept> method is used to specify the default output or target fields for the functions that are used for data migration.","pos":[13857,13994],"source":"The **getReturnFields** method is used to specify the default output or target fields for the functions that are used for data migration."},{"content":"Some of the parameters for the method are as follows:","pos":[13995,14048]},{"content":"<ph id=\"ph1\">\\_</ph>entity – The name of the entity.","pos":[14053,14087],"source":"\\_entity – The name of the entity."},{"content":"<ph id=\"ph1\">\\_</ph>name – The name of the function.","pos":[14092,14126],"source":"\\_name – The name of the function."},{"pos":[14128,14190],"content":"<bpt id=\"p1\">**</bpt>Return<ept id=\"p1\">**</ept>: This method must return the following information:","source":"**Return**: This method must return the following information:"},{"content":"A container","pos":[14195,14206]},{"content":"The name of the data source in the target entity query with which the method should be run","pos":[14211,14301]},{"content":"The name of the data source field in the target entity query that should be initialized by the function","pos":[14306,14409]},{"pos":[14416,14447],"content":"Create an addStagingLink method","linkify":"Create an addStagingLink method","nodes":[{"content":"Create an addStagingLink method","pos":[0,31]}]},{"content":"The <bpt id=\"p1\">**</bpt>addStagingLink<ept id=\"p1\">**</ept> method is used to define the relationship between the staging table and target table when this relationship cannot be defined by using the relations property of the staging table.","pos":[14449,14651],"source":"The **addStagingLink** method is used to define the relationship between the staging table and target table when this relationship cannot be defined by using the relations property of the staging table."},{"content":"The target query and the staging record are available in the method.","pos":[14652,14720]},{"content":"Therefore, the range between target and staging can be added by using code.","pos":[14721,14796]},{"content":"The following example shows the <bpt id=\"p1\">**</bpt>addStagingLink<ept id=\"p1\">**</ept> method for the <bpt id=\"p2\">**</bpt>DMFEmployeeEntityClass<ept id=\"p2\">**</ept> class.","pos":[14797,14896],"source":" The following example shows the **addStagingLink** method for the **DMFEmployeeEntityClass** class."},{"content":"public Query addStagingLink(Query query, TableId _entityTableId, Common _staging) { QueryBuildDataSource qbd; qbd = query.dataSourceTable(tableNum(HcmWorker)); qbd.addRange(fieldNum(HcmWorker,PersonnelNumber)).value(_staging.(fieldNum(DMFEmployeeEntity,PersonnelNumber))); return query; }","pos":[14897,15219],"source":"\n    public Query addStagingLink(Query query, TableId _entityTableId, Common _staging) \n    { \n    QueryBuildDataSource qbd; \n    qbd = query.dataSourceTable(tableNum(HcmWorker)); \n    qbd.addRange(fieldNum(HcmWorker,PersonnelNumber)).value(_staging.(fieldNum(DMFEmployeeEntity,PersonnelNumber))); \n    return query; \n    }"},{"pos":[15227,15271],"content":"Create a query to populate the target entity","linkify":"Create a query to populate the target entity","nodes":[{"content":"Create a query to populate the target entity","pos":[0,44]}]},{"content":"Tables that represent the entity should be added to the target entity query.","pos":[15273,15349]},{"content":"You must add a query for manual projects.","pos":[15350,15391]},{"pos":[15397,15438],"content":"Create an enum field in the target entity","linkify":"Create an enum field in the target entity","nodes":[{"content":"Create an enum field in the target entity","pos":[0,41]}]},{"content":"The enum field in the target entity is represented by a string field in the staging table.","pos":[15440,15530]},{"content":"You must create a new EDT of the string type that is of appropriate length to hold the enum label strings.","pos":[15531,15637]},{"content":"The conversion between the enum field in the target entity and the string field in the staging table is handled automatically by the Data Import/Export Framework.","pos":[15638,15800]},{"pos":[15806,15831],"content":"Handle the RefRecId field","linkify":"Handle the RefRecId field","nodes":[{"content":"Handle the RefRecId field","pos":[0,25]}]},{"content":"A staging table usually has natural keys (strings).","pos":[15833,15884]},{"content":"If the target table contains fields that are RecIds from other tables, you must convert the natural key to a RecId.","pos":[15885,16000]},{"content":"In this case, you have two options:","pos":[16001,16036]},{"content":"Add a data source, so that the referenced table can be added to the target entity query.","pos":[16041,16129]},{"content":"Create a function.","pos":[16134,16152]},{"pos":[16159,16176],"content":"Add a data source","linkify":"Add a data source","nodes":[{"content":"Add a data source","pos":[0,17]}]},{"content":"You can add a data source, so that the referenced table can be added to the target entity query.","pos":[16178,16274]},{"content":"For example, the target <bpt id=\"p1\">**</bpt>VendTable<ept id=\"p1\">**</ept> table contains <bpt id=\"p2\">**</bpt>VendExceptionGroup<ept id=\"p2\">**</ept>, which is a RecId that comes from the <bpt id=\"p3\">**</bpt>VendExceptionGroup<ept id=\"p3\">**</ept> table.","pos":[16275,16418],"source":" For example, the target **VendTable** table contains **VendExceptionGroup**, which is a RecId that comes from the **VendExceptionGroup** table."},{"content":"In this case, the staging table must include <bpt id=\"p1\">**</bpt>VendExceptionGroup<ept id=\"p1\">**</ept>.","pos":[16419,16487],"source":" In this case, the staging table must include **VendExceptionGroup**."},{"content":"The <bpt id=\"p1\">**</bpt>VendExceptionGroup<ept id=\"p1\">**</ept> table must also be added to the target entity query, under the <bpt id=\"p2\">**</bpt>VendTable<ept id=\"p2\">**</ept> data source.","pos":[16488,16604],"source":" The **VendExceptionGroup** table must also be added to the target entity query, under the **VendTable** data source."},{"content":"The relationship between <bpt id=\"p1\">**</bpt>VendTable<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>VendExecptionGroup<ept id=\"p2\">**</ept> must be specified manually.","pos":[16605,16698],"source":" The relationship between **VendTable** and **VendExecptionGroup** must be specified manually."},{"content":"The relationship should be between the <bpt id=\"p1\">**</bpt>RefRecId<ept id=\"p1\">**</ept> field in <bpt id=\"p2\">**</bpt>VendTable<ept id=\"p2\">**</ept> and the RecId on <bpt id=\"p3\">**</bpt>VendExceptionGroup<ept id=\"p3\">**</ept>.","pos":[16699,16814],"source":" The relationship should be between the **RefRecId** field in **VendTable** and the RecId on **VendExceptionGroup**."},{"content":"The staging field <bpt id=\"p1\">**</bpt>DMFVendorEntity.VendExecptionGroup<ept id=\"p1\">**</ept> must be mapped to the target field query for <bpt id=\"p2\">**</bpt>DMFVendorTargetEntity. DS:VendExceptionGroup.VendExceptionGroup<ept id=\"p2\">**</ept>.","pos":[16815,16985],"source":" The staging field **DMFVendorEntity.VendExecptionGroup** must be mapped to the target field query for **DMFVendorTargetEntity. DS:VendExceptionGroup.VendExceptionGroup**."},{"content":"In many scenarios, if the name of the field in the target query is same as the staging field, the mapping is performed automatically.","pos":[16986,17119]},{"content":"You can also manually map target fields to staging fields.","pos":[17120,17178]},{"pos":[17185,17202],"content":"Create a function","linkify":"Create a function","nodes":[{"content":"Create a function","pos":[0,17]}]},{"content":"You can create a function on the entity class.","pos":[17204,17250]},{"content":"The related fields for the RefRecId field on the staging table should be natural keys from the staging table.","pos":[17251,17360]},{"content":"You create a method on the entity class to convert the string to a RecId.","pos":[17361,17434]},{"content":"For example, the CustTable table includes the CompanyNAFCode field, which is the RecId of the CompanyNAFCode table.","pos":[17435,17550]},{"content":"In this case, you can create a function on DMFCustomerEntityClass to convert the string (DMFCustomerEntity.CompanyIdNAF) to a RecId (CompanyNAFCode.RecID).","pos":[17551,17706]},{"content":"When you create a function, you must create a field group for the staging table, and the return fields on the target must be specified in the <bpt id=\"p1\">**</bpt>getReturnFields<ept id=\"p1\">**</ept> method in the entity class.","pos":[17707,17896],"source":" When you create a function, you must create a field group for the staging table, and the return fields on the target must be specified in the **getReturnFields** method in the entity class."}],"content":"---\n# required metadata\n\ntitle: Create a custom target entity for the Data import/export framework (AX 2012)\ndescription: This topic describes how to create a custom entity, so that you can use the Microsoft Dynamics AX Data Import/Export Framework to import, export, or migrate data that does not fit a predefined entity.\nauthor: kfend\nmanager: AnnBe\nms.date: 2015-12-04 23 - 17 - 17\nms.topic: article\nms.prod: \nms.service: Lifecycle Services\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \n# ms.reviewer: 51\nms.search.scope: AX 2012\n# ms.tgt_pltfrm: \nms.custom: 18181\nms.assetid: 60c79bd4-1090-4e79-9a8c-2117d963647a\nms.search.region: Global\n# ms.search.industry: \nms.author: kfend\nms.search.validFrom: \nms.dyn365.ops.version: 2012\n\n---\n\n# Create a custom target entity for the Data import/export framework (AX 2012)\n\nThis topic describes how to create a custom entity, so that you can use the Microsoft Dynamics AX Data Import/Export Framework to import, export, or migrate data that does not fit a predefined entity.\n\nA custom entity requires a staging table, a project, a query, a class, and functions. You can use the **Create a custom entity for data import/export Wizard** to create these elements for you, or you can create them manually.\n\n## Prerequisites\nBefore you begin, you must know which table in Microsoft Dynamics AX maps to the entity that you are creating. This table is either the source of the data that you are exporting or the target of the data that you are importing. If you have to create a new table, follow the instructions in [How to: Create Tables](create-tables.md).\n\n## Create a custom entity by using the Create a custom entity for data import/export Wizard\nThe **Create a custom entity for data import/export Wizard** lets you quickly create a custom entity.\n\n1.  Go to **Data Import/Export Framework** &gt; **Common** &gt; **Create a custom entity for data import/export**.\n2.  Select the table that is related to the entity that you want to migrate, and then click **Next**.\n   **Caution**: The wizard can be used to create custom entities that are associated only with tables that do not inherit data structures from other tables.\n3.  On the **Select code generation parameters** page, follow these steps:\n    1.  The wizard suggests names for the staging table, query, and class. You can accept these names or change them.\n    2.  Select a display menu item for the entity. If you have to create a new display menu item, follow the instructions in [How to: Create Menus and Menu Items](https://msdn.microsoft.com/library/5277205c-edb9-498e-b927-406237806217(AX.60).aspx).\n    3.  Select whether to use a method or a query to generate data for any foreign keys in the table. Depending on your selection, either a **generate** method is added to the class, or the source tables for the foreign keys are added to the query for the entity.\n    4.  If the entity will be used with a data source that contains related data from two tables, select composite entity. The **RowID** field is then created in the staging table. This field is used to map the rows of related data to each other.\n    5.  When you have finished setting the values that are required for your entity, click **Next**.\n\n4.  On the **Fields in the target table** page, select the fields for the target table. Click **Next**.\n5.  On the **Wizard complete** page, click **Finish**. The Data Import/Export Framework opens the Microsoft Dynamics AX Application Object Tree (AOT) and creates a project for the custom entity in the current layer.\n6.  If the table that you selected uses an extended data type (EDT), you are asked two times whether you want to add the ForeignKey relation from the EDT to the new staging table. Click **Yes** each time to create the ForeignKey relationship.\n7.  Add the custom entity as a new target entity. Depending on the entity, some manual steps might be required. For more information about how to create a target entity, see [Migrating data using the Data import/export framework (DIXF, DMF)](migrate-data-dixf.md).\n\n## Manually create a custom entity\nThis section describes how to manually create a custom entity.\n\n### Create a staging table for the entity\n\n1.  In Microsoft Dynamics AX, in the AOT, create a staging table for the entity.\n2.  Use the following information to set up the table properties for the staging table.\n\n    | Property name               | Value   |\n    |-----------------------------|---------|\n    | **SaveDataPerCompany**      | No      |\n    | **SupportInheritance**      | No      |\n    | **TableType**               | Regular |\n    | **ConfigurationKey**        | DMF     |\n    | **ValidTimeStateFieldType** | None    |\n\n3.  Create fields that have the following properties.\n\n    | Field name          | Extended data type     | Enum              |\n    |---------------------|------------------------|-------------------|\n    | **DefinitionGroup** | DMFDefinitionGroupName |                   |\n    | **IsSelected**      | DMFIsSelected          | NoYes             |\n    | **TransferStatus**  |                        | DMFTransferStatus |\n    | **ExecutionId**     | DMFExecutionId         |                   |\n\n4.  Create field groups that have the following properties.\n\n    | Field group name                                                         | Label                                                                         | Field                                                                                        |\n    |--------------------------------------------------------------------------|-------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|\n    | **ExclusionList**                                                        | **Exclusion List**                                                            | **DefinitionGroup**                                                                          |\n    | ** **                                                                    | ** **                                                                         | **IsSelected**                                                                               |\n    | ** **                                                                    | ** **                                                                         | **TransferStatus**                                                                           |\n    | ** **                                                                    | ** **                                                                         | **ExecutionId**                                                                              |\n    | **Enabled**                                                              | **Enabled**                                                                   | Optional: Fields from the staging table that you want to include in the template by default. |\n    | &lt;&lt;FunctionName\\_Sequence&gt;&gt;Example – GeneratePostalAddress\\_2 | &lt;&lt; Description of function &gt;&gt;Function to generate postal address. | The fields from the staging table that are the source for the specified method.              |\n    |                                                                          |                                                                               | **CountryRegionId**                                                                          |\n    | ** **                                                                    | ** **                                                                         | **State**                                                                                    |\n    | ** **                                                                    | ** **                                                                         | **City**                                                                                     |\n    | ** **                                                                    |                                                                               | ..                                                                                           |\n\n5.  Create a primary index for the table.\n\n    | Index name                              | Properties                             | Fields                                                 |\n    |-----------------------------------------|----------------------------------------|--------------------------------------------------------|\n    | &lt;&lt;any name&gt;&gt;. Example – Idx | AllowDuplicates – NoAlternateKey - Yes | **DefinitionGroup**                                    |\n    |                                         |                                        | **ExecutionId**                                        |\n    |                                         |                                        | **Fields from the staging table to define uniqueness** |\n    |                                         |                                        | ..                                                     |\n\n6.  Specify the relationship between the staging table and the target table. This relation is used to automatically link a particular staging record with the related target entity. If you cannot define the relationship by using the relation node, you should define it by using the addStagingLink() method in the entity class.\n\n    | Index name                                    | Relation properties                  | Relation fields                |\n    |-----------------------------------------------|--------------------------------------|--------------------------------|\n    | &lt;&lt;Target Table&gt;&gt;. Example -Target | Table - &lt;&lt;Target Table&gt;&gt; | Staging.Field1 = Target.Field1 |\n    |                                               |                                      | ..                             |\n    |                                               |                                      | ..                             |\n\n### Create a project\n\nIn Microsoft Dynamics AX, in the AOT, create a project.\n\n### Create a class for the entity\n\n1.  In Microsoft Dynamics AX, in the AOT, create a class for the entity.\n2.  In the class declaration, include the following properties:\n\n    -   Specify “\\[DMFAttribute(true)\\]”.\n    -   Specify “DMFClassName extends DMFEntityBase”.\n    -   Declare the object for the staging table that has the name **entity**.\n    -   Declare the object for the main table for the target entity with the name **target**.\n\n    The following example shows how the **DMFCustomerEntityClass** class is declared.\n\n        [DMFAttribute(true)]\n        class DMFCustomerEntityClass extends DMFEntityBase\n        {\n\n        DMFCustomerEntity entity;\n\n        CustTable target;\n\n        }\n\n3.  Create the **new** method as follows:\n\n    -   The method must take the staging table as a parameter.\n    -   The value entity should be initialized from a parameter.\n\n    The following example shows the **new** method for **DMFCustomerEntity**.\n\n        Public void new(DMFCustomerEntity _entity)\n        {\n        entity = _entity;\n        }\n\n4.  Create the **construct** method as follows:\n\n    -   The method must take the staging table as a parameter.\n    -   The method must create and return the object of the current class by using a parameter.\n\n    The following example shows the **construct** method for **DMFCustomerEntity**.\n\n        public static DMFCustomerEntityClass construct (DMFCustomerEntity _entity)\n        {\n        DMFCustomerEntityClass entityClass = new DMFCustomerEntityClass(_entity);\n        return entityClass;\n        }\n\n5.  Create the **setTargetBuffer** method as follows:\n\n    -   A target entity can have multiple data sources. One data source is the main table that represents the entity. In the **setTargetBuffer** method, the **\\_dataSourceName** parameter represents the data sources that are present in the target entity query.\n    -   Depending on the data source, you might have to initialize a local instance of the table for the data source. The local instance can then be used in the functions that are required for data migration. The target should be initialized by the main table that represents the target entity.\n\n    The following example shows the **setTargetBuffer** method.\n\n        public void setTargetBuffer(Common _common, Name _dataSourceName = ' ')\n        {\n        switch (_common.TableId)\n        {\n        Case tableNum(CustTable) :\n        Target = _common;\n        Break;\n        }\n        }\n\n6.  Set the value of the **RunOn** property for the class to **CalledFrom**.\n\n### Write functions to import and export data\n\nYou can map data from the staging to the target entity in two ways:\n-   Assign a field in the staging entity directly to a field in the target entity. In this case, the data types for the staging and target fields must be same.\n-   Write an X++ function to transform the field values from staging to target.\n\nData import and export functions that you define must perform the following actions:\n-   **Input/Source** – The whole staging record is available to the class as a local variable. Therefore, you do not have to pass any parameters to this class.\n-   **Output/Target** – After the function is run, zero or multiple fields in the target entity are set. The return type of the function is a container that can hold zero or more values that should be set on the target.\n\nThe sequence of values that are returned by a particular function must be defined in the **getReturnFields** method.\n#### Create a getReturnFields method\n\nThe **getReturnFields** method is used to specify the default output or target fields for the functions that are used for data migration. Some of the parameters for the method are as follows:\n-   \\_entity – The name of the entity.\n-   \\_name – The name of the function.\n\n**Return**: This method must return the following information:\n-   A container\n-   The name of the data source in the target entity query with which the method should be run\n-   The name of the data source field in the target entity query that should be initialized by the function\n\n#### Create an addStagingLink method\n\nThe **addStagingLink** method is used to define the relationship between the staging table and target table when this relationship cannot be defined by using the relations property of the staging table. The target query and the staging record are available in the method. Therefore, the range between target and staging can be added by using code. The following example shows the **addStagingLink** method for the **DMFEmployeeEntityClass** class.\n    public Query addStagingLink(Query query, TableId _entityTableId, Common _staging) \n    { \n    QueryBuildDataSource qbd; \n    qbd = query.dataSourceTable(tableNum(HcmWorker)); \n    qbd.addRange(fieldNum(HcmWorker,PersonnelNumber)).value(_staging.(fieldNum(DMFEmployeeEntity,PersonnelNumber))); \n    return query; \n    } \n\n#### Create a query to populate the target entity\n\nTables that represent the entity should be added to the target entity query. You must add a query for manual projects.\n\n### Create an enum field in the target entity\n\nThe enum field in the target entity is represented by a string field in the staging table. You must create a new EDT of the string type that is of appropriate length to hold the enum label strings. The conversion between the enum field in the target entity and the string field in the staging table is handled automatically by the Data Import/Export Framework.\n\n### Handle the RefRecId field\n\nA staging table usually has natural keys (strings). If the target table contains fields that are RecIds from other tables, you must convert the natural key to a RecId. In this case, you have two options:\n-   Add a data source, so that the referenced table can be added to the target entity query.\n-   Create a function.\n\n#### Add a data source\n\nYou can add a data source, so that the referenced table can be added to the target entity query. For example, the target **VendTable** table contains **VendExceptionGroup**, which is a RecId that comes from the **VendExceptionGroup** table. In this case, the staging table must include **VendExceptionGroup**. The **VendExceptionGroup** table must also be added to the target entity query, under the **VendTable** data source. The relationship between **VendTable** and **VendExecptionGroup** must be specified manually. The relationship should be between the **RefRecId** field in **VendTable** and the RecId on **VendExceptionGroup**. The staging field **DMFVendorEntity.VendExecptionGroup** must be mapped to the target field query for **DMFVendorTargetEntity. DS:VendExceptionGroup.VendExceptionGroup**. In many scenarios, if the name of the field in the target query is same as the staging field, the mapping is performed automatically. You can also manually map target fields to staging fields.\n\n#### Create a function\n\nYou can create a function on the entity class. The related fields for the RefRecId field on the staging table should be natural keys from the staging table. You create a method on the entity class to convert the string to a RecId. For example, the CustTable table includes the CompanyNAFCode field, which is the RecId of the CompanyNAFCode table. In this case, you can create a function on DMFCustomerEntityClass to convert the string (DMFCustomerEntity.CompanyIdNAF) to a RecId (CompanyNAFCode.RecID). When you create a function, you must create a field group for the staging table, and the return fields on the target must be specified in the **getReturnFields** method in the entity class.\n\n\n\n"}