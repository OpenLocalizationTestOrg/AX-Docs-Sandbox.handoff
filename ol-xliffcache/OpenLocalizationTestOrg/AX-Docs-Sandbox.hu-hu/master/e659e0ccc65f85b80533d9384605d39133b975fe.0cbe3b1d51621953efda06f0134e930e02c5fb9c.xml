{"content":"---\n# required metadata\n\ntitle: Gantt development guide\ndescription: This article describes how to create new forms by using the Gantt control. We highly recommend that you look at the code in the Tutorial_Gantt form. This code demonstrates the full capabilities of the Gantt control, and shows how to load data and work with the application programming interface (API).\nauthor: YuyuScheller\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \n# ms.reviewer: 61\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 17311\nms.assetid: e5cd372c-6ac2-4995-bb3c-ff863b40fedb\nms.search.region: Global\n# ms.search.industry: \nms.author: yuyus\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Gantt development guide\n\n[!include[banner](../includes/banner.md)]\n\n\nThis article describes how to create new forms by using the Gantt control. We highly recommend that you look at the code in the Tutorial_Gantt form. This code demonstrates the full capabilities of the Gantt control, and shows how to load data and work with the application programming interface (API).\n\nWhat’s new for Gantt\n--------------------\n\nIn Microsoft Dynamics AX 2012, the client was a Win32 application, and extensions used Microsoft ActiveX, WinForm, or Microsoft Windows Presentation Foundation (WPF) controls. In Microsoft Dynamics 365 for Operations, ActiveX and ManagedHost controls can no longer be used to add custom controls, because they are incompatible with the HTML-based platform. Instead, a new extensible control framework lets you add controls by using HTML and JavaScript. The new Gantt control is implemented by using this framework. Note that, unlike in earlier versions, you don't have to pay an additional license fee to use the control in your own forms or to extend the control.\n\n## Highlevel overview of the control\nThe following illustration shows the visual elements of the Gantt control.\n\n[![Elements of the Gantt](./media/ganttchartelements.png)](./media/ganttchartelements.png)\n\nTo add the control to a new form, just right-click the top node in the form design, and then select **Add new** &gt; **Gantt**. After you set the **Height** and **Width** properties to **SizeToAvailable**, there are no other properties that must be set in the designer. Unlike many other controls, Gantt controls can't be bound to data sources. Instead, you must add all data to the control from code.\n\n## Adding activities, links, and milestone markers\nThe most basic element of a Gantt chart is the task activity. Each activity is allocated its own row in the chart. Activities can form a hierarchy, like a tree, by referencing a parent activity. Additionally, any two activities can be connected to each other through links (across hierarchies). To add data to the control, you build up a list that contains the instances of the element that you want to add. You then assign the list to the control by using a **parm** method. Note that, when you modify data, you can't just modify the content of the list. To notify the client that data has changed, and to trigger a refresh, you must reassign the list to the control by using the **parm** method.\n\n[![API for activities and links](./media/ganttchartactivitiesapi.png)](./media/ganttchartactivitiesapi.png)\n\nEach activity must have a unique ID across all activity types. This ID is required in order to build the hierarchy and the links. The ID is also used to identify the activity when the server is notified after a user interaction. There are two types of milestones: the milestone activity is a stand-alone activity that receives its own row in the chart and can be referenced from the links, whereas the milestone markers appear on the same row as the related activity. Both types of markers are represented by using symbols from the Dynamics Symbol font.\n\n## Column headers and content\nIn the “grid” on the left side of the control, you can arrange the data into columns. The column definitions are provided through the **GanttControl.parmColumns** property, which is a list of **GanttControlColumn** objects. The content of the columns is given as a simple **List** object that contains the text strings for an activity through the **GanttControlActivity.parmColumnTexts** property. Note that the values in the column list must be strings. Therefore, any formatting of numbers, enumerations, dates, and so on, must occur on the server side. The formatting of **utcdatetime** must take into account the user's preferred time zone, because that time zone will be used when the Gantt chart is rendered.\n\n[![API for configuring the control](./media/ganttchartconfigurationapi.png)](./media/ganttchartconfigurationapi.png)\n\n## Working times\nAn activity can reference a calendar. A calendar is basically a list of working time intervals. A calendar is used to visually separate working time from non-working time by giving the “cells” (intersections of a row and a time scale interval) a different background color. Note that these working time intervals don't have to come from the standard calendar tables. The intervals are just data that you can load from anywhere. Although calendars are a nice feature that can give you a good overview, there are some performance issues that you must consider. When you turn calendars on (by setting **GanttControlConfiguration.parmUseCalendars** to **true**), each “cell” is rendered in HTML by using a DIV element. If a calendar shows lots of activities for a long period at a very granular minor timescale, there will be many DIV elements. Depending on the browser and hardware, the large number of DIV elements can cause performance issues for the user. In this case, you might have to turn calendars off. In this way, you significantly reduce the number of DIV elements that must be rendered. The control can't turn off calendars by itself to improve performance. Based on the specific scenario, you must determine what will be best for the user.\n\n## Color use\nElements such as the activities and milestone markers have a color property. Typically, either the int value for a specific color is calculated by using the **WinAPI::RGB2int** method, or the user sets the value by using the color picker (which is opened by calling **ColorSelection::selectColor**). Instead of controlling the colors yourself, you can specify that the colors should adhere to the current theme. When you set the **GanttControlConfiguration.parmUseThemeColors** option to **true**, if any color values have been set that aren't part of the current theme, they are overridden (no colors have to be specified manually). When theme colors are used, the **parmIsActive** flag on an activity is used to determine whether the activity should appear in a dark color or a light color.\n\n## Interactions\nWhenever the user interacts with the Gantt, an event is raised to notify the server-side code. The following events are currently available:\n\n-   onActivitySelected(str \\_activityId, GanttControlActivityIdCollection \\_allSelectedActivityIds)\n-   onActivityDblClick(str \\_activityId)\n-   onSummaryActivityExpand(str \\_activityId)\n-   onSummaryActivityCollapse(str \\_activityId)\n-   onActivityChanged(GanttControlActivityModification \\_modification, GanttControlActivityModificationResponse \\_response)\n\nAll these events are one-way notifications from the client. However, the **onActivityChanged** event is somewhat special, because you can set a response. Typically, when a user makes a modification (for example, he or she drags an activity to a new time), either other activities must also be updated or some adjustments must be made to the activity itself (for example, the column texts must be changed). In the **GanttControlActivityModificationResponse** response, you can provide a list of activities that must be updated. If the change that the user makes is just accepted as is, no response must be set. However, at the very least, the column texts of the current activity must be updated in most cases, to guarantee that the new from and to dates appear. On an activity, the **parmAllowMove** flag determines whether the activity can be moved. However, higher-level flags on **GanttControlConfiguration** determine whether any activity can be moved (**parmAllowMoveActivities**) or resized (**parmAllowResizeActivities**), or whether the completion percentage for the activity can be changed (**parmAllowCompletionChange**).\n\n\n\n","nodes":[{"pos":[32,55],"content":"Gantt development guide","needQuote":true,"needEscape":true,"nodes":[{"content":"Gantt development guide","pos":[0,23]}]},{"pos":[69,370],"content":"This article describes how to create new forms by using the Gantt control. We highly recommend that you look at the code in the Tutorial_Gantt form. This code demonstrates the full capabilities of the Gantt control, and shows how to load data and work with the application programming interface (API).","needQuote":true,"needEscape":true,"nodes":[{"content":"This article describes how to create new forms by using the Gantt control. We highly recommend that you look at the code in the Tutorial_Gantt form. This code demonstrates the full capabilities of the Gantt control, and shows how to load data and work with the application programming interface (API).","pos":[0,301],"nodes":[{"content":"This article describes how to create new forms by using the Gantt control.","pos":[0,74]},{"content":"We highly recommend that you look at the code in the Tutorial_Gantt form.","pos":[75,148]},{"content":"This code demonstrates the full capabilities of the Gantt control, and shows how to load data and work with the application programming interface (API).","pos":[149,301]}]}]},{"pos":[869,892],"content":"Gantt development guide","linkify":"Gantt development guide","nodes":[{"content":"Gantt development guide","pos":[0,23]}]},{"content":"This article describes how to create new forms by using the Gantt control.","pos":[938,1012]},{"content":"We highly recommend that you look at the code in the Tutorial_Gantt form.","pos":[1013,1086]},{"content":"This code demonstrates the full capabilities of the Gantt control, and shows how to load data and work with the application programming interface (API).","pos":[1087,1239]},{"pos":[1241,1261],"content":"What’s new for Gantt","linkify":"What’s new for Gantt","nodes":[{"content":"What’s new for Gantt","pos":[0,20]}]},{"content":"In Microsoft Dynamics AX 2012, the client was a Win32 application, and extensions used Microsoft ActiveX, WinForm, or Microsoft Windows Presentation Foundation (WPF) controls.","pos":[1284,1459]},{"content":"In Microsoft Dynamics 365 for Operations, ActiveX and ManagedHost controls can no longer be used to add custom controls, because they are incompatible with the HTML-based platform.","pos":[1460,1640]},{"content":"Instead, a new extensible control framework lets you add controls by using HTML and JavaScript.","pos":[1641,1736]},{"content":"The new Gantt control is implemented by using this framework.","pos":[1737,1798]},{"content":"Note that, unlike in earlier versions, you don't have to pay an additional license fee to use the control in your own forms or to extend the control.","pos":[1799,1948]},{"pos":[1953,1986],"content":"Highlevel overview of the control","linkify":"Highlevel overview of the control","nodes":[{"content":"Highlevel overview of the control","pos":[0,33]}]},{"content":"The following illustration shows the visual elements of the Gantt control.","pos":[1987,2061]},{"pos":[2063,2153],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Elements of the Gantt<ept id=\"p1\">](./media/ganttchartelements.png)](./media/ganttchartelements.png)</ept>","source":"[![Elements of the Gantt](./media/ganttchartelements.png)](./media/ganttchartelements.png)"},{"content":"To add the control to a new form, just right-click the top node in the form design, and then select <bpt id=\"p1\">**</bpt>Add new<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Gantt<ept id=\"p2\">**</ept>.","pos":[2155,2282],"source":"To add the control to a new form, just right-click the top node in the form design, and then select **Add new** &gt; **Gantt**."},{"content":"After you set the <bpt id=\"p1\">**</bpt>Height<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Width<ept id=\"p2\">**</ept> properties to <bpt id=\"p3\">**</bpt>SizeToAvailable<ept id=\"p3\">**</ept>, there are no other properties that must be set in the designer.","pos":[2283,2424],"source":" After you set the **Height** and **Width** properties to **SizeToAvailable**, there are no other properties that must be set in the designer."},{"content":"Unlike many other controls, Gantt controls can't be bound to data sources.","pos":[2425,2499]},{"content":"Instead, you must add all data to the control from code.","pos":[2500,2556]},{"pos":[2561,2608],"content":"Adding activities, links, and milestone markers","linkify":"Adding activities, links, and milestone markers","nodes":[{"content":"Adding activities, links, and milestone markers","pos":[0,47]}]},{"content":"The most basic element of a Gantt chart is the task activity.","pos":[2609,2670]},{"content":"Each activity is allocated its own row in the chart.","pos":[2671,2723]},{"content":"Activities can form a hierarchy, like a tree, by referencing a parent activity.","pos":[2724,2803]},{"content":"Additionally, any two activities can be connected to each other through links (across hierarchies).","pos":[2804,2903]},{"content":"To add data to the control, you build up a list that contains the instances of the element that you want to add.","pos":[2904,3016]},{"content":"You then assign the list to the control by using a <bpt id=\"p1\">**</bpt>parm<ept id=\"p1\">**</ept> method.","pos":[3017,3084],"source":" You then assign the list to the control by using a **parm** method."},{"content":"Note that, when you modify data, you can't just modify the content of the list.","pos":[3085,3164]},{"content":"To notify the client that data has changed, and to trigger a refresh, you must reassign the list to the control by using the <bpt id=\"p1\">**</bpt>parm<ept id=\"p1\">**</ept> method.","pos":[3165,3306],"source":" To notify the client that data has changed, and to trigger a refresh, you must reassign the list to the control by using the **parm** method."},{"pos":[3308,3415],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>API for activities and links<ept id=\"p1\">](./media/ganttchartactivitiesapi.png)](./media/ganttchartactivitiesapi.png)</ept>","source":"[![API for activities and links](./media/ganttchartactivitiesapi.png)](./media/ganttchartactivitiesapi.png)"},{"content":"Each activity must have a unique ID across all activity types.","pos":[3417,3479]},{"content":"This ID is required in order to build the hierarchy and the links.","pos":[3480,3546]},{"content":"The ID is also used to identify the activity when the server is notified after a user interaction.","pos":[3547,3645]},{"content":"There are two types of milestones: the milestone activity is a stand-alone activity that receives its own row in the chart and can be referenced from the links, whereas the milestone markers appear on the same row as the related activity.","pos":[3646,3884]},{"content":"Both types of markers are represented by using symbols from the Dynamics Symbol font.","pos":[3885,3970]},{"pos":[3975,4001],"content":"Column headers and content","linkify":"Column headers and content","nodes":[{"content":"Column headers and content","pos":[0,26]}]},{"content":"In the “grid” on the left side of the control, you can arrange the data into columns.","pos":[4002,4087]},{"content":"The column definitions are provided through the <bpt id=\"p1\">**</bpt>GanttControl.parmColumns<ept id=\"p1\">**</ept> property, which is a list of <bpt id=\"p2\">**</bpt>GanttControlColumn<ept id=\"p2\">**</ept> objects.","pos":[4088,4225],"source":" The column definitions are provided through the **GanttControl.parmColumns** property, which is a list of **GanttControlColumn** objects."},{"content":"The content of the columns is given as a simple <bpt id=\"p1\">**</bpt>List<ept id=\"p1\">**</ept> object that contains the text strings for an activity through the <bpt id=\"p2\">**</bpt>GanttControlActivity.parmColumnTexts<ept id=\"p2\">**</ept> property.","pos":[4226,4399],"source":" The content of the columns is given as a simple **List** object that contains the text strings for an activity through the **GanttControlActivity.parmColumnTexts** property."},{"content":"Note that the values in the column list must be strings.","pos":[4400,4456]},{"content":"Therefore, any formatting of numbers, enumerations, dates, and so on, must occur on the server side.","pos":[4457,4557]},{"content":"The formatting of <bpt id=\"p1\">**</bpt>utcdatetime<ept id=\"p1\">**</ept> must take into account the user's preferred time zone, because that time zone will be used when the Gantt chart is rendered.","pos":[4558,4716],"source":" The formatting of **utcdatetime** must take into account the user's preferred time zone, because that time zone will be used when the Gantt chart is rendered."},{"pos":[4718,4834],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>API for configuring the control<ept id=\"p1\">](./media/ganttchartconfigurationapi.png)](./media/ganttchartconfigurationapi.png)</ept>","source":"[![API for configuring the control](./media/ganttchartconfigurationapi.png)](./media/ganttchartconfigurationapi.png)"},{"pos":[4839,4852],"content":"Working times","linkify":"Working times","nodes":[{"content":"Working times","pos":[0,13]}]},{"content":"An activity can reference a calendar.","pos":[4853,4890]},{"content":"A calendar is basically a list of working time intervals.","pos":[4891,4948]},{"content":"A calendar is used to visually separate working time from non-working time by giving the “cells” (intersections of a row and a time scale interval) a different background color.","pos":[4949,5126]},{"content":"Note that these working time intervals don't have to come from the standard calendar tables.","pos":[5127,5219]},{"content":"The intervals are just data that you can load from anywhere.","pos":[5220,5280]},{"content":"Although calendars are a nice feature that can give you a good overview, there are some performance issues that you must consider.","pos":[5281,5411]},{"content":"When you turn calendars on (by setting <bpt id=\"p1\">**</bpt>GanttControlConfiguration.parmUseCalendars<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>true<ept id=\"p2\">**</ept>), each “cell” is rendered in HTML by using a DIV element.","pos":[5412,5567],"source":" When you turn calendars on (by setting **GanttControlConfiguration.parmUseCalendars** to **true**), each “cell” is rendered in HTML by using a DIV element."},{"content":"If a calendar shows lots of activities for a long period at a very granular minor timescale, there will be many DIV elements.","pos":[5568,5693]},{"content":"Depending on the browser and hardware, the large number of DIV elements can cause performance issues for the user.","pos":[5694,5808]},{"content":"In this case, you might have to turn calendars off.","pos":[5809,5860]},{"content":"In this way, you significantly reduce the number of DIV elements that must be rendered.","pos":[5861,5948]},{"content":"The control can't turn off calendars by itself to improve performance.","pos":[5949,6019]},{"content":"Based on the specific scenario, you must determine what will be best for the user.","pos":[6020,6102]},{"pos":[6107,6116],"content":"Color use","linkify":"Color use","nodes":[{"content":"Color use","pos":[0,9]}]},{"content":"Elements such as the activities and milestone markers have a color property.","pos":[6117,6193]},{"content":"Typically, either the int value for a specific color is calculated by using the <bpt id=\"p1\">**</bpt>WinAPI::RGB2int<ept id=\"p1\">**</ept> method, or the user sets the value by using the color picker (which is opened by calling <bpt id=\"p2\">**</bpt>ColorSelection::selectColor<ept id=\"p2\">**</ept>).","pos":[6194,6416],"source":" Typically, either the int value for a specific color is calculated by using the **WinAPI::RGB2int** method, or the user sets the value by using the color picker (which is opened by calling **ColorSelection::selectColor**)."},{"content":"Instead of controlling the colors yourself, you can specify that the colors should adhere to the current theme.","pos":[6417,6528]},{"content":"When you set the <bpt id=\"p1\">**</bpt>GanttControlConfiguration.parmUseThemeColors<ept id=\"p1\">**</ept> option to <bpt id=\"p2\">**</bpt>true<ept id=\"p2\">**</ept>, if any color values have been set that aren't part of the current theme, they are overridden (no colors have to be specified manually).","pos":[6529,6750],"source":" When you set the **GanttControlConfiguration.parmUseThemeColors** option to **true**, if any color values have been set that aren't part of the current theme, they are overridden (no colors have to be specified manually)."},{"content":"When theme colors are used, the <bpt id=\"p1\">**</bpt>parmIsActive<ept id=\"p1\">**</ept> flag on an activity is used to determine whether the activity should appear in a dark color or a light color.","pos":[6751,6909],"source":" When theme colors are used, the **parmIsActive** flag on an activity is used to determine whether the activity should appear in a dark color or a light color."},{"pos":[6914,6926],"content":"Interactions","linkify":"Interactions","nodes":[{"content":"Interactions","pos":[0,12]}]},{"content":"Whenever the user interacts with the Gantt, an event is raised to notify the server-side code.","pos":[6927,7021]},{"content":"The following events are currently available:","pos":[7022,7067]},{"content":"onActivitySelected(str <ph id=\"ph1\">\\_</ph>activityId, GanttControlActivityIdCollection <ph id=\"ph2\">\\_</ph>allSelectedActivityIds)","pos":[7073,7168],"source":"onActivitySelected(str \\_activityId, GanttControlActivityIdCollection \\_allSelectedActivityIds)"},{"content":"onActivityDblClick(str <ph id=\"ph1\">\\_</ph>activityId)","pos":[7173,7209],"source":"onActivityDblClick(str \\_activityId)"},{"content":"onSummaryActivityExpand(str <ph id=\"ph1\">\\_</ph>activityId)","pos":[7214,7255],"source":"onSummaryActivityExpand(str \\_activityId)"},{"content":"onSummaryActivityCollapse(str <ph id=\"ph1\">\\_</ph>activityId)","pos":[7260,7303],"source":"onSummaryActivityCollapse(str \\_activityId)"},{"content":"onActivityChanged(GanttControlActivityModification <ph id=\"ph1\">\\_</ph>modification, GanttControlActivityModificationResponse <ph id=\"ph2\">\\_</ph>response)","pos":[7308,7427],"source":"onActivityChanged(GanttControlActivityModification \\_modification, GanttControlActivityModificationResponse \\_response)"},{"content":"All these events are one-way notifications from the client.","pos":[7429,7488]},{"content":"However, the <bpt id=\"p1\">**</bpt>onActivityChanged<ept id=\"p1\">**</ept> event is somewhat special, because you can set a response.","pos":[7489,7582],"source":" However, the **onActivityChanged** event is somewhat special, because you can set a response."},{"content":"Typically, when a user makes a modification (for example, he or she drags an activity to a new time), either other activities must also be updated or some adjustments must be made to the activity itself (for example, the column texts must be changed).","pos":[7583,7834]},{"content":"In the <bpt id=\"p1\">**</bpt>GanttControlActivityModificationResponse<ept id=\"p1\">**</ept> response, you can provide a list of activities that must be updated.","pos":[7835,7955],"source":" In the **GanttControlActivityModificationResponse** response, you can provide a list of activities that must be updated."},{"content":"If the change that the user makes is just accepted as is, no response must be set.","pos":[7956,8038]},{"content":"However, at the very least, the column texts of the current activity must be updated in most cases, to guarantee that the new from and to dates appear.","pos":[8039,8190]},{"content":"On an activity, the <bpt id=\"p1\">**</bpt>parmAllowMove<ept id=\"p1\">**</ept> flag determines whether the activity can be moved.","pos":[8191,8279],"source":" On an activity, the **parmAllowMove** flag determines whether the activity can be moved."},{"content":"However, higher-level flags on <bpt id=\"p1\">**</bpt>GanttControlConfiguration<ept id=\"p1\">**</ept> determine whether any activity can be moved (<bpt id=\"p2\">**</bpt>parmAllowMoveActivities<ept id=\"p2\">**</ept>) or resized (<bpt id=\"p3\">**</bpt>parmAllowResizeActivities<ept id=\"p3\">**</ept>), or whether the completion percentage for the activity can be changed (<bpt id=\"p4\">**</bpt>parmAllowCompletionChange<ept id=\"p4\">**</ept>).","pos":[8280,8560],"source":" However, higher-level flags on **GanttControlConfiguration** determine whether any activity can be moved (**parmAllowMoveActivities**) or resized (**parmAllowResizeActivities**), or whether the completion percentage for the activity can be changed (**parmAllowCompletionChange**)."}]}