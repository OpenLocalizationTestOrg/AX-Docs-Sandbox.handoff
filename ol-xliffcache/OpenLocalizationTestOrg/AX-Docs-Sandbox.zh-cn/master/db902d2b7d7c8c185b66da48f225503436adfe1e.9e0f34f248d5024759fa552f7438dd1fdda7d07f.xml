{"content":"---\n# required metadata\n\ntitle: Office integration troubleshooting\ndescription: This topic provides answers to questions, tips, and troubleshooting information for the Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.\nauthor: ChrisGarty\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\nms.search.form: OfficeAppParameters\n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: annbe\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 72263\nms.assetid: 89588fed-b47f-4f01-9328-325518f016d6\nms.search.region: Global\n# ms.search.industry: \nms.author: cgarty\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Office integration troubleshooting\n\n[!include[banner](../includes/banner.md)]\n\n\nThis topic provides answers to questions, tips, and troubleshooting information about the Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.\n\nFrequently asked questions\n--------------------------\n\n### What platforms are supported for the Office Add-ins?\n\nThe Excel Add-in and Word Add-in are built using the Office Web/JavaScript Add-in framework that was initially released for Office 2013, but received significant updates in Office 2016. For more information, see [Office Add-in host and platform availability](http://dev.office.com/add-in-availability). The Excel Add-in requires the ExcelAPI 1.2, so use the [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) matrix to determine which platforms it is supported on. For many users, the phrase \"Excel 2016 with the latest updates\" is sufficient.\n\n### Is Office for Mac supported for the Excel Add-in?\n\nNo. Mac and iOS support is currently under development. There are authentication differences in how the Office JS APIs function in Safari versus Internet Explorer, particularly in the authentication space. See [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) for details about Office JS API platform support.\n\n### What version of Office is needed to allow the Excel Add-in to support ADFS?\n\nRead more about that in the troubleshooting section below.\n\n### How can Office be forced into updating?\n\nIf your Office build does not update then it might be because you are on the deferred track ([\"Microsoft Office 365 ProPlus\" update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)), in which case you could [use the \"Office Deployment Tool\" to move to the Current channel ](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396)or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider) to ensure that you have the latest updates. The easiest path is to use the Office Deployment Tool to switch to the Current channel, which will cause the latest updates to install immediately.\n\n### Why can't you tell me what version of Office/Excel a particular issue is fixed in?\n\nOffice has many different releases, which receive updates at different times and have different version numbers that don't correspond. Some of the more common Office versions and update methods are Click to Run (C2R) Current channel, C2R Deferred, C2R First Update Deferred, Office Insider Fast, Office Insider Slow, and MSI/MSO (install from DVD). The [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page has more information about Office versions.\n\n### Why am I having trouble signing into the Excel Add-in?\n\nThe Excel Add-in runs inside an Internet Explorer (IE) window. The Excel Add-in will pick up stored credentials from IE by default, and IE will provide the current Windows credentials if there are no stored credentials. Ensure that you are trying to sign in with the correct credentials. In the Excel Add-in, explicitly sign out and then sign in to ensure that the desired credentials are in use.\n\n## Troubleshooting issues\n### \\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"\n\n**Issue:** During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\". \n\n**Explanation:** This is usually caused when Microsoft Azure Active Directory (AAD) cannot find the AAD application representing the Excel Add-in because during [Power BI configuration](..\\analytics\\configure-power-bi-integration.md) an AAD application was added that has the App ID URI set to the environment URL. \n\n**Fix:** Ensure that there are no AAD App ID URI's set to the environment URI. App ID URI's should be a fabricated, unique URI like `https://contosoAXPowerBI`.\n\n### \\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"\n\n**Issue:** During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\". \n\n**Explanation:** This is likely a failure in the deployment system that caused the environment to get a URL that was not added in the configured list of service principals for the tenant. \n\n**Fix:** File a support issue for your environment so that the problem can be investigated and the configuration can be adjusted.\n\n### \\[Fixed\\] Issue: After the Excel Add-in opens and refreshes data, an error appears, \"An error occurred while writing to the data cache\"\n\n**Issue:** After the Excel Add-in opens and refreshes data, an error appears, \"An error occurred while writing to the data cache.\" Details of the error state, \"The argument is invalid or missing or has an incorrect format.\" \n\n**Explanation:** This error will appear if the client is open in Internet Explorer (IE) and after using the **Open in Excel** option, the user clicks **Open** immediately. The way IE handles temporary Internet files causes an issue inside Excel, which causes API calls to fail. \n\n**Workaround:** For IE, when opening a workbook, click **Save** first, and then click **Open**. The file will open from your Downloads folder. Alternately, Edge and Chrome will both not showcase this problem since they save files to a Downloads folder automatically. \n\n**Long term fix:** We are working with the Office team to understand this issue so that it can be fixed in Excel.\n\n### Issue: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender\n\n**Issue:** When sending email using SMTP, you may see the error: The server response was: \"5.7.60 SMTP; Client does not have permissions to send as this sender\" or \"Something went wrong while generating the report.\"\n\n**Explanation:** This is usually caused by incorrect setup of the Send As permissions setup for the email account. \n\n**Fix:** Send As permissions can be configured on the Office 365 admin center (portal.office.com/Admin) > **Users** > **Active users** > **User** > **Edit mailbox permissions** > **Send email from this mailbox** [Office 365 Help on Send email from another userâ€™s mailbox](https://support.office.com/en-us/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E)). \n\nThe following SMTP setup example shows the **Email parameters** page, where you need to provide the outgoing mail server, port, user name, password, and SSL requirements. \n\n[![smtp](./media/smtp.png)](./media/smtp.png)   \n\nThe permissions SMTP User account is `serviceacct@d365forops.onmicrosoft.com`. \n\n**Important:** All users, like the example Test User below, will need to allow the SMTP account to have **Send As** permissions on their email setup in Office 365. This is done in the Mailbox permissions in Exchange or in the Office 365 Admin portal. The following screenshot shows the setup for the test user account with the STMP service account added in the **Send As** section. \n\n[![o365](./media/o365.png)](./media/o365.png)  \n\n### \\[Fixed\\] Issue: The Office Add-ins don't yet support ADFS\n\n**Affected versions:** CTP8 and the February 2016 releases \n\n**Issue:** When users from a Microsoft Azure Active Directory (Azure AD) tenant that uses Active Directory Federation Services (AD FS) try to sign in to Office Add-ins (that is, when the users enter their account, and then press tab or click to enter their password), a separate browser window opens. This browser window usually has a URL that starts with `https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\\#id\\_token=`. The user is not able to sign in. \n\n**Explanation:** The issue that the Microsoft Office add-ins (both Microsoft Excel and Microsoft Word) have with ADFS is that a redirect to the ADFS site for the tenant occurs during sign-in. However, that site is an unknown (and therefore disallowed) application domain (AppDomain). \n\n**Long-term fix:** The long-term fix for this issue was put in place May 10, 2016. The long-term fix was for the Office Add-ins to use a new dialog API that the Office team added. \n\n**To take advantage of the Add-in updates that support ADFS:** All Office installations should be updated via **File** > **Account** > **Updates** (for click to run installations) or via Windows Update (for MSI installations). The ADFS Dialog API was in the May Update [16.0.6868.2060](http://answers.microsoft.com/en-us/office/forum/office_2016-office_install/may-update-16068682060-for-office-2016-on-windows/ea082237-7ec3-4b06-895b-83490980e6d2?auth=1). The [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page provides information about updates. \n\nIf your Office build does not update then it might be because you are on the deferred track ([\"Microsoft Office 365 ProPlus\" update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)), in which case you could [use the \"Office Deployment Tool\" to move to the Current channel ](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396)or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider) to ensure you have the latest updates. Also refer to [Install the latest version of Office 2016](https://dev.office.com/docs/add-ins/develop/install-latest-office-version) and [Office 2016 Deployment Guides for Admins](https://technet.microsoft.com/en-us/library/cc303401(v=office.16).aspx). \n\nIf Office updates cannot be installed, then the following workaround that can unblock users.\n\n#### Workaround: Use Internet Explorer to sign in to the client before you use the Office Add-ins\n\nThis workaround requires user knowledge and extra steps. After users have been educated about this workaround, it should be straightforward for them. \n\n**User steps:** Before users open Excel (or Word), they should first sign in to the client by using Internet Explorer. \n\n**Explanation:** The sign-in context will be used by the Excel (or Word) Add-in, and no redirect will be required. The earlier sign-in must occur in Internet Explorer because the Office Add-ins run inside an Internet Explorer window in Excel and Word. The sign-in context lasts 6 to 24 hours, depending on policies. Therefore, a new sign-in through Internet Explorer is required only occasionally.\n\n1.  Close Internet Explorer and Excel.\n2.  Open Internet Explorer and sign in to the client.\n3.  Test the Excel add-in using an Open in Excel experience. (For example, click **Fleet Management** &gt; **Customers** &gt; **Customer** &gt; **Open in Microsoft Office** &gt; **Open in Excel** &gt; **Fleet Management Customers**.)\n\n\nSee also\n--------\n\n[Office integration](office-integration.md)\n\n[Office integration tutorial](office-integration-tutorial.md)\n\n[Configuring Power BI integration](..\\analytics\\configure-power-bi-integration.md)\n\n\n\n","nodes":[{"pos":[4,812],"nodes":[{"content":"Office integration troubleshooting","nodes":[{"pos":[0,34],"content":"Office integration troubleshooting","nodes":[{"content":"Office integration troubleshooting","pos":[0,34]}]}],"pos":[27,62],"yaml":true},{"content":"This topic provides answers to questions, tips, and troubleshooting information for the Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.","nodes":[{"pos":[0,217],"content":"This topic provides answers to questions, tips, and troubleshooting information for the Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.","nodes":[{"content":"This topic provides answers to questions, tips, and troubleshooting information for the Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.","pos":[0,217],"nodes":[{"content":"This topic provides answers to questions, tips, and troubleshooting information for the Office integration capabilities.","pos":[0,120]},{"content":"The questions and issues discussed range across user, administration, and development scenarios.","pos":[121,217]}]}]}],"pos":[75,293],"yaml":true}],"content":"# required metadata\n\ntitle: Office integration troubleshooting\ndescription: This topic provides answers to questions, tips, and troubleshooting information for the Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.\nauthor: ChrisGarty\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\nms.search.form: OfficeAppParameters\n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: annbe\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 72263\nms.assetid: 89588fed-b47f-4f01-9328-325518f016d6\nms.search.region: Global\n# ms.search.industry: \nms.author: cgarty\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n","yamlblock":true},{"pos":[820,854],"content":"Office integration troubleshooting","linkify":"Office integration troubleshooting","nodes":[{"content":"Office integration troubleshooting","pos":[0,34]}]},{"content":"This topic provides answers to questions, tips, and troubleshooting information about the Office integration capabilities.","pos":[900,1022]},{"content":"The questions and issues discussed range across user, administration, and development scenarios.","pos":[1023,1119]},{"pos":[1121,1147],"content":"Frequently asked questions","linkify":"Frequently asked questions","nodes":[{"content":"Frequently asked questions","pos":[0,26]}]},{"pos":[1180,1232],"content":"What platforms are supported for the Office Add-ins?","linkify":"What platforms are supported for the Office Add-ins?","nodes":[{"content":"What platforms are supported for the Office Add-ins?","pos":[0,52]}]},{"content":"The Excel Add-in and Word Add-in are built using the Office Web/JavaScript Add-in framework that was initially released for Office 2013, but received significant updates in Office 2016.","pos":[1234,1419]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Office Add-in host and platform availability<ept id=\"p1\">](http://dev.office.com/add-in-availability)</ept>.","pos":[1420,1536],"source":" For more information, see [Office Add-in host and platform availability](http://dev.office.com/add-in-availability)."},{"content":"The Excel Add-in requires the ExcelAPI 1.2, so use the <bpt id=\"p1\">[</bpt>Office Add-in host and platform availability<ept id=\"p1\">](http://dev.office.com/add-in-availability)</ept> matrix to determine which platforms it is supported on.","pos":[1537,1737],"source":" The Excel Add-in requires the ExcelAPI 1.2, so use the [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) matrix to determine which platforms it is supported on."},{"content":"For many users, the phrase \"Excel 2016 with the latest updates\" is sufficient.","pos":[1738,1816]},{"pos":[1822,1871],"content":"Is Office for Mac supported for the Excel Add-in?","linkify":"Is Office for Mac supported for the Excel Add-in?","nodes":[{"content":"Is Office for Mac supported for the Excel Add-in?","pos":[0,49]}]},{"content":"No.","pos":[1873,1876]},{"content":"Mac and iOS support is currently under development.","pos":[1877,1928]},{"content":"There are authentication differences in how the Office JS APIs function in Safari versus Internet Explorer, particularly in the authentication space.","pos":[1929,2078]},{"content":"See <bpt id=\"p1\">[</bpt>Office Add-in host and platform availability<ept id=\"p1\">](http://dev.office.com/add-in-availability)</ept> for details about Office JS API platform support.","pos":[2079,2222],"source":" See [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) for details about Office JS API platform support."},{"pos":[2228,2303],"content":"What version of Office is needed to allow the Excel Add-in to support ADFS?","linkify":"What version of Office is needed to allow the Excel Add-in to support ADFS?","nodes":[{"content":"What version of Office is needed to allow the Excel Add-in to support ADFS?","pos":[0,75]}]},{"content":"Read more about that in the troubleshooting section below.","pos":[2305,2363]},{"pos":[2369,2408],"content":"How can Office be forced into updating?","linkify":"How can Office be forced into updating?","nodes":[{"content":"How can Office be forced into updating?","pos":[0,39]}]},{"content":"If your Office build does not update then it might be because you are on the deferred track (<bpt id=\"p1\">[</bpt>\"Microsoft Office 365 ProPlus\" update channel option<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/mt455210.aspx)</ept>), in which case you could <bpt id=\"p2\">[</bpt>use the \"Office Deployment Tool\" to move to the Current channel <ept id=\"p2\">](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&amp;MSPPError=-2147217396)</ept>or sign up for the <bpt id=\"p3\">[</bpt>Office Insider program<ept id=\"p3\">](https://products.office.com/en-us/office-insider)</ept> to ensure that you have the latest updates.","pos":[2410,2933],"source":"If your Office build does not update then it might be because you are on the deferred track ([\"Microsoft Office 365 ProPlus\" update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)), in which case you could [use the \"Office Deployment Tool\" to move to the Current channel ](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396)or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider) to ensure that you have the latest updates."},{"content":"The easiest path is to use the Office Deployment Tool to switch to the Current channel, which will cause the latest updates to install immediately.","pos":[2934,3081]},{"pos":[3087,3169],"content":"Why can't you tell me what version of Office/Excel a particular issue is fixed in?","linkify":"Why can't you tell me what version of Office/Excel a particular issue is fixed in?","nodes":[{"content":"Why can't you tell me what version of Office/Excel a particular issue is fixed in?","pos":[0,82]}]},{"content":"Office has many different releases, which receive updates at different times and have different version numbers that don't correspond.","pos":[3171,3305]},{"content":"Some of the more common Office versions and update methods are Click to Run (C2R) Current channel, C2R Deferred, C2R First Update Deferred, Office Insider Fast, Office Insider Slow, and MSI/MSO (install from DVD).","pos":[3306,3519]},{"content":"The <bpt id=\"p1\">[</bpt>Office 365 client update channel releases<ept id=\"p1\">](https://technet.microsoft.com/en-us/office/mt465751?f=255&amp;MSPPError=-2147217396)</ept> page has more information about Office versions.","pos":[3520,3697],"source":" The [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page has more information about Office versions."},{"pos":[3703,3757],"content":"Why am I having trouble signing into the Excel Add-in?","linkify":"Why am I having trouble signing into the Excel Add-in?","nodes":[{"content":"Why am I having trouble signing into the Excel Add-in?","pos":[0,54]}]},{"content":"The Excel Add-in runs inside an Internet Explorer (IE) window.","pos":[3759,3821]},{"content":"The Excel Add-in will pick up stored credentials from IE by default, and IE will provide the current Windows credentials if there are no stored credentials.","pos":[3822,3978]},{"content":"Ensure that you are trying to sign in with the correct credentials.","pos":[3979,4046]},{"content":"In the Excel Add-in, explicitly sign out and then sign in to ensure that the desired credentials are in use.","pos":[4047,4155]},{"pos":[4160,4182],"content":"Troubleshooting issues","linkify":"Troubleshooting issues","nodes":[{"content":"Troubleshooting issues","pos":[0,22]}]},{"pos":[4187,4343],"content":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"","linkify":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"","pos":[0,156],"source":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\""}]},{"pos":[4345,4496],"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\".","source":"**Issue:** During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"."},{"pos":[4499,4813],"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> This is usually caused when Microsoft Azure Active Directory (AAD) cannot find the AAD application representing the Excel Add-in because during <bpt id=\"p2\">[</bpt>Power BI configuration<ept id=\"p2\">](..\\analytics\\configure-power-bi-integration.md)</ept> an AAD application was added that has the App ID URI set to the environment URL.","source":"**Explanation:** This is usually caused when Microsoft Azure Active Directory (AAD) cannot find the AAD application representing the Excel Add-in because during [Power BI configuration](..\\analytics\\configure-power-bi-integration.md) an AAD application was added that has the App ID URI set to the environment URL."},{"content":"<bpt id=\"p1\">**</bpt>Fix:<ept id=\"p1\">**</ept> Ensure that there are no AAD App ID URI's set to the environment URI.","pos":[4816,4894],"source":"**Fix:** Ensure that there are no AAD App ID URI's set to the environment URI."},{"content":"App ID URI's should be a fabricated, unique URI like <ph id=\"ph1\">`https://contosoAXPowerBI`</ph>.","pos":[4895,4975],"source":" App ID URI's should be a fabricated, unique URI like `https://contosoAXPowerBI`."},{"pos":[4981,5122],"content":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"","linkify":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"","pos":[0,141],"source":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\""}]},{"pos":[5124,5260],"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\".","source":"**Issue:** During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"."},{"pos":[5263,5450],"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> This is likely a failure in the deployment system that caused the environment to get a URL that was not added in the configured list of service principals for the tenant.","source":"**Explanation:** This is likely a failure in the deployment system that caused the environment to get a URL that was not added in the configured list of service principals for the tenant."},{"pos":[5453,5582],"content":"<bpt id=\"p1\">**</bpt>Fix:<ept id=\"p1\">**</ept> File a support issue for your environment so that the problem can be investigated and the configuration can be adjusted.","source":"**Fix:** File a support issue for your environment so that the problem can be investigated and the configuration can be adjusted."},{"pos":[5588,5723],"content":"\\[Fixed\\] Issue: After the Excel Add-in opens and refreshes data, an error appears, \"An error occurred while writing to the data cache\"","linkify":"\\[Fixed\\] Issue: After the Excel Add-in opens and refreshes data, an error appears, \"An error occurred while writing to the data cache\"","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: After the Excel Add-in opens and refreshes data, an error appears, \"An error occurred while writing to the data cache\"","pos":[0,135],"source":"\\[Fixed\\] Issue: After the Excel Add-in opens and refreshes data, an error appears, \"An error occurred while writing to the data cache\""}]},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> After the Excel Add-in opens and refreshes data, an error appears, \"An error occurred while writing to the data cache.\"","pos":[5725,5855],"source":"**Issue:** After the Excel Add-in opens and refreshes data, an error appears, \"An error occurred while writing to the data cache.\""},{"content":"Details of the error state, \"The argument is invalid or missing or has an incorrect format.\"","pos":[5856,5948]},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> This error will appear if the client is open in Internet Explorer (IE) and after using the <bpt id=\"p2\">**</bpt>Open in Excel<ept id=\"p2\">**</ept> option, the user clicks <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept> immediately.","pos":[5951,6122],"source":"**Explanation:** This error will appear if the client is open in Internet Explorer (IE) and after using the **Open in Excel** option, the user clicks **Open** immediately."},{"content":"The way IE handles temporary Internet files causes an issue inside Excel, which causes API calls to fail.","pos":[6123,6228]},{"content":"<bpt id=\"p1\">**</bpt>Workaround:<ept id=\"p1\">**</ept> For IE, when opening a workbook, click <bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept> first, and then click <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept>.","pos":[6231,6326],"source":"**Workaround:** For IE, when opening a workbook, click **Save** first, and then click **Open**."},{"content":"The file will open from your Downloads folder.","pos":[6327,6373]},{"content":"Alternately, Edge and Chrome will both not showcase this problem since they save files to a Downloads folder automatically.","pos":[6374,6497]},{"pos":[6500,6613],"content":"<bpt id=\"p1\">**</bpt>Long term fix:<ept id=\"p1\">**</ept> We are working with the Office team to understand this issue so that it can be fixed in Excel.","source":"**Long term fix:** We are working with the Office team to understand this issue so that it can be fixed in Excel."},{"pos":[6619,6719],"content":"Issue: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender","linkify":"Issue: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender","nodes":[{"content":"Issue: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender","pos":[0,100]}]},{"pos":[6721,6936],"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> When sending email using SMTP, you may see the error: The server response was: \"5.7.60 SMTP; Client does not have permissions to send as this sender\" or \"Something went wrong while generating the report.\"","source":"**Issue:** When sending email using SMTP, you may see the error: The server response was: \"5.7.60 SMTP; Client does not have permissions to send as this sender\" or \"Something went wrong while generating the report.\""},{"pos":[6938,7052],"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> This is usually caused by incorrect setup of the Send As permissions setup for the email account.","source":"**Explanation:** This is usually caused by incorrect setup of the Send As permissions setup for the email account."},{"pos":[7055,7470],"content":"<bpt id=\"p1\">**</bpt>Fix:<ept id=\"p1\">**</ept> Send As permissions can be configured on the Office 365 admin center (portal.office.com/Admin) &gt; <bpt id=\"p2\">**</bpt>Users<ept id=\"p2\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p3\">**</bpt>Active users<ept id=\"p3\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p4\">**</bpt>User<ept id=\"p4\">**</ept><ph id=\"ph3\"> &gt; </ph><bpt id=\"p5\">**</bpt>Edit mailbox permissions<ept id=\"p5\">**</ept><ph id=\"ph4\"> &gt; </ph><bpt id=\"p6\">**</bpt>Send email from this mailbox<ept id=\"p6\">**</ept> <bpt id=\"p7\">[</bpt>Office 365 Help on Send email from another userâ€™s mailbox<ept id=\"p7\">](https://support.office.com/en-us/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E)</ept>).","source":"**Fix:** Send As permissions can be configured on the Office 365 admin center (portal.office.com/Admin) > **Users** > **Active users** > **User** > **Edit mailbox permissions** > **Send email from this mailbox** [Office 365 Help on Send email from another userâ€™s mailbox](https://support.office.com/en-us/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E))."},{"pos":[7473,7643],"content":"The following SMTP setup example shows the <bpt id=\"p1\">**</bpt>Email parameters<ept id=\"p1\">**</ept> page, where you need to provide the outgoing mail server, port, user name, password, and SSL requirements.","source":"The following SMTP setup example shows the **Email parameters** page, where you need to provide the outgoing mail server, port, user name, password, and SSL requirements."},{"pos":[7646,7691],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>smtp<ept id=\"p1\">](./media/smtp.png)](./media/smtp.png)</ept>","source":"[![smtp](./media/smtp.png)](./media/smtp.png)"},{"pos":[7696,7774],"content":"The permissions SMTP User account is <ph id=\"ph1\">`serviceacct@d365forops.onmicrosoft.com`</ph>.","source":"The permissions SMTP User account is `serviceacct@d365forops.onmicrosoft.com`."},{"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept> All users, like the example Test User below, will need to allow the SMTP account to have <bpt id=\"p2\">**</bpt>Send As<ept id=\"p2\">**</ept> permissions on their email setup in Office 365.","pos":[7777,7940],"source":"**Important:** All users, like the example Test User below, will need to allow the SMTP account to have **Send As** permissions on their email setup in Office 365."},{"content":"This is done in the Mailbox permissions in Exchange or in the Office 365 Admin portal.","pos":[7941,8027]},{"content":"The following screenshot shows the setup for the test user account with the STMP service account added in the <bpt id=\"p1\">**</bpt>Send As<ept id=\"p1\">**</ept> section.","pos":[8028,8158],"source":" The following screenshot shows the setup for the test user account with the STMP service account added in the **Send As** section."},{"pos":[8161,8206],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>o365<ept id=\"p1\">](./media/o365.png)](./media/o365.png)</ept>","source":"[![o365](./media/o365.png)](./media/o365.png)"},{"pos":[8214,8272],"content":"\\[Fixed\\] Issue: The Office Add-ins don't yet support ADFS","linkify":"\\[Fixed\\] Issue: The Office Add-ins don't yet support ADFS","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: The Office Add-ins don't yet support ADFS","pos":[0,58],"source":"\\[Fixed\\] Issue: The Office Add-ins don't yet support ADFS"}]},{"pos":[8274,8332],"content":"<bpt id=\"p1\">**</bpt>Affected versions:<ept id=\"p1\">**</ept> CTP8 and the February 2016 releases","source":"**Affected versions:** CTP8 and the February 2016 releases"},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> When users from a Microsoft Azure Active Directory (Azure AD) tenant that uses Active Directory Federation Services (AD FS) try to sign in to Office Add-ins (that is, when the users enter their account, and then press tab or click to enter their password), a separate browser window opens.","pos":[8335,8635],"source":"**Issue:** When users from a Microsoft Azure Active Directory (Azure AD) tenant that uses Active Directory Federation Services (AD FS) try to sign in to Office Add-ins (that is, when the users enter their account, and then press tab or click to enter their password), a separate browser window opens."},{"content":"This browser window usually has a URL that starts with <ph id=\"ph1\">`https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\\#id\\_token=`</ph>.","pos":[8636,8784],"source":" This browser window usually has a URL that starts with `https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\\#id\\_token=`."},{"content":"The user is not able to sign in.","pos":[8785,8817]},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> The issue that the Microsoft Office add-ins (both Microsoft Excel and Microsoft Word) have with ADFS is that a redirect to the ADFS site for the tenant occurs during sign-in.","pos":[8820,9011],"source":"**Explanation:** The issue that the Microsoft Office add-ins (both Microsoft Excel and Microsoft Word) have with ADFS is that a redirect to the ADFS site for the tenant occurs during sign-in."},{"content":"However, that site is an unknown (and therefore disallowed) application domain (AppDomain).","pos":[9012,9103]},{"content":"<bpt id=\"p1\">**</bpt>Long-term fix:<ept id=\"p1\">**</ept> The long-term fix for this issue was put in place May 10, 2016.","pos":[9106,9188],"source":"**Long-term fix:** The long-term fix for this issue was put in place May 10, 2016."},{"content":"The long-term fix was for the Office Add-ins to use a new dialog API that the Office team added.","pos":[9189,9285]},{"content":"<bpt id=\"p1\">**</bpt>To take advantage of the Add-in updates that support ADFS:<ept id=\"p1\">**</ept> All Office installations should be updated via <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p3\">**</bpt>Account<ept id=\"p3\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p4\">**</bpt>Updates<ept id=\"p4\">**</ept> (for click to run installations) or via Windows Update (for MSI installations).","pos":[9288,9514],"source":"**To take advantage of the Add-in updates that support ADFS:** All Office installations should be updated via **File** > **Account** > **Updates** (for click to run installations) or via Windows Update (for MSI installations)."},{"content":"The ADFS Dialog API was in the May Update <bpt id=\"p1\">[</bpt>16.0.6868.2060<ept id=\"p1\">](http://answers.microsoft.com/en-us/office/forum/office_2016-office_install/may-update-16068682060-for-office-2016-on-windows/ea082237-7ec3-4b06-895b-83490980e6d2?auth=1)</ept>.","pos":[9515,9744],"source":" The ADFS Dialog API was in the May Update [16.0.6868.2060](http://answers.microsoft.com/en-us/office/forum/office_2016-office_install/may-update-16068682060-for-office-2016-on-windows/ea082237-7ec3-4b06-895b-83490980e6d2?auth=1)."},{"content":"The <bpt id=\"p1\">[</bpt>Office 365 client update channel releases<ept id=\"p1\">](https://technet.microsoft.com/en-us/office/mt465751?f=255&amp;MSPPError=-2147217396)</ept> page provides information about updates.","pos":[9745,9914],"source":" The [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page provides information about updates."},{"content":"If your Office build does not update then it might be because you are on the deferred track (<bpt id=\"p1\">[</bpt>\"Microsoft Office 365 ProPlus\" update channel option<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/mt455210.aspx)</ept>), in which case you could <bpt id=\"p2\">[</bpt>use the \"Office Deployment Tool\" to move to the Current channel <ept id=\"p2\">](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&amp;MSPPError=-2147217396)</ept>or sign up for the <bpt id=\"p3\">[</bpt>Office Insider program<ept id=\"p3\">](https://products.office.com/en-us/office-insider)</ept> to ensure you have the latest updates.","pos":[9917,10435],"source":"If your Office build does not update then it might be because you are on the deferred track ([\"Microsoft Office 365 ProPlus\" update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)), in which case you could [use the \"Office Deployment Tool\" to move to the Current channel ](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396)or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider) to ensure you have the latest updates."},{"content":"Also refer to <bpt id=\"p1\">[</bpt>Install the latest version of Office 2016<ept id=\"p1\">](https://dev.office.com/docs/add-ins/develop/install-latest-office-version)</ept> and <bpt id=\"p2\">[</bpt>Office 2016 Deployment Guides for Admins<ept id=\"p2\">](https://technet.microsoft.com/en-us/library/cc303401(v=office.16).aspx)</ept>.","pos":[10436,10688],"source":" Also refer to [Install the latest version of Office 2016](https://dev.office.com/docs/add-ins/develop/install-latest-office-version) and [Office 2016 Deployment Guides for Admins](https://technet.microsoft.com/en-us/library/cc303401(v=office.16).aspx)."},{"content":"If Office updates cannot be installed, then the following workaround that can unblock users.","pos":[10691,10783]},{"pos":[10790,10882],"content":"Workaround: Use Internet Explorer to sign in to the client before you use the Office Add-ins","linkify":"Workaround: Use Internet Explorer to sign in to the client before you use the Office Add-ins","nodes":[{"content":"Workaround: Use Internet Explorer to sign in to the client before you use the Office Add-ins","pos":[0,92]}]},{"content":"This workaround requires user knowledge and extra steps.","pos":[10884,10940]},{"content":"After users have been educated about this workaround, it should be straightforward for them.","pos":[10941,11033]},{"pos":[11036,11154],"content":"<bpt id=\"p1\">**</bpt>User steps:<ept id=\"p1\">**</ept> Before users open Excel (or Word), they should first sign in to the client by using Internet Explorer.","source":"**User steps:** Before users open Excel (or Word), they should first sign in to the client by using Internet Explorer."},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> The sign-in context will be used by the Excel (or Word) Add-in, and no redirect will be required.","pos":[11157,11271],"source":"**Explanation:** The sign-in context will be used by the Excel (or Word) Add-in, and no redirect will be required."},{"content":"The earlier sign-in must occur in Internet Explorer because the Office Add-ins run inside an Internet Explorer window in Excel and Word.","pos":[11272,11408]},{"content":"The sign-in context lasts 6 to 24 hours, depending on policies.","pos":[11409,11472]},{"content":"Therefore, a new sign-in through Internet Explorer is required only occasionally.","pos":[11473,11554]},{"content":"Close Internet Explorer and Excel.","pos":[11560,11594]},{"content":"Open Internet Explorer and sign in to the client.","pos":[11599,11648]},{"content":"Test the Excel add-in using an Open in Excel experience.","pos":[11653,11709]},{"content":"(For example, click <bpt id=\"p1\">**</bpt>Fleet Management<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Customers<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Customer<ept id=\"p3\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Open in Microsoft Office<ept id=\"p4\">**</ept> <ph id=\"ph4\">&amp;gt;</ph> <bpt id=\"p5\">**</bpt>Open in Excel<ept id=\"p5\">**</ept> <ph id=\"ph5\">&amp;gt;</ph> <bpt id=\"p6\">**</bpt>Fleet Management Customers<ept id=\"p6\">**</ept>.)","pos":[11710,11882],"source":" (For example, click **Fleet Management** &gt; **Customers** &gt; **Customer** &gt; **Open in Microsoft Office** &gt; **Open in Excel** &gt; **Fleet Management Customers**.)"},{"pos":[11885,11893],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[11904,11947],"content":"<bpt id=\"p1\">[</bpt>Office integration<ept id=\"p1\">](office-integration.md)</ept>","source":"[Office integration](office-integration.md)"},{"pos":[11949,12010],"content":"<bpt id=\"p1\">[</bpt>Office integration tutorial<ept id=\"p1\">](office-integration-tutorial.md)</ept>","source":"[Office integration tutorial](office-integration-tutorial.md)"},{"pos":[12012,12094],"content":"<bpt id=\"p1\">[</bpt>Configuring Power BI integration<ept id=\"p1\">](..\\analytics\\configure-power-bi-integration.md)</ept>","source":"[Configuring Power BI integration](..\\analytics\\configure-power-bi-integration.md)"}]}