{"nodes":[{"pos":[32,81],"content":"Create Open in Excel experiences | Microsoft Docs","needQuote":true,"needEscape":true,"nodes":[{"content":"Create Open in Excel experiences | Microsoft Docs","pos":[0,49]}]},{"pos":[95,162],"content":"Learn about creating Open in Office experiences for Excel and Word.","needQuote":true,"needEscape":true,"nodes":[{"content":"Learn about creating Open in Office experiences for Excel and Word.","pos":[0,67]}]},{"pos":[583,615],"content":"Create Open in Excel experiences","linkify":"Create Open in Excel experiences","nodes":[{"content":"Create Open in Excel experiences","pos":[0,32]}]},{"content":"Learn about creating Open in Office experiences for Excel and Word.","pos":[617,684]},{"pos":[686,721],"content":"What are Open in Excel experiences?","linkify":"What are Open in Excel experiences?","nodes":[{"content":"What are Open in Excel experiences?","pos":[0,35]}]},{"content":"Open in Excel experiences are:","pos":[759,789]},{"content":"Based on Entities and the OData services they create.","pos":[795,848]},{"content":"Dynamically generated or based on a pre-defined template.","pos":[853,910]},{"content":"Editable and refreshable via the Excel Data Connector App.","pos":[915,973]},{"pos":[975,1126],"content":"The following image shows the <bpt id=\"p1\">**</bpt>Excel Data Connector App<ept id=\"p1\">**</ept> inside the Journal Entry in Microsoft.<bpt id=\"p2\">[</bpt><ph id=\"ph1\">![</ph>off101a<ept id=\"p2\">](./media/off101a.png)](./media/off101a.png)</ept>","source":"The following image shows the **Excel Data Connector App** inside the Journal Entry in Microsoft.[![off101a](./media/off101a.png)](./media/off101a.png)"},{"pos":[1131,1171],"content":"Where are the Open in Excel experiences?","linkify":"Where are the Open in Excel experiences?","nodes":[{"content":"Where are the Open in Excel experiences?","pos":[0,40]}]},{"content":"Open in Excel experiences are usually found under in the Open in Excel section of the Open in Microsoft Office menu, but an explicit button can be added for these experiences.","pos":[1172,1347]},{"pos":[1352,1416],"content":"What's the difference between Export to Excel and Open in Excel?","linkify":"What's the difference between Export to Excel and Open in Excel?","nodes":[{"content":"What's the difference between Export to Excel and Open in Excel?","pos":[0,64]}]},{"content":"The Export to Excel and experiences are both found in the Open in Microsoft Office menu:","pos":[1417,1505]},{"content":"The Export to Excel options are static exports of grid data.","pos":[1511,1571]},{"content":"Each one corresponds to a visible grid.","pos":[1572,1611]},{"content":"All the grid data for the current filter is placed into a workbook.","pos":[1612,1679]},{"content":"The Open in Excel experiences utilize the Excel Data Connector App to facilitate refresh and publish.","pos":[1684,1785]},{"pos":[1787,2057],"content":"The following image shows the <bpt id=\"p1\">**</bpt>Open in Microsoft O<ept id=\"p1\">**</ept>ffice menu on the <bpt id=\"p2\">**</bpt>Fleet Customers<ept id=\"p2\">**</ept> form with a template <bpt id=\"p3\">**</bpt>Open in Excel<ept id=\"p3\">**</ept> option, a generated <bpt id=\"p4\">**</bpt>Open in Excel<ept id=\"p4\">**</ept> option, and a static <bpt id=\"p5\">**</bpt>Export to Excel<ept id=\"p5\">**</ept> option.<bpt id=\"p6\">[</bpt><ph id=\"ph1\">![</ph>off101b<ept id=\"p6\">](./media/off101b.png)](./media/off101b.png)</ept>","source":"The following image shows the **Open in Microsoft O**ffice menu on the **Fleet Customers** form with a template **Open in Excel** option, a generated **Open in Excel** option, and a static **Export to Excel** option.[![off101b](./media/off101b.png)](./media/off101b.png)"},{"pos":[2062,2114],"content":"When will an entity show as an Open in Excel option?","linkify":"When will an entity show as an Open in Excel option?","nodes":[{"content":"When will an entity show as an Open in Excel option?","pos":[0,52]}]},{"content":"When an entity has the same root datasource (table) as a form, it will be added as an option in the Open in Excel section of the Open in Microsoft Office menu.","pos":[2115,2274]},{"content":"This is referred to as a “generated” option.","pos":[2275,2319]},{"pos":[2324,2366],"content":"What fields will be shown in the workbook?","linkify":"What fields will be shown in the workbook?","nodes":[{"content":"What fields will be shown in the workbook?","pos":[0,42]}]},{"content":"The default fields that will be added into the workbook are the key and mandatory fields of the entity.","pos":[2367,2470]},{"content":"If a different set of fields should be provided by default, then those fields can be added into the <bpt id=\"p1\">**</bpt>AutoReport field group<ept id=\"p1\">**</ept> on the entity.","pos":[2471,2612],"source":" If a different set of fields should be provided by default, then those fields can be added into the **AutoReport field group** on the entity."},{"content":"The following image show the Visual Studio view of the AutoReport field group for the FMCustomerEntity.<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>off101c<ept id=\"p1\">](./media/off101c.png)](./media/off101c.png)</ept>","pos":[2613,2770],"source":" The following image show the Visual Studio view of the AutoReport field group for the FMCustomerEntity.[![off101c](./media/off101c.png)](./media/off101c.png)"},{"pos":[2775,2842],"content":"What fields will be shown when an entity is the target of a lookup?","linkify":"What fields will be shown when an entity is the target of a lookup?","nodes":[{"content":"What fields will be shown when an entity is the target of a lookup?","pos":[0,67]}]},{"content":"When a relationship is defined between two entities, if the identifier for one entity is shown on the other then the fields that will be shown in that lookup are either the key fields, or the fields in the <bpt id=\"p1\">**</bpt>AutoLookup field group<ept id=\"p1\">**</ept> if it is not empty.","pos":[2843,3095],"source":"When a relationship is defined between two entities, if the identifier for one entity is shown on the other then the fields that will be shown in that lookup are either the key fields, or the fields in the **AutoLookup field group** if it is not empty."},{"content":"Relationship lookups are not currently supported, but they will eventually be displayed in the app in a similar way to the enumeration lookups.","pos":[3096,3239]},{"content":"Excel Data Connector App with an enumeration lookup is shown below.<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>off101d<ept id=\"p1\">](./media/off101d.png)](./media/off101d.png)</ept>","pos":[3240,3361],"source":" Excel Data Connector App with an enumeration lookup is shown below.[![off101d](./media/off101d.png)](./media/off101d.png)"},{"pos":[3366,3427],"content":"What should be done to make an entity ready for use in Excel?","linkify":"What should be done to make an entity ready for use in Excel?","nodes":[{"content":"What should be done to make an entity ready for use in Excel?","pos":[0,61]}]},{"content":"Define the AutoReport and AutoLookup field groups and test them using the Excel App design experience.","pos":[3428,3530]},{"pos":[3535,3623],"content":"Why does an automatically added entity option have “(unfiltered)” after the entity name?","linkify":"Why does an automatically added entity option have “(unfiltered)” after the entity name?","nodes":[{"content":"Why does an automatically added entity option have “(unfiltered)” after the entity name?","pos":[0,88]}]},{"content":"Currently no filter is added to these options, hence the term “(unfiltered)”.","pos":[3624,3701]},{"content":"In the future, an attempt will be made to apply the filter from the form to these options.","pos":[3702,3792]},{"content":"For example, if a list of Customers was filtered to just Customers in the state of California, then, in the future, the entity will be scanned for the state field and if it was found then a filter would be automatically added.","pos":[3793,4019]},{"pos":[4024,4132],"content":"How can an entity be added as an Open in Excel option on a form that doesn’t share the same root datasource?","linkify":"How can an entity be added as an Open in Excel option on a form that doesn’t share the same root datasource?","nodes":[{"content":"How can an entity be added as an Open in Excel option on a form that doesn’t share the same root datasource?","pos":[0,108]}]},{"content":"A generated Open in Excel option can be added on any form by implementing the ExportToExcelIGeneratedCustomExport interface.","pos":[4133,4257]},{"content":"When adding a generated option programmatically, the set of fields can be explicitly specified.","pos":[4258,4353]},{"pos":[4358,4423],"content":"What are the regionspecific considerations for defining entities?","linkify":"What are the regionspecific considerations for defining entities?","nodes":[{"content":"What are the regionspecific considerations for defining entities?","pos":[0,65]}]},{"content":"The Open in Excel generated experiences can be made region-specific by adding region-specific fields into the AutoLookup group.","pos":[4424,4551]},{"content":"Those region-specific fields will then be included in the generated workbook.","pos":[4552,4629]},{"pos":[4634,4696],"content":"How can I create a custom lookup for an entity field in Excel?","linkify":"How can I create a custom lookup for an entity field in Excel?","nodes":[{"content":"How can I create a custom lookup for an entity field in Excel?","pos":[0,62]}]},{"content":"A custom lookup can be shown for an Entity field.","pos":[4697,4746]},{"content":"Name - The method needs to have a name that is “lookup<ph id=\"ph1\">\\_</ph><ph id=\"ph2\">&amp;lt;</ph>fieldname<ph id=\"ph3\">&amp;gt;</ph>” e.g. a field “MyField” could have a lookup method “lookup<ph id=\"ph4\">\\_</ph>MyField”.","pos":[4752,4895],"source":"Name - The method needs to have a name that is “lookup\\_&lt;fieldname&gt;” e.g. a field “MyField” could have a lookup method “lookup\\_MyField”."},{"content":"Attributes – Attributes need to be added to the method:","pos":[4900,4955]},{"content":"SysODataActionAttribute(str <ph id=\"ph1\">&amp;lt;</ph>name<ph id=\"ph2\">&amp;gt;</ph>, Boolean <ph id=\"ph3\">&amp;lt;</ph>isInstanceMethod<ph id=\"ph4\">&amp;gt;</ph>)","pos":[4964,5039],"source":"SysODataActionAttribute(str &lt;name&gt;, Boolean &lt;isInstanceMethod&gt;)"},{"content":"SysODataCollectionAttribute(str <ph id=\"ph1\">&amp;lt;</ph>name<ph id=\"ph2\">&amp;gt;</ph>, Types <ph id=\"ph3\">&amp;lt;</ph>type<ph id=\"ph4\">&amp;gt;</ph>, “Value”)","pos":[5048,5122],"source":"SysODataCollectionAttribute(str &lt;name&gt;, Types &lt;type&gt;, “Value”)"},{"content":"Return – The method should return a list of strings.","pos":[5127,5179]},{"content":"Example:","pos":[5181,5189]},{"pos":[5771,5846],"content":"How does the app get injected into a workbook to start building a template?","linkify":"How does the app get injected into a workbook to start building a template?","nodes":[{"content":"How does the app get injected into a workbook to start building a template?","pos":[0,75]}]},{"pos":[5924,6169],"content":"The Excel Data Connector App is injected into a workbook when a generated Open in Excel experience is triggered or when a workbook is created using the <bpt id=\"p1\">**</bpt>Common<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Common<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Office integration<ept id=\"p3\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Excel workbook designer<ept id=\"p4\">**</ept> form.","source":"The Excel Data Connector App is injected into a workbook when a generated Open in Excel experience is triggered or when a workbook is created using the **Common** &gt; **Common** &gt; **Office integration** &gt; **Excel workbook designer** form."},{"pos":[6175,6300],"content":"The <bpt id=\"p1\">**</bpt>Create workbook<ept id=\"p1\">**</ept> button will add the selected entity and fields, a pointer to the server, and the app into a workbook.","source":"The **Create workbook** button will add the selected entity and fields, a pointer to the server, and the app into a workbook."},{"pos":[6305,6410],"content":"The <bpt id=\"p1\">**</bpt>Create blank workbook<ept id=\"p1\">**</ept> button will simply add a pointer to the server and the app into a workbook.","source":"The **Create blank workbook** button will simply add a pointer to the server and the app into a workbook."},{"pos":[6415,6572],"content":"The <bpt id=\"p1\">**</bpt>View related<ept id=\"p1\">**</ept> form will navigate to the form relating to the currently selected entity to more easily review the effect of data changes made in Excel.","source":"The **View related** form will navigate to the form relating to the currently selected entity to more easily review the effect of data changes made in Excel."},{"content":"The <bpt id=\"p1\">**</bpt>Get entity record count<ept id=\"p1\">**</ept> button will show the record count for the currently selected entity.","pos":[6577,6677],"source":"The **Get entity record count** button will show the record count for the currently selected entity."},{"content":"Currently, the Excel Data Connector App cannot handle large (tall and wide) data sets.","pos":[6678,6764]},{"content":"Any unfiltered entity with more than 10,000 records is at risk of crashing the app.","pos":[6765,6848]},{"content":"The following image shows the <bpt id=\"p1\">**</bpt>Excel workbook designer<ept id=\"p1\">**</ept> form.<bpt id=\"p2\">[</bpt><ph id=\"ph1\">![</ph>off101e<ept id=\"p2\">](./media/off101e.png)](./media/off101e.png)</ept> After obtaining a workbook containing the Excel Data Connector App, additional datasources can be added via the <bpt id=\"p3\">**</bpt>Design<ept id=\"p3\">**</ept> button.","pos":[6850,7098],"source":"The following image shows the **Excel workbook designer** form.[![off101e](./media/off101e.png)](./media/off101e.png) After obtaining a workbook containing the Excel Data Connector App, additional datasources can be added via the **Design** button."},{"content":"Currently, datasources cannot be removed.","pos":[7099,7140]},{"content":"The following image shows the Excel Data Connector App with the <bpt id=\"p1\">**</bpt>Design<ept id=\"p1\">**</ept> button highlighted.<bpt id=\"p2\">[</bpt><ph id=\"ph1\">![</ph>off101f<ept id=\"p2\">](./media/off101f.png)](./media/off101f.png)</ept>","pos":[7141,7289],"source":" The following image shows the Excel Data Connector App with the **Design** button highlighted.[![off101f](./media/off101f.png)](./media/off101f.png)"},{"pos":[7294,7347],"content":"When will a template show as an Open in Excel option?","linkify":"When will a template show as an Open in Excel option?","nodes":[{"content":"When will a template show as an Open in Excel option?","pos":[0,53]}]},{"content":"When a template listed in the <bpt id=\"p1\">**</bpt>Common<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Common<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Office integration<ept id=\"p3\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Document templates<ept id=\"p4\">**</ept> form (DocuTemplate) has ShowInOpenInOfficeMenu set to Yes and has the same root datasource (table) as the current form, it will be added as an option in the Open in Excel section of the Open in Microsoft Office menu.","pos":[7348,7677],"source":"When a template listed in the **Common** &gt; **Common** &gt; **Office integration** &gt; **Document templates** form (DocuTemplate) has ShowInOpenInOfficeMenu set to Yes and has the same root datasource (table) as the current form, it will be added as an option in the Open in Excel section of the Open in Microsoft Office menu."},{"content":"The following image shows the <bpt id=\"p1\">**</bpt>Document templates<ept id=\"p1\">**</ept> form.<bpt id=\"p2\">[</bpt><ph id=\"ph1\">![</ph>off101g<ept id=\"p2\">](./media/off101g.png)](./media/off101g.png)</ept>","pos":[7678,7790],"source":" The following image shows the **Document templates** form.[![off101g](./media/off101g.png)](./media/off101g.png)"},{"pos":[7795,7834],"content":"Will a filter be added to the template?","linkify":"Will a filter be added to the template?","nodes":[{"content":"Will a filter be added to the template?","pos":[0,39]}]},{"content":"In the <bpt id=\"p1\">**</bpt>Document Templates<ept id=\"p1\">**</ept> form, the standard filter for “current record” can be turned on and off.","pos":[7835,7937],"source":"In the **Document Templates** form, the standard filter for “current record” can be turned on and off."},{"content":"If the filter is on, then when the template is invoked as an Open in Excel option and a filter for the current record will be added to the workbook.","pos":[7938,8086]},{"content":"The filter will be the key fields and their values.","pos":[8087,8138]},{"pos":[8143,8218],"content":"How can templates be defined in metadata and code and loaded automatically?","linkify":"How can templates be defined in metadata and code and loaded automatically?","nodes":[{"content":"How can templates be defined in metadata and code and loaded automatically?","pos":[0,75]}]},{"content":"When adding a template into the <bpt id=\"p1\">**</bpt>Document Templates<ept id=\"p1\">**</ept> form, it is added for that instance and is referred to as a “user-defined” template.","pos":[8219,8358],"source":"When adding a template into the **Document Templates** form, it is added for that instance and is referred to as a “user-defined” template."},{"content":"Templates can also be defined in metadata and code and loaded in an automatic way, thus making them “system-defined” templates.","pos":[8359,8486]},{"content":"To create a system-defined template via metadata and code:","pos":[8487,8545]},{"content":"Define the template.","pos":[8551,8571]},{"content":"Create a new resource in a project.","pos":[8576,8611]},{"content":"Define a new class that extends the DocuTemplateRegistrationBase class and add an implementation of the registerTemplates method.","pos":[8616,8745]},{"content":"The LedgerJournalLineEntryTemplateRegistration and FMTemplateRegistrations classes are good examples of template registrations defined in code.","pos":[8747,8890]},{"content":"And the LedgerJournalLineEntryTemplate and FMTemplateCustomersWithLocations resources are the corresponding templates stored in metadata as resources.","pos":[8891,9041]},{"content":"When a template has a registration class, it will be loaded when the <bpt id=\"p1\">**</bpt>Reload system templates<ept id=\"p1\">**</ept> button is clicked in the <bpt id=\"p2\">**</bpt>Document Templates<ept id=\"p2\">**</ept> form.","pos":[9042,9192],"source":" When a template has a registration class, it will be loaded when the **Reload system templates** button is clicked in the **Document Templates** form."},{"pos":[9197,9249],"content":"How do templates get loaded into a fresh deployment?","linkify":"How do templates get loaded into a fresh deployment?","nodes":[{"content":"How do templates get loaded into a fresh deployment?","pos":[0,52]}]},{"pos":[9250,9582],"content":"To load system defined templates, click the <bpt id=\"p1\">**</bpt>Reload system templates<ept id=\"p1\">**</ept> button in the <bpt id=\"p2\">**</bpt>Common<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Common<ept id=\"p3\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Office integration<ept id=\"p4\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p5\">**</bpt>Document templates<ept id=\"p5\">**</ept> form, as shown below.<bpt id=\"p6\">[</bpt><ph id=\"ph4\">![</ph>off101h<ept id=\"p6\">](./media/off101h.png)](./media/off101h.png)</ept> In the near future we will do the equivalent of clicking that button during deployment.","source":"To load system defined templates, click the **Reload system templates** button in the **Common** &gt; **Common** &gt; **Office integration** &gt; **Document templates** form, as shown below.[![off101h](./media/off101h.png)](./media/off101h.png) In the near future we will do the equivalent of clicking that button during deployment."},{"pos":[9587,9633],"content":"How do I decide if I should create a template?","linkify":"How do I decide if I should create a template?","nodes":[{"content":"How do I decide if I should create a template?","pos":[0,46]}]},{"content":"A template is an artifact that needs to be maintained and versioned.","pos":[9634,9702]},{"content":"If you can avoid defining a template without sacrificing much from the user experience, then you probably should use a template.","pos":[9703,9831]},{"content":"Create a template if:","pos":[9832,9853]},{"content":"You need additional content or formatting in the template.","pos":[9859,9917]},{"content":"You want to combine multiple entities/datasources in the same workbook.","pos":[9922,9993]},{"content":"Don’t create a template if:","pos":[9995,10022]},{"content":"You can just specify a set of fields to show in a table binding.","pos":[10028,10092]},{"pos":[10097,10154],"content":"What are the regionspecific considerations for templates?","linkify":"What are the regionspecific considerations for templates?","nodes":[{"content":"What are the regionspecific considerations for templates?","pos":[0,57]}]},{"content":"When creating a template for an entity that has region-specific fields, you should leave those region-specific fields out of the template since otherwise all users will see the region-specific fields.","pos":[10155,10355]},{"content":"Templates should cater to the majority of users by default and region-specific users can add those fields using the easy-to-use design experience of the Excel Data Connector App.","pos":[10356,10534]},{"content":"The region-specific fields and columns can be added by users as needed and then that template can be either saved to local computer for reuse by a single user or uploaded via the Document Templates form for reuse by any user of that instance.","pos":[10536,10778]},{"content":"A couple of other considerations:","pos":[10779,10812]},{"content":"If a region has a region-specific entity, then a region-specific template could be created.","pos":[10818,10909]},{"content":"If a region is important enough, then you could define a region-specific template as well as a region-generic template.","pos":[10914,11033]},{"pos":[11035,11103],"content":"How do I add an explicit button for a template Open in Excel option?","linkify":"How do I add an explicit button for a template Open in Excel option?","nodes":[{"content":"How do I add an explicit button for a template Open in Excel option?","pos":[0,68]}]},{"content":"An explicit button can be added for Open in Excel experiences.","pos":[11174,11236]},{"content":"The label shown on the button should usually be “Open target in Excel” where target is the name of the target data like “lines” or “catalog”.","pos":[11237,11378]},{"content":"The code behind such a button will:","pos":[11379,11414]},{"content":"Obtain the template to be used.","pos":[11420,11451]},{"content":"Add the desired filter.","pos":[11456,11479]},{"content":"Pass the template to the user.","pos":[11484,11514]},{"pos":[11516,11713],"content":"An example of such code can be found on the <bpt id=\"p1\">**</bpt>LedgerJournalTable<ept id=\"p1\">**</ept> form (<bpt id=\"p2\">**</bpt>General ledger<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Journals<ept id=\"p3\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>General journal<ept id=\"p4\">**</ept>) in the <bpt id=\"p5\">**</bpt>Clicked<ept id=\"p5\">**</ept> method on the <bpt id=\"p6\">**</bpt>OpenLinesInExcel<ept id=\"p6\">**</ept> button.","source":"An example of such code can be found on the **LedgerJournalTable** form (**General ledger** &gt; **Journals** &gt; **General journal**) in the **Clicked** method on the **OpenLinesInExcel** button."},{"content":"The following image shows the <bpt id=\"p1\">**</bpt>General ledger<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Journals<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>General journal<ept id=\"p3\">**</ept> form with the <bpt id=\"p4\">**</bpt>Open lines in Excel<ept id=\"p4\">**</ept> button highlighted.","pos":[14093,14242],"source":"The following image shows the **General ledger** &gt; **Journals** &gt; **General journal** form with the **Open lines in Excel** button highlighted."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>off101i<ept id=\"p1\">](./media/off101i.png)](./media/off101i.png)</ept>To programmatically add generated and template Open in Excel options Open in Excel options can be programmatically added by implementing the ExportToExcelIGeneratedCustomExport and ExportToExcelITemplateCustomExport interfaces.","pos":[14243,14524],"source":"[![off101i](./media/off101i.png)](./media/off101i.png)To programmatically add generated and template Open in Excel options Open in Excel options can be programmatically added by implementing the ExportToExcelIGeneratedCustomExport and ExportToExcelITemplateCustomExport interfaces."},{"content":"This allows the addition of options to forms where the entity or template doesn’t have the same table as the root datasource.","pos":[14525,14650]},{"content":"A good example of when you would use this capability is on forms without a datasource, potentially containing just a collection of form parts.","pos":[14651,14793]},{"content":"The following example adds generated and template Open in Excel options programmatically to the <bpt id=\"p1\">**</bpt>FMRental<ept id=\"p1\">**</ept> form.","pos":[14794,14908],"source":" The following example adds generated and template Open in Excel options programmatically to the **FMRental** form."},{"pos":[16803,16884],"content":"How do I add a filter for a programmatically-added template Open in Excel option?","linkify":"How do I add a filter for a programmatically-added template Open in Excel option?","nodes":[{"content":"How do I add a filter for a programmatically-added template Open in Excel option?","pos":[0,81]}]},{"content":"A template Open in Excel option can be programmatically added by implementing the ExportToExcelITemplateCustomExport interface and providing a template in the getTemplate method.","pos":[16968,17146]},{"content":"A filter for that option can be programmatically added by using the ExportToExcelFilterBuilder API in the updateTemplateSettings method.","pos":[17147,17283]},{"content":"After a filter has been added programmatically, the resulting filter can be viewed in the Excel Data Connector App using the <bpt id=\"p1\">**</bpt>Filter<ept id=\"p1\">**</ept> button.","pos":[17859,18002],"source":"After a filter has been added programmatically, the resulting filter can be viewed in the Excel Data Connector App using the **Filter** button."},{"content":"The following image shows the Excel Data Connector App with the <bpt id=\"p1\">**</bpt>Filter<ept id=\"p1\">**</ept> button highlighted.<bpt id=\"p2\">[</bpt><ph id=\"ph1\">![</ph>off101j<ept id=\"p2\">](./media/off101j.png)](./media/off101j.png)</ept> The following image shows the Excel Data Connector App with the <bpt id=\"p3\">**</bpt>Filter<ept id=\"p3\">**</ept> dialog opened.<bpt id=\"p4\">[</bpt><ph id=\"ph2\">![</ph>off101k<ept id=\"p4\">](./media/off101k.png)](./media/off101k.png)</ept>","pos":[18003,18295],"source":" The following image shows the Excel Data Connector App with the **Filter** button highlighted.[![off101j](./media/off101j.png)](./media/off101j.png) The following image shows the Excel Data Connector App with the **Filter** dialog opened.[![off101k](./media/off101k.png)](./media/off101k.png)"},{"pos":[18300,18346],"content":"How do I enable relationship lookups in Excel?","linkify":"How do I enable relationship lookups in Excel?","nodes":[{"content":"How do I enable relationship lookups in Excel?","pos":[0,46]}]},{"content":"To enable relationship lookups in the Excel Data Connector, you must ensure the following metadata is set.","pos":[18347,18453]},{"content":"The Role and Related Data Entity Role defined on the relationship need to be unique among all relationships on both the source and target entity.","pos":[18459,18604]},{"content":"This is particularly important for relationships involving entities with lots of relationships, such as DimensionCombinationEntity.","pos":[18605,18736]},{"content":"If you're not seeing an expected lookup, try changing the role names to the following format:","pos":[18737,18830]},{"pos":[18836,18946],"content":"<bpt id=\"p1\">**</bpt>Role<ept id=\"p1\">**</ept>: <ph id=\"ph1\">\\[</ph>this entity's public name<ph id=\"ph2\">\\]</ph><ph id=\"ph3\"> + </ph><ph id=\"ph4\">\\[</ph>target entity's public name<ph id=\"ph5\">\\]</ph><ph id=\"ph6\"> + </ph><ph id=\"ph7\">\\[</ph>target entity field<ph id=\"ph8\">\\]</ph> + \"Source\"","source":"**Role**: \\[this entity's public name\\] + \\[target entity's public name\\] + \\[target entity field\\] + \"Source\""},{"pos":[18951,19081],"content":"<bpt id=\"p1\">**</bpt>Related Data Entity Role<ept id=\"p1\">**</ept>: <ph id=\"ph1\">\\[</ph>this entity's public name<ph id=\"ph2\">\\]</ph><ph id=\"ph3\"> + </ph><ph id=\"ph4\">\\[</ph>target entity's public name<ph id=\"ph5\">\\]</ph><ph id=\"ph6\"> + </ph><ph id=\"ph7\">\\[</ph>target entity field<ph id=\"ph8\">\\]</ph> + \"Target\"","source":"**Related Data Entity Role**: \\[this entity's public name\\] + \\[target entity's public name\\] + \\[target entity field\\] + \"Target\""},{"content":"The Cardinality and Related Data Entity Cardinality need to be set appropriately.","pos":[19087,19168]},{"content":"At least one constraint must be added to the relationship.","pos":[19173,19231]},{"content":"With the exception of dimension relationships, which are a special case, the properties constrained must both be public.","pos":[19232,19352]},{"pos":[19358,19373],"content":"Troubleshooting","linkify":"Troubleshooting","nodes":[{"content":"Troubleshooting","pos":[0,15]}]},{"content":"If you are not seeing an expected lookup, validate relationship metadata by checking the metadata feed available at <ph id=\"ph1\">\\[</ph>YourSiteURL<ph id=\"ph2\">\\]</ph>/data/$metadata.","pos":[19375,19522],"source":"If you are not seeing an expected lookup, validate relationship metadata by checking the metadata feed available at \\[YourSiteURL\\]/data/$metadata."},{"content":"Search the $metadat feed for the public name of your entity to find its EntityType element, then make sure there is a child NavigationProperty element with a name equal to the Role value of the relationship.","pos":[19524,19731]},{"content":"If the navigation property exists, it will be used by the Excel Data Connector to show a relationship lookup.","pos":[19732,19841]},{"content":"Lookups are not shown under the following conditions:","pos":[19842,19895]},{"content":"All of the entity's key fields are included as constraints in the relationship.","pos":[19901,19980]},{"content":"The selected field is a key and the selected record is not new.","pos":[19985,20048]},{"content":"The authenticated user does not have permission to access the entity targeted by the lookup.","pos":[20053,20145]},{"pos":[20150,20173],"content":"How do dimensions work?","linkify":"How do dimensions work?","nodes":[{"content":"How do dimensions work?","pos":[0,23]}]},{"content":"The easiest way to set up dimension metadata on data entities is to use the data entity creation wizard, which will automatically create the private relationships and public display value fields exactly as the dimensions framework needs them.","pos":[20174,20416]},{"content":"If you want to customize your dimensions setup, see <bpt id=\"p1\">[</bpt>Dimensions Overview<ept id=\"p1\">](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/financial-dimensions/dimensions-overview)</ept>.","pos":[20417,20599],"source":" If you want to customize your dimensions setup, see [Dimensions Overview](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/financial-dimensions/dimensions-overview)."},{"content":"Lookups, at RTW, are only generated automatically for non-Ledger dimensions.","pos":[20600,20676]},{"content":"Custom dimensions are not supported for the initial release, but support will be added in a future update.","pos":[20677,20783]},{"content":"If you want to enable lookups for Ledger dimensions (MainAccount, Department, CostCenter, etc.), see the link above for guidance on creating relationships on DimensionCombationEntity and DimensionSetEntity fields; once those relationships are present, relationship lookups will be displayed in the Excel Data Connector.","pos":[20784,21103]},{"content":"The Excel Data Connector supports two types of dimension data entry: editing the display value directly or each attribute of the display value in a separate column.","pos":[21104,21268]},{"content":"If both the display value column and the individual attribute columns are bound, they can both be edited and published separately; if both the display value and an individual attribute are edited in the same row, the individual attribute change overrides the display value change.","pos":[21269,21549]},{"pos":[21554,21592],"content":"How do I create formula table columns?","linkify":"How do I create formula table columns?","nodes":[{"content":"How do I create formula table columns?","pos":[0,38]}]},{"content":"If a formula is needed in a table, then add a formula column.","pos":[21593,21654]},{"content":"When in the field selection page for a table binding, click the \"Formula\" button above the Selected fields list to add a new formula column.","pos":[21655,21795]},{"content":"The label and value for the formula are entered in the fields immediately below the Selected fields list.","pos":[21796,21901]},{"content":"After adding a new formula column, leave the value empty and click Update.","pos":[21902,21976]},{"content":"Once the field has been added to the table, use standard Excel capabilities to create a formula.","pos":[21977,22073]},{"content":"Then copy the formula and paste it into the formula column value field.","pos":[22074,22145]},{"content":"When defining a formula, make sure there is more than one row in the table, otherwise the formula that Excel gives you may be for ALL rows instead of THAT row.","pos":[22146,22305]},{"content":"To specify just the current row, the at symbol <ph id=\"ph1\">(\"@\")</ph> is needed.","pos":[22306,22369],"source":" To specify just the current row, the at symbol (\"@\") is needed."},{"content":"For example, sum of four columns for all rows \"=SUM(Table1<ph id=\"ph1\">\\[</ph><ph id=\"ph2\">\\[</ph>ColumnA<ph id=\"ph3\">\\]</ph>:<ph id=\"ph4\">\\[</ph>ColumnD<ph id=\"ph5\">\\]</ph><ph id=\"ph6\">\\]</ph>)\" versus sum of four columns for the current row \"=SUM(Table1<ph id=\"ph7\">\\[</ph><ph id=\"ph8\">@</ph><ph id=\"ph9\">\\[</ph>ColumnA<ph id=\"ph10\">\\]</ph>:<ph id=\"ph11\">\\[</ph>ColumnD<ph id=\"ph12\">\\]</ph><ph id=\"ph13\">\\]</ph>)\".","pos":[22370,22548],"source":" For example, sum of four columns for all rows \"=SUM(Table1\\[\\[ColumnA\\]:\\[ColumnD\\]\\])\" versus sum of four columns for the current row \"=SUM(Table1\\[@\\[ColumnA\\]:\\[ColumnD\\]\\])\"."},{"pos":[22553,22565],"content":"Known issues","linkify":"Known issues","nodes":[{"content":"Known issues","pos":[0,12]}]},{"pos":[22570,22622],"content":"Refresh doesn’t automatically occur in old templates","linkify":"Refresh doesn’t automatically occur in old templates","nodes":[{"content":"Refresh doesn’t automatically occur in old templates","pos":[0,52]}]},{"content":"The ability to control “refresh on open” was added as a setting.","pos":[22624,22688]},{"content":"To opt-in to the default behavior, existing templates and workbooks need to have the <bpt id=\"p1\">**</bpt>Refresh on open<ept id=\"p1\">**</ept> check box selected in <bpt id=\"p2\">**</bpt>Options<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Data Connector<ept id=\"p3\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Refresh Options<ept id=\"p4\">**</ept>.","pos":[22689,22877],"source":" To opt-in to the default behavior, existing templates and workbooks need to have the **Refresh on open** check box selected in **Options** &gt; **Data Connector** &gt; **Refresh Options**."},{"pos":[22883,22903],"content":"Error finding entity","linkify":"Error finding entity","nodes":[{"content":"Error finding entity","pos":[0,20]}]},{"content":"The reference to entities changed from using the Private Entity Name (DataEntity.Name) to Public Entity Name (DataEntity.PublicEntityName).","pos":[22905,23044]},{"content":"If the public and private names for an entity were different and that entity was used in an Excel template or workbook, then this will cause the following error to be displayed in the Excel App: “Error Finding Entity.","pos":[23045,23262]},{"content":"Details: Entity \"<ph id=\"ph1\">&amp;lt;</ph>DataEntity.Name<ph id=\"ph2\">&amp;gt;</ph>\" not found”.<bpt id=\"p1\">[</bpt><ph id=\"ph3\">![</ph>off101l<ept id=\"p1\">](./media/off101l.png)](./media/off101l.png)</ept> To resolve this, change the binding information in the affected template so that it points to DataEntity.PublicEntityName instead of DataEntity.Name.","pos":[23263,23520],"source":" Details: Entity \"&lt;DataEntity.Name&gt;\" not found”.[![off101l](./media/off101l.png)](./media/off101l.png) To resolve this, change the binding information in the affected template so that it points to DataEntity.PublicEntityName instead of DataEntity.Name."},{"content":"For the DataEntity.Name that needs to be replaced, determine the DataEntity.PublicEntityName, for exmaple replace FMCustomerEntity with FleetCustomer.","pos":[23526,23676]},{"content":"Find the affected template.","pos":[23681,23708]},{"pos":[23713,23820],"content":"Change file extension on template from .xlsx to .zip.<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>off101m<ept id=\"p1\">](./media/off101m.png)](./media/off101m.png)</ept>","source":"Change file extension on template from .xlsx to .zip.[![off101m](./media/off101m.png)](./media/off101m.png)"},{"content":"The file to be changed will be one of the webextension<ph id=\"ph1\">\\*</ph>.xml files in the xlwebextensions directory, such as 2015-05-25-FleetCustomersWithLocations.zipxlwebextensionswebextension2.xml.","pos":[23825,24009],"source":"The file to be changed will be one of the webextension\\*.xml files in the xlwebextensions directory, such as 2015-05-25-FleetCustomersWithLocations.zipxlwebextensionswebextension2.xml."},{"content":"Open the file to ensure that you have the correct location.","pos":[24014,24073]},{"pos":[24078,24184],"content":"Find the DataEntity.Name,  such as FMCustomerEntity.<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>off101n<ept id=\"p1\">](./media/off101n.png)](./media/off101n.png)</ept>","source":"Find the DataEntity.Name,  such as FMCustomerEntity.[![off101n](./media/off101n.png)](./media/off101n.png)"},{"pos":[24189,24264],"content":"Extract the zip file.<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>off101o<ept id=\"p1\">](./media/off101o.png)](./media/off101o.png)</ept>","source":"Extract the zip file.[![off101o](./media/off101o.png)](./media/off101o.png)"},{"content":"Open the webextension xml file.","pos":[24269,24300]},{"content":"Replace the DataEntity.Name with the corresponding DataEntity.PublicEntityName.","pos":[24305,24384]},{"content":"Save the webextension xml file changes.","pos":[24389,24428]},{"content":"Rename the old zip file e.g. add “.old” to the name.","pos":[24433,24485]},{"content":"Create a new zip file of all the previously extracted content.","pos":[24490,24552]},{"content":"This usually involves highlighting the content inside the archive/zip folder and creating a zipped folder using that content.<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>off101p<ept id=\"p1\">](./media/off101p.png)](./media/off101p.png)</ept>","pos":[24553,24732],"source":" This usually involves highlighting the content inside the archive/zip folder and creating a zipped folder using that content.[![off101p](./media/off101p.png)](./media/off101p.png)"},{"content":"Verify that the zip file has the “<ph id=\"ph1\">\\_</ph>rels”, “docProps”, and “xl” folders in the root of the zip file.","pos":[24737,24837],"source":"Verify that the zip file has the “\\_rels”, “docProps”, and “xl” folders in the root of the zip file."},{"content":"Rename the zip file as needed, for example back to 2015-05-25-FleetCustomersWithLocations.zip.","pos":[24842,24936]},{"content":"Change the zip file extension back to xlsx.","pos":[24941,24984]},{"content":"Re-publish the workbook xlsx file, if needed.","pos":[24989,25034]}],"content":"---\n# required metadata\n\ntitle: Create Open in Excel experiences | Microsoft Docs\ndescription: Learn about creating Open in Office experiences for Excel and Word.\nauthor: ChrisGarty\nmanager: AnnBe\nms.date: 2016-04-07 21:51:22\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# keywords: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: 61\nms.suite: Released- Dynamics AX 7.0.0\n# ms.tgt_pltfrm: \nms.custom: 79223\nms.assetid: 01715d49-423a-4498-b4a7-29cc2ab02ea3\nms.region: Global\n# ms.industry: \nms.author: cgarty\n\n---\n\n# Create Open in Excel experiences\n\nLearn about creating Open in Office experiences for Excel and Word.\n\nWhat are Open in Excel experiences?\n-----------------------------------\n\nOpen in Excel experiences are:\n\n-   Based on Entities and the OData services they create.\n-   Dynamically generated or based on a pre-defined template.\n-   Editable and refreshable via the Excel Data Connector App.\n\nThe following image shows the **Excel Data Connector App** inside the Journal Entry in Microsoft.[![off101a](./media/off101a.png)](./media/off101a.png)\n\n## Where are the Open in Excel experiences?\nOpen in Excel experiences are usually found under in the Open in Excel section of the Open in Microsoft Office menu, but an explicit button can be added for these experiences.\n\n## What's the difference between Export to Excel and Open in Excel?\nThe Export to Excel and experiences are both found in the Open in Microsoft Office menu:\n\n-   The Export to Excel options are static exports of grid data. Each one corresponds to a visible grid. All the grid data for the current filter is placed into a workbook.\n-   The Open in Excel experiences utilize the Excel Data Connector App to facilitate refresh and publish.\n\nThe following image shows the **Open in Microsoft O**ffice menu on the **Fleet Customers** form with a template **Open in Excel** option, a generated **Open in Excel** option, and a static **Export to Excel** option.[![off101b](./media/off101b.png)](./media/off101b.png)\n\n## When will an entity show as an Open in Excel option?\nWhen an entity has the same root datasource (table) as a form, it will be added as an option in the Open in Excel section of the Open in Microsoft Office menu. This is referred to as a “generated” option.\n\n## What fields will be shown in the workbook?\nThe default fields that will be added into the workbook are the key and mandatory fields of the entity. If a different set of fields should be provided by default, then those fields can be added into the **AutoReport field group** on the entity. The following image show the Visual Studio view of the AutoReport field group for the FMCustomerEntity.[![off101c](./media/off101c.png)](./media/off101c.png)\n\n## What fields will be shown when an entity is the target of a lookup?\nWhen a relationship is defined between two entities, if the identifier for one entity is shown on the other then the fields that will be shown in that lookup are either the key fields, or the fields in the **AutoLookup field group** if it is not empty. Relationship lookups are not currently supported, but they will eventually be displayed in the app in a similar way to the enumeration lookups. Excel Data Connector App with an enumeration lookup is shown below.[![off101d](./media/off101d.png)](./media/off101d.png)\n\n## What should be done to make an entity ready for use in Excel?\nDefine the AutoReport and AutoLookup field groups and test them using the Excel App design experience.\n\n## Why does an automatically added entity option have “(unfiltered)” after the entity name?\nCurrently no filter is added to these options, hence the term “(unfiltered)”. In the future, an attempt will be made to apply the filter from the form to these options. For example, if a list of Customers was filtered to just Customers in the state of California, then, in the future, the entity will be scanned for the state field and if it was found then a filter would be automatically added.\n\n## How can an entity be added as an Open in Excel option on a form that doesn’t share the same root datasource?\nA generated Open in Excel option can be added on any form by implementing the ExportToExcelIGeneratedCustomExport interface. When adding a generated option programmatically, the set of fields can be explicitly specified.\n\n## What are the regionspecific considerations for defining entities?\nThe Open in Excel generated experiences can be made region-specific by adding region-specific fields into the AutoLookup group. Those region-specific fields will then be included in the generated workbook.\n\n## How can I create a custom lookup for an entity field in Excel?\nA custom lookup can be shown for an Entity field.\n\n-   Name - The method needs to have a name that is “lookup\\_&lt;fieldname&gt;” e.g. a field “MyField” could have a lookup method “lookup\\_MyField”.\n-   Attributes – Attributes need to be added to the method:\n    -   SysODataActionAttribute(str &lt;name&gt;, Boolean &lt;isInstanceMethod&gt;)\n    -   SysODataCollectionAttribute(str &lt;name&gt;, Types &lt;type&gt;, “Value”)\n-   Return – The method should return a list of strings.\n\nExample:  \n\n    public class ExportToExcel_SimpleEntity extends common\n    {\n        [SysODataActionAttribute(\"Lookup_StringLookupField\", true),\n        SysODataCollectionAttribute(\"return\", Types::String, \"Value\")]\n        public List lookup_StringLookupField()\n        {\n            List lookupList = new List(Types::String);\n            const int items = 5;\n\n            for (int item = 0; item < items; item++)\n            {\n                lookupList.addEnd(strfmt('%1 - %2 (%3)', this.StringField, this.IntField, item));\n            }\n\n            return lookupList;\n        }\n    }\n\nHow does the app get injected into a workbook to start building a template?\n===========================================================================\n\nThe Excel Data Connector App is injected into a workbook when a generated Open in Excel experience is triggered or when a workbook is created using the **Common** &gt; **Common** &gt; **Office integration** &gt; **Excel workbook designer** form.\n\n-   The **Create workbook** button will add the selected entity and fields, a pointer to the server, and the app into a workbook.\n-   The **Create blank workbook** button will simply add a pointer to the server and the app into a workbook.\n-   The **View related** form will navigate to the form relating to the currently selected entity to more easily review the effect of data changes made in Excel.\n-   The **Get entity record count** button will show the record count for the currently selected entity. Currently, the Excel Data Connector App cannot handle large (tall and wide) data sets. Any unfiltered entity with more than 10,000 records is at risk of crashing the app.\n\nThe following image shows the **Excel workbook designer** form.[![off101e](./media/off101e.png)](./media/off101e.png) After obtaining a workbook containing the Excel Data Connector App, additional datasources can be added via the **Design** button. Currently, datasources cannot be removed. The following image shows the Excel Data Connector App with the **Design** button highlighted.[![off101f](./media/off101f.png)](./media/off101f.png)\n\n## When will a template show as an Open in Excel option?\nWhen a template listed in the **Common** &gt; **Common** &gt; **Office integration** &gt; **Document templates** form (DocuTemplate) has ShowInOpenInOfficeMenu set to Yes and has the same root datasource (table) as the current form, it will be added as an option in the Open in Excel section of the Open in Microsoft Office menu. The following image shows the **Document templates** form.[![off101g](./media/off101g.png)](./media/off101g.png)\n\n## Will a filter be added to the template?\nIn the **Document Templates** form, the standard filter for “current record” can be turned on and off. If the filter is on, then when the template is invoked as an Open in Excel option and a filter for the current record will be added to the workbook. The filter will be the key fields and their values.\n\n## How can templates be defined in metadata and code and loaded automatically?\nWhen adding a template into the **Document Templates** form, it is added for that instance and is referred to as a “user-defined” template. Templates can also be defined in metadata and code and loaded in an automatic way, thus making them “system-defined” templates. To create a system-defined template via metadata and code:\n\n-   Define the template.\n-   Create a new resource in a project.\n-   Define a new class that extends the DocuTemplateRegistrationBase class and add an implementation of the registerTemplates method.\n\nThe LedgerJournalLineEntryTemplateRegistration and FMTemplateRegistrations classes are good examples of template registrations defined in code. And the LedgerJournalLineEntryTemplate and FMTemplateCustomersWithLocations resources are the corresponding templates stored in metadata as resources. When a template has a registration class, it will be loaded when the **Reload system templates** button is clicked in the **Document Templates** form.\n\n## How do templates get loaded into a fresh deployment?\nTo load system defined templates, click the **Reload system templates** button in the **Common** &gt; **Common** &gt; **Office integration** &gt; **Document templates** form, as shown below.[![off101h](./media/off101h.png)](./media/off101h.png) In the near future we will do the equivalent of clicking that button during deployment.\n\n## How do I decide if I should create a template?\nA template is an artifact that needs to be maintained and versioned. If you can avoid defining a template without sacrificing much from the user experience, then you probably should use a template. Create a template if:\n\n-   You need additional content or formatting in the template.\n-   You want to combine multiple entities/datasources in the same workbook.\n\nDon’t create a template if:\n\n-   You can just specify a set of fields to show in a table binding.\n\n## What are the regionspecific considerations for templates?\nWhen creating a template for an entity that has region-specific fields, you should leave those region-specific fields out of the template since otherwise all users will see the region-specific fields. Templates should cater to the majority of users by default and region-specific users can add those fields using the easy-to-use design experience of the Excel Data Connector App.  The region-specific fields and columns can be added by users as needed and then that template can be either saved to local computer for reuse by a single user or uploaded via the Document Templates form for reuse by any user of that instance. A couple of other considerations:\n\n-   If a region has a region-specific entity, then a region-specific template could be created.\n-   If a region is important enough, then you could define a region-specific template as well as a region-generic template.\n\nHow do I add an explicit button for a template Open in Excel option?\n====================================================================\n\nAn explicit button can be added for Open in Excel experiences. The label shown on the button should usually be “Open target in Excel” where target is the name of the target data like “lines” or “catalog”. The code behind such a button will:\n\n-   Obtain the template to be used.\n-   Add the desired filter.\n-   Pass the template to the user.\n\nAn example of such code can be found on the **LedgerJournalTable** form (**General ledger** &gt; **Journals** &gt; **General journal**) in the **Clicked** method on the **OpenLinesInExcel** button.\n\n        [Control(\"Button\")]\n        class OpenLinesInExcel\n        {\n            /// <summary>\n            /// Opens the current journal in Excel for line entry and editing\n            /// </summary>\n            public void clicked()\n            {\n                super();\n\n                const str templateName = resourceStr(LedgerJournalLineEntryTemplate);\n                DocuTemplate template = DocuTemplate::findTemplate(OfficeAppApplicationType::Excel, templateName);\n\n                // Ensure the template was present\n                if (template && template.TemplateID == templateName)\n                {\n                    Map filtersToApply = new Map(Types::String, Types::String);\n\n                    // Create lines filter\n                    ExportToExcelFilterBuilder filterBuilder = new ExportToExcelFilterBuilder(tablestr(LedgerJournalLineEntity));\n                    str filterString = filterBuilder.areEqual(fieldstr(LedgerJournalLineEntity, JournalBatchNumber), LedgerJournalTable.JournalNum);\n                    filtersToApply.insert(tablestr(LedgerJournalLineEntity), filterString);\n\n                    // Create header filter\n                    filterBuilder = new ExportToExcelFilterBuilder(tablestr(LedgerJournalHeaderEntity));\n                    filterString = filterBuilder.areEqual(fieldstr(LedgerJournalHeaderEntity, JournalBatchNumber), LedgerJournalTable.JournalNum);\n                    filtersToApply.insert(tablestr(LedgerJournalHeaderEntity), filterString);\n\n                    // Generate the workbook using the template and filters\n                    DocuTemplateRender renderer = new DocuTemplateRender();\n                    str documentUrl = renderer.renderTemplateToStorage(template, filtersToApply);\n\n                    // Pass the workbook to the user\n                    if (documentUrl)\n                    {\n                        Browser b = new Browser();\n                        b.navigate(documentUrl, false, false);\n                    }\n                    else\n                    {\n                        error(strFmt(\"@ApplicationFoundation:DocuTemplateGenerationFailed\", templateName));\n                    }\n                }\n                else\n                {\n                    warning(strFmt(\"@ApplicationFoundation:DocuTemplateNotFound\", templateName));\n                }\n            }\n\n        }\n\n  The following image shows the **General ledger** &gt; **Journals** &gt; **General journal** form with the **Open lines in Excel** button highlighted. [![off101i](./media/off101i.png)](./media/off101i.png)To programmatically add generated and template Open in Excel options Open in Excel options can be programmatically added by implementing the ExportToExcelIGeneratedCustomExport and ExportToExcelITemplateCustomExport interfaces. This allows the addition of options to forms where the entity or template doesn’t have the same table as the root datasource. A good example of when you would use this capability is on forms without a datasource, potentially containing just a collection of form parts. The following example adds generated and template Open in Excel options programmatically to the **FMRental** form.\n\n    [Form]\n    public class FMRental extends FormRun implements ExportToExcelIGeneratedCustomExport, ExportToExcelITemplateCustomExport\n    {    \n    ...\n        public List getExportOptions()\n        {\n            List exportOptions = new List(Types::Class);\n\n            ExportToExcelExportOption exportOption = ExportToExcelExportOption::construct(ExportToExcelExportType::CustomGenerated, int2str(1));\n            exportOption.setDisplayNameWithDataEntity(tablestr(FMRentalEntity));\n            exportOptions.addEnd(exportOption);\n\n            ExportToExcelExportOption exportOption2 = ExportToExcelExportOption::construct(ExportToExcelExportType::CustomTemplate, int2str(2));\n            exportOption2.displayName(\"Analyze rentals\");\n            exportOptions.addEnd(exportOption2);\n            \n            return exportOptions;\n        }\n\n        public ExportToExcelDataEntityContext getDataEntityContext(ExportToExcelExportOption _exportOption)\n        {\n            ExportToExcelDataEntityContext context = null;\n\n            if (_exportOption.id() == int2str(1))\n            {\n                context = ExportToExcelDataEntityContext::construct(tablestr(FMRentalEntity), tablefieldgroupstr(FMRentalEntity, AutoReport));\n            }\n\n            return context;\n        }\n\n        public System.IO.Stream getTemplate(ExportToExcelExportOption _exportOption)\n        {\n            System.IO.Stream stream = null;\n\n            if (_exportOption.id() == int2str(2))\n            {\n                stream = Microsoft.Dynamics.Ax.Xpp.MetadataSupport::GetResourceContentStream(resourcestr(FMRentalEditableExportTemplate));\n            }\n\n            return stream;\n        }\n\n        public void updateTemplateSettings(ExportToExcelExportOption _exportOption, Microsoft.Dynamics.Platform.Integration.Office.ExportToExcelHelper.SettingsEditor _settingsEditor)\n        {\n        }\n    ...\n\nHow do I add a filter for a programmatically-added template Open in Excel option?\n=================================================================================\n\nA template Open in Excel option can be programmatically added by implementing the ExportToExcelITemplateCustomExport interface and providing a template in the getTemplate method. A filter for that option can be programmatically added by using the ExportToExcelFilterBuilder API in the updateTemplateSettings method.\n\n    public void updateTemplateSettings(ExportToExcelExportOption _exportOption, Microsoft.Dynamics.Platform.Integration.Office.ExportToExcelHelper.SettingsEditor _settingsEditor)\n\n    {\n\n    _settingsEditor.SetFilterExpression(tableStr(RetailTmpBulkProductAttributeValueEntity), element.getExportToExcelFilterExpression());\n\n    DictDataEntity dictDataEntity = new DictDataEntity(tableNum(RetailTmpBulkProductAttributeValueEntity));\n\n    _settingsEditor.SetFilterExpressionByPublicName(dictDataEntity.publicEntityName(), element.getExportToExcelFilterExpression());\n\n    }\n\nAfter a filter has been added programmatically, the resulting filter can be viewed in the Excel Data Connector App using the **Filter** button. The following image shows the Excel Data Connector App with the **Filter** button highlighted.[![off101j](./media/off101j.png)](./media/off101j.png) The following image shows the Excel Data Connector App with the **Filter** dialog opened.[![off101k](./media/off101k.png)](./media/off101k.png)\n\n## How do I enable relationship lookups in Excel?\nTo enable relationship lookups in the Excel Data Connector, you must ensure the following metadata is set.\n\n1.  The Role and Related Data Entity Role defined on the relationship need to be unique among all relationships on both the source and target entity. This is particularly important for relationships involving entities with lots of relationships, such as DimensionCombinationEntity. If you're not seeing an expected lookup, try changing the role names to the following format:\n\n-   **Role**: \\[this entity's public name\\] + \\[target entity's public name\\] + \\[target entity field\\] + \"Source\"\n-   **Related Data Entity Role**: \\[this entity's public name\\] + \\[target entity's public name\\] + \\[target entity field\\] + \"Target\"\n\n1.  The Cardinality and Related Data Entity Cardinality need to be set appropriately.\n2.  At least one constraint must be added to the relationship. With the exception of dimension relationships, which are a special case, the properties constrained must both be public.\n\n### Troubleshooting\n\nIf you are not seeing an expected lookup, validate relationship metadata by checking the metadata feed available at \\[YourSiteURL\\]/data/$metadata.  Search the $metadat feed for the public name of your entity to find its EntityType element, then make sure there is a child NavigationProperty element with a name equal to the Role value of the relationship. If the navigation property exists, it will be used by the Excel Data Connector to show a relationship lookup. Lookups are not shown under the following conditions:\n\n1.  All of the entity's key fields are included as constraints in the relationship.\n2.  The selected field is a key and the selected record is not new.\n3.  The authenticated user does not have permission to access the entity targeted by the lookup.\n\n## How do dimensions work?\nThe easiest way to set up dimension metadata on data entities is to use the data entity creation wizard, which will automatically create the private relationships and public display value fields exactly as the dimensions framework needs them. If you want to customize your dimensions setup, see [Dimensions Overview](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/financial-dimensions/dimensions-overview). Lookups, at RTW, are only generated automatically for non-Ledger dimensions. Custom dimensions are not supported for the initial release, but support will be added in a future update. If you want to enable lookups for Ledger dimensions (MainAccount, Department, CostCenter, etc.), see the link above for guidance on creating relationships on DimensionCombationEntity and DimensionSetEntity fields; once those relationships are present, relationship lookups will be displayed in the Excel Data Connector. The Excel Data Connector supports two types of dimension data entry: editing the display value directly or each attribute of the display value in a separate column. If both the display value column and the individual attribute columns are bound, they can both be edited and published separately; if both the display value and an individual attribute are edited in the same row, the individual attribute change overrides the display value change.\n\n## How do I create formula table columns?\nIf a formula is needed in a table, then add a formula column. When in the field selection page for a table binding, click the \"Formula\" button above the Selected fields list to add a new formula column. The label and value for the formula are entered in the fields immediately below the Selected fields list. After adding a new formula column, leave the value empty and click Update. Once the field has been added to the table, use standard Excel capabilities to create a formula. Then copy the formula and paste it into the formula column value field. When defining a formula, make sure there is more than one row in the table, otherwise the formula that Excel gives you may be for ALL rows instead of THAT row. To specify just the current row, the at symbol (\"@\") is needed. For example, sum of four columns for all rows \"=SUM(Table1\\[\\[ColumnA\\]:\\[ColumnD\\]\\])\" versus sum of four columns for the current row \"=SUM(Table1\\[@\\[ColumnA\\]:\\[ColumnD\\]\\])\".\n\n## Known issues\n### Refresh doesn’t automatically occur in old templates\n\nThe ability to control “refresh on open” was added as a setting. To opt-in to the default behavior, existing templates and workbooks need to have the **Refresh on open** check box selected in **Options** &gt; **Data Connector** &gt; **Refresh Options**.\n\n### Error finding entity\n\nThe reference to entities changed from using the Private Entity Name (DataEntity.Name) to Public Entity Name (DataEntity.PublicEntityName). If the public and private names for an entity were different and that entity was used in an Excel template or workbook, then this will cause the following error to be displayed in the Excel App: “Error Finding Entity. Details: Entity \"&lt;DataEntity.Name&gt;\" not found”.[![off101l](./media/off101l.png)](./media/off101l.png) To resolve this, change the binding information in the affected template so that it points to DataEntity.PublicEntityName instead of DataEntity.Name.\n\n1.  For the DataEntity.Name that needs to be replaced, determine the DataEntity.PublicEntityName, for exmaple replace FMCustomerEntity with FleetCustomer.\n2.  Find the affected template.\n3.  Change file extension on template from .xlsx to .zip.[![off101m](./media/off101m.png)](./media/off101m.png)\n4.  The file to be changed will be one of the webextension\\*.xml files in the xlwebextensions directory, such as 2015-05-25-FleetCustomersWithLocations.zipxlwebextensionswebextension2.xml.\n5.  Open the file to ensure that you have the correct location.\n6.  Find the DataEntity.Name,  such as FMCustomerEntity.[![off101n](./media/off101n.png)](./media/off101n.png)\n7.  Extract the zip file.[![off101o](./media/off101o.png)](./media/off101o.png)\n8.  Open the webextension xml file.\n9.  Replace the DataEntity.Name with the corresponding DataEntity.PublicEntityName.\n10. Save the webextension xml file changes.\n11. Rename the old zip file e.g. add “.old” to the name.\n12. Create a new zip file of all the previously extracted content. This usually involves highlighting the content inside the archive/zip folder and creating a zipped folder using that content.[![off101p](./media/off101p.png)](./media/off101p.png)\n13. Verify that the zip file has the “\\_rels”, “docProps”, and “xl” folders in the root of the zip file.\n14. Rename the zip file as needed, for example back to 2015-05-25-FleetCustomersWithLocations.zip.\n15. Change the zip file extension back to xlsx.\n16. Re-publish the workbook xlsx file, if needed.\n\n\n"}