{"nodes":[{"pos":[32,74],"content":"Segmented entry control migration guidance","needQuote":true,"needEscape":true,"nodes":[{"content":"Segmented entry control migration guidance","pos":[0,42]}]},{"pos":[88,259],"content":"This article guides you through the process of migrating a Segmented Entry control from the Microsoft Dynamics AX 2012 pattern to the new pattern in Microsoft Dynamics AX.","needQuote":true,"needEscape":true,"nodes":[{"content":"This article guides you through the process of migrating a Segmented Entry control from the Microsoft Dynamics AX 2012 pattern to the new pattern in Microsoft Dynamics AX.","pos":[0,171]}]},{"pos":[767,809],"content":"Segmented entry control migration guidance","linkify":"Segmented entry control migration guidance","nodes":[{"content":"Segmented entry control migration guidance","pos":[0,42]}]},{"content":"This article guides you through the process of migrating a Segmented Entry control from the Microsoft Dynamics AX 2012 pattern to the new pattern in Microsoft Dynamics AX.","pos":[811,982]},{"content":"The goal of the new design is to encapsulate the control implementation and not require that forms interact with the classes that back the control.","pos":[984,1131]},{"content":"Therefore, in Microsoft Dynamics AX, <bpt id=\"p1\">*</bpt>all forms should interact only with the application programming interface (API) of the <ept id=\"p1\">*</ept><bpt id=\"p2\">*</bpt>Segmented Entry<ept id=\"p2\">*</ept><bpt id=\"p3\">*</bpt> control instance<ept id=\"p3\">*</ept>.","pos":[1132,1295],"source":" Therefore, in Microsoft Dynamics AX, *all forms should interact only with the application programming interface (API) of the **Segmented Entry** control instance*."},{"content":"They should not interact directly with the controller classes (such as <bpt id=\"p1\">**</bpt>LedgerDimensionAccountController<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>DimensionDynamicAccountController<ept id=\"p2\">**</ept>).","pos":[1296,1447],"source":" They should not interact directly with the controller classes (such as **LedgerDimensionAccountController** and **DimensionDynamicAccountController**)."},{"content":"Any property that was previously manipulated or called on the controller must now be called on the control.","pos":[1448,1555]},{"content":"<bpt id=\"p1\">**</bpt>Notes:<ept id=\"p1\">**</ept>","pos":[1556,1566],"source":"**Notes:**"},{"pos":[1572,1907],"content":"Some APIs have naming differences between the controller and the control. The following table lists these APIs.\n**Controller Method (old)**\n**Control Method (new)**\nparmDate\nparmControlDate\nparmFilterLedgerPostingType\nparmPostingType\nparmDimensionAccountStorageUsage\nparmDimensionAccountStorageUsageType","leadings":["","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Some APIs have naming differences between the controller and the control.","pos":[0,73]},{"content":"The following table lists these APIs.","pos":[74,111]},{"content":"<bpt id=\"p1\">**</bpt>Controller Method (old)<ept id=\"p1\">**</ept><ph id=\"ph1\">\n</ph><bpt id=\"p2\">**</bpt>Control Method (new)<ept id=\"p2\">**</ept> parmDate parmControlDate parmFilterLedgerPostingType parmPostingType parmDimensionAccountStorageUsage parmDimensionAccountStorageUsageType","pos":[112,303],"source":"**Controller Method (old)**\n**Control Method (new)**\nparmDate\nparmControlDate\nparmFilterLedgerPostingType\nparmPostingType\nparmDimensionAccountStorageUsage\nparmDimensionAccountStorageUsageType"}]},{"pos":[1912,1923],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","source":"**Example**"},{"pos":[1932,1980],"content":"<bpt id=\"p1\">**</bpt>Before:<ept id=\"p1\">**</ept> controller.parmDate(systemDateGet())","source":"**Before:** controller.parmDate(systemDateGet())"},{"pos":[1989,2047],"content":"<bpt id=\"p1\">**</bpt>After:<ept id=\"p1\">**</ept> LedgerAccount.parmControlDate(systemDateGet());","source":"**After:** LedgerAccount.parmControlDate(systemDateGet());"},{"pos":[2053,2203],"content":"In this example, <bpt id=\"p1\">**</bpt>controller<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>LedgerDimensionAccountController<ept id=\"p2\">**</ept> instance and <bpt id=\"p3\">**</bpt>LedgerAccount<ept id=\"p3\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> new <bpt id=\"p4\">**</bpt>Segmented Entry<ept id=\"p4\">**</ept> control instance","source":"In this example, **controller** &gt; **LedgerDimensionAccountController** instance and **LedgerAccount** &gt; new **Segmented Entry** control instance"},{"content":"In methods that have been overridden on controls and data fields, the code upgrade rule replaces method calls on the controllers with method calls on each control instance that was using a particular controller.","pos":[2208,2419]},{"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>","pos":[2420,2431],"source":"**Example**"},{"pos":[2440,2451],"content":"<bpt id=\"p1\">**</bpt>Before:<ept id=\"p1\">**</ept>","source":"**Before:**"},{"pos":[2591,2601],"content":"<bpt id=\"p1\">**</bpt>After:<ept id=\"p1\">**</ept>","source":"**After:**"},{"content":"These changes are made so that it's easier to copy and paste code that must be moved elsewhere (for example, in some instances of <bpt id=\"p1\">**</bpt>loadSegments()<ept id=\"p1\">**</ept> and other such methods).","pos":[2770,2943],"source":"These changes are made so that it's easier to copy and paste code that must be moved elsewhere (for example, in some instances of **loadSegments()** and other such methods)."},{"content":"You can ignore this change when you decide whether the method can be deleted.","pos":[2944,3021]},{"content":"Your decision should depend on whether the method has any custom logic.","pos":[3022,3093]},{"content":"The code upgrade script does not handle cases where a controller is instantiated within a method.","pos":[3098,3195]},{"content":"These cases must be migrated manually.","pos":[3196,3234]},{"content":"The MRU functionality from Microsoft Dynamics AX 2012 has been removed in Dynamics AX and won't be replaced.","pos":[3239,3347]},{"content":"<bpt id=\"p1\">**</bpt>parmTaxCode<ept id=\"p1\">**</ept> has been removed.","pos":[3352,3385],"source":"**parmTaxCode** has been removed."},{"content":"There is no replacement.","pos":[3386,3410]},{"pos":[3415,3425],"content":"Properties","linkify":"Properties","nodes":[{"content":"Properties","pos":[0,10]}]},{"content":"The custom properties for the <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control are found under <bpt id=\"p2\">**</bpt>Controller<ept id=\"p2\">**</ept>.","pos":[3426,3515],"source":"The custom properties for the **Segmented Entry** control are found under **Controller**."},{"content":"The following screen shot shows an example.","pos":[3516,3559]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>111<ept id=\"p1\">](./media/111.png)](./media/111.png)</ept> Not all properties apply to all <bpt id=\"p2\">**</bpt>Controller<ept id=\"p2\">**</ept> class types.","pos":[3560,3662],"source":"[![111](./media/111.png)](./media/111.png) Not all properties apply to all **Controller** class types."},{"content":"Properties that don't apply to a selected controller class will be disabled.","pos":[3663,3739]},{"content":"The following table provides details about the properties.","pos":[3740,3798]},{"pos":[3800,3812],"content":"<bpt id=\"p1\">**</bpt>Property<ept id=\"p1\">**</ept>","source":"**Property**"},{"pos":[3814,3830],"content":"<bpt id=\"p1\">**</bpt>Valid Values<ept id=\"p1\">**</ept>","source":"**Valid Values**"},{"pos":[3832,3841],"content":"<bpt id=\"p1\">**</bpt>Usage<ept id=\"p1\">**</ept>","source":"**Usage**"},{"content":"Account Type Field","pos":[3843,3861]},{"content":"A field from the datasource.","pos":[3863,3891]},{"content":"Determines the type of account used.","pos":[3893,3929]},{"content":"Typically utilized for journal entry from a multi-segment ledger account to single segment values from other backing tables such as Cust, Vend, Bank, Project and similar.","pos":[3930,4100]},{"content":"Controller Class","pos":[4102,4118]},{"content":"One of 6 Controller classes.","pos":[4120,4148]},{"content":"For example LedgerDimensionDefaultAccountController.","pos":[4149,4201]},{"content":"Determines the pattern and behavior of the Segmented Entry control.","pos":[4203,4270]},{"content":"More information about this property is provided below.","pos":[4271,4326]},{"content":"Include Financial Accounts","pos":[4328,4354]},{"content":"NoYes","pos":[4356,4361]},{"content":"Determines if Main accounts that are Financial accounts are valid for use.","pos":[4363,4437]},{"content":"Include Total Accounts","pos":[4439,4461]},{"content":"NoYes","pos":[4463,4468]},{"content":"Determines if Main accounts of type Total are valid for use.","pos":[4470,4530]},{"content":"Is Default Account","pos":[4532,4550]},{"content":"TrueFalse","pos":[4552,4561]},{"content":"For a Dynamic account, determines if the account should be a default or full account.","pos":[4563,4648]},{"content":"Lock Main Account Segment","pos":[4650,4675]},{"content":"NoYes","pos":[4677,4682]},{"content":"Controls whether the Main account segment is locked.","pos":[4684,4736]},{"content":"Typically used in journals and distributions based upon configuration.","pos":[4737,4807]},{"content":"Posting Type","pos":[4809,4821]},{"content":"A value from the LedgerPostingType enumeration.","pos":[4823,4870]},{"content":"The Main account is validated to see if the posting type is allowed to be used with that account.","pos":[4872,4969]},{"content":"Validate Blocked For Manual Entry","pos":[4971,5004]},{"content":"NoYes","pos":[5006,5011]},{"content":"Determines if the 'Blocked for Manual Entry' status on the dimension should be respected or not.","pos":[5013,5109]},{"pos":[5114,5139],"content":"Controller class property","linkify":"Controller class property","nodes":[{"content":"Controller class property","pos":[0,25]}]},{"content":"The following table provides details about each controller.","pos":[5140,5199]},{"pos":[5201,5215],"content":"<bpt id=\"p1\">**</bpt>Controller<ept id=\"p1\">**</ept>","source":"**Controller**"},{"pos":[5217,5228],"content":"<bpt id=\"p1\">**</bpt>Details<ept id=\"p1\">**</ept>","source":"**Details**"},{"content":"BudgetLedgerDimension","pos":[5230,5251]},{"content":"This Controller provides budget based support for data entry in the Segmented Entry control.","pos":[5253,5345]},{"content":"When using this controller, an Account Structure must be provided to the Segmented Entry control.","pos":[5346,5443]},{"content":"BudgetPlanningLedgerDimension","pos":[5445,5474]},{"content":"This Controller provides budget planning based support for data entry in the Segmented Entry control.","pos":[5476,5577]},{"content":"When using this controller, an Account Structure must be provided to the Segmented Entry control.","pos":[5578,5675]},{"content":"DimensionDynamicAccount","pos":[5677,5700]},{"content":"This Controller provides support for multiple account types in the Segmented Entry control.","pos":[5702,5793]},{"content":"LedgerDimensionAccountAlias","pos":[5795,5822]},{"content":"This Controller provides support for account aliases in the Segmented Entry control","pos":[5824,5907]},{"content":"LedgerDimensionAccount","pos":[5909,5931]},{"content":"This Controller provides support for multi-segment data entry in the Segmented Entry control.","pos":[5933,6026]},{"content":"LedgerDimensionDefaultAccount","pos":[6028,6057]},{"content":"This Controller provides support for default accounts in the Segmented Entry control.","pos":[6059,6144]},{"pos":[6149,6164],"content":"Migration steps","linkify":"Migration steps","nodes":[{"content":"Migration steps","pos":[0,15]}]},{"pos":[6169,6175],"content":"Step 1","linkify":"Step 1","nodes":[{"content":"Step 1","pos":[0,6]}]},{"pos":[6182,6189],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"content":"If <bpt id=\"p1\">**</bpt>SegmentedEntry<ept id=\"p1\">**</ept> appears as the type next to any control, change it to <bpt id=\"p2\">**</bpt>SegmentedEntryControl<ept id=\"p2\">**</ept>.","pos":[6191,6293],"source":"If **SegmentedEntry** appears as the type next to any control, change it to **SegmentedEntryControl**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>SegmentMigrate01<ept id=\"p1\">](./media/segmentmigrate01.png)](./media/segmentmigrate01.png)</ept>","pos":[6294,6375],"source":"[![SegmentMigrate01](./media/segmentmigrate01.png)](./media/segmentmigrate01.png)"},{"pos":[6382,6393],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"An easy method is to append \"<ph id=\"ph1\">\\_</ph>old\" to the name of the old control, add the new control (which should have the original name of the control), migrate all the settings over, and then delete the old control.","pos":[6395,6600],"source":"An easy method is to append \"\\_old\" to the name of the old control, add the new control (which should have the original name of the control), migrate all the settings over, and then delete the old control."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> To prevent tests and other code that references the control from breaking, make sure that the new control has the same name as the old control.","pos":[6601,6754],"source":"**Note:** To prevent tests and other code that references the control from breaking, make sure that the new control has the same name as the old control."},{"content":"To add the new control, right-click the parent control that will contain the <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control, and then select <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>SegmentedEntryControl<ept id=\"p3\">**</ept>.","pos":[6755,6916],"source":" To add the new control, right-click the parent control that will contain the **Segmented Entry** control, and then select **New** &gt; **SegmentedEntryControl**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>SegmentMigrate02<ept id=\"p1\">](./media/segmentmigrate02-623x1024.png)](./media/segmentmigrate02.png)</ept> The following screen shot shows how new control will look.","pos":[6917,7066],"source":"[![SegmentMigrate02](./media/segmentmigrate02-623x1024.png)](./media/segmentmigrate02.png) The following screen shot shows how new control will look."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>SegmentMigrate03<ept id=\"p1\">](./media/segmentmigrate03.png)](./media/segmentmigrate03.png)</ept>","pos":[7067,7148],"source":"[![SegmentMigrate03](./media/segmentmigrate03.png)](./media/segmentmigrate03.png)"},{"pos":[7154,7160],"content":"Step 2","linkify":"Step 2","nodes":[{"content":"Step 2","pos":[0,6]}]},{"pos":[7167,7174],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[7176,7225],"content":"Override the  <bpt id=\"p1\">**</bpt>jumpRef()<ept id=\"p1\">**</ept> control/field method.","source":"Override the  **jumpRef()** control/field method."},{"pos":[7330,7341],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"Remove the <bpt id=\"p1\">**</bpt>jumpRef()<ept id=\"p1\">**</ept> method completely if it contains no other functionality.","pos":[7343,7424],"source":"Remove the **jumpRef()** method completely if it contains no other functionality."},{"content":"If there is other custom <bpt id=\"p1\">**</bpt>jumpRef<ept id=\"p1\">**</ept> functionality, leave that.","pos":[7425,7488],"source":" If there is other custom **jumpRef** functionality, leave that."},{"content":"However, <bpt id=\"p1\">**</bpt>jumpRef<ept id=\"p1\">**</ept> is otherwise automatically handled by the control.","pos":[7489,7560],"source":" However, **jumpRef** is otherwise automatically handled by the control."},{"pos":[7566,7572],"content":"Step 3","linkify":"Step 3","nodes":[{"content":"Step 3","pos":[0,6]}]},{"pos":[7579,7586],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[7588,7643],"content":"Override the <bpt id=\"p1\">**</bpt>loadAutoCompleteData()<ept id=\"p1\">**</ept> control method.","source":"Override the **loadAutoCompleteData()** control method."},{"pos":[7827,7838],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"pos":[7840,7885],"content":"Remove the <bpt id=\"p1\">**</bpt>loadAutoCompleteData()<ept id=\"p1\">**</ept> method.","source":"Remove the **loadAutoCompleteData()** method."},{"pos":[7891,7897],"content":"Step 4","linkify":"Step 4","nodes":[{"content":"Step 4","pos":[0,6]}]},{"pos":[7904,7911],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[7913,7960],"content":"Override the <bpt id=\"p1\">**</bpt>loadSegments()<ept id=\"p1\">**</ept> control method.","source":"Override the **loadSegments()** control method."},{"pos":[8159,8170],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"If the <bpt id=\"p1\">**</bpt>loadSegments()<ept id=\"p1\">**</ept> method does nothing except call the controller's <bpt id=\"p2\">**</bpt>loadSegments()<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>parmControl()<ept id=\"p3\">**</ept> methods, remove it.","pos":[8172,8307],"source":"If the **loadSegments()** method does nothing except call the controller's **loadSegments()** and **parmControl()** methods, remove it."},{"content":"However, make a note of the SEC control instance that is passed to the <bpt id=\"p1\">**</bpt>parmControl()<ept id=\"p1\">**</ept> call.","pos":[8308,8402],"source":" However, make a note of the SEC control instance that is passed to the **parmControl()** call."},{"content":"The methods that were being called will now have to be called on that instance.","pos":[8403,8482]},{"pos":[8488,8494],"content":"Step 5","linkify":"Step 5","nodes":[{"content":"Step 5","pos":[0,6]}]},{"pos":[8501,8508],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[8510,8557],"content":"Override the <bpt id=\"p1\">**</bpt>loadSegments()<ept id=\"p1\">**</ept> control method.","source":"Override the **loadSegments()** control method."},{"pos":[9125,9136],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"If the <bpt id=\"p1\">**</bpt>loadSegments()<ept id=\"p1\">**</ept> method was used to set parameters on the controller, the calls to <bpt id=\"p2\">**</bpt>parm<ept id=\"p2\">**</ept> method must be moved to every location where the source of the <bpt id=\"p3\">**</bpt>parm<ept id=\"p3\">**</ept> method can change.","pos":[9138,9329],"source":"If the **loadSegments()** method was used to set parameters on the controller, the calls to **parm** method must be moved to every location where the source of the **parm** method can change."},{"content":"In most cases, these locations are the <bpt id=\"p1\">**</bpt>modified()<ept id=\"p1\">**</ept> method on the corresponding data field and/or the <bpt id=\"p2\">**</bpt>active()<ept id=\"p2\">**</ept> method on the data source.","pos":[9330,9473],"source":" In most cases, these locations are the **modified()** method on the corresponding data field and/or the **active()** method on the data source."},{"content":"For example, some of the migrated code for the <bpt id=\"p1\">**</bpt>loadSegments()<ept id=\"p1\">**</ept> override on the left would look like this.","pos":[9474,9582],"source":" For example, some of the migrated code for the **loadSegments()** override on the left would look like this."},{"content":"Make a note of the SEC control instance that is passed on to the <bpt id=\"p1\">**</bpt>parmControl()<ept id=\"p1\">**</ept> call.","pos":[9649,9737],"source":"Make a note of the SEC control instance that is passed on to the **parmControl()** call."},{"content":"The methods that were being called on the controller will now have to be called on that instance.","pos":[9738,9835]},{"pos":[10070,10104],"content":"<bpt id=\"p1\">**</bpt>LedgerJournalTable data source<ept id=\"p1\">**</ept>","source":"**LedgerJournalTable data source**"},{"pos":[10202,10308],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> After you've moved all the code out of the <bpt id=\"p2\">**</bpt>loadSegments()<ept id=\"p2\">**</ept> method, you can delete the method.","source":"**Note:** After you've moved all the code out of the **loadSegments()** method, you can delete the method."},{"pos":[10314,10320],"content":"Step 6","linkify":"Step 6","nodes":[{"content":"Step 6","pos":[0,6]}]},{"pos":[10327,10334],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"content":"Override the <bpt id=\"p1\">**</bpt>loadSegments()<ept id=\"p1\">**</ept> control method.","pos":[10336,10383],"source":"Override the **loadSegments()** control method."},{"content":"In some cases, the <bpt id=\"p1\">**</bpt>loadSegments()<ept id=\"p1\">**</ept> method might use a table buffer to set parameters on the controller, but that table buffer isn't a data source on the form.","pos":[10384,10545],"source":" In some cases, the **loadSegments()** method might use a table buffer to set parameters on the controller, but that table buffer isn't a data source on the form."},{"content":"For example, on the <bpt id=\"p1\">**</bpt>LedgerJournalTransDaily<ept id=\"p1\">**</ept> form, the original implementation of <bpt id=\"p2\">**</bpt>loadSegments()<ept id=\"p2\">**</ept> looked like this.","pos":[10546,10667],"source":" For example, on the **LedgerJournalTransDaily** form, the original implementation of **loadSegments()** looked like this."},{"pos":[11350,11497],"content":"Note that the <bpt id=\"p1\">**</bpt>JournalName<ept id=\"p1\">**</ept> property is set from the ledgerJournalTable buffer, but the LedgerJournalTable table isn't a data source on the form.","source":"Note that the **JournalName** property is set from the ledgerJournalTable buffer, but the LedgerJournalTable table isn't a data source on the form."},{"pos":[11504,11515],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"In such cases, you can't move that code to either the <bpt id=\"p1\">**</bpt>active()<ept id=\"p1\">**</ept> method of a data source or the <bpt id=\"p2\">**</bpt>modified()<ept id=\"p2\">**</ept> method on the data field.","pos":[11517,11655],"source":"In such cases, you can't move that code to either the **active()** method of a data source or the **modified()** method on the data field."},{"content":"Instead, you should identify where the table buffer is being set.","pos":[11656,11721]},{"content":"For example, in the original implementation of the <bpt id=\"p1\">**</bpt>LedgerJournalTransDaily<ept id=\"p1\">**</ept> form, the ledgerJournalTable buffer was set in the <bpt id=\"p2\">**</bpt>initLedger()<ept id=\"p2\">**</ept> method on the form.","pos":[11722,11888],"source":" For example, in the original implementation of the **LedgerJournalTransDaily** form, the ledgerJournalTable buffer was set in the **initLedger()** method on the form."},{"content":"It should be evident that the value that is passed to <bpt id=\"p1\">**</bpt>parmJournalName()<ept id=\"p1\">**</ept> can change only when the buffer is reassigned in the <bpt id=\"p2\">**</bpt>initLedger()<ept id=\"p2\">**</ept> method.","pos":[11889,12042],"source":" It should be evident that the value that is passed to **parmJournalName()** can change only when the buffer is reassigned in the **initLedger()** method."},{"content":"Therefore, code would have to be moved to the <bpt id=\"p1\">**</bpt>initLedger()<ept id=\"p1\">**</ept> method after the assignment of the buffer.","pos":[12043,12148],"source":" Therefore, code would have to be moved to the **initLedger()** method after the assignment of the buffer."},{"content":"Also, in accordance with the general guidelines, the <bpt id=\"p1\">**</bpt>parmJournalName()<ept id=\"p1\">**</ept> method would be called on the control instance.","pos":[12149,12271],"source":" Also, in accordance with the general guidelines, the **parmJournalName()** method would be called on the control instance."},{"pos":[12941,12947],"content":"Step 7","linkify":"Step 7","nodes":[{"content":"Step 7","pos":[0,6]}]},{"pos":[12954,12961],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[12963,13017],"content":"Override the <bpt id=\"p1\">**</bpt>segmentValueChanged()<ept id=\"p1\">**</ept> control method.","source":"Override the **segmentValueChanged()** control method."},{"pos":[13198,13209],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"pos":[13211,13385],"content":"If the implementation of <bpt id=\"p1\">**</bpt>segmentValueChanged()<ept id=\"p1\">**</ept> does nothing except call <bpt id=\"p2\">**</bpt>super()<ept id=\"p2\">**</ept> and the <bpt id=\"p3\">**</bpt>segmentValueChanged()<ept id=\"p3\">**</ept> method on the controller, you can remove the method.","source":"If the implementation of **segmentValueChanged()** does nothing except call **super()** and the **segmentValueChanged()** method on the controller, you can remove the method."},{"pos":[13391,13397],"content":"Step 8","linkify":"Step 8","nodes":[{"content":"Step 8","pos":[0,6]}]},{"pos":[13404,13411],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[13413,13467],"content":"Override the <bpt id=\"p1\">**</bpt>segmentValueChanged()<ept id=\"p1\">**</ept> control method.","source":"Override the **segmentValueChanged()** control method."},{"pos":[13800,13811],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"pos":[13813,13968],"content":"If the implementation of <bpt id=\"p1\">**</bpt>segmentValueChanged()<ept id=\"p1\">**</ept> has additional logic, you must replace the method with the <bpt id=\"p2\">**</bpt>onSegmentChanged()<ept id=\"p2\">**</ept> method, as shown here.","source":"If the implementation of **segmentValueChanged()** has additional logic, you must replace the method with the **onSegmentChanged()** method, as shown here."},{"pos":[14192,14202],"content":"<bpt id=\"p1\">**</bpt>Notes:<ept id=\"p1\">**</ept>","source":"**Notes:**"},{"pos":[14208,14269],"content":"To add the <bpt id=\"p1\">**</bpt>onSegmentChanged()<ept id=\"p1\">**</ept> method, follow these steps:","source":"To add the **onSegmentChanged()** method, follow these steps:"},{"pos":[14278,14338],"content":"Expand the <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control to add the method to.","source":"Expand the **Segmented Entry** control to add the method to."},{"pos":[14347,14436],"content":"Right-click the <bpt id=\"p1\">**</bpt>Methods<ept id=\"p1\">**</ept> node, and then select <bpt id=\"p2\">**</bpt>Override<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>onSegmentChanged<ept id=\"p3\">**</ept>.","source":"Right-click the **Methods** node, and then select **Override** &gt; **onSegmentChanged**."},{"pos":[14441,14549],"content":"The new method doesn't have to call <bpt id=\"p1\">**</bpt>super()<ept id=\"p1\">**</ept> or any other method on either the control or the controller.","source":"The new method doesn't have to call **super()** or any other method on either the control or the controller."},{"pos":[14555,14561],"content":"Step 9","linkify":"Step 9","nodes":[{"content":"Step 9","pos":[0,6]}]},{"pos":[14568,14575],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[14577,14620],"content":"Override the <bpt id=\"p1\">**</bpt>validate()<ept id=\"p1\">**</ept> control method.","source":"Override the **validate()** control method."},{"pos":[14828,14839],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"Remove the <bpt id=\"p1\">**</bpt>validate()<ept id=\"p1\">**</ept> method, unless you have additional validation.","pos":[14841,14913],"source":"Remove the **validate()** method, unless you have additional validation."},{"content":"The <bpt id=\"p1\">**</bpt>super()<ept id=\"p1\">**</ept> call does everything that this code used to do.","pos":[14914,14977],"source":" The **super()** call does everything that this code used to do."},{"content":"Therefore, keep only any new code that you have.","pos":[14978,15026]},{"pos":[15032,15039],"content":"Step 10","linkify":"Step 10","nodes":[{"content":"Step 10","pos":[0,7]}]},{"pos":[15046,15053],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[15055,15096],"content":"Override the <bpt id=\"p1\">**</bpt>lookup()<ept id=\"p1\">**</ept> control method.","source":"Override the **lookup()** control method."},{"pos":[15909,15920],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"pos":[15922,15961],"content":"Leave the <bpt id=\"p1\">**</bpt>lookup()<ept id=\"p1\">**</ept> method as it is.","source":"Leave the **lookup()** method as it is."},{"pos":[15967,15974],"content":"Step 11","linkify":"Step 11","nodes":[{"content":"Step 11","pos":[0,7]}]},{"pos":[15981,15988],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[15990,16040],"content":"Override the <bpt id=\"p1\">**</bpt>lookupReference()<ept id=\"p1\">**</ept> control method.","source":"Override the **lookupReference()** control method."},{"pos":[16159,16170],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"pos":[16172,16259],"content":"If the <bpt id=\"p1\">**</bpt>lookupReference()<ept id=\"p1\">**</ept> method uses the default implementation, you can delete it.","source":"If the **lookupReference()** method uses the default implementation, you can delete it."},{"pos":[16265,16272],"content":"Step 12","linkify":"Step 12","nodes":[{"content":"Step 12","pos":[0,7]}]},{"pos":[16279,16286],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[16288,16331],"content":"Override the <bpt id=\"p1\">**</bpt>modified()<ept id=\"p1\">**</ept> control method.","source":"Override the **modified()** control method."},{"pos":[16899,16910],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"pos":[16912,16953],"content":"Leave the <bpt id=\"p1\">**</bpt>modified()<ept id=\"p1\">**</ept> method as it is.","source":"Leave the **modified()** method as it is."},{"pos":[16959,16966],"content":"Step 13","linkify":"Step 13","nodes":[{"content":"Step 13","pos":[0,7]}]},{"pos":[16973,16980],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[16982,17025],"content":"Override the <bpt id=\"p1\">**</bpt>gotFocus()<ept id=\"p1\">**</ept> control method.","source":"Override the **gotFocus()** control method."},{"pos":[17424,17435],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"The approach is similar to the approach for the <bpt id=\"p1\">**</bpt>loadSegments()<ept id=\"p1\">**</ept> method.","pos":[17437,17511],"source":"The approach is similar to the approach for the **loadSegments()** method."},{"content":"The code must be moved to every location where the source of the <bpt id=\"p1\">**</bpt>parm<ept id=\"p1\">**</ept> method can change.","pos":[17512,17604],"source":" The code must be moved to every location where the source of the **parm** method can change."},{"content":"In most cases, these locations are the <bpt id=\"p1\">**</bpt>modified()<ept id=\"p1\">**</ept> method on the corresponding data field and/or the <bpt id=\"p2\">**</bpt>active()<ept id=\"p2\">**</ept> method on the data source.","pos":[17605,17748],"source":" In most cases, these locations are the **modified()** method on the corresponding data field and/or the **active()** method on the data source."},{"content":"For example, for the preceding code, the migrated code would look like this.","pos":[17749,17825]},{"pos":[19556,19660],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> After all the code has been moved out of the <bpt id=\"p2\">**</bpt>gotFocus()<ept id=\"p2\">**</ept> method, you can delete the method.","source":"**Note:** After all the code has been moved out of the **gotFocus()** method, you can delete the method."},{"pos":[19666,19673],"content":"Step 14","linkify":"Step 14","nodes":[{"content":"Step 14","pos":[0,7]}]},{"pos":[19680,19687],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[19689,19719],"content":"In the form <bpt id=\"p1\">**</bpt>init()<ept id=\"p1\">**</ept> method:","source":"In the form **init()** method:"},{"pos":[19895,19906],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"Set the following properties on the control:","pos":[19908,19952]},{"pos":[19958,19973],"content":"<bpt id=\"p1\">**</bpt>Data Source<ept id=\"p1\">**</ept>","source":"**Data Source**"},{"pos":[19978,19997],"content":"<bpt id=\"p1\">**</bpt>Reference Field<ept id=\"p1\">**</ept>","source":"**Reference Field**"},{"pos":[20002,20022],"content":"<bpt id=\"p1\">**</bpt>Controller Class<ept id=\"p1\">**</ept>","source":"**Controller Class**"},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>SegmentMigrate04<ept id=\"p1\">](./media/segmentmigrate04.png)](./media/segmentmigrate04.png)</ept> <bpt id=\"p2\">[</bpt><ph id=\"ph2\">![</ph>SegmentMigrate05<ept id=\"p2\">](./media/segmentmigrate05.png)](./media/segmentmigrate05.png)</ept> <bpt id=\"p3\">**</bpt>Note:<ept id=\"p3\">**</ept> A controller class is required for the control to work.","pos":[20024,20253],"source":"[![SegmentMigrate04](./media/segmentmigrate04.png)](./media/segmentmigrate04.png) [![SegmentMigrate05](./media/segmentmigrate05.png)](./media/segmentmigrate05.png) **Note:** A controller class is required for the control to work."},{"content":"Therefore, a run-time error will be thrown if the <bpt id=\"p1\">**</bpt>Controller Class<ept id=\"p1\">**</ept> property isn't set.","pos":[20254,20344],"source":" Therefore, a run-time error will be thrown if the **Controller Class** property isn't set."},{"pos":[20350,20357],"content":"Step 15","linkify":"Step 15","nodes":[{"content":"Step 15","pos":[0,7]}]},{"pos":[20364,20371],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[20471,20482],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"pos":[20484,20629],"content":"A map of the dimension specifiers must be created that can then be sent into the <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control's <bpt id=\"p2\">**</bpt>setDimensionSpecifiers<ept id=\"p2\">**</ept> method.","source":"A map of the dimension specifiers must be created that can then be sent into the **Segmented Entry** control's **setDimensionSpecifiers** method."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> You can add anything to the dimension specifiers map before it's sent to the control.","pos":[20875,20970],"source":"**Note:** You can add anything to the dimension specifiers map before it's sent to the control."},{"content":"You can also create a new map here.","pos":[20971,21006]},{"content":"(See the <bpt id=\"p1\">**</bpt>onSegmentChangedForPrimaryAccount<ept id=\"p1\">**</ept> method in the <bpt id=\"p2\">**</bpt>LedgerJournalEngine<ept id=\"p2\">**</ept> class for similar logic.)","pos":[21007,21117],"source":" (See the **onSegmentChangedForPrimaryAccount** method in the **LedgerJournalEngine** class for similar logic.)"},{"pos":[21123,21130],"content":"Step 16","linkify":"Step 16","nodes":[{"content":"Step 16","pos":[0,7]}]},{"pos":[21137,21144],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[21146,21297],"content":"<bpt id=\"p1\">**</bpt>parmControl()<ept id=\"p1\">**</ept> method calls: (These are typically present in the form's <bpt id=\"p2\">**</bpt>init()<ept id=\"p2\">**</ept> method or one of the methods that are overridden on the control.)","source":"**parmControl()** method calls: (These are typically present in the form's **init()** method or one of the methods that are overridden on the control.)"},{"pos":[21379,21390],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"Remove this line of code, because it's no longer required.","pos":[21392,21450]},{"content":"However, first make a note of which controller is used with which control.","pos":[21451,21525]},{"content":"For example, in this case, ledgerDimensionDefaultAccoutnController is being used with the ClearningAccount SEC.","pos":[21526,21637]},{"content":"A mapping is required when you replace method calls on controller objects with corresponding method calls on the control, and when you set the properties at design time.","pos":[21638,21807]},{"pos":[21813,21820],"content":"Step 17","linkify":"Step 17","nodes":[{"content":"Step 17","pos":[0,7]}]},{"pos":[21827,21834],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[21836,21866],"content":"In the form <bpt id=\"p1\">**</bpt>init()<ept id=\"p1\">**</ept> method:","source":"In the form **init()** method:"},{"pos":[21982,21993],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"This is the <bpt id=\"p1\">**</bpt>Posting Type<ept id=\"p1\">**</ept> property on the control.","pos":[21995,22048],"source":"This is the **Posting Type** property on the control."},{"content":"The control that the <bpt id=\"p1\">**</bpt>PostingType<ept id=\"p1\">**</ept> property must be set on can be determined from the mapping details that are derived by looking at the <bpt id=\"p2\">**</bpt>parmControl()<ept id=\"p2\">**</ept> call.","pos":[22049,22211],"source":" The control that the **PostingType** property must be set on can be determined from the mapping details that are derived by looking at the **parmControl()** call."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>SegmentMigrate06<ept id=\"p1\">](./media/segmentmigrate06.png)](./media/segmentmigrate06.png)</ept> These properties can also be set in code, through corresponding <bpt id=\"p2\">**</bpt>parm<ept id=\"p2\">**</ept> methods on the control instance.","pos":[22212,22399],"source":"[![SegmentMigrate06](./media/segmentmigrate06.png)](./media/segmentmigrate06.png) These properties can also be set in code, through corresponding **parm** methods on the control instance."},{"content":"Here's an example.","pos":[22400,22418]},{"pos":[22497,22504],"content":"Step 18","linkify":"Step 18","nodes":[{"content":"Step 18","pos":[0,7]}]},{"pos":[22511,22518],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"content":"Override <bpt id=\"p1\">**</bpt>resolveReference()<ept id=\"p1\">**</ept> in the data source field for the ledger dimension.","pos":[22520,22602],"source":"Override **resolveReference()** in the data source field for the ledger dimension."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>SegmentMigrate07<ept id=\"p1\">](./media/segmentmigrate07.png)](./media/segmentmigrate07.png)</ept>","pos":[22603,22684],"source":"[![SegmentMigrate07](./media/segmentmigrate07.png)](./media/segmentmigrate07.png)"},{"pos":[22691,22702],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"Delete this code, because it's no longer required.","pos":[22704,22754]},{"content":"The control handles this automatically.","pos":[22755,22794]},{"pos":[22800,22807],"content":"Step 19","linkify":"Step 19","nodes":[{"content":"Step 19","pos":[0,7]}]},{"pos":[22814,22821],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[22823,22891],"content":"The form sets properties on the controller through <bpt id=\"p1\">**</bpt>parm<ept id=\"p1\">**</ept> methods.","source":"The form sets properties on the controller through **parm** methods."},{"pos":[22898,22909],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"In general, any property that was previously set on the controller class should now be set directly on the control.","pos":[22911,23026]},{"content":"The control that the property must be set on can be determined from the mapping details that are derived by looking at the <bpt id=\"p1\">**</bpt>parmControl()<ept id=\"p1\">**</ept> call.","pos":[23027,23173],"source":" The control that the property must be set on can be determined from the mapping details that are derived by looking at the **parmControl()** call."},{"content":"Additionally, for the <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control, any property that is available in the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> dialog box in Microsoft Visual Studio can also be set in code, through the corresponding <bpt id=\"p3\">**</bpt>parm<ept id=\"p3\">**</ept> method on the control instance.","pos":[23174,23407],"source":" Additionally, for the **Segmented Entry** control, any property that is available in the **Properties** dialog box in Microsoft Visual Studio can also be set in code, through the corresponding **parm** method on the control instance."},{"pos":[23413,23420],"content":"Step 20","linkify":"Step 20","nodes":[{"content":"Step 20","pos":[0,7]}]},{"pos":[23427,23434],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[23436,23497],"content":"The form uses the control's <bpt id=\"p1\">**</bpt>currentSegmentIndex()<ept id=\"p1\">**</ept> method.","source":"The form uses the control's **currentSegmentIndex()** method."},{"pos":[23592,23603],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"In general, any property that was previously set on the controller class should now be set directly on the control.","pos":[23605,23720]},{"content":"The control that the property must be set on can be determined from the mapping details that are derived by looking at the <bpt id=\"p1\">**</bpt>parmControl()<ept id=\"p1\">**</ept> call.","pos":[23721,23867],"source":" The control that the property must be set on can be determined from the mapping details that are derived by looking at the **parmControl()** call."},{"content":"Additionally, for the <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control, any property that is available in the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> dialog box in Visual Studio can also be set in code, through the corresponding <bpt id=\"p3\">**</bpt>parm<ept id=\"p3\">**</ept> method on the control instance.","pos":[23868,24091],"source":" Additionally, for the **Segmented Entry** control, any property that is available in the **Properties** dialog box in Visual Studio can also be set in code, through the corresponding **parm** method on the control instance."},{"pos":[24097,24104],"content":"Step 21","linkify":"Step 21","nodes":[{"content":"Step 21","pos":[0,7]}]},{"pos":[24111,24118],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"content":"The form calls methods on the controller object.","pos":[24120,24168]},{"content":"Here's an example.","pos":[24169,24187]},{"pos":[24282,24293],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"All method calls on the controller must be replaced with method calls on the control.","pos":[24295,24380]},{"content":"For this example, use the <bpt id=\"p1\">**</bpt>getDimensionAttributeByControlIndex()<ept id=\"p1\">**</ept> method on the control instead.","pos":[24381,24479],"source":" For this example, use the **getDimensionAttributeByControlIndex()** method on the control instead."},{"pos":[24552,24559],"content":"Step 22","linkify":"Step 22","nodes":[{"content":"Step 22","pos":[0,7]}]},{"pos":[24566,24573],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[24575,24672],"content":"For <bpt id=\"p1\">**</bpt>DimensionDynamicAccountController<ept id=\"p1\">**</ept>, the account type is specified through the constructor.","source":"For **DimensionDynamicAccountController**, the account type is specified through the constructor."},{"pos":[24843,24854],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"There are two methods for implementing this functionality.","pos":[24856,24914]},{"content":"These methods are mutually exclusive, so use only one of them, depending on the situation:","pos":[24915,25005]},{"content":"For the <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control, in the <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept> dialog box, set the <bpt id=\"p3\">**</bpt>Account Type Field<ept id=\"p3\">**</ept> property to the data source field that will provide the account type.","pos":[25011,25182],"source":"For the **Segmented Entry** control, in the **Properties** dialog box, set the **Account Type Field** property to the data source field that will provide the account type."},{"content":"This is the preferred method.","pos":[25183,25212]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> If the <bpt id=\"p2\">**</bpt>super()<ept id=\"p2\">**</ept> call has been removed from the <bpt id=\"p3\">**</bpt>modified()<ept id=\"p3\">**</ept> method for the field that is bound to the <bpt id=\"p4\">**</bpt>Account Type Field<ept id=\"p4\">**</ept> property, this method won't work.","pos":[25213,25386],"source":"**Note:** If the **super()** call has been removed from the **modified()** method for the field that is bound to the **Account Type Field** property, this method won't work."},{"content":"We have seen this issue in some journal forms, such as <bpt id=\"p1\">**</bpt>LedgerJournalTransDaily<ept id=\"p1\">**</ept>.","pos":[25387,25470],"source":" We have seen this issue in some journal forms, such as **LedgerJournalTransDaily**."},{"content":"In such cases, either add the <bpt id=\"p1\">**</bpt>super()<ept id=\"p1\">**</ept> call back to the <bpt id=\"p2\">**</bpt>modified()<ept id=\"p2\">**</ept> method, or use the second method.","pos":[25471,25578],"source":" In such cases, either add the **super()** call back to the **modified()** method, or use the second method."},{"content":"Set the account type manually by calling the <bpt id=\"p1\">**</bpt>parmAccountTypeEnumValue()<ept id=\"p1\">**</ept> method on the control.","pos":[25583,25681],"source":"Set the account type manually by calling the **parmAccountTypeEnumValue()** method on the control."},{"content":"Here's an example.","pos":[25682,25700]},{"pos":[25813,26002],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> The call to <bpt id=\"p2\">**</bpt>parmAccountTypeEnumValue()<ept id=\"p2\">**</ept> must be put in both the data source's <bpt id=\"p3\">**</bpt>active()<ept id=\"p3\">**</ept> method and the <bpt id=\"p4\">**</bpt>modified()<ept id=\"p4\">**</ept> method of the field that will provide the account type.","source":"**Note:** The call to **parmAccountTypeEnumValue()** must be put in both the data source's **active()** method and the **modified()** method of the field that will provide the account type."},{"pos":[26008,26015],"content":"Step 23","linkify":"Step 23","nodes":[{"content":"Step 23","pos":[0,7]}]},{"pos":[26022,26029],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"content":"The form has a variable that is defined.","pos":[26031,26071]},{"pos":[26164,26175],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"Remove this, because the controller is no longer required.","pos":[26177,26235]},{"pos":[26241,26248],"content":"Step 24","linkify":"Step 24","nodes":[{"content":"Step 24","pos":[0,7]}]},{"pos":[26255,26262],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[26264,26424],"content":"<bpt id=\"p1\">**</bpt>parmCurrentLedgerCOA()<ept id=\"p1\">**</ept> method calls: (These are typically present in the form's <bpt id=\"p2\">**</bpt>init()<ept id=\"p2\">**</ept> method or one of the methods that are overridden on the control.)","source":"**parmCurrentLedgerCOA()** method calls: (These are typically present in the form's **init()** method or one of the methods that are overridden on the control.)"},{"pos":[26520,26531],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"Remove this line of code, because it's no longer required in most cases.","pos":[26533,26605]},{"content":"Before you delete this line, make sure that the data area ID is correctly passed in to the controller as a parameter, because the <bpt id=\"p1\">**</bpt>LedgerCOA<ept id=\"p1\">**</ept> value will be derived from that information.","pos":[26606,26794],"source":" Before you delete this line, make sure that the data area ID is correctly passed in to the controller as a parameter, because the **LedgerCOA** value will be derived from that information."},{"content":"If the data area ID is not passed in, replace <bpt id=\"p1\">**</bpt>parmCurrentLedgerCOA(â€¦)<ept id=\"p1\">**</ept> with <bpt id=\"p2\">**</bpt>parmDataAreaId(â€¦)<ept id=\"p2\">**</ept>, and pass the appropriate <bpt id=\"p3\">**</bpt>SelectableDataArea<ept id=\"p3\">**</ept> value, which is usually <bpt id=\"p4\">**</bpt>curext()<ept id=\"p4\">**</ept> or another table field that controls the scope of the company for the account control.","pos":[26795,27072],"source":" If the data area ID is not passed in, replace **parmCurrentLedgerCOA(â€¦)** with **parmDataAreaId(â€¦)**, and pass the appropriate **SelectableDataArea** value, which is usually **curext()** or another table field that controls the scope of the company for the account control."},{"content":"If the form has no data area context but only a current <bpt id=\"p1\">**</bpt>LedgerCOA<ept id=\"p1\">**</ept> value, it should be working only with the default account controller.","pos":[27073,27212],"source":" If the form has no data area context but only a current **LedgerCOA** value, it should be working only with the default account controller."},{"content":"There are only a few forms that are agnostic of a company, but that are scoped to a specific chart of accounts (COA) (for example, <bpt id=\"p1\">**</bpt>MainAccount<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Allocations<ept id=\"p2\">**</ept>).","pos":[27213,27381],"source":" There are only a few forms that are agnostic of a company, but that are scoped to a specific chart of accounts (COA) (for example, **MainAccount** and **Allocations**)."},{"content":"In these cases, <bpt id=\"p1\">**</bpt>parmCurrentLedgerCOA<ept id=\"p1\">**</ept> should be called on the <bpt id=\"p2\">**</bpt>Segmented Entry<ept id=\"p2\">**</ept> control instance that has a default account controller type set.","pos":[27382,27531],"source":" In these cases, **parmCurrentLedgerCOA** should be called on the **Segmented Entry** control instance that has a default account controller type set."},{"pos":[27537,27544],"content":"Step 25","linkify":"Step 25","nodes":[{"content":"Step 25","pos":[0,7]}]},{"pos":[27551,27558],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[27560,27613],"content":"<bpt id=\"p1\">**</bpt>parmIncludeFinancialAccounts(NoYes)<ept id=\"p1\">**</ept> method calls:","source":"**parmIncludeFinancialAccounts(NoYes)** method calls:"},{"pos":[27707,27718],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"This line of code is no longer required and should be set directly via a property on the <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control.","pos":[27720,27837],"source":"This line of code is no longer required and should be set directly via a property on the **Segmented Entry** control."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Because of a framework bug, if you don't setting this explicitly, <bpt id=\"p2\">**</bpt>No<ept id=\"p2\">**</ept> will be assigned on a ledger dimension default account controller, whereas the previous behavior was to implicitly assign <bpt id=\"p3\">**</bpt>Yes<ept id=\"p3\">**</ept> during construction.","pos":[27838,28071],"source":"**Note:** Because of a framework bug, if you don't setting this explicitly, **No** will be assigned on a ledger dimension default account controller, whereas the previous behavior was to implicitly assign **Yes** during construction."},{"content":"You must set this manually as a property.","pos":[28072,28113]},{"content":"Alternatively, for a <bpt id=\"p1\">**</bpt>dialog<ept id=\"p1\">**</ept> class, the <bpt id=\"p2\">**</bpt>parm<ept id=\"p2\">**</ept> method should still be explicitly called.","pos":[28114,28207],"source":" Alternatively, for a **dialog** class, the **parm** method should still be explicitly called."},{"pos":[28213,28220],"content":"Step 26","linkify":"Step 26","nodes":[{"content":"Step 26","pos":[0,7]}]},{"pos":[28227,28234],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[28236,28433],"content":"The code for the <bpt id=\"p1\">**</bpt>modified<ept id=\"p1\">**</ept> method of the data field that provides the account type for the <bpt id=\"p2\">**</bpt>Segmented Entry<ept id=\"p2\">**</ept> control might look like this when the control is used as a dynamic account control.","source":"The code for the **modified** method of the data field that provides the account type for the **Segmented Entry** control might look like this when the control is used as a dynamic account control."},{"pos":[28785,28796],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"The <bpt id=\"p1\">**</bpt>modified<ept id=\"p1\">**</ept> method of this data field must now clear the ledger dimension field that is bound to the <bpt id=\"p2\">**</bpt>Segmented Entry<ept id=\"p2\">**</ept> control as a <bpt id=\"p3\">**</bpt>Reference<ept id=\"p3\">**</ept> field.","pos":[28798,28957],"source":"The **modified** method of this data field must now clear the ledger dimension field that is bound to the **Segmented Entry** control as a **Reference** field."},{"content":"For example, if the name of the <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control is <bpt id=\"p2\">**</bpt>OffsetAccount<ept id=\"p2\">**</ept>, and the <bpt id=\"p3\">**</bpt>Reference<ept id=\"p3\">**</ept> field property for this control is set to <bpt id=\"p4\">**</bpt>LedgerDimension<ept id=\"p4\">**</ept>, the <bpt id=\"p5\">**</bpt>modified<ept id=\"p5\">**</ept> method in the preceding code should be changed as follows.","pos":[28958,29200],"source":" For example, if the name of the **Segmented Entry** control is **OffsetAccount**, and the **Reference** field property for this control is set to **LedgerDimension**, the **modified** method in the preceding code should be changed as follows."},{"content":"The additional line is required to clear the control when the account type is changed.","pos":[29594,29680]},{"pos":[29686,29693],"content":"Step 27","linkify":"Step 27","nodes":[{"content":"Step 27","pos":[0,7]}]},{"pos":[29700,29707],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[29709,29778],"content":"You can call the <bpt id=\"p1\">**</bpt>parmAccountStructure()<ept id=\"p1\">**</ept> method on the controller.","source":"You can call the **parmAccountStructure()** method on the controller."},{"pos":[29883,29894],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"This method is replaced by two different methods.","pos":[29896,29945]},{"content":"Additionally, the purpose of the new methods is the opposite of the old method: the old method turned validation off, whereas the new methods turn it on.","pos":[29946,30099]},{"content":"Therefore, when you migrate code, you must reverse the Boolean parameter for the new methods.","pos":[30100,30193]},{"content":"For example, for the method call in the preceding code, the new methods would look like this.","pos":[30194,30287]},{"pos":[30463,30470],"content":"Step 28","linkify":"Step 28","nodes":[{"content":"Step 28","pos":[0,7]}]},{"pos":[30477,30484],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[30486,30555],"content":"You can call the <bpt id=\"p1\">**</bpt>parmAccountStructure()<ept id=\"p1\">**</ept> method on the controller:","source":"You can call the **parmAccountStructure()** method on the controller:"},{"pos":[30660,30671],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"The <bpt id=\"p1\">**</bpt>parmAccountStructureId()<ept id=\"p1\">**</ept> method doesn't exist on the control.","pos":[30673,30742],"source":"The **parmAccountStructureId()** method doesn't exist on the control."},{"content":"Instead, separate <bpt id=\"p1\">**</bpt>getAccountStructure()<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>setAccountStructure()<ept id=\"p2\">**</ept> methods exist.","pos":[30743,30831],"source":" Instead, separate **getAccountStructure()** and **setAccountStructure()** methods exist."},{"content":"Therefore, the <bpt id=\"p1\">**</bpt>parmAccountStructureId()<ept id=\"p1\">**</ept> call must be replaced by the <bpt id=\"p2\">**</bpt>get<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>set<ept id=\"p3\">**</ept> method, depending on how the <bpt id=\"p4\">**</bpt>parm<ept id=\"p4\">**</ept> method was used.","pos":[30832,30978],"source":" Therefore, the **parmAccountStructureId()** call must be replaced by the **get** or **set** method, depending on how the **parm** method was used."},{"content":"For example, the <bpt id=\"p1\">**</bpt>parm<ept id=\"p1\">**</ept> method in the preceding code was called as a setter, so the call should be replaced by a call to the <bpt id=\"p2\">**</bpt>set<ept id=\"p2\">**</ept> method.","pos":[30979,31121],"source":" For example, the **parm** method in the preceding code was called as a setter, so the call should be replaced by a call to the **set** method."},{"pos":[31228,31235],"content":"Step 29","linkify":"Step 29","nodes":[{"content":"Step 29","pos":[0,7]}]},{"pos":[31242,31249],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[31303,31314],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"This method is replaced by two different methods.","pos":[31316,31365]},{"content":"Additionally, the purpose of the new methods is opposite of the old method: the old method turned validation off, whereas the new methods turn it on.","pos":[31366,31515]},{"content":"Therefore, when you migrate code, you must reverse the Boolean parameter for the new methods.","pos":[31516,31609]},{"content":"For example, for the method call in the preceding code, the new methods would look like this.","pos":[31610,31703]},{"pos":[31879,31886],"content":"Step 30","linkify":"Step 30","nodes":[{"content":"Step 30","pos":[0,7]}]},{"pos":[31893,31900],"content":"AX 2012","linkify":"AX 2012","nodes":[{"content":"AX 2012","pos":[0,7]}]},{"pos":[31902,31995],"content":"Typically, call the <bpt id=\"p1\">**</bpt>loadFromId<ept id=\"p1\">**</ept> method on the controller in the <bpt id=\"p2\">**</bpt>loadSegments()<ept id=\"p2\">**</ept> method.","source":"Typically, call the **loadFromId** method on the controller in the **loadSegments()** method."},{"pos":[32126,32137],"content":"Dynamics AX","linkify":"Dynamics AX","nodes":[{"content":"Dynamics AX","pos":[0,11]}]},{"content":"This method has been deprecated and must not be used.","pos":[32139,32192]},{"content":"You should delete all calls to this method.","pos":[32193,32236]},{"pos":[32242,32289],"content":"Migrating a Segmented Entry control on a dialog","linkify":"Migrating a Segmented Entry control on a dialog","nodes":[{"content":"Migrating a Segmented Entry control on a dialog","pos":[0,47]}]},{"content":"The uptake pattern for the new <bpt id=\"p1\">**</bpt>Segmented Entry<ept id=\"p1\">**</ept> control on a dialog has changed in Dynamics AX.","pos":[32291,32389],"source":"The uptake pattern for the new **Segmented Entry** control on a dialog has changed in Dynamics AX."},{"content":"Instead of interacting with the controller class API, you must now interact with the <bpt id=\"p1\">**</bpt>SegmentedEntryControlBuild<ept id=\"p1\">**</ept> class to link the SEC with the dialog.","pos":[32390,32544],"source":" Instead of interacting with the controller class API, you must now interact with the **SegmentedEntryControlBuild** class to link the SEC with the dialog."},{"content":"This section shows the code patterns for using SEC on a dialog with different controller types.","pos":[32545,32640]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Help text is no longer required in Dynamics AX, so you don't have to set the Help text on dialog fields.","pos":[32641,32755],"source":"**Note:** Help text is no longer required in Dynamics AX, so you don't have to set the Help text on dialog fields."},{"pos":[32761,32781],"content":"<bpt id=\"p1\">**</bpt>Dynamic account:<ept id=\"p1\">**</ept>","source":"**Dynamic account:**"},{"pos":[32790,32801],"content":"<bpt id=\"p1\">**</bpt>Before:<ept id=\"p1\">**</ept>","source":"**Before:**"},{"pos":[34148,34158],"content":"<bpt id=\"p1\">**</bpt>After:<ept id=\"p1\">**</ept>","source":"**After:**"},{"pos":[36549,36568],"content":"<bpt id=\"p1\">**</bpt>Ledger account:<ept id=\"p1\">**</ept>","source":"**Ledger account:**"},{"pos":[36577,36588],"content":"<bpt id=\"p1\">**</bpt>Before:<ept id=\"p1\">**</ept>","source":"**Before:**"},{"pos":[36873,36883],"content":"<bpt id=\"p1\">**</bpt>After:<ept id=\"p1\">**</ept>","source":"**After:**"},{"pos":[37101,37121],"content":"<bpt id=\"p1\">**</bpt>Default account:<ept id=\"p1\">**</ept>","source":"**Default account:**"},{"pos":[37130,37141],"content":"<bpt id=\"p1\">**</bpt>Before:<ept id=\"p1\">**</ept>","source":"**Before:**"},{"pos":[37474,37484],"content":"<bpt id=\"p1\">**</bpt>After:<ept id=\"p1\">**</ept>","source":"**After:**"},{"pos":[37725,37736],"content":"<bpt id=\"p1\">**</bpt>Budget:<ept id=\"p1\">**</ept>","source":"**Budget:**"},{"pos":[37745,37902],"content":"<bpt id=\"p1\">**</bpt>Before:<ept id=\"p1\">**</ept> No uptake of the <bpt id=\"p2\">**</bpt>Budget<ept id=\"p2\">**</ept> controller (<bpt id=\"p3\">**</bpt>BudgetLedgerDimensionController<ept id=\"p3\">**</ept>) for a dialog scenario was found in the existing program source code.","source":"**Before:** No uptake of the **Budget** controller (**BudgetLedgerDimensionController**) for a dialog scenario was found in the existing program source code."},{"pos":[37911,37921],"content":"<bpt id=\"p1\">**</bpt>After:<ept id=\"p1\">**</ept>","source":"**After:**"},{"pos":[38129,38139],"content":"<bpt id=\"p1\">**</bpt>Notes:<ept id=\"p1\">**</ept>","source":"**Notes:**"},{"pos":[38148,38259],"content":"The new API lets you specify the label (<bpt id=\"p1\">**</bpt>Budget<ept id=\"p1\">**</ept> in the preceding example) while you set up the dialog field.","source":"The new API lets you specify the label (**Budget** in the preceding example) while you set up the dialog field."},{"pos":[38268,38358],"content":"The default value for the control is specified via the <bpt id=\"p1\">**</bpt>ledgerDimensionBudget<ept id=\"p1\">**</ept> variable.","source":"The default value for the control is specified via the **ledgerDimensionBudget** variable."},{"content":"You must specify the account structure that should be used with the <bpt id=\"p1\">**</bpt>Budget<ept id=\"p1\">**</ept> controller.","pos":[38367,38457],"source":"You must specify the account structure that should be used with the **Budget** controller."},{"content":"The <bpt id=\"p1\">**</bpt>Dialog<ept id=\"p1\">**</ept> class must implement a way for the user to select the account structure (outside of the SEC) and set the selected account structure on the SEC.","pos":[38458,38616],"source":" The **Dialog** class must implement a way for the user to select the account structure (outside of the SEC) and set the selected account structure on the SEC."},{"pos":[38621,38641],"content":"<bpt id=\"p1\">**</bpt>Budget planning:<ept id=\"p1\">**</ept>","source":"**Budget planning:**"},{"pos":[38650,38824],"content":"<bpt id=\"p1\">**</bpt>Before:<ept id=\"p1\">**</ept> No uptake of the <bpt id=\"p2\">**</bpt>Budget planning<ept id=\"p2\">**</ept> controller (<bpt id=\"p3\">**</bpt>BudgetPlanningLedgerDimensionController<ept id=\"p3\">**</ept>) for a dialog scenario was found in the existing program source code.","source":"**Before:** No uptake of the **Budget planning** controller (**BudgetPlanningLedgerDimensionController**) for a dialog scenario was found in the existing program source code."},{"pos":[38833,38843],"content":"<bpt id=\"p1\">**</bpt>After:<ept id=\"p1\">**</ept>","source":"**After:**"},{"pos":[39092,39102],"content":"<bpt id=\"p1\">**</bpt>Notes:<ept id=\"p1\">**</ept>","source":"**Notes:**"},{"pos":[39111,39231],"content":"The new API lets you specify the label (<bpt id=\"p1\">**</bpt>Budget planning<ept id=\"p1\">**</ept> in the preceding example) while you set up the dialog field.","source":"The new API lets you specify the label (**Budget planning** in the preceding example) while you set up the dialog field."},{"pos":[39240,39338],"content":"The default value for the control is specified via the <bpt id=\"p1\">**</bpt>ledgerDimensionBudgetPlanning<ept id=\"p1\">**</ept> variable.","source":"The default value for the control is specified via the **ledgerDimensionBudgetPlanning** variable."},{"content":"You must specify the account structure that should be used with the <bpt id=\"p1\">**</bpt>Budget planning<ept id=\"p1\">**</ept> controller.","pos":[39347,39446],"source":"You must specify the account structure that should be used with the **Budget planning** controller."},{"content":"The <bpt id=\"p1\">**</bpt>Dialog<ept id=\"p1\">**</ept> class must implement a way for the user to select the account structure (outside of the SEC) and set the selected account structure on the SEC.","pos":[39447,39605],"source":" The **Dialog** class must implement a way for the user to select the account structure (outside of the SEC) and set the selected account structure on the SEC."},{"pos":[39608,39616],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[39627,39710],"content":"<bpt id=\"p1\">[</bpt>Segmented Entry control dialog support<ept id=\"p1\">](https://ax.help.dynamics.com/en/?p=145221)</ept>","source":"[Segmented Entry control dialog support](https://ax.help.dynamics.com/en/?p=145221)"},{"pos":[39712,39803],"content":"<bpt id=\"p1\">[</bpt>Segmented Entry control Metadata Specification<ept id=\"p1\">](https://ax.help.dynamics.com/en/?p=145441)</ept>","source":"[Segmented Entry control Metadata Specification](https://ax.help.dynamics.com/en/?p=145441)"},{"pos":[39805,39899],"content":"<bpt id=\"p1\">[</bpt>Segmented Entry control Parm method Specification<ept id=\"p1\">](https://ax.help.dynamics.com/en/?p=154321)</ept>","source":"[Segmented Entry control Parm method Specification](https://ax.help.dynamics.com/en/?p=154321)"},{"pos":[39901,39991],"content":"<bpt id=\"p1\">[</bpt>Segmented Entry control migration walkthrough<ept id=\"p1\">](https://ax.help.dynamics.com/en/?p=118381)</ept>","source":"[Segmented Entry control migration walkthrough](https://ax.help.dynamics.com/en/?p=118381)"}],"content":"---\n# required metadata\n\ntitle: Segmented entry control migration guidance\ndescription: This article guides you through the process of migrating a Segmented Entry control from the Microsoft Dynamics AX 2012 pattern to the new pattern in Microsoft Dynamics AX.\nauthor: twheeloc\nmanager: AnnBe\nms.date: 2015-12-12 20 - 45 - 57\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: annbe\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 25651\nms.assetid: f43c4c6f-c7e8-4bf7-99a5-fbb02c4aa6d5\nms.search.region: Global\n# ms.search.industry: \nms.author: ghenriks\nms.dyn365.ops.intro: Feb-16\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Segmented entry control migration guidance\n\nThis article guides you through the process of migrating a Segmented Entry control from the Microsoft Dynamics AX 2012 pattern to the new pattern in Microsoft Dynamics AX.\n\nThe goal of the new design is to encapsulate the control implementation and not require that forms interact with the classes that back the control. Therefore, in Microsoft Dynamics AX, *all forms should interact only with the application programming interface (API) of the **Segmented Entry** control instance*. They should not interact directly with the controller classes (such as **LedgerDimensionAccountController** and **DimensionDynamicAccountController**). Any property that was previously manipulated or called on the controller must now be called on the control. **Notes:**\n\n-   Some APIs have naming differences between the controller and the control. The following table lists these APIs.\n    **Controller Method (old)**\n    **Control Method (new)**\n    parmDate\n    parmControlDate\n    parmFilterLedgerPostingType\n    parmPostingType\n    parmDimensionAccountStorageUsage\n    parmDimensionAccountStorageUsageType\n-   **Example**\n    -   **Before:** controller.parmDate(systemDateGet())\n    -   **After:** LedgerAccount.parmControlDate(systemDateGet());\n\n    In this example, **controller** &gt; **LedgerDimensionAccountController** instance and **LedgerAccount** &gt; new **Segmented Entry** control instance\n-   In methods that have been overridden on controls and data fields, the code upgrade rule replaces method calls on the controllers with method calls on each control instance that was using a particular controller. **Example**\n    -   **Before:**\n\n            Public void jumpRef()\n            {\n                ledgerDimensionDefaultAccountcontroller.jumpRef();\n            }\n\n    -   **After:**\n\n            Public void jumpRef()\n            {\n                segmentedEntryControl1.jumpRef();\n                segmentedEntryControl2.jumpRef();\n            }\n\n    These changes are made so that it's easier to copy and paste code that must be moved elsewhere (for example, in some instances of **loadSegments()** and other such methods). You can ignore this change when you decide whether the method can be deleted. Your decision should depend on whether the method has any custom logic.\n-   The code upgrade script does not handle cases where a controller is instantiated within a method. These cases must be migrated manually.\n-   The MRU functionality from Microsoft Dynamics AX 2012 has been removed in Dynamics AX and won't be replaced.\n-   **parmTaxCode** has been removed. There is no replacement.\n\n## Properties\nThe custom properties for the **Segmented Entry** control are found under **Controller**. The following screen shot shows an example. [![111](./media/111.png)](./media/111.png) Not all properties apply to all **Controller** class types. Properties that don't apply to a selected controller class will be disabled. The following table provides details about the properties.\n\n**Property**\n\n**Valid Values**\n\n**Usage**\n\nAccount Type Field\n\nA field from the datasource.\n\nDetermines the type of account used. Typically utilized for journal entry from a multi-segment ledger account to single segment values from other backing tables such as Cust, Vend, Bank, Project and similar.\n\nController Class\n\nOne of 6 Controller classes. For example LedgerDimensionDefaultAccountController.\n\nDetermines the pattern and behavior of the Segmented Entry control. More information about this property is provided below.\n\nInclude Financial Accounts\n\nNoYes\n\nDetermines if Main accounts that are Financial accounts are valid for use.\n\nInclude Total Accounts\n\nNoYes\n\nDetermines if Main accounts of type Total are valid for use.\n\nIs Default Account\n\nTrueFalse\n\nFor a Dynamic account, determines if the account should be a default or full account.\n\nLock Main Account Segment\n\nNoYes\n\nControls whether the Main account segment is locked. Typically used in journals and distributions based upon configuration.\n\nPosting Type\n\nA value from the LedgerPostingType enumeration.\n\nThe Main account is validated to see if the posting type is allowed to be used with that account.\n\nValidate Blocked For Manual Entry\n\nNoYes\n\nDetermines if the 'Blocked for Manual Entry' status on the dimension should be respected or not.\n\n## Controller class property\nThe following table provides details about each controller.\n\n**Controller**\n\n**Details**\n\nBudgetLedgerDimension\n\nThis Controller provides budget based support for data entry in the Segmented Entry control. When using this controller, an Account Structure must be provided to the Segmented Entry control.\n\nBudgetPlanningLedgerDimension\n\nThis Controller provides budget planning based support for data entry in the Segmented Entry control. When using this controller, an Account Structure must be provided to the Segmented Entry control.\n\nDimensionDynamicAccount\n\nThis Controller provides support for multiple account types in the Segmented Entry control.\n\nLedgerDimensionAccountAlias\n\nThis Controller provides support for account aliases in the Segmented Entry control\n\nLedgerDimensionAccount\n\nThis Controller provides support for multi-segment data entry in the Segmented Entry control.\n\nLedgerDimensionDefaultAccount\n\nThis Controller provides support for default accounts in the Segmented Entry control.\n\n## Migration steps\n### Step 1\n\n#### AX 2012\n\nIf **SegmentedEntry** appears as the type next to any control, change it to **SegmentedEntryControl**. [![SegmentMigrate01](./media/segmentmigrate01.png)](./media/segmentmigrate01.png)\n\n#### Dynamics AX\n\nAn easy method is to append \"\\_old\" to the name of the old control, add the new control (which should have the original name of the control), migrate all the settings over, and then delete the old control. **Note:** To prevent tests and other code that references the control from breaking, make sure that the new control has the same name as the old control. To add the new control, right-click the parent control that will contain the **Segmented Entry** control, and then select **New** &gt; **SegmentedEntryControl**. [![SegmentMigrate02](./media/segmentmigrate02-623x1024.png)](./media/segmentmigrate02.png) The following screen shot shows how new control will look. [![SegmentMigrate03](./media/segmentmigrate03.png)](./media/segmentmigrate03.png)\n\n### Step 2\n\n#### AX 2012\n\nOverride the  **jumpRef()** control/field method.\n\n    public void jumpRef()\n    {\n        ledgerDimensionDefaultAccountController.jumpRef();\n    }\n\n#### Dynamics AX\n\nRemove the **jumpRef()** method completely if it contains no other functionality. If there is other custom **jumpRef** functionality, leave that. However, **jumpRef** is otherwise automatically handled by the control.\n\n### Step 3\n\n#### AX 2012\n\nOverride the **loadAutoCompleteData()** control method.\n\n    public void loadAutoCompleteData(LoadAutoCompleteDataEventArgs _e)\n    {\n        ledgerDimensionDefaultAccountController.loadAutoCompleteData(_e);\n        super(_e);\n    }\n\n#### Dynamics AX\n\nRemove the **loadAutoCompleteData()** method.\n\n### Step 4\n\n#### AX 2012\n\nOverride the **loadSegments()** control method.\n\n    public void loadSegments()\n    {\n        super();\n        ledgerDimensionDefaultAccountController.loadSegments();\n        ledgerDimensionDefaultAccountController.parmControl(this);\n    }\n\n#### Dynamics AX\n\nIf the **loadSegments()** method does nothing except call the controller's **loadSegments()** and **parmControl()** methods, remove it. However, make a note of the SEC control instance that is passed to the **parmControl()** call. The methods that were being called will now have to be called on that instance.\n\n### Step 5\n\n#### AX 2012\n\nOverride the **loadSegments()** control method.\n\n    public void loadSegments()\n    {\n        super();\n        dimAccountController.parmControl(this);\n        dimAccountController.parmJournalName(ledgerJournalTable.JournalName);\n        dimAccountController.parmCurrency(ledgerJournalTrans.CurrencyCode);\n        dimAccountController.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());\n        dimAccountController.parmDate(ledgerJournalTrans.TransDate);\n        dimAccountController.parmTaxCode(ledgerJournalTrans.TaxCode);\n\n        dimAccountController.loadSegments();\n    }\n\n#### Dynamics AX\n\nIf the **loadSegments()** method was used to set parameters on the controller, the calls to **parm** method must be moved to every location where the source of the **parm** method can change. In most cases, these locations are the **modified()** method on the corresponding data field and/or the **active()** method on the data source. For example, some of the migrated code for the **loadSegments()** override on the left would look like this.\n\n    dimAccountController.parmControl(this) -> No longer needed.\n\nMake a note of the SEC control instance that is passed on to the **parmControl()** call. The methods that were being called on the controller will now have to be called on that instance.\n\n    dimAccountController.parmJournalName(ledgerJournalTable.JournalName) ->\n    LedgerJournalTable data source,\n    JournalName field,\n    public void modified()\n    {\n        .parmJournalName(ledgerJournalTable.JournalName);\n    }\n\n**LedgerJournalTable data source**\n\n    public void active()\n    {\n        .parmJournalName(ledgerJournalTable.JournalName);\n    }\n\n**Note:** After you've moved all the code out of the **loadSegments()** method, you can delete the method.\n\n### Step 6\n\n#### AX 2012\n\nOverride the **loadSegments()** control method. In some cases, the **loadSegments()** method might use a table buffer to set parameters on the controller, but that table buffer isn't a data source on the form. For example, on the **LedgerJournalTransDaily** form, the original implementation of **loadSegments()** looked like this.\n\n    public void loadSegments()\n    {\n        super();\n\n        dimAccountController.parmControl(this);\n        dimAccountController.parmJournalName(ledgerJournalTable.JournalName);\n        dimAccountController.parmCurrency(ledgerJournalTrans.CurrencyCode);\n        dimAccountController.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());\n        dimAccountController.parmDate(ledgerJournalTrans.TransDate);\n        dimAccountController.parmTaxCode(ledgerJournalTrans.TaxCode);\n\n        dimAccountController.loadSegments();\n\n        currentMainAccountId = dimAccountController.getValue(DimensionAttribute::getMainAccountDimensionAttribute());\n    }\n\nNote that the **JournalName** property is set from the ledgerJournalTable buffer, but the LedgerJournalTable table isn't a data source on the form.\n\n#### Dynamics AX\n\nIn such cases, you can't move that code to either the **active()** method of a data source or the **modified()** method on the data field. Instead, you should identify where the table buffer is being set. For example, in the original implementation of the **LedgerJournalTransDaily** form, the ledgerJournalTable buffer was set in the **initLedger()** method on the form. It should be evident that the value that is passed to **parmJournalName()** can change only when the buffer is reassigned in the **initLedger()** method. Therefore, code would have to be moved to the **initLedger()** method after the assignment of the buffer. Also, in accordance with the general guidelines, the **parmJournalName()** method would be called on the control instance.\n\n    void initLedger()\n    {\n        TransDate   dateFrom   = dateNull();\n        TransDate   dateTo     = systemDateGet();\n\n        if (element.args().dataset() == tableNum(LedgerJournalTable))\n        {\n            ledgerJournalTable = element.args().record();\n            LedgerJournalTrans_AccountNum.parmJournalName(ledgerJournalTable.JournalName);\n            LedgerJournalTrans_AccountNum1.parmJournalName(ledgerJournalTable.JournalName);\n            GridOffsetAccount.parmJournalName(ledgerJournalTable.JournalName);\n            LedgerJournalTrans_OffsetAccount1.parmJournalName(ledgerJournalTable.JournalName);\n            ...\n        }\n        ...\n    }\n\n### Step 7\n\n#### AX 2012\n\nOverride the **segmentValueChanged()** control method.\n\n    public void segmentValueChanged(SegmentValueChangedEventArgs _e)\n    {\n        super(_e);\n        ledgerDimensionDefaultAccountController.segmentValueChanged(_e);\n    }\n\n#### Dynamics AX\n\nIf the implementation of **segmentValueChanged()** does nothing except call **super()** and the **segmentValueChanged()** method on the controller, you can remove the method.\n\n### Step 8\n\n#### AX 2012\n\nOverride the **segmentValueChanged()** control method.\n\n    public void segmentValueChanged(SegmentValueChangedEventArgs _e)\n    {\n        super(_e);\n\n        dimOffsetAccountController.segmentValueChanged(_e);\n        currentOffsetMainAccountId = ledgerJournalEngine.onOffsetAccountSegmentChanged(dimOffsetAccountController, currentOffsetMainAccountId, ledgerJournalTrans);\n    }\n\n#### Dynamics AX\n\nIf the implementation of **segmentValueChanged()** has additional logic, you must replace the method with the **onSegmentChanged()** method, as shown here.\n\n    public void onSegmentChanged(DimensionControlSegment _segment)\n    {\n        currentOffsetMainAccountId = ledgerJournalEngine.onOffsetAccountSegmentChanged(this, currentOffsetMainAccountId, ledgerJournalTrans);\n    }\n\n**Notes:**\n\n-   To add the **onSegmentChanged()** method, follow these steps:\n    1.  Expand the **Segmented Entry** control to add the method to.\n    2.  Right-click the **Methods** node, and then select **Override** &gt; **onSegmentChanged**.\n-   The new method doesn't have to call **super()** or any other method on either the control or the controller.\n\n### Step 9\n\n#### AX 2012\n\nOverride the **validate()** control method.\n\n    public boolean validate()\n    {\n        boolean isValid;\n        isValid = super();\n        isValid = ledgerDimensionDefaultAccountController.validate() && isValid;\n\n        return isValid;\n    }\n\n#### Dynamics AX\n\nRemove the **validate()** method, unless you have additional validation. The **super()** call does everything that this code used to do. Therefore, keep only any new code that you have.\n\n### Step 10\n\n#### AX 2012\n\nOverride the **lookup()** control method.\n\n    public void lookup()\n    {\n        switch (emplParameters_RU.BankCloseACType)\n        {\n        case LedgerJournalACType::Bank:\n            BankAccountTable::lookupBankAccount(this);\n            break;\n        case LedgerJournalACType::Cust:\n            CustTable::lookupCustomer(this);\n            break;\n        case LedgerJournalACType::FixedAssets:\n            AssetTable::lookupAccountNum(this);\n            break;\n        case LedgerJournalACType::Ledger:\n            super();\n            break;\n        case LedgerJournalACType::Project:\n            ProjTable::lookupProjId(this, emplParameters_RU);\n            break;\n        case LedgerJournalACType::Vend:\n            VendTable::lookupVendor(this);\n            break;\n        default:\n            super();\n            break;\n        }\n    }\n\n#### Dynamics AX\n\nLeave the **lookup()** method as it is.\n\n### Step 11\n\n#### AX 2012\n\nOverride the **lookupReference()** control method.\n\n    public Common lookupReference()\n    {\n        Common ret;\n        ret = super();\n        return ret;\n    }\n\n#### Dynamics AX\n\nIf the **lookupReference()** method uses the default implementation, you can delete it.\n\n### Step 12\n\n#### AX 2012\n\nOverride the **modified()** control method.\n\n    public boolean modified()\n    {\n        boolean ret;\n\n        ret = super();\n\n        if (tmpCurrencyLedgerGainLossAccount.LedgerDimension)\n        {\n            tmpCurrencyLedgerGainLossAccount.AccountName =\n            MainAccount::getLocalizedNameByMainAccountId(\n            DimensionStorage::getMainAccountNumFromLedgerDimension(\n            tmpCurrencyLedgerGainLossAccount.LedgerDimension), ledger.ChartOfAccounts);\n        }\n        else\n        {\n            tmpCurrencyLedgerGainLossAccount.AccountName = '';\n        }\n\n        return ret;\n    }\n\n#### Dynamics AX\n\nLeave the **modified()** method as it is.\n\n### Step 13\n\n#### AX 2012\n\nOverride the **gotFocus()** control method.\n\n    void gotFocus()\n    {\n        super();\n        if (ledgerJournalTable.FixedOffsetAccount)\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger);\n        }\n        else if (!ledgerJournalTrans_OffsetAccount.allowEdit())\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(true);\n        }\n    }\n\n#### Dynamics AX\n\nThe approach is similar to the approach for the **loadSegments()** method. The code must be moved to every location where the source of the **parm** method can change. In most cases, these locations are the **modified()** method on the corresponding data field and/or the **active()** method on the data source. For example, for the preceding code, the migrated code would look like this.\n\n    LedgerJournalTable data source,\n    FixedOffsetAccount field\n    public void modified()\n    {\n        if (ledgerJournalTable.FixedOffsetAccount)\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger);\n        }\n        else if (!ledgerJournalTrans_OffsetAccount.allowEdit())\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(true);\n        }\n    }\n\n    LedgerJournalTrans data source,\n    OffsetAccountType field\n    public void modified()\n    {\n        if (ledgerJournalTable.FixedOffsetAccount)\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger);\n        }\n            else if (!ledgerJournalTrans_OffsetAccount.allowEdit())\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(true);\n        }\n    }\n\n    LedgerJournalTrans data source:\n    public void active()\n    {\n        if (ledgerJournalTable.FixedOffsetAccount)\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger);\n        }\n        else if (!ledgerJournalTrans_OffsetAccount.allowEdit())\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(true);\n        }\n    }\n\n    LedgerJournalTable data source:\n    public void active()\n    {\n        if (ledgerJournalTable.FixedOffsetAccount)\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger);\n        }\n        else if (!ledgerJournalTrans_OffsetAccount.allowEdit())\n        {\n            ledgerJournalTrans_OffsetAccount.allowEdit(true);\n        }\n    }\n\n**Note:** After all the code has been moved out of the **gotFocus()** method, you can delete the method.\n\n### Step 14\n\n#### AX 2012\n\nIn the form **init()** method:\n\n    ledgerDimensionDefaultAccountController = LedgerDimensionDefaultAccountController::construct(vendParameters_ds, fieldStr(VendParameters, ClearingLedgerDimension));\n\n#### Dynamics AX\n\nSet the following properties on the control:\n\n-   **Data Source**\n-   **Reference Field**\n-   **Controller Class**\n\n[![SegmentMigrate04](./media/segmentmigrate04.png)](./media/segmentmigrate04.png) [![SegmentMigrate05](./media/segmentmigrate05.png)](./media/segmentmigrate05.png) **Note:** A controller class is required for the control to work. Therefore, a run-time error will be thrown if the **Controller Class** property isn't set.\n\n### Step 15\n\n#### AX 2012\n\n    ledgerDimensionAccountController.setValues(ledgerJournalTrans.DefaultDimension, false);\n\n#### Dynamics AX\n\nA map of the dimension specifiers must be created that can then be sent into the **Segmented Entry** control's **setDimensionSpecifiers** method.\n\n    Map defaultDimensionSpecifiers = LedgerDimensionDefaultingEngine::getDefaultDimensionSpecifiers(ledgerJournalTable.DefaultDimension);\n\n    TmpLedgerJournalSplitLines_LedgerAccount.setDimensionSpecifiers(defaultDimensionSpecifiers, false);\n\n**Note:** You can add anything to the dimension specifiers map before it's sent to the control. You can also create a new map here. (See the **onSegmentChangedForPrimaryAccount** method in the **LedgerJournalEngine** class for similar logic.)\n\n### Step 16\n\n#### AX 2012\n\n**parmControl()** method calls: (These are typically present in the form's **init()** method or one of the methods that are overridden on the control.)\n\n    ledgerDimensionDefaultAccountController.parmControl(clearingAccount);\n\n#### Dynamics AX\n\nRemove this line of code, because it's no longer required. However, first make a note of which controller is used with which control. For example, in this case, ledgerDimensionDefaultAccoutnController is being used with the ClearningAccount SEC. A mapping is required when you replace method calls on controller objects with corresponding method calls on the control, and when you set the properties at design time.\n\n### Step 17\n\n#### AX 2012\n\nIn the form **init()** method:\n\n    ledgerDimensionDefaultAccountController.parmFilterLedgerPostingType(LedgerPostingType::VendSettlement);\n\n#### Dynamics AX\n\nThis is the **Posting Type** property on the control. The control that the **PostingType** property must be set on can be determined from the mapping details that are derived by looking at the **parmControl()** call. [![SegmentMigrate06](./media/segmentmigrate06.png)](./media/segmentmigrate06.png) These properties can also be set in code, through corresponding **parm** methods on the control instance. Here's an example.\n\n    ClearingAccount.parmPostingType(LedgerPostingType::VendSettlement);\n\n### Step 18\n\n#### AX 2012\n\nOverride **resolveReference()** in the data source field for the ledger dimension. [![SegmentMigrate07](./media/segmentmigrate07.png)](./media/segmentmigrate07.png)\n\n#### Dynamics AX\n\nDelete this code, because it's no longer required. The control handles this automatically.\n\n### Step 19\n\n#### AX 2012\n\nThe form sets properties on the controller through **parm** methods.\n\n#### Dynamics AX\n\nIn general, any property that was previously set on the controller class should now be set directly on the control. The control that the property must be set on can be determined from the mapping details that are derived by looking at the **parmControl()** call. Additionally, for the **Segmented Entry** control, any property that is available in the **Properties** dialog box in Microsoft Visual Studio can also be set in code, through the corresponding **parm** method on the control instance.\n\n### Step 20\n\n#### AX 2012\n\nThe form uses the control's **currentSegmentIndex()** method.\n\n    dimOffetAssetController. getDimensionAttributeByControlIndex(currentSegmentIndex);\n\n#### Dynamics AX\n\nIn general, any property that was previously set on the controller class should now be set directly on the control. The control that the property must be set on can be determined from the mapping details that are derived by looking at the **parmControl()** call. Additionally, for the **Segmented Entry** control, any property that is available in the **Properties** dialog box in Visual Studio can also be set in code, through the corresponding **parm** method on the control instance.\n\n### Step 21\n\n#### AX 2012\n\nThe form calls methods on the controller object. Here's an example.\n\n    dimOffetAssetController. getDimensionAttributeByControlIndex(currentSegmentIndex);\n\n#### Dynamics AX\n\nAll method calls on the controller must be replaced with method calls on the control. For this example, use the **getDimensionAttributeByControlIndex()** method on the control instead.\n\n    segmentedEntryControl. getDimensionAttributeByControlIndex();\n\n### Step 22\n\n#### AX 2012\n\nFor **DimensionDynamicAccountController**, the account type is specified through the constructor.\n\n    DimensionDynamicAccountController::construct(ledgerJournalTrans_ds, fieldStr(LedgerJournalTrans, LedgerDimension), fieldStr(LedgerJournalTrans, AccountType));\n\n#### Dynamics AX\n\nThere are two methods for implementing this functionality. These methods are mutually exclusive, so use only one of them, depending on the situation:\n\n-   For the **Segmented Entry** control, in the **Properties** dialog box, set the **Account Type Field** property to the data source field that will provide the account type. This is the preferred method. **Note:** If the **super()** call has been removed from the **modified()** method for the field that is bound to the **Account Type Field** property, this method won't work. We have seen this issue in some journal forms, such as **LedgerJournalTransDaily**. In such cases, either add the **super()** call back to the **modified()** method, or use the second method.\n-   Set the account type manually by calling the **parmAccountTypeEnumValue()** method on the control. Here's an example.\n\n        LedgerJournalTrans_AccountNum.parmAccountTypeEnumValue(enum2int(ledgerJournalTrans.AccountType));\n\n    **Note:** The call to **parmAccountTypeEnumValue()** must be put in both the data source's **active()** method and the **modified()** method of the field that will provide the account type.\n\n### Step 23\n\n#### AX 2012\n\nThe form has a variable that is defined.\n\n    LedgerDimensionDefaultAccountController ledgerDimensionDefaultAccountController;\n\n#### Dynamics AX\n\nRemove this, because the controller is no longer required.\n\n### Step 24\n\n#### AX 2012\n\n**parmCurrentLedgerCOA()** method calls: (These are typically present in the form's **init()** method or one of the methods that are overridden on the control.)\n\n    ledgerDimensionDefaultAccountController.parmCurrentLedgerCOA(LedgerCOA::current());\n\n#### Dynamics AX\n\nRemove this line of code, because it's no longer required in most cases. Before you delete this line, make sure that the data area ID is correctly passed in to the controller as a parameter, because the **LedgerCOA** value will be derived from that information. If the data area ID is not passed in, replace **parmCurrentLedgerCOA(â€¦)** with **parmDataAreaId(â€¦)**, and pass the appropriate **SelectableDataArea** value, which is usually **curext()** or another table field that controls the scope of the company for the account control. If the form has no data area context but only a current **LedgerCOA** value, it should be working only with the default account controller. There are only a few forms that are agnostic of a company, but that are scoped to a specific chart of accounts (COA) (for example, **MainAccount** and **Allocations**). In these cases, **parmCurrentLedgerCOA** should be called on the **Segmented Entry** control instance that has a default account controller type set.\n\n### Step 25\n\n#### AX 2012\n\n**parmIncludeFinancialAccounts(NoYes)** method calls:\n\n    LedgerDimensionDefaultAccountController.parmIncludeFinancialAccounts(NoYes::Yes);\n\n#### Dynamics AX\n\nThis line of code is no longer required and should be set directly via a property on the **Segmented Entry** control. **Note:** Because of a framework bug, if you don't setting this explicitly, **No** will be assigned on a ledger dimension default account controller, whereas the previous behavior was to implicitly assign **Yes** during construction. You must set this manually as a property. Alternatively, for a **dialog** class, the **parm** method should still be explicitly called.\n\n### Step 26\n\n#### AX 2012\n\nThe code for the **modified** method of the data field that provides the account type for the **Segmented Entry** control might look like this when the control is used as a dynamic account control.\n\n    public void modified()\n    {\n        super();\n\n        // Lock the main account segment if \"Fixed offset account\" is selected in Journal Names\n        if (ledgerJournalTable.OffsetAccountType == LedgerJournalACType::Ledger)\n        {\n            controller.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);\n        }\n    }\n\n#### Dynamics AX\n\nThe **modified** method of this data field must now clear the ledger dimension field that is bound to the **Segmented Entry** control as a **Reference** field. For example, if the name of the **Segmented Entry** control is **OffsetAccount**, and the **Reference** field property for this control is set to **LedgerDimension**, the **modified** method in the preceding code should be changed as follows.\n\n    public void modified()\n    {\n        super();\n\n        OffsetAccount.LedgerDimension = 0;\n\n        // Lock the main account segment if \"Fixed offset account\" is selected in Journal Names\n        if (ledgerJournalTable.OffsetAccountType == LedgerJournalACType::Ledger)\n        {\n            OffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);\n        }\n    }\n\nThe additional line is required to clear the control when the account type is changed.\n\n### Step 27\n\n#### AX 2012\n\nYou can call the **parmAccountStructure()** method on the controller.\n\n    fromBudgetPlanningLedgerDimensionController.parmAccountStructureId(accountStructureIdLocal);\n\n#### Dynamics AX\n\nThis method is replaced by two different methods. Additionally, the purpose of the new methods is the opposite of the old method: the old method turned validation off, whereas the new methods turn it on. Therefore, when you migrate code, you must reverse the Boolean parameter for the new methods. For example, for the method call in the preceding code, the new methods would look like this.\n\n    ToBudgetTransactionLine_LedgerDimension.parmDoValueActiveDatesValidation(false);\n\n    ToBudgetTransactionLine_LedgerDimension.parmDoValueSuspendedValidation(false);\n\n### Step 28\n\n#### AX 2012\n\nYou can call the **parmAccountStructure()** method on the controller:\n\n    fromBudgetPlanningLedgerDimensionController.parmAccountStructureId(accountStructureIdLocal);\n\n#### Dynamics AX\n\nThe **parmAccountStructureId()** method doesn't exist on the control. Instead, separate **getAccountStructure()** and **setAccountStructure()** methods exist. Therefore, the **parmAccountStructureId()** call must be replaced by the **get** or **set** method, depending on how the **parm** method was used. For example, the **parm** method in the preceding code was called as a setter, so the call should be replaced by a call to the **set** method.\n\n    ToBudgetPlanningTransactionLine_LedgerDimension.setAccountStructureId(accountStructureIdLocal);\n\n### Step 29\n\n#### AX 2012\n\n    parmSkipSuspendedAndActiveDateValidation:\n\n#### Dynamics AX\n\nThis method is replaced by two different methods. Additionally, the purpose of the new methods is opposite of the old method: the old method turned validation off, whereas the new methods turn it on. Therefore, when you migrate code, you must reverse the Boolean parameter for the new methods. For example, for the method call in the preceding code, the new methods would look like this.\n\n    ToBudgetTransactionLine_LedgerDimension.parmDoValueActiveDatesValidation(false);\n\n    ToBudgetTransactionLine_LedgerDimension.parmDoValueSuspendedValidation(false);\n\n### Step 30\n\n#### AX 2012\n\nTypically, call the **loadFromId** method on the controller in the **loadSegments()** method.\n\n    ledgerDimensionDefaultAccountControllerResourceIssueOffset.loadFromId(wrkCtrTable.ResourceIssueOffsetLedgerDimension);\n\n#### Dynamics AX\n\nThis method has been deprecated and must not be used. You should delete all calls to this method.\n\n### Migrating a Segmented Entry control on a dialog\n\nThe uptake pattern for the new **Segmented Entry** control on a dialog has changed in Dynamics AX. Instead of interacting with the controller class API, you must now interact with the **SegmentedEntryControlBuild** class to link the SEC with the dialog. This section shows the code patterns for using SEC on a dialog with different controller types. **Note:** Help text is no longer required in Dynamics AX, so you don't have to set the Help text on dialog fields.\n\n-   **Dynamic account:**\n    -   **Before:**\n\n            // Creating the dialog field for the SEC\n            dialogDynamicAccountType = _dialog.addFieldValue(enumStr(LedgerJournalACTypeForPaymProposal), defaultOffsetAccountType, \"@SYS115164\", \"@SYS115165\");\n            dialogDynamicAccount = _dialog.addFieldValue(extendedTypeStr(LedgerDimensionBase), defaultOffsetLedgerDimension, \"@SYS115166\", \"@SYS115167\");\n            dimensionDynamicAccountController = DimensionDynamicAccountController::constructForDialog(dialogDynamicAccount, dialogDynamicAccountType, enumStr(LedgerJournalACTypeForPaymProposal));\n                       dimensionDynamicAccountController.parmIsDefaultAccount(true);\n             \n            public void dialogPostRun(DialogRunBase _dialog)\n            {\n            …\n             \n            dialogDynamicAccountType.registerOverrideMethod('modified', 'accountType_Modified', this);\n             \n            ...\n            }\n             \n            private boolean accountType_Modified(FormComboBoxControl _formComboBoxControl)\n            {\n             boolean valueWasModified;\n             \n             valueWasModified = _formComboBoxControl.modified();\n             if (valueWasModified)\n             {\n             dialogDynamicAccount.value(0);\n                        }\n             \n             return valueWasModified;\n            }\n\n    -   **After:**\n\n            // Creating the dialog field for the SEC\n            protected Object dialog()\n            {\n            ...        \n             \n            // Create the account type dialog field\n            dialogDynamicAccountType = _dialog.addFieldValue(enumStr(LedgerJournalACTypeForPaymProposal), defaultOffsetAccountType, \"@SYS115164\", \"@SYS115165\");\n            // Create the SEC dialog field\n            dialogDynamicAccount = SegmentedEntryControlBuild::addToDialog(dialog, classstr(DimensionDynamicAccountControl), extendedTypeStr(LedgerDimensionBase), \"@SYS115166\", defaultOffsetLedgerDimension);\n             \n            // Provide account type information for the SEC field\n            SegmentedEntryControlBuild::initDialogFieldAccountType(dialogDynamicAccount, enumStr(LedgerJournalACTypeForPaymProposal) , defaultOffsetAccountType);\n            // Set additional parameters on the SEC dialog field\n            SegmentedEntryControlBuild segmentedEntryControlBuild = dialogDynamicAccount.control(); \n            segmentedEntryControlBuild.parmIsDefaultAccount(true);\n             \n            …\n            }\n             \n            // Override for modified method of the Account type checkbox to update the SEC when account type is changed\n            public int accountType_selectionChange(FormComboBoxControl _formComboBoxControl)\n            {\n            SegmentedEntryControl secDDAC = dialogDynamicAccount.control();\n            accountType = _formComboBoxControl.selection();\n             \n            // This is the backing variable used to pack the account specified via the SEC\n            ledgerDimensionDynamicAccount = 0; \n            // Clear the SEC value\n            secDDAC.clearReference();                     \n             \n            // Specify the new account type to the SEC; this is an additional step needed for the AX SEC\n            secDDAC.parmAccountTypeEnumValue(enum2int(accountType));\n             \n            return true;\n            }\n             \n            // Set default account type based on value read from SysLastValue\n            public void dialogPostRun(DialogRunBase _dialog)\n            {\n            …\n            // Default any previously saved account type info\n            secDDAC = dialogDynamicAccount.control();\n            secDDAC.parmAccountTypeEnumValue(enum2int(accountType));\n            ….\n            }\n\n-   **Ledger account:**\n    -   **Before:**\n\n            dialogFeeLedgerDimension = dialog.addFieldValue(extendedtypestr(LedgerDimensionAccount),feeLedgerDimension,\"@SYS119703\", \"@SYS85534\");\n            ledgerDimensionAccountController = LedgerDimensionAccountController::constructForDialog(dialogFeeLedgerDimension);\n\n    -   **After:**\n\n            DialogField dialogLedgerAccount = SegmentedEntryControlBuild::addToDialog(dialog, classstr(LedgerDimensionAccountControl), extendedTypeStr(LedgerDimensionAccount), \"@SYS119703\", feeLedgerDimension);\n\n-   **Default account:**\n    -   **Before:**\n\n            dialogInterCompanyLedgerDimension = dialog.addFieldValue(extendedTypeStr(LedgerDimensionDefaultAccount),interCompanyLedgerDimension, \"@SYS21687\", \"@SYS85534\");\n            ledgerDimensionDefaultAccountController = LedgerDimensionDefaultAccountController::constructForDialog(dialogInterCompanyLedgerDimension);\n\n    -   **After:**\n\n            DialogField dialogDefaultAccount = SegmentedEntryControlBuild::addToDialog(dialog, classstr(LedgerDimensionDefaultAccountControl), extendedTypeStr(LedgerDimensionDefaultAccount), \"@SYS21687\", interCompanyLedgerDimension);\n\n-   **Budget:**\n    -   **Before:** No uptake of the **Budget** controller (**BudgetLedgerDimensionController**) for a dialog scenario was found in the existing program source code.\n    -   **After:**\n\n            DialogField dialogBudget = SegmentedEntryControlBuild::addToDialog(dialog, classstr(BudgetLedgerDimensionControl), extendedTypeStr(LedgerDimensionBudget), 'Budget', ledgerDimensionBudget);\n\n    **Notes:**\n    -   The new API lets you specify the label (**Budget** in the preceding example) while you set up the dialog field.\n    -   The default value for the control is specified via the **ledgerDimensionBudget** variable.\n    -   You must specify the account structure that should be used with the **Budget** controller. The **Dialog** class must implement a way for the user to select the account structure (outside of the SEC) and set the selected account structure on the SEC.\n-   **Budget planning:**\n    -   **Before:** No uptake of the **Budget planning** controller (**BudgetPlanningLedgerDimensionController**) for a dialog scenario was found in the existing program source code.\n    -   **After:**\n\n            DialogField dialogBudgetPlanning = SegmentedEntryControlBuild::addToDialog(dialog, classstr(BudgetPlanningLedgerDimensionControl), extendedTypeStr(LedgerDimensionBudgetPlanning), 'Budget planning', ledgerDimensionBudgetPlanning);\n\n    **Notes:**\n    -   The new API lets you specify the label (**Budget planning** in the preceding example) while you set up the dialog field.\n    -   The default value for the control is specified via the **ledgerDimensionBudgetPlanning** variable.\n    -   You must specify the account structure that should be used with the **Budget planning** controller. The **Dialog** class must implement a way for the user to select the account structure (outside of the SEC) and set the selected account structure on the SEC.\n\n\nSee also\n--------\n\n[Segmented Entry control dialog support](https://ax.help.dynamics.com/en/?p=145221)\n\n[Segmented Entry control Metadata Specification](https://ax.help.dynamics.com/en/?p=145441)\n\n[Segmented Entry control Parm method Specification](https://ax.help.dynamics.com/en/?p=154321)\n\n[Segmented Entry control migration walkthrough](https://ax.help.dynamics.com/en/?p=118381)\n\n"}