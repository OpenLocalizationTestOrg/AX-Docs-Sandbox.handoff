{"content":"---\n# required metadata\n\ntitle: Help secure analytical workspaces and reports by using Power BI Embedded\ndescription: This topic describes the recommended strategies for securing access to both the reports that are delivered by using Power BI Embedded and the data set, based on viewer access rights.\nauthor: robinarh\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: robinr\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 21551\nms.assetid: \nms.search.region: Global\n# ms.search.industry: \nms.author: tjvass\nms.search.validFrom: 2017-06-30\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Help secure analytical workspaces and reports by using Power BI Embedded\n\n[!include[banner](../includes/banner.md)]\n\n> [!NOTE]\n> This feature is supported in Microsoft Dynamics 365 for Finance and Operations, Enterprise edition July 2017 update (version 7.2) and later releases.\n\n## Introduction\nThis topic provides a walk-through for application developers who want to help secure analytical workspaces and reports that are delivered by using Microsoft Power BI Embedded. It describes the recommended strategies for securing access to both the reports and the data set, based on viewer access rights. By using the techniques that are described in this topic, you can hide reports from users and filter reports to show the data set that is appropriate for a specific user, based on the active company context.\n\n## Prerequisites\n+ Access to a developer environment that runs Microsoft Dynamics 365 for Finance and Operations, Enterprise edition July 2017 with Platform update 8 or later\n+ An analytical report (.pbix file) that was created by using Microsoft Power BI Desktop, and that has a data model that is sourced from the Entity store database\n\n## Overview\nWhether you're extending an existing application workspace or adding your own workspace, you can use embedded analytical views to deliver insightful and interactive views of your business data. Before you add new analytical workspaces and reports, it’s important that you establish a strategy to help secure the content. \n\nThere are several considerations that you should be aware of when you develop analytical solutions by using Power BI Embedded. Analytical reports are secured by using menu items. After they have access to a report, all viewers can access the underlying data model that is defined in the report. Although service options are available that automatically hide the fields that back a report data set, all viewers of the report have effective access to the fields in the data model. Additionally, X++ extensions are available that influence the way that the report is presented in the client. Both the **Filter** pane and the **Report** tabs can be hidden. However, Microsoft Power BI filters can be modified by using client-side script injections.\n\n### Recommendation\nCreate scenario-specific .pbix files to deliver analytical views:\n\n+ Area overviews that are delivered by using workspaces\n+ Subject matter–specific analytical reports\n\n    > [!NOTE]\n    > These analytical reports are often used to deliver reports that contain medium-business-impact and high-business-impact data.\n\nFor more information about how to create analytical reports, see [Getting started with Power BI Desktop](https://powerbi.microsoft.com/en-us/documentation/powerbi-desktop-getting-started/). This page is a great source for insights that can help you create compelling analytical reporting solutions.\n\n## Help secure analytical views that are provided through embedded Power BI reports\nPower BI report filters and the **Filter** pane serve as a mechanism for passing session context into the report that is embedded on the **Analytics** tab. The capability to turn the visibility of the **Filter** pane on and off isn't a security feature. Power BI report filters and the capability to hide and show the **Filter** pane are user experience (UX) decisions that the application designer makes.\n\nRow-level security that is defined in Finance and Operations isn't inherited by Power BI reports. Instead, application developers can help secure the workspace or the report.\n\n### Help secure analytical workspaces on the Analytics tab\nAnalytical workspaces are embedded Power BI reports that are shown in a form control. Unless you complete the following procedure, anyone who has access to the workspace can see the **Analytics** tab and access the Power BI reports.\n\n1. Add a menu item for the analytical workspace.\n2. Verify that the form initialization uses the **hasMenuItemAccess** application programming interface (API) to verify that the user has access to the menu item.\n\n    ```\n    // Note: secure entry point into the Workspace's Analytics report\n    if (Global::hasMenuItemAccess(menuItemDisplayStr(FMClerkWorkspace), MenuItemType::Display))\n    {\n        FMPBIWorkspaceController controller = new FMPBIWorkspaceController();\n        PBIReportHelper::initializeReportControl('FMPBIWorkspaces', powerBIReportGroup);\n    }\n    ```\n\nThe preceding logic will prevent the Power BI Viewer control from being initialized. Therefore, an empty tab will appear on the page. By default, the framework automatically hides empty tabs. Therefore, the **Analytics** tab is hidden and can't be access if the user doesn't have access to the menu item that is associated with the analytical workspace.\n\n### Help secure analytical reports\nEmbedded Power BI reports in the application are secured by using menu items. Users who try to access a Power BI report directly, by using a menu item in Finance and Operations, will receive an error. Follow these steps to help secure the analytical reports.\n\n1. Add a menu item for the report or the appropriate tab. By default, the first tab of the report will be shown if no other tab is selected.\n2. Link the menu item to the **PowerBIEmbedded_App** configuration key.\n\n    ![Link the menu item to the PowerBIEmbedded_App configuration key](media/secure-workspace-key.png)\n\nThe menu item is now associated with the availability of the Power BI Embedded service. If the service is unavailable, the links for the menu items will be removed from the application.\n\n## Help secure analytical workspaces and reports by company\nPower BI workspaces and reports can be secured by company (for example, **DataAreaID** value). Application solutions must apply the following steps for company-level security in analytical workspaces and reports.\n\nIn this scenario, the workspaces and reports that the sales manager from Contoso USA sees are limited to data that is related to Contoso USA. The report viewer must not have access to data that associated with any other company, unless the company context is changed.\n\n1. Open the analytical report in Power BI Desktop by double-clicking the resource in a Microsoft Visual Studio project.\n2. On the **Modeling** tab, click **Manage Roles**.\n3. Create a new role against a column in the data model that contains the **Company** field. Name the new role **CompanyFilter**. A **COMPANY** field must be present in the data model to restrict access by company.\n\n    ![Create a new role](media/secure-workspace-filter.png)\n\n4. In the **Table filter DAX expression** field, enter **[COMPANY]=username()**.\n5. To make sure that the rules work, on the **Modeling** tab, click **View as Roles**. In the dialog box, set the following fields:\n\n    1. Clear the **None** check box.\n    2. Select the **Other user** check box, and then enter **USMF** in the text box.\n    3. Select the **CompanyFilter** check box.\n\nThe reports will now show data as if you're running the USMF company. For more information, see [Row level security with Power BI Embedded](https://docs.microsoft.com/en-us/azure/power-bi-embedded/power-bi-embedded-rls).\n","nodes":[{"pos":[4,753],"nodes":[{"content":"Help secure analytical workspaces and reports by using Power BI Embedded","nodes":[{"pos":[0,72],"content":"Help secure analytical workspaces and reports by using Power BI Embedded","nodes":[{"content":"Help secure analytical workspaces and reports by using Power BI Embedded","pos":[0,72]}]}],"pos":[27,100],"yaml":true},{"content":"This topic describes the recommended strategies for securing access to both the reports that are delivered by using Power BI Embedded and the data set, based on viewer access rights.","nodes":[{"pos":[0,182],"content":"This topic describes the recommended strategies for securing access to both the reports that are delivered by using Power BI Embedded and the data set, based on viewer access rights.","nodes":[{"content":"This topic describes the recommended strategies for securing access to both the reports that are delivered by using Power BI Embedded and the data set, based on viewer access rights.","pos":[0,182]}]}],"pos":[113,296],"yaml":true}],"content":"# required metadata\n\ntitle: Help secure analytical workspaces and reports by using Power BI Embedded\ndescription: This topic describes the recommended strategies for securing access to both the reports that are delivered by using Power BI Embedded and the data set, based on viewer access rights.\nauthor: robinarh\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: robinr\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 21551\nms.assetid: \nms.search.region: Global\n# ms.search.industry: \nms.author: tjvass\nms.search.validFrom: 2017-06-30\nms.dyn365.ops.version: AX 7.0.0\n","yamlblock":true},{"pos":[761,833],"content":"Help secure analytical workspaces and reports by using Power BI Embedded","linkify":"Help secure analytical workspaces and reports by using Power BI Embedded","nodes":[{"content":"Help secure analytical workspaces and reports by using Power BI Embedded","pos":[0,72]}]},{"pos":[880,1039],"content":"[!NOTE]\nThis feature is supported in Microsoft Dynamics 365 for Finance and Operations, Enterprise edition July 2017 update (version 7.2) and later releases.","leadings":["","> "],"nodes":[{"content":"This feature is supported in Microsoft Dynamics 365 for Finance and Operations, Enterprise edition July 2017 update (version 7.2) and later releases.","pos":[8,157]}]},{"pos":[1044,1056],"content":"Introduction","linkify":"Introduction","nodes":[{"content":"Introduction","pos":[0,12]}]},{"content":"This topic provides a walk-through for application developers who want to help secure analytical workspaces and reports that are delivered by using Microsoft Power BI Embedded.","pos":[1057,1233]},{"content":"It describes the recommended strategies for securing access to both the reports and the data set, based on viewer access rights.","pos":[1234,1362]},{"content":"By using the techniques that are described in this topic, you can hide reports from users and filter reports to show the data set that is appropriate for a specific user, based on the active company context.","pos":[1363,1570]},{"pos":[1575,1588],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"Access to a developer environment that runs Microsoft Dynamics 365 for Finance and Operations, Enterprise edition July 2017 with Platform update 8 or later","pos":[1591,1746]},{"content":"An analytical report (.pbix file) that was created by using Microsoft Power BI Desktop, and that has a data model that is sourced from the Entity store database","pos":[1749,1909]},{"pos":[1914,1922],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"Whether you're extending an existing application workspace or adding your own workspace, you can use embedded analytical views to deliver insightful and interactive views of your business data.","pos":[1923,2116]},{"content":"Before you add new analytical workspaces and reports, it’s important that you establish a strategy to help secure the content.","pos":[2117,2243]},{"content":"There are several considerations that you should be aware of when you develop analytical solutions by using Power BI Embedded.","pos":[2246,2372]},{"content":"Analytical reports are secured by using menu items.","pos":[2373,2424]},{"content":"After they have access to a report, all viewers can access the underlying data model that is defined in the report.","pos":[2425,2540]},{"content":"Although service options are available that automatically hide the fields that back a report data set, all viewers of the report have effective access to the fields in the data model.","pos":[2541,2724]},{"content":"Additionally, X++ extensions are available that influence the way that the report is presented in the client.","pos":[2725,2834]},{"content":"Both the <bpt id=\"p1\">**</bpt>Filter<ept id=\"p1\">**</ept> pane and the <bpt id=\"p2\">**</bpt>Report<ept id=\"p2\">**</ept> tabs can be hidden.","pos":[2835,2898],"source":" Both the **Filter** pane and the **Report** tabs can be hidden."},{"content":"However, Microsoft Power BI filters can be modified by using client-side script injections.","pos":[2899,2990]},{"pos":[2996,3010],"content":"Recommendation","linkify":"Recommendation","nodes":[{"content":"Recommendation","pos":[0,14]}]},{"content":"Create scenario-specific .pbix files to deliver analytical views:","pos":[3011,3076]},{"content":"Area overviews that are delivered by using workspaces","pos":[3080,3133]},{"content":"Subject matter–specific analytical reports","pos":[3136,3178]},{"pos":[3186,3325],"content":"[!NOTE]\nThese analytical reports are often used to deliver reports that contain medium-business-impact and high-business-impact data.","leadings":["","    > "],"nodes":[{"content":"These analytical reports are often used to deliver reports that contain medium-business-impact and high-business-impact data.","pos":[8,133]}]},{"content":"For more information about how to create analytical reports, see <bpt id=\"p1\">[</bpt>Getting started with Power BI Desktop<ept id=\"p1\">](https://powerbi.microsoft.com/en-us/documentation/powerbi-desktop-getting-started/)</ept>.","pos":[3327,3516],"source":"For more information about how to create analytical reports, see [Getting started with Power BI Desktop](https://powerbi.microsoft.com/en-us/documentation/powerbi-desktop-getting-started/)."},{"content":"This page is a great source for insights that can help you create compelling analytical reporting solutions.","pos":[3517,3625]},{"pos":[3630,3710],"content":"Help secure analytical views that are provided through embedded Power BI reports","linkify":"Help secure analytical views that are provided through embedded Power BI reports","nodes":[{"content":"Help secure analytical views that are provided through embedded Power BI reports","pos":[0,80]}]},{"content":"Power BI report filters and the <bpt id=\"p1\">**</bpt>Filter<ept id=\"p1\">**</ept> pane serve as a mechanism for passing session context into the report that is embedded on the <bpt id=\"p2\">**</bpt>Analytics<ept id=\"p2\">**</ept> tab.","pos":[3711,3866],"source":"Power BI report filters and the **Filter** pane serve as a mechanism for passing session context into the report that is embedded on the **Analytics** tab."},{"content":"The capability to turn the visibility of the <bpt id=\"p1\">**</bpt>Filter<ept id=\"p1\">**</ept> pane on and off isn't a security feature.","pos":[3867,3964],"source":" The capability to turn the visibility of the **Filter** pane on and off isn't a security feature."},{"content":"Power BI report filters and the capability to hide and show the <bpt id=\"p1\">**</bpt>Filter<ept id=\"p1\">**</ept> pane are user experience (UX) decisions that the application designer makes.","pos":[3965,4116],"source":" Power BI report filters and the capability to hide and show the **Filter** pane are user experience (UX) decisions that the application designer makes."},{"content":"Row-level security that is defined in Finance and Operations isn't inherited by Power BI reports.","pos":[4118,4215]},{"content":"Instead, application developers can help secure the workspace or the report.","pos":[4216,4292]},{"pos":[4298,4352],"content":"Help secure analytical workspaces on the Analytics tab","linkify":"Help secure analytical workspaces on the Analytics tab","nodes":[{"content":"Help secure analytical workspaces on the Analytics tab","pos":[0,54]}]},{"content":"Analytical workspaces are embedded Power BI reports that are shown in a form control.","pos":[4353,4438]},{"content":"Unless you complete the following procedure, anyone who has access to the workspace can see the <bpt id=\"p1\">**</bpt>Analytics<ept id=\"p1\">**</ept> tab and access the Power BI reports.","pos":[4439,4585],"source":" Unless you complete the following procedure, anyone who has access to the workspace can see the **Analytics** tab and access the Power BI reports."},{"content":"Add a menu item for the analytical workspace.","pos":[4590,4635]},{"pos":[4639,4798],"content":"Verify that the form initialization uses the <bpt id=\"p1\">**</bpt>hasMenuItemAccess<ept id=\"p1\">**</ept> application programming interface (API) to verify that the user has access to the menu item.","source":"Verify that the form initialization uses the **hasMenuItemAccess** application programming interface (API) to verify that the user has access to the menu item."},{"content":"The preceding logic will prevent the Power BI Viewer control from being initialized.","pos":[5162,5246]},{"content":"Therefore, an empty tab will appear on the page.","pos":[5247,5295]},{"content":"By default, the framework automatically hides empty tabs.","pos":[5296,5353]},{"content":"Therefore, the <bpt id=\"p1\">**</bpt>Analytics<ept id=\"p1\">**</ept> tab is hidden and can't be access if the user doesn't have access to the menu item that is associated with the analytical workspace.","pos":[5354,5515],"source":" Therefore, the **Analytics** tab is hidden and can't be access if the user doesn't have access to the menu item that is associated with the analytical workspace."},{"pos":[5521,5551],"content":"Help secure analytical reports","linkify":"Help secure analytical reports","nodes":[{"content":"Help secure analytical reports","pos":[0,30]}]},{"content":"Embedded Power BI reports in the application are secured by using menu items.","pos":[5552,5629]},{"content":"Users who try to access a Power BI report directly, by using a menu item in Finance and Operations, will receive an error.","pos":[5630,5752]},{"content":"Follow these steps to help secure the analytical reports.","pos":[5753,5810]},{"content":"Add a menu item for the report or the appropriate tab.","pos":[5815,5869]},{"content":"By default, the first tab of the report will be shown if no other tab is selected.","pos":[5870,5952]},{"pos":[5956,6024],"content":"Link the menu item to the <bpt id=\"p1\">**</bpt>PowerBIEmbedded_App<ept id=\"p1\">**</ept> configuration key.","source":"Link the menu item to the **PowerBIEmbedded_App** configuration key."},{"content":"Link the menu item to the PowerBIEmbedded_App configuration key","pos":[6032,6095]},{"content":"The menu item is now associated with the availability of the Power BI Embedded service.","pos":[6130,6217]},{"content":"If the service is unavailable, the links for the menu items will be removed from the application.","pos":[6218,6315]},{"pos":[6320,6376],"content":"Help secure analytical workspaces and reports by company","linkify":"Help secure analytical workspaces and reports by company","nodes":[{"content":"Help secure analytical workspaces and reports by company","pos":[0,56]}]},{"content":"Power BI workspaces and reports can be secured by company (for example, <bpt id=\"p1\">**</bpt>DataAreaID<ept id=\"p1\">**</ept> value).","pos":[6377,6471],"source":"Power BI workspaces and reports can be secured by company (for example, **DataAreaID** value)."},{"content":"Application solutions must apply the following steps for company-level security in analytical workspaces and reports.","pos":[6472,6589]},{"content":"In this scenario, the workspaces and reports that the sales manager from Contoso USA sees are limited to data that is related to Contoso USA.","pos":[6591,6732]},{"content":"The report viewer must not have access to data that associated with any other company, unless the company context is changed.","pos":[6733,6858]},{"content":"Open the analytical report in Power BI Desktop by double-clicking the resource in a Microsoft Visual Studio project.","pos":[6863,6979]},{"pos":[6983,7031],"content":"On the <bpt id=\"p1\">**</bpt>Modeling<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>Manage Roles<ept id=\"p2\">**</ept>.","source":"On the **Modeling** tab, click **Manage Roles**."},{"content":"Create a new role against a column in the data model that contains the <bpt id=\"p1\">**</bpt>Company<ept id=\"p1\">**</ept> field.","pos":[7035,7124],"source":"Create a new role against a column in the data model that contains the **Company** field."},{"content":"Name the new role <bpt id=\"p1\">**</bpt>CompanyFilter<ept id=\"p1\">**</ept>.","pos":[7125,7161],"source":" Name the new role **CompanyFilter**."},{"content":"A <bpt id=\"p1\">**</bpt>COMPANY<ept id=\"p1\">**</ept> field must be present in the data model to restrict access by company.","pos":[7162,7246],"source":" A **COMPANY** field must be present in the data model to restrict access by company."},{"content":"Create a new role","pos":[7254,7271]},{"pos":[7312,7389],"content":"In the <bpt id=\"p1\">**</bpt>Table filter DAX expression<ept id=\"p1\">**</ept> field, enter <bpt id=\"p2\">**</bpt>[COMPANY]=username()<ept id=\"p2\">**</ept>.","source":"In the **Table filter DAX expression** field, enter **[COMPANY]=username()**."},{"content":"To make sure that the rules work, on the <bpt id=\"p1\">**</bpt>Modeling<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>View as Roles<ept id=\"p2\">**</ept>.","pos":[7393,7476],"source":"To make sure that the rules work, on the **Modeling** tab, click **View as Roles**."},{"content":"In the dialog box, set the following fields:","pos":[7477,7521]},{"pos":[7530,7559],"content":"Clear the <bpt id=\"p1\">**</bpt>None<ept id=\"p1\">**</ept> check box.","source":"Clear the **None** check box."},{"pos":[7567,7644],"content":"Select the <bpt id=\"p1\">**</bpt>Other user<ept id=\"p1\">**</ept> check box, and then enter <bpt id=\"p2\">**</bpt>USMF<ept id=\"p2\">**</ept> in the text box.","source":"Select the **Other user** check box, and then enter **USMF** in the text box."},{"pos":[7652,7691],"content":"Select the <bpt id=\"p1\">**</bpt>CompanyFilter<ept id=\"p1\">**</ept> check box.","source":"Select the **CompanyFilter** check box."},{"content":"The reports will now show data as if you're running the USMF company.","pos":[7693,7762]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Row level security with Power BI Embedded<ept id=\"p1\">](https://docs.microsoft.com/en-us/azure/power-bi-embedded/power-bi-embedded-rls)</ept>.","pos":[7763,7913],"source":" For more information, see [Row level security with Power BI Embedded](https://docs.microsoft.com/en-us/azure/power-bi-embedded/power-bi-embedded-rls)."}]}