{"content":"---\n# required metadata\n\ntitle: Upgrade cutover testing\ndescription: This topic explains how to test the tasks that occur after you turn off AX 2012 but before you turn on Dynamics 365 for Finance and Operations, Enterprise edition. \nauthor: tariqbell\nmanager: AnnBe\nms.date: 05/29/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \naudience: Developer;IT Pro\n# ms.devlang: \nms.reviewer: margoc\nms.search.scope: Operations Platform\n# ms.tgt_pltfrm: \n# ms.custom: \nms.search.region: Global\n# ms.search.industry: \nms.author: tabell\nms.search.validFrom: 2017-06-16\nms.dyn365.ops.version: Platform update 8\n---\n\n# Upgrade cutover testing\n\n[!include[banner](../includes/banner.md)]\n\n*Cutover* is the term that we use for the final process of getting a new system live. This cutover process consists of the tasks that occur after Microsoft Dynamics AX 2012 is turned off but before Microsoft Dynamics 365 for Finance and Operations, Enterprise edition, is turned on. The purpose of upgrade cutover testing is to practice the cutover process, to help guarantee a smooth experience for everyone who is involved during the actual cutover to go-live.\n\nThere are two main workstreams during a cutover:\n\n- **Technical workstream** – This workstream includes the data upgrade execution process. Your business will enforce a limit on the amount of downtime that is allowed. During this downtime, neither AX 2012 nor Finance and Operations will be available. This workstream might have to tune the data upgrade procedure to meet the business's downtime limit.\n- **Functional workstream** – This workstream includes the configuration tasks that are performed after the data upgrade is completed. All these tasks must be documented and quantified, and a resource must be assigned, because both the functional workstream and the technical workstream must fit within the business's downtime limit.\n\nThe following illustration shows the overall process for cutover to go-live as it will occur in the production environment.\n\n![Cutover process](./media/cutover_1.png)\n\nThis cutover process differs from a basic data upgrade in a sandbox environment in the following ways:\n\n- The AX 2012 database isn’t copied but is only backed up, and then the original database is modified. This approach is faster, and the backup provides rollback, if rollback is required.\n- Because the production environment for Finance and Operations has restricted access, the tasks that were previously performed on the sandbox instance of Application Object Server (AOS) are now performed by the Microsoft DSE team. These tasks include downloading and importing the bacpac file, and running the MajorversionDataUpgrade.zip package.\n- We added the following tasks:\n\n    - Perform a smoke test.\n    - Complete application setup tasks. This step can be large, depending on the functionality that is used. During this step, the functional team configures new application functionality so that it's ready to be used in the upgraded system.\n    - Allow users back in. Notify your user base that the upgrade is completed and that they can use the system again.\n\n## Technical workstream\n\nThe technical workstream involves various technical team members: the database administrator (DBA), the AX 2012 system administrator, server administrators, and developers who are familiar with AX 2012 and Finance and Operations. This topic will explain which tasks involve which roles.\n\nDuring cutover testing, the technical team is focused on performance and reliability testing of the data upgrade process, to make sure that it meets the business's downtime limit. Many elements of hardware and software are involved in this process. Some of these elements are on-premises, whereas others are in the Microsoft cloud. In addition, many elements of custom application code and standard code are involved. The result of this testing should be confidence in the cutover process for your environment.\n\n### Turn off the AX 2012 AOS instances\n\nThis task involves the AX 2012 system administrator and the server administrators.\n\nThe following areas should be validated:\n\n- **Batch jobs that are running at the time of cutover** – A long-running batch job that has already started to run will prevent the system from stopping. Plan ahead, so that you can stop your AOS instances at the desired moment. You might have to schedule batches so that they're completed some time before you turn off AX 2012.\n- **Integrated systems** – You might have other systems that are integrated with the AX 2012 environment. You must factor these systems into your plan to turn off AX 2012. For example, you might have to turn off the integrated systems some time before you turn off AX 2012 itself, so that any remaining in-flight transactions can be completed. The requirements for integrated systems vary widely from business to business. Therefore, your team of experts must plan for this scenario independently.\n\n### Create a backup of the AX 2012 database\n\nThis task involves the DBA. The backup will be used if a rollback is required. It will also be used as a reference point that will be kept for a period and show the system state at the moment of cutover.\n\nThe following areas should be validated:\n\n- Get concrete timings for the backup process.\n- Adjust the backup options that are used (for example, compression versus non-compression), to help guarantee the fastest possible backup.\n\n### Export the database to bacpac\n\nThis task involves the DBA. The output of this task is the export file that will be uploaded to Microsoft Azure for the new system.\n\nThe following areas should be validated:\n\n- Get concrete timings for the backup process.\n- Optimize the export process to help guarantee the fastest possible experience. Optimization might require the following tasks:\n\n    - Measure system resources during export, such as CPU, disk I/O, and memory.\n    - If resource bottlenecks are found, create a plan to mitigate them. Typically, you will mitigate these bottlenecks by assigning more of the required resource.\n\n### Upload the bacpac file to Azure storage\n\nThis task involves the DBA or the server administrators. During this task, the bacpac file is moved into Azure.\n\nThe following areas should be validated:\n\n- Select the machine that will be used for upload, and make sure that the Azure Storage explorer tool is configured and ready to use.\n- Get concrete timings for the upload process by measuring it several times. Upload times will vary, based on the speed of your Internet connection and the geographical location of the Azure datacenter in relation to your location.\n\n### Download and import the bacpac file to the Azure SQL database\n\nWhen this task occurs at go-live, it will be performed by the Microsoft DSE team. However, during cutover testing, it involves your DBA. The outcome of this task is the export file that will be uploaded to Azure for the new system.\n\nThe following areas should be validated:\n\n- Get concrete timings for the import process.\n- Optimize the export process to help guarantee the fastest possible experience. Optimization might require the following tasks:\n\n    - Measure system resources during export. Here are some examples:\n\n        - **On the AOS machine:** CPU, disk I/O, and memory\n        - **On the Azure SQL Database instance:** SQL database throughput (DTU). You can monitor Azure SQL DTU from Microsoft SQL Server Management Studio on the AOS machine by looking at the sys.dm_resource_stats system view.\n\n    - If resource bottlenecks are found, create a plan to mitigate them. Typically, you will mitigate these bottlenecks by assigning more of the required resource. Because this machine is Microsoft-hosted, you must submit a request to Microsoft to increase resources if you identify that they are a bottleneck.\n\n### Run the MajorVersiondataUpgrade.zip package\n\nWhen this task occurs at go-live, it will be performed by the Microsoft DSE team. However, during cutover testing, it involves the developers. During this task, the old database structure is transformed to the structure of the new system.\n\nThe database synchronization process runs as part of this task. Database synchronization might take a significant amount of time in some situations, such as when a clustered index has changed on a table, because this operation is a costly operation in SQL.\n\nWe strongly recommend that you first perform your analysis and debugging process in a development environment. In a sandbox environment, debugging and analysis options are more restricted. The goal is to have few or no issues that must be addressed when you do cutover testing.\n\nThe following areas should be validated:\n\n- Get concrete timings for the import process.\n- Optimize the process to help guarantee the fastest experience. Optimization might require the following tasks:\n\n    - Monitor the performance of individual upgrade scripts through the ReleaseUpdateScriptsExecution table.\n    - Adjust scripts to optimize performance. This task might require that you customize a script’s X++ code to optimize it for your dataset.\n    - Monitor Azure SQL DTU by using Microsoft Dynamics Lifecycle Services (LCS) monitoring or the sys.dm_resources_stats system view in Management Studio. If resources are maxed out, you might have to request a higher database level from the Microsoft DSE team.\n\n### Roll back to AX 2012\n\nThe goal of this task is to restore the database by using the backup that was made when AX 2012 was turned off, and then turn AX 2012 back on. The state of integrated systems might also have to be restored. However, because integrated systems vary from business to business, you must plan for this scenario independently, based on your specific circumstances. Although it's unlikely that you will have to roll back, it's very important that you have a tested process in case you require it.\n\n## Functional workstream\n\nAfter data upgrade, several configuration tasks will be required in the new environment. The goal of this workstream is to document and quantify all configuration tasks, and to assign a resource to each task, to help guarantee that these tasks can be done together with the technical workstream during the downtime window.\n\nTypically, functional tasks involve changing the values of specific system parameters or other configuration data. These tasks are identified through the full functional test pass, which is a separate activity from the cutover testing. When a task of this type is identified, it should be reviewed together with the functional resource and your developer.\n\nLarger changes might require that a new custom data upgrade script be written to update the data during the data upgrade process. However, the functional resource can manually run smaller changes through the new system after data upgrade.\n\nLarger changes that have new data upgrade scripts must be tested. Therefore, one or more additional iterations of the MajorVersionDataUpgrade.zip package will have to be run. It's important that you weigh the cost of running the package again against the cost of manual data entry.\n\nFor each manual change, a task must be added to the cutover plan document. This task must show the following details:\n\n-   What is the task, and what must be done?\n-   Who must do it?\n-   How long does it take?\n","nodes":[{"content":"Upgrade cutover testing","nodes":[{"pos":[0,23],"content":"Upgrade cutover testing","nodes":[{"content":"Upgrade cutover testing","pos":[0,23]}]}],"pos":[31,55],"yaml":true},{"content":"This topic explains how to test the tasks that occur after you turn off AX 2012 but before you turn on Dynamics 365 for Finance and Operations, Enterprise edition.","nodes":[{"pos":[0,163],"content":"This topic explains how to test the tasks that occur after you turn off AX 2012 but before you turn on Dynamics 365 for Finance and Operations, Enterprise edition.","nodes":[{"content":"This topic explains how to test the tasks that occur after you turn off AX 2012 but before you turn on Dynamics 365 for Finance and Operations, Enterprise edition.","pos":[0,163]}]}],"pos":[68,232],"yaml":true},{"pos":[682,705],"content":"Upgrade cutover testing","linkify":"Upgrade cutover testing","nodes":[{"content":"Upgrade cutover testing","pos":[0,23]}]},{"content":"<bpt id=\"p1\">*</bpt>Cutover<ept id=\"p1\">*</ept> is the term that we use for the final process of getting a new system live.","pos":[750,835],"source":"*Cutover* is the term that we use for the final process of getting a new system live."},{"content":"This cutover process consists of the tasks that occur after Microsoft Dynamics AX 2012 is turned off but before Microsoft Dynamics 365 for Finance and Operations, Enterprise edition, is turned on.","pos":[836,1032]},{"content":"The purpose of upgrade cutover testing is to practice the cutover process, to help guarantee a smooth experience for everyone who is involved during the actual cutover to go-live.","pos":[1033,1212]},{"content":"There are two main workstreams during a cutover:","pos":[1214,1262]},{"content":"<bpt id=\"p1\">**</bpt>Technical workstream<ept id=\"p1\">**</ept> – This workstream includes the data upgrade execution process.","pos":[1266,1353],"source":"**Technical workstream** – This workstream includes the data upgrade execution process."},{"content":"Your business will enforce a limit on the amount of downtime that is allowed.","pos":[1354,1431]},{"content":"During this downtime, neither AX 2012 nor Finance and Operations will be available.","pos":[1432,1515]},{"content":"This workstream might have to tune the data upgrade procedure to meet the business's downtime limit.","pos":[1516,1616]},{"content":"<bpt id=\"p1\">**</bpt>Functional workstream<ept id=\"p1\">**</ept> – This workstream includes the configuration tasks that are performed after the data upgrade is completed.","pos":[1619,1751],"source":"**Functional workstream** – This workstream includes the configuration tasks that are performed after the data upgrade is completed."},{"content":"All these tasks must be documented and quantified, and a resource must be assigned, because both the functional workstream and the technical workstream must fit within the business's downtime limit.","pos":[1752,1950]},{"content":"The following illustration shows the overall process for cutover to go-live as it will occur in the production environment.","pos":[1952,2075]},{"content":"Cutover process","pos":[2079,2094]},{"content":"This cutover process differs from a basic data upgrade in a sandbox environment in the following ways:","pos":[2120,2222]},{"content":"The AX 2012 database isn’t copied but is only backed up, and then the original database is modified.","pos":[2226,2326]},{"content":"This approach is faster, and the backup provides rollback, if rollback is required.","pos":[2327,2410]},{"content":"Because the production environment for Finance and Operations has restricted access, the tasks that were previously performed on the sandbox instance of Application Object Server (AOS) are now performed by the Microsoft DSE team.","pos":[2413,2642]},{"content":"These tasks include downloading and importing the bacpac file, and running the MajorversionDataUpgrade.zip package.","pos":[2643,2758]},{"content":"We added the following tasks:","pos":[2761,2790]},{"content":"Perform a smoke test.","pos":[2798,2819]},{"content":"Complete application setup tasks.","pos":[2826,2859]},{"content":"This step can be large, depending on the functionality that is used.","pos":[2860,2928]},{"content":"During this step, the functional team configures new application functionality so that it's ready to be used in the upgraded system.","pos":[2929,3061]},{"content":"Allow users back in.","pos":[3068,3088]},{"content":"Notify your user base that the upgrade is completed and that they can use the system again.","pos":[3089,3180]},{"pos":[3185,3205],"content":"Technical workstream","linkify":"Technical workstream","nodes":[{"content":"Technical workstream","pos":[0,20]}]},{"content":"The technical workstream involves various technical team members: the database administrator (DBA), the AX 2012 system administrator, server administrators, and developers who are familiar with AX 2012 and Finance and Operations.","pos":[3207,3436]},{"content":"This topic will explain which tasks involve which roles.","pos":[3437,3493]},{"content":"During cutover testing, the technical team is focused on performance and reliability testing of the data upgrade process, to make sure that it meets the business's downtime limit.","pos":[3495,3674]},{"content":"Many elements of hardware and software are involved in this process.","pos":[3675,3743]},{"content":"Some of these elements are on-premises, whereas others are in the Microsoft cloud.","pos":[3744,3826]},{"content":"In addition, many elements of custom application code and standard code are involved.","pos":[3827,3912]},{"content":"The result of this testing should be confidence in the cutover process for your environment.","pos":[3913,4005]},{"pos":[4011,4045],"content":"Turn off the AX 2012 AOS instances","linkify":"Turn off the AX 2012 AOS instances","nodes":[{"content":"Turn off the AX 2012 AOS instances","pos":[0,34]}]},{"content":"This task involves the AX 2012 system administrator and the server administrators.","pos":[4047,4129]},{"content":"The following areas should be validated:","pos":[4131,4171]},{"content":"<bpt id=\"p1\">**</bpt>Batch jobs that are running at the time of cutover<ept id=\"p1\">**</ept> – A long-running batch job that has already started to run will prevent the system from stopping.","pos":[4175,4327],"source":"**Batch jobs that are running at the time of cutover** – A long-running batch job that has already started to run will prevent the system from stopping."},{"content":"Plan ahead, so that you can stop your AOS instances at the desired moment.","pos":[4328,4402]},{"content":"You might have to schedule batches so that they're completed some time before you turn off AX 2012.","pos":[4403,4502]},{"content":"<bpt id=\"p1\">**</bpt>Integrated systems<ept id=\"p1\">**</ept> – You might have other systems that are integrated with the AX 2012 environment.","pos":[4505,4608],"source":"**Integrated systems** – You might have other systems that are integrated with the AX 2012 environment."},{"content":"You must factor these systems into your plan to turn off AX 2012.","pos":[4609,4674]},{"content":"For example, you might have to turn off the integrated systems some time before you turn off AX 2012 itself, so that any remaining in-flight transactions can be completed.","pos":[4675,4846]},{"content":"The requirements for integrated systems vary widely from business to business.","pos":[4847,4925]},{"content":"Therefore, your team of experts must plan for this scenario independently.","pos":[4926,5000]},{"pos":[5006,5045],"content":"Create a backup of the AX 2012 database","linkify":"Create a backup of the AX 2012 database","nodes":[{"content":"Create a backup of the AX 2012 database","pos":[0,39]}]},{"content":"This task involves the DBA.","pos":[5047,5074]},{"content":"The backup will be used if a rollback is required.","pos":[5075,5125]},{"content":"It will also be used as a reference point that will be kept for a period and show the system state at the moment of cutover.","pos":[5126,5250]},{"content":"The following areas should be validated:","pos":[5252,5292]},{"content":"Get concrete timings for the backup process.","pos":[5296,5340]},{"content":"Adjust the backup options that are used (for example, compression versus non-compression), to help guarantee the fastest possible backup.","pos":[5343,5480]},{"pos":[5486,5515],"content":"Export the database to bacpac","linkify":"Export the database to bacpac","nodes":[{"content":"Export the database to bacpac","pos":[0,29]}]},{"content":"This task involves the DBA.","pos":[5517,5544]},{"content":"The output of this task is the export file that will be uploaded to Microsoft Azure for the new system.","pos":[5545,5648]},{"content":"The following areas should be validated:","pos":[5650,5690]},{"content":"Get concrete timings for the backup process.","pos":[5694,5738]},{"content":"Optimize the export process to help guarantee the fastest possible experience.","pos":[5741,5819]},{"content":"Optimization might require the following tasks:","pos":[5820,5867]},{"content":"Measure system resources during export, such as CPU, disk I/O, and memory.","pos":[5875,5949]},{"content":"If resource bottlenecks are found, create a plan to mitigate them.","pos":[5956,6022]},{"content":"Typically, you will mitigate these bottlenecks by assigning more of the required resource.","pos":[6023,6113]},{"pos":[6119,6158],"content":"Upload the bacpac file to Azure storage","linkify":"Upload the bacpac file to Azure storage","nodes":[{"content":"Upload the bacpac file to Azure storage","pos":[0,39]}]},{"content":"This task involves the DBA or the server administrators.","pos":[6160,6216]},{"content":"During this task, the bacpac file is moved into Azure.","pos":[6217,6271]},{"content":"The following areas should be validated:","pos":[6273,6313]},{"content":"Select the machine that will be used for upload, and make sure that the Azure Storage explorer tool is configured and ready to use.","pos":[6317,6448]},{"content":"Get concrete timings for the upload process by measuring it several times.","pos":[6451,6525]},{"content":"Upload times will vary, based on the speed of your Internet connection and the geographical location of the Azure datacenter in relation to your location.","pos":[6526,6680]},{"pos":[6686,6747],"content":"Download and import the bacpac file to the Azure SQL database","linkify":"Download and import the bacpac file to the Azure SQL database","nodes":[{"content":"Download and import the bacpac file to the Azure SQL database","pos":[0,61]}]},{"content":"When this task occurs at go-live, it will be performed by the Microsoft DSE team.","pos":[6749,6830]},{"content":"However, during cutover testing, it involves your DBA.","pos":[6831,6885]},{"content":"The outcome of this task is the export file that will be uploaded to Azure for the new system.","pos":[6886,6980]},{"content":"The following areas should be validated:","pos":[6982,7022]},{"content":"Get concrete timings for the import process.","pos":[7026,7070]},{"content":"Optimize the export process to help guarantee the fastest possible experience.","pos":[7073,7151]},{"content":"Optimization might require the following tasks:","pos":[7152,7199]},{"content":"Measure system resources during export.","pos":[7207,7246]},{"content":"Here are some examples:","pos":[7247,7270]},{"pos":[7282,7331],"content":"<bpt id=\"p1\">**</bpt>On the AOS machine:<ept id=\"p1\">**</ept> CPU, disk I/O, and memory","source":"**On the AOS machine:** CPU, disk I/O, and memory"},{"content":"<bpt id=\"p1\">**</bpt>On the Azure SQL Database instance:<ept id=\"p1\">**</ept> SQL database throughput (DTU).","pos":[7342,7412],"source":"**On the Azure SQL Database instance:** SQL database throughput (DTU)."},{"content":"You can monitor Azure SQL DTU from Microsoft SQL Server Management Studio on the AOS machine by looking at the sys.dm_resource_stats system view.","pos":[7413,7558]},{"content":"If resource bottlenecks are found, create a plan to mitigate them.","pos":[7566,7632]},{"content":"Typically, you will mitigate these bottlenecks by assigning more of the required resource.","pos":[7633,7723]},{"content":"Because this machine is Microsoft-hosted, you must submit a request to Microsoft to increase resources if you identify that they are a bottleneck.","pos":[7724,7870]},{"pos":[7876,7919],"content":"Run the MajorVersiondataUpgrade.zip package","linkify":"Run the MajorVersiondataUpgrade.zip package","nodes":[{"content":"Run the MajorVersiondataUpgrade.zip package","pos":[0,43]}]},{"content":"When this task occurs at go-live, it will be performed by the Microsoft DSE team.","pos":[7921,8002]},{"content":"However, during cutover testing, it involves the developers.","pos":[8003,8063]},{"content":"During this task, the old database structure is transformed to the structure of the new system.","pos":[8064,8159]},{"content":"The database synchronization process runs as part of this task.","pos":[8161,8224]},{"content":"Database synchronization might take a significant amount of time in some situations, such as when a clustered index has changed on a table, because this operation is a costly operation in SQL.","pos":[8225,8417]},{"content":"We strongly recommend that you first perform your analysis and debugging process in a development environment.","pos":[8419,8529]},{"content":"In a sandbox environment, debugging and analysis options are more restricted.","pos":[8530,8607]},{"content":"The goal is to have few or no issues that must be addressed when you do cutover testing.","pos":[8608,8696]},{"content":"The following areas should be validated:","pos":[8698,8738]},{"content":"Get concrete timings for the import process.","pos":[8742,8786]},{"content":"Optimize the process to help guarantee the fastest experience.","pos":[8789,8851]},{"content":"Optimization might require the following tasks:","pos":[8852,8899]},{"content":"Monitor the performance of individual upgrade scripts through the ReleaseUpdateScriptsExecution table.","pos":[8907,9009]},{"content":"Adjust scripts to optimize performance.","pos":[9016,9055]},{"content":"This task might require that you customize a script’s X++ code to optimize it for your dataset.","pos":[9056,9151]},{"content":"Monitor Azure SQL DTU by using Microsoft Dynamics Lifecycle Services (LCS) monitoring or the sys.dm_resources_stats system view in Management Studio.","pos":[9158,9307]},{"content":"If resources are maxed out, you might have to request a higher database level from the Microsoft DSE team.","pos":[9308,9414]},{"pos":[9420,9440],"content":"Roll back to AX 2012","linkify":"Roll back to AX 2012","nodes":[{"content":"Roll back to AX 2012","pos":[0,20]}]},{"content":"The goal of this task is to restore the database by using the backup that was made when AX 2012 was turned off, and then turn AX 2012 back on.","pos":[9442,9584]},{"content":"The state of integrated systems might also have to be restored.","pos":[9585,9648]},{"content":"However, because integrated systems vary from business to business, you must plan for this scenario independently, based on your specific circumstances.","pos":[9649,9801]},{"content":"Although it's unlikely that you will have to roll back, it's very important that you have a tested process in case you require it.","pos":[9802,9932]},{"pos":[9937,9958],"content":"Functional workstream","linkify":"Functional workstream","nodes":[{"content":"Functional workstream","pos":[0,21]}]},{"content":"After data upgrade, several configuration tasks will be required in the new environment.","pos":[9960,10048]},{"content":"The goal of this workstream is to document and quantify all configuration tasks, and to assign a resource to each task, to help guarantee that these tasks can be done together with the technical workstream during the downtime window.","pos":[10049,10282]},{"content":"Typically, functional tasks involve changing the values of specific system parameters or other configuration data.","pos":[10284,10398]},{"content":"These tasks are identified through the full functional test pass, which is a separate activity from the cutover testing.","pos":[10399,10519]},{"content":"When a task of this type is identified, it should be reviewed together with the functional resource and your developer.","pos":[10520,10639]},{"content":"Larger changes might require that a new custom data upgrade script be written to update the data during the data upgrade process.","pos":[10641,10770]},{"content":"However, the functional resource can manually run smaller changes through the new system after data upgrade.","pos":[10771,10879]},{"content":"Larger changes that have new data upgrade scripts must be tested.","pos":[10881,10946]},{"content":"Therefore, one or more additional iterations of the MajorVersionDataUpgrade.zip package will have to be run.","pos":[10947,11055]},{"content":"It's important that you weigh the cost of running the package again against the cost of manual data entry.","pos":[11056,11162]},{"content":"For each manual change, a task must be added to the cutover plan document.","pos":[11164,11238]},{"content":"This task must show the following details:","pos":[11239,11281]},{"content":"What is the task, and what must be done?","pos":[11287,11327]},{"content":"Who must do it?","pos":[11332,11347]},{"content":"How long does it take?","pos":[11352,11374]}]}