{"content":"---\n# required metadata\n\ntitle: Expand Application Suite report data sets\ndescription: This topic shows how to expand an existing report data set that is produced by using X++ business logic in a report data provider (RDP) class. \nauthor: sericks007\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \n# ms.reviewer: 2051\nms.search.scope: Operations, Platform\n# ms.tgt_pltfrm: \nms.custom: 266594\nms.assetid: 7810ee2c-e012-4a0f-992c-840e626bf437\nms.search.region: Global\n# ms.search.industry: \nms.author: tjvass\nms.search.validFrom: 2016-11-30\nms.dyn365.ops.version: Platform update 3\n\n---\n\n# Expand Application Suite report data sets\n\n[!include[banner](../includes/banner.md)]\n\n\nThis topic shows how to expand an existing report data set that is produced by using X++ business logic in a report data provider (RDP) class. \n\nMicrosoft Dynamics 365 for Operations offers an expanded set of tools to support custom solutions. This topic focuses on the expansion of an existing report data set that is produced by using X++ business logic in a report data provider (RDP) class. You use custom delegate handlers and table extensions to include additional field data and/or calculations. You don't have to over-layer the Application Suite. You then create custom designs that replace the standard application solutions and present the data to users. The following illustration shows a typical application customization, as described in this topic.\n\n[![extendingdatasets](./media/extendingdatasets.png)](./media/extendingdatasets.png)  \n\n## What's important to know?\nThere are a few basic assumptions that you should be aware of before you apply this solution.\n\n-   **You can't directly extend RDP classes.** However, the platform provides extension points that enable data set expansion without duplicating business logic in the standard application.\n-   **There are two methods that can be used to expand report data sets.** Use the strategy that is appropriate for your solution:\n    -   **Data processing post-handler** – This method is called only one time, after the **ProcessReport** method is completed and before the data set is returned to the report server. Register for this post-handler to perform bulk updates on the temporary data set that is produced by the standard application solution.\n    -   **Temp table inserting event** – This method is called for each row that is added to the temporary table. It's more suitable for calculations and inline evaluations. Try to avoid expensive queries that have many joins and look-up operations.\n-   **Use event handlers to redirect menu items to your new report design.** You can customize all aspects of an application reporting solution by using event handlers. Add a **PostHandler** event for the controller class to reroute user navigations to a custom report design.\n\n## Expand a report data set\nThe following walkthrough shows the process of expanding an existing application data set by using a \"pure\" extension-based solution. The solution includes a custom **Rentals list** report for the Fleet Management application. The new report includes additional rental charge data in the rental details. The application customizations are defined in an extension model. The following illustrations show the standard design and the custom solution.\n\n### Before (standard design)\n\n[![Standard design (before customization)](./media/fleet-extension-rentals-list-before-1024x673.png)](./media/fleet-extension-rentals-list-before.png)\n\n### After (custom solution)\n\n[![Custom solution (after customization)](./media/fleet-extension-rentals-list-after-1024x672.png)](./media/fleet-extension-rentals-list-after.png)\n\n1.  **Create a new model for your application customizations.** For more information about extension models, see [Customization: Overlayering and extensions](..\\extensibility\\customization-overlayering-extensions.md). For this example, add a custom report to the **Fleet Management Extensions** model.\n2.  **Create a new project in Microsoft Visual Studio.** Make sure that the project is associated with your extension model. The following illustration shows the project settings. \n    \n    [![Project settings in Visual Studio](./media/fleet-extension-vs-project-settings.png)](./media/fleet-extension-vs-project-settings.png)\n\n3.  **Add a table extension to store the custom report data.** Find the temporary cache for the **TmpFMRentalsByCust** data set that is populated by the RDP class, and create an extension in your model. Define the fields that will be used to store the data for the report server, and then click **Save** to save your changes. The following illustration shows the table extension that is required for this example. \n\n    [![Table extension for this example](./media/fleet-extension-table-extension.png)](./media/fleet-extension-table-extension.png)\n\n4.  **Add your custom report to the project.** The custom design closely resembles the standard solution. Therefore, you can just duplicate the existing application report in the **Fleet Management Extension** model, and then update the report design so that it includes the custom title and additional text box in the Rental Charges container.\n5.  **Rename the report so that it has a meaningful name.** For this example, rename the custom report **FERentalsByCustomer** to distinguish it from the standard solution.\n6.  **Restore the report data set references.** Open the report designer, expand the **Datasets** collection, right-click the data set that is named **FMRentalsByCustDS**, and then click **Restore**. The data set is expanded so that it includes the newly introduced columns. Therefore, these columns are now available in the report designer.\n7.  **Customize the report design.** The designer offers a free-form design surface that you can use to create the custom solution. The following illustration shows the custom design that is used for this example. \n\n    [![Custom design for this example](./media/fleet-extension-custom-design.png)](./media/fleet-extension-custom-design.png)\n    \n8.  **Add a new report handler (X++) class to the project.** Give the class a name that appropriately describes that it's a handler for an existing application report. For this example, rename the class **FERentalsByCustomerHandler** to distinguish it from other report handlers.\n9.  **Add a PostHandler method to begin to use your custom report.** In this example, extend the controller class in the standard solution, **FMRentalsByCustController**, by using the following code.\n\n        class FERentalsByCustomerHandler\n        {\n            [PostHandlerFor(classStr(FMRentalsByCustController), staticMethodStr(FMRentalsByCustController, construct))]\n            public static void ReportNamePostHandler(XppPrePostArgs arguments)\n            {\n                FMRentalsByCustController controller = arguments.getReturnValue();\n                controller.parmReportName(ssrsreportstr(FERentalsByCustomer, Report));\n            }\n        }\n\n    User navigations in the application will now be rerouted to the custom reporting solution. Take some time to deploy the custom report to the report server and verify that the application is using it. At this point, you just have to add the business logic that is used to populate the custom fields that you introduced in step 3. In the next step, you must select the method of data set expansion that is appropriate for your solution.\n\n10. **Add X++ business logic to populate the custom field data.** Select the data processing technique that makes sense for the type of transformation that you require for the solution.\n    -   **Option 1: Add a data processing post-handler.** Apply this technique for bulk insert operations that use a single pass over the result set of the standard solution. Here is the code that expands the data set by using a table lookup.\n\n            class FERentalsByCustomerHandler\n            {\n                [PostHandlerFor(classStr(FMRentalsByCustDP), methodstr(FMRentalsByCustDP, getTmpFMRentalsByCust))]\n                public static void TmpTablePostHandler(XppPrePostArgs arguments)\n                {\n                    TmpFMRentalsByCust tmpTable = arguments.getReturnValue();\n                    FMRentalCharge chargeTable;\n                    ttsbegin;\n                        while select forUpdate tmpTable\n                        {\n                            select * from chargeTable where chargeTable.RentalId == tmpTable.RentalId;\n                            tmpTable.ChargeDesc = chargeTable.Description;\n                            tmpTable.update();\n                        }\n                    ttscommit;\n                }\n            }\n\n    -   **Option 2: Add a temp table Inserting event.** Apply this technique for row-by-row calculations. Here is the code that expands the data set by using a table lookup.\n\n            class FERentalsByCustomerHandler\n            {\n                [DataEventHandlerAttribute(tableStr(TmpFMRentalsByCust), DataEventType::Inserting)]\n                public static void TmpFMRentalsByCustInsertEvent(Common c, DataEventArgs e)\n                {\n                    TmpFMRentalsByCust tempTable = c;\n                    FMRentalCharge chargeTable;\n                    // update the value of the 'ChargeDesc' column during 'insert' operation\n                    select * from chargeTable where chargeTable.RentalId == tempTable.RentalId\n                    && chargeTable.ChargeType == tempTable.ChargeType;\n                    tempTable.ChargeDesc = chargeTable.Description;\n                }\n            }\n\nYou’ve now finished expanding the report data set. After the application is compiled, it will begin to reroute user navigations to the new report design by using the custom X++ business logic that you defined in the report class handler that is defined in the extension model.\n\n\n\n","nodes":[{"pos":[4,732],"content":"# required metadata\n\ntitle: Expand Application Suite report data sets\ndescription: This topic shows how to expand an existing report data set that is produced by using X++ business logic in a report data provider (RDP) class. \nauthor: sericks007\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \n# ms.reviewer: 2051\nms.search.scope: Operations, Platform\n# ms.tgt_pltfrm: \nms.custom: 266594\nms.assetid: 7810ee2c-e012-4a0f-992c-840e626bf437\nms.search.region: Global\n# ms.search.industry: \nms.author: tjvass\nms.search.validFrom: 2016-11-30\nms.dyn365.ops.version: Platform update 3\n","nodes":[{"content":"Expand Application Suite report data sets","nodes":[{"pos":[0,41],"content":"Expand Application Suite report data sets","nodes":[{"content":"Expand Application Suite report data sets","pos":[0,41]}]}],"path":["title"]},{"content":"This topic shows how to expand an existing report data set that is produced by using X++ business logic in a report data provider (RDP) class.","nodes":[{"pos":[0,142],"content":"This topic shows how to expand an existing report data set that is produced by using X++ business logic in a report data provider (RDP) class.","nodes":[{"content":"This topic shows how to expand an existing report data set that is produced by using X++ business logic in a report data provider (RDP) class.","pos":[0,142]}]}],"path":["description"]}],"header":"# required metadata\n","yml":true},{"pos":[740,781],"content":"Expand Application Suite report data sets","linkify":"Expand Application Suite report data sets","nodes":[{"content":"Expand Application Suite report data sets","pos":[0,41]}]},{"content":"This topic shows how to expand an existing report data set that is produced by using X++ business logic in a report data provider (RDP) class.","pos":[827,969]},{"content":"Microsoft Dynamics 365 for Operations offers an expanded set of tools to support custom solutions.","pos":[972,1070]},{"content":"This topic focuses on the expansion of an existing report data set that is produced by using X++ business logic in a report data provider (RDP) class.","pos":[1071,1221]},{"content":"You use custom delegate handlers and table extensions to include additional field data and/or calculations.","pos":[1222,1329]},{"content":"You don't have to over-layer the Application Suite.","pos":[1330,1381]},{"content":"You then create custom designs that replace the standard application solutions and present the data to users.","pos":[1382,1491]},{"content":"The following illustration shows a typical application customization, as described in this topic.","pos":[1492,1589]},{"pos":[1591,1675],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>extendingdatasets<ept id=\"p1\">](./media/extendingdatasets.png)](./media/extendingdatasets.png)</ept>","source":"[![extendingdatasets](./media/extendingdatasets.png)](./media/extendingdatasets.png)"},{"pos":[1682,1707],"content":"What's important to know?","linkify":"What's important to know?","nodes":[{"content":"What's important to know?","pos":[0,25]}]},{"content":"There are a few basic assumptions that you should be aware of before you apply this solution.","pos":[1708,1801]},{"content":"<bpt id=\"p1\">**</bpt>You can't directly extend RDP classes.<ept id=\"p1\">**</ept>","pos":[1807,1849],"source":"**You can't directly extend RDP classes.**"},{"content":"However, the platform provides extension points that enable data set expansion without duplicating business logic in the standard application.","pos":[1850,1992]},{"content":"<bpt id=\"p1\">**</bpt>There are two methods that can be used to expand report data sets.<ept id=\"p1\">**</ept>","pos":[1997,2067],"source":"**There are two methods that can be used to expand report data sets.**"},{"content":"Use the strategy that is appropriate for your solution:","pos":[2068,2123]},{"content":"<bpt id=\"p1\">**</bpt>Data processing post-handler<ept id=\"p1\">**</ept> – This method is called only one time, after the <bpt id=\"p2\">**</bpt>ProcessReport<ept id=\"p2\">**</ept> method is completed and before the data set is returned to the report server.","pos":[2132,2309],"source":"**Data processing post-handler** – This method is called only one time, after the **ProcessReport** method is completed and before the data set is returned to the report server."},{"content":"Register for this post-handler to perform bulk updates on the temporary data set that is produced by the standard application solution.","pos":[2310,2445]},{"content":"<bpt id=\"p1\">**</bpt>Temp table inserting event<ept id=\"p1\">**</ept> – This method is called for each row that is added to the temporary table.","pos":[2454,2559],"source":"**Temp table inserting event** – This method is called for each row that is added to the temporary table."},{"content":"It's more suitable for calculations and inline evaluations.","pos":[2560,2619]},{"content":"Try to avoid expensive queries that have many joins and look-up operations.","pos":[2620,2695]},{"content":"<bpt id=\"p1\">**</bpt>Use event handlers to redirect menu items to your new report design.<ept id=\"p1\">**</ept>","pos":[2700,2772],"source":"**Use event handlers to redirect menu items to your new report design.**"},{"content":"You can customize all aspects of an application reporting solution by using event handlers.","pos":[2773,2864]},{"content":"Add a <bpt id=\"p1\">**</bpt>PostHandler<ept id=\"p1\">**</ept> event for the controller class to reroute user navigations to a custom report design.","pos":[2865,2972],"source":" Add a **PostHandler** event for the controller class to reroute user navigations to a custom report design."},{"pos":[2977,3001],"content":"Expand a report data set","linkify":"Expand a report data set","nodes":[{"content":"Expand a report data set","pos":[0,24]}]},{"content":"The following walkthrough shows the process of expanding an existing application data set by using a \"pure\" extension-based solution.","pos":[3002,3135]},{"content":"The solution includes a custom <bpt id=\"p1\">**</bpt>Rentals list<ept id=\"p1\">**</ept> report for the Fleet Management application.","pos":[3136,3228],"source":" The solution includes a custom **Rentals list** report for the Fleet Management application."},{"content":"The new report includes additional rental charge data in the rental details.","pos":[3229,3305]},{"content":"The application customizations are defined in an extension model.","pos":[3306,3371]},{"content":"The following illustrations show the standard design and the custom solution.","pos":[3372,3449]},{"pos":[3455,3479],"content":"Before (standard design)","linkify":"Before (standard design)","nodes":[{"content":"Before (standard design)","pos":[0,24]}]},{"pos":[3481,3631],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Standard design (before customization)<ept id=\"p1\">](./media/fleet-extension-rentals-list-before-1024x673.png)](./media/fleet-extension-rentals-list-before.png)</ept>","source":"[![Standard design (before customization)](./media/fleet-extension-rentals-list-before-1024x673.png)](./media/fleet-extension-rentals-list-before.png)"},{"pos":[3637,3660],"content":"After (custom solution)","linkify":"After (custom solution)","nodes":[{"content":"After (custom solution)","pos":[0,23]}]},{"pos":[3662,3809],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Custom solution (after customization)<ept id=\"p1\">](./media/fleet-extension-rentals-list-after-1024x672.png)](./media/fleet-extension-rentals-list-after.png)</ept>","source":"[![Custom solution (after customization)](./media/fleet-extension-rentals-list-after-1024x672.png)](./media/fleet-extension-rentals-list-after.png)"},{"content":"<bpt id=\"p1\">**</bpt>Create a new model for your application customizations.<ept id=\"p1\">**</ept>","pos":[3815,3874],"source":"**Create a new model for your application customizations.**"},{"content":"For more information about extension models, see <bpt id=\"p1\">[</bpt>Customization: Overlayering and extensions<ept id=\"p1\">](..\\extensibility\\customization-overlayering-extensions.md)</ept>.","pos":[3875,4028],"source":" For more information about extension models, see [Customization: Overlayering and extensions](..\\extensibility\\customization-overlayering-extensions.md)."},{"content":"For this example, add a custom report to the <bpt id=\"p1\">**</bpt>Fleet Management Extensions<ept id=\"p1\">**</ept> model.","pos":[4029,4112],"source":" For this example, add a custom report to the **Fleet Management Extensions** model."},{"content":"<bpt id=\"p1\">**</bpt>Create a new project in Microsoft Visual Studio.<ept id=\"p1\">**</ept>","pos":[4117,4169],"source":"**Create a new project in Microsoft Visual Studio.**"},{"content":"Make sure that the project is associated with your extension model.","pos":[4170,4237]},{"content":"The following illustration shows the project settings.","pos":[4238,4292]},{"pos":[4303,4439],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Project settings in Visual Studio<ept id=\"p1\">](./media/fleet-extension-vs-project-settings.png)](./media/fleet-extension-vs-project-settings.png)</ept>","source":"[![Project settings in Visual Studio](./media/fleet-extension-vs-project-settings.png)](./media/fleet-extension-vs-project-settings.png)"},{"content":"<bpt id=\"p1\">**</bpt>Add a table extension to store the custom report data.<ept id=\"p1\">**</ept>","pos":[4445,4503],"source":"**Add a table extension to store the custom report data.**"},{"content":"Find the temporary cache for the <bpt id=\"p1\">**</bpt>TmpFMRentalsByCust<ept id=\"p1\">**</ept> data set that is populated by the RDP class, and create an extension in your model.","pos":[4504,4643],"source":" Find the temporary cache for the **TmpFMRentalsByCust** data set that is populated by the RDP class, and create an extension in your model."},{"content":"Define the fields that will be used to store the data for the report server, and then click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> to save your changes.","pos":[4644,4766],"source":" Define the fields that will be used to store the data for the report server, and then click **Save** to save your changes."},{"content":"The following illustration shows the table extension that is required for this example.","pos":[4767,4854]},{"pos":[4861,4988],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Table extension for this example<ept id=\"p1\">](./media/fleet-extension-table-extension.png)](./media/fleet-extension-table-extension.png)</ept>","source":"[![Table extension for this example](./media/fleet-extension-table-extension.png)](./media/fleet-extension-table-extension.png)"},{"content":"<bpt id=\"p1\">**</bpt>Add your custom report to the project.<ept id=\"p1\">**</ept>","pos":[4994,5036],"source":"**Add your custom report to the project.**"},{"content":"The custom design closely resembles the standard solution.","pos":[5037,5095]},{"content":"Therefore, you can just duplicate the existing application report in the <bpt id=\"p1\">**</bpt>Fleet Management Extension<ept id=\"p1\">**</ept> model, and then update the report design so that it includes the custom title and additional text box in the Rental Charges container.","pos":[5096,5334],"source":" Therefore, you can just duplicate the existing application report in the **Fleet Management Extension** model, and then update the report design so that it includes the custom title and additional text box in the Rental Charges container."},{"content":"<bpt id=\"p1\">**</bpt>Rename the report so that it has a meaningful name.<ept id=\"p1\">**</ept>","pos":[5339,5394],"source":"**Rename the report so that it has a meaningful name.**"},{"content":"For this example, rename the custom report <bpt id=\"p1\">**</bpt>FERentalsByCustomer<ept id=\"p1\">**</ept> to distinguish it from the standard solution.","pos":[5395,5507],"source":" For this example, rename the custom report **FERentalsByCustomer** to distinguish it from the standard solution."},{"content":"<bpt id=\"p1\">**</bpt>Restore the report data set references.<ept id=\"p1\">**</ept>","pos":[5512,5555],"source":"**Restore the report data set references.**"},{"content":"Open the report designer, expand the <bpt id=\"p1\">**</bpt>Datasets<ept id=\"p1\">**</ept> collection, right-click the data set that is named <bpt id=\"p2\">**</bpt>FMRentalsByCustDS<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Restore<ept id=\"p3\">**</ept>.","pos":[5556,5707],"source":" Open the report designer, expand the **Datasets** collection, right-click the data set that is named **FMRentalsByCustDS**, and then click **Restore**."},{"content":"The data set is expanded so that it includes the newly introduced columns.","pos":[5708,5782]},{"content":"Therefore, these columns are now available in the report designer.","pos":[5783,5849]},{"content":"<bpt id=\"p1\">**</bpt>Customize the report design.<ept id=\"p1\">**</ept>","pos":[5854,5886],"source":"**Customize the report design.**"},{"content":"The designer offers a free-form design surface that you can use to create the custom solution.","pos":[5887,5981]},{"content":"The following illustration shows the custom design that is used for this example.","pos":[5982,6063]},{"pos":[6070,6191],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Custom design for this example<ept id=\"p1\">](./media/fleet-extension-custom-design.png)](./media/fleet-extension-custom-design.png)</ept>","source":"[![Custom design for this example](./media/fleet-extension-custom-design.png)](./media/fleet-extension-custom-design.png)"},{"content":"<bpt id=\"p1\">**</bpt>Add a new report handler (X++) class to the project.<ept id=\"p1\">**</ept>","pos":[6201,6257],"source":"**Add a new report handler (X++) class to the project.**"},{"content":"Give the class a name that appropriately describes that it's a handler for an existing application report.","pos":[6258,6364]},{"content":"For this example, rename the class <bpt id=\"p1\">**</bpt>FERentalsByCustomerHandler<ept id=\"p1\">**</ept> to distinguish it from other report handlers.","pos":[6365,6476],"source":" For this example, rename the class **FERentalsByCustomerHandler** to distinguish it from other report handlers."},{"content":"<bpt id=\"p1\">**</bpt>Add a PostHandler method to begin to use your custom report.<ept id=\"p1\">**</ept>","pos":[6481,6545],"source":"**Add a PostHandler method to begin to use your custom report.**"},{"content":"In this example, extend the controller class in the standard solution, <bpt id=\"p1\">**</bpt>FMRentalsByCustController<ept id=\"p1\">**</ept>, by using the following code.","pos":[6546,6676],"source":" In this example, extend the controller class in the standard solution, **FMRentalsByCustController**, by using the following code."},{"content":"User navigations in the application will now be rerouted to the custom reporting solution.","pos":[7142,7232]},{"content":"Take some time to deploy the custom report to the report server and verify that the application is using it.","pos":[7233,7341]},{"content":"At this point, you just have to add the business logic that is used to populate the custom fields that you introduced in step 3.","pos":[7342,7470]},{"content":"In the next step, you must select the method of data set expansion that is appropriate for your solution.","pos":[7471,7576]},{"content":"<bpt id=\"p1\">**</bpt>Add X++ business logic to populate the custom field data.<ept id=\"p1\">**</ept>","pos":[7582,7643],"source":"**Add X++ business logic to populate the custom field data.**"},{"content":"Select the data processing technique that makes sense for the type of transformation that you require for the solution.","pos":[7644,7763]},{"content":"<bpt id=\"p1\">**</bpt>Option 1: Add a data processing post-handler.<ept id=\"p1\">**</ept>","pos":[7772,7821],"source":"**Option 1: Add a data processing post-handler.**"},{"content":"Apply this technique for bulk insert operations that use a single pass over the result set of the standard solution.","pos":[7822,7938]},{"content":"Here is the code that expands the data set by using a table lookup.","pos":[7939,8006]},{"content":"<bpt id=\"p1\">**</bpt>Option 2: Add a temp table Inserting event.<ept id=\"p1\">**</ept>","pos":[8842,8889],"source":"**Option 2: Add a temp table Inserting event.**"},{"content":"Apply this technique for row-by-row calculations.","pos":[8890,8939]},{"content":"Here is the code that expands the data set by using a table lookup.","pos":[8940,9007]},{"content":"You’ve now finished expanding the report data set.","pos":[9740,9790]},{"content":"After the application is compiled, it will begin to reroute user navigations to the new report design by using the custom X++ business logic that you defined in the report class handler that is defined in the extension model.","pos":[9791,10016]}]}