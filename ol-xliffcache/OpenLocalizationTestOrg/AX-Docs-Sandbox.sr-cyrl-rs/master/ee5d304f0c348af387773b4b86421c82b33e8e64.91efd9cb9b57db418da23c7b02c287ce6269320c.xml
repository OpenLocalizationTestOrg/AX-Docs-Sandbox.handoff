{"nodes":[{"pos":[32,153],"content":"Use an Electronic reporting configuration to provide Power BI with data from Dynamics 365 for Operations | Microsoft Docs","needQuote":true,"needEscape":true,"nodes":[{"content":"Use an Electronic reporting configuration to provide Power BI with data from Dynamics 365 for Operations | Microsoft Docs","pos":[0,121]}]},{"pos":[167,607],"content":"This topic explains how you can use your Electronic reporting (ER) configuration to arrange the transfer of data from your instance of Dynamics 365 for Operations to Power BI services. As an example, this topic uses Intrastat transactions as business data that must be transferred. The Power BI map visualization uses this Intrastat transaction data to present a view for analysis of company import/export activities on the Power BI report.","needQuote":true,"needEscape":true,"nodes":[{"content":"This topic explains how you can use your Electronic reporting (ER) configuration to arrange the transfer of data from your instance of Dynamics 365 for Operations to Power BI services. As an example, this topic uses Intrastat transactions as business data that must be transferred. The Power BI map visualization uses this Intrastat transaction data to present a view for analysis of company import/export activities on the Power BI report.","pos":[0,440],"nodes":[{"content":"This topic explains how you can use your Electronic reporting (ER) configuration to arrange the transfer of data from your instance of Dynamics 365 for Operations to Power BI services.","pos":[0,184]},{"content":"As an example, this topic uses Intrastat transactions as business data that must be transferred.","pos":[185,281]},{"content":"The Power BI map visualization uses this Intrastat transaction data to present a view for analysis of company import/export activities on the Power BI report.","pos":[282,440]}]}]},{"pos":[1068,1172],"content":"Use an Electronic reporting configuration to provide Power BI with data from Dynamics 365 for Operations","linkify":"Use an Electronic reporting configuration to provide Power BI with data from Dynamics 365 for Operations","nodes":[{"content":"Use an Electronic reporting configuration to provide Power BI with data from Dynamics 365 for Operations","pos":[0,104]}]},{"pos":[1174,1182],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"Microsoft Power BI is a collection of software services, apps, and connectors that work together to turn external sources of data into coherent, visually immersive, and interactive insights.","pos":[1193,1383]},{"content":"Electronic reporting (ER) lets users of Microsoft Dynamics 365 for Operations easily configure data sources and arrange the transfer of data from Dynamics 365 for Operations to Power BI.","pos":[1384,1570]},{"content":"The data is transferred as files in the OpenXML worksheet (Microsoft Excel workbook file) format.","pos":[1571,1668]},{"content":"The transferred files are stored on a Microsoft SharePoint Server that has been configured for that purpose.","pos":[1669,1777]},{"content":"The stored files are used in Power BI to make reports that include visualizations (tables, charts, maps, and so on).","pos":[1778,1894]},{"content":"Power BI reports are shared with Power BI users, and they are accessed in Power BI dashboards and on Dynamics 365 for Operations pages.","pos":[1895,2030]},{"content":"This topic explains the following tasks:","pos":[2031,2071]},{"content":"Configure Dynamics 365 for Operations.","pos":[2077,2115]},{"content":"Prepare your ER format configuration to get data from Dynamics 365 for Operations.","pos":[2120,2202]},{"content":"Configure the ER environment to transfer data to Power BI.","pos":[2207,2265]},{"content":"Use transferred data to create a Power BI report.","pos":[2270,2319]},{"content":"Make the Power BI report accessible in Dynamics 365 for Operations.","pos":[2324,2391]},{"pos":[2396,2409],"content":"Prerequisites","linkify":"Prerequisites","nodes":[{"content":"Prerequisites","pos":[0,13]}]},{"content":"To complete the example in this topic, you must have the following access:","pos":[2410,2484]},{"content":"Access to Dynamics 365 for Operations for one of the following roles:","pos":[2490,2559]},{"content":"Electronic reporting developer","pos":[2568,2598]},{"content":"Electronic reporting functional consultant","pos":[2607,2649]},{"content":"System administrator","pos":[2658,2678]},{"content":"Access to the SharePoint Server that is configured for use with Dynamics 365 for Operations","pos":[2683,2774]},{"content":"Access to the Power BI framework","pos":[2779,2811]},{"pos":[2816,2856],"content":"Configure document management parameters","linkify":"Configure document management parameters","nodes":[{"content":"Configure document management parameters","pos":[0,40]}]},{"pos":[2861,3044],"content":"On the <bpt id=\"p1\">**</bpt>Document management parameters<ept id=\"p1\">**</ept> page, configure access to the SharePoint Server that will be used in the company that you're signed in to (the DEMF company in this example).","source":"On the **Document management parameters** page, configure access to the SharePoint Server that will be used in the company that you're signed in to (the DEMF company in this example)."},{"content":"Test the connection to the SharePoint Server to make sure that you've been granted access.","pos":[3049,3139]},{"content":"Document management parameters page","pos":[3142,3177]},{"content":"Open the configured SharePoint site.","pos":[3242,3278]},{"content":"Create a new folder where ER will store Excel files that have the business data that the Power BI reports require as a source of Power BI datasets.","pos":[3279,3426]},{"content":"In Dynamics 365 for Operations, on the <bpt id=\"p1\">**</bpt>Document types<ept id=\"p1\">**</ept> page, create a new document type that will be used to access the SharePoint folder that you just created.","pos":[3431,3594],"source":"In Dynamics 365 for Operations, on the **Document types** page, create a new document type that will be used to access the SharePoint folder that you just created."},{"content":"Enter <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Group<ept id=\"p2\">**</ept> field and <bpt id=\"p3\">**</bpt>SharePoint<ept id=\"p3\">**</ept> in the <bpt id=\"p4\">**</bpt>Location<ept id=\"p4\">**</ept> field, and then enter the address of the SharePoint folder.","pos":[3595,3731],"source":" Enter **File** in the **Group** field and **SharePoint** in the **Location** field, and then enter the address of the SharePoint folder."},{"content":"<ph id=\"ph1\">![</ph>Document types page<ph id=\"ph2\">](media/GER-Power-BI-sharepoint-document-type-1024x485.png)</ph>","pos":[3732,3812],"source":"![Document types page](media/GER-Power-BI-sharepoint-document-type-1024x485.png)"},{"pos":[3817,3840],"content":"Configure ER parameters","linkify":"Configure ER parameters","nodes":[{"content":"Configure ER parameters","pos":[0,23]}]},{"pos":[3845,3939],"content":"In the <bpt id=\"p1\">**</bpt>Electronic reporting<ept id=\"p1\">**</ept> workspace, click the <bpt id=\"p2\">**</bpt>Electronic reporting parameters<ept id=\"p2\">**</ept> link.","source":"In the **Electronic reporting** workspace, click the **Electronic reporting parameters** link."},{"pos":[3944,4025],"content":"On the <bpt id=\"p1\">**</bpt>Attachments<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept> document type for all the fields.","source":"On the **Attachments** tab, select the **File** document type for all the fields."},{"content":"In the <bpt id=\"p1\">**</bpt>Electronic reporting<ept id=\"p1\">**</ept> workspace, make the required provider active by clicking <bpt id=\"p2\">**</bpt>Set active<ept id=\"p2\">**</ept>.","pos":[4030,4134],"source":"In the **Electronic reporting** workspace, make the required provider active by clicking **Set active**."},{"content":"For more information, play the <bpt id=\"p1\">**</bpt>ER Select service provider<ept id=\"p1\">**</ept> task guide.","pos":[4135,4208],"source":" For more information, play the **ER Select service provider** task guide."},{"pos":[4213,4255],"content":"Use an ER data model as the source of data","linkify":"Use an ER data model as the source of data","nodes":[{"content":"Use an ER data model as the source of data","pos":[0,42]}]},{"content":"You must have an ER data model as the source of business data that will be used on Power BI reports.","pos":[4256,4356]},{"content":"This data model is uploaded from the ER configurations repository.","pos":[4357,4423]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Download Electronic reporting configurations from Lifecycle Services<ept id=\"p1\">](http://ax.help.dynamics.com/en/wiki/download-electronic-reporting-er-configuration-from-lifecycle-services/)</ept>, or play the <bpt id=\"p2\">**</bpt>ER Import a configuration from Lifecycle Services<ept id=\"p2\">**</ept> task guide.","pos":[4424,4708],"source":" For more information, see [Download Electronic reporting configurations from Lifecycle Services](http://ax.help.dynamics.com/en/wiki/download-electronic-reporting-er-configuration-from-lifecycle-services/), or play the **ER Import a configuration from Lifecycle Services** task guide."},{"content":"Select <bpt id=\"p1\">**</bpt>Intrastat<ept id=\"p1\">**</ept> as the data model that will be uploaded from the selected ER configurations repository.","pos":[4709,4817],"source":" Select **Intrastat** as the data model that will be uploaded from the selected ER configurations repository."},{"content":"(In this example, version 1 of the model is used.) You can then access the <bpt id=\"p1\">**</bpt>Intrastat<ept id=\"p1\">**</ept> ER model configuration on the <bpt id=\"p2\">**</bpt>Configurations<ept id=\"p2\">**</ept> page.","pos":[4818,4961],"source":" (In this example, version 1 of the model is used.) You can then access the **Intrastat** ER model configuration on the **Configurations** page."},{"content":"<ph id=\"ph1\">![</ph>Configurations page<ph id=\"ph2\">](media/GER-Power-BI-data-model-1024x371.png)</ph>","pos":[4962,5028],"source":"![Configurations page](media/GER-Power-BI-data-model-1024x371.png)"},{"pos":[5033,5066],"content":"Design an ER format configuration","linkify":"Design an ER format configuration","nodes":[{"content":"Design an ER format configuration","pos":[0,33]}]},{"content":"You must create a new ER format configuration that uses the <bpt id=\"p1\">**</bpt>Intrastat<ept id=\"p1\">**</ept> data model as the source of business data.","pos":[5067,5183],"source":"You must create a new ER format configuration that uses the **Intrastat** data model as the source of business data."},{"content":"This format configuration must generate output results as electronic documents in OpenXML (Excel file) format.","pos":[5184,5294]},{"content":"For more information, play the <bpt id=\"p1\">**</bpt>ER Create a configuration for reports in OPENXML format<ept id=\"p1\">**</ept> task guide.","pos":[5295,5397],"source":" For more information, play the **ER Create a configuration for reports in OPENXML format** task guide."},{"content":"Name the new configuration <bpt id=\"p1\">**</bpt>Import / export activities<ept id=\"p1\">**</ept>, as shown in the following illustration.","pos":[5398,5496],"source":" Name the new configuration **Import / export activities**, as shown in the following illustration."},{"content":"Use the <bpt id=\"p1\">[</bpt>ER data - import and export details<ept id=\"p1\">](media/ER-data-import-and-export-details.xlsx)</ept> Excel file as a template when you design the ER format.","pos":[5497,5644],"source":" Use the [ER data - import and export details](media/ER-data-import-and-export-details.xlsx) Excel file as a template when you design the ER format."},{"content":"(For information about how to import a format template, play the task guide.) <bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Import / export activities configuration<ept id=\"p1\">](media/GER-Power-BI-format-configuration-1024x398.png)](media/GER-Power-BI-format-configuration.png)</ept> To modify the <bpt id=\"p2\">**</bpt>Import / export activities<ept id=\"p2\">**</ept> format configuration, follow these steps.","pos":[5645,5954],"source":" (For information about how to import a format template, play the task guide.) [![Import / export activities configuration](media/GER-Power-BI-format-configuration-1024x398.png)](media/GER-Power-BI-format-configuration.png) To modify the **Import / export activities** format configuration, follow these steps."},{"pos":[5960,5979],"content":"Click <bpt id=\"p1\">**</bpt>Designer<ept id=\"p1\">**</ept>.","source":"Click **Designer**."},{"content":"On the <bpt id=\"p1\">**</bpt>Format<ept id=\"p1\">**</ept> tab, name the file element for this format <bpt id=\"p2\">**</bpt>Excel output file<ept id=\"p2\">**</ept>.","pos":[5984,6067],"source":"On the **Format** tab, name the file element for this format **Excel output file**."},{"content":"<ph id=\"ph1\">![</ph>Excel output file element<ph id=\"ph2\">](media/GER-Power-BI-format-configuration-file-element-name-1024x395.png)</ph>","pos":[6068,6168],"source":"![Excel output file element](media/GER-Power-BI-format-configuration-file-element-name-1024x395.png)"},{"content":"On the <bpt id=\"p1\">**</bpt>Mapping<ept id=\"p1\">**</ept> tab, specify the name of the Excel file that will be generated whenever this format is run.","pos":[6173,6283],"source":"On the **Mapping** tab, specify the name of the Excel file that will be generated whenever this format is run."},{"content":"Configure the related expression to return the value <bpt id=\"p1\">**</bpt>Import and export details<ept id=\"p1\">**</ept> (the .xlsx file name extension will be added automatically).","pos":[6284,6427],"source":" Configure the related expression to return the value **Import and export details** (the .xlsx file name extension will be added automatically)."},{"content":"<ph id=\"ph1\">![</ph>Format designer<ph id=\"ph2\">](media/GER-Power-BI-format-configuration-output-file-name-1024x396.png)</ph>","pos":[6428,6517],"source":"![Format designer](media/GER-Power-BI-format-configuration-output-file-name-1024x396.png)"},{"content":"Add a new data source item for this format.","pos":[6522,6565]},{"content":"(This enumeration will be required for further data binding.)","pos":[6566,6627]},{"pos":[6636,6677],"content":"Name the data source <bpt id=\"p1\">**</bpt>direction<ph id=\"ph1\">\\_</ph>enum<ept id=\"p1\">**</ept>.","source":"Name the data source **direction\\_enum**."},{"pos":[6686,6744],"content":"Select <bpt id=\"p1\">**</bpt>Data model enumeration<ept id=\"p1\">**</ept> as the data source type.","source":"Select **Data model enumeration** as the data source type."},{"pos":[6753,6803],"content":"Refer to the <bpt id=\"p1\">**</bpt>Direction<ept id=\"p1\">**</ept> data model enumeration.","source":"Refer to the **Direction** data model enumeration."},{"pos":[6809,6966],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>direction<ph id=\"ph2\">\\_</ph>enum<ept id=\"p1\">](media/GER-Power-BI-format-configuration-mapping-added-enum-1024x454.png)](media/GER-Power-BI-format-configuration-mapping-added-enum.png)</ept>","source":"[![direction\\_enum](media/GER-Power-BI-format-configuration-mapping-added-enum-1024x454.png)](media/GER-Power-BI-format-configuration-mapping-added-enum.png)"},{"content":"Complete the binding of elements of the <bpt id=\"p1\">**</bpt>Intrastat<ept id=\"p1\">**</ept> data model and elements of the designed format, as shown in the following illustration.","pos":[6971,7112],"source":"Complete the binding of elements of the **Intrastat** data model and elements of the designed format, as shown in the following illustration."},{"content":"<ph id=\"ph1\">![</ph>Completing the binding<ph id=\"ph2\">](media/GER-Power-BI-format-configuration-mapping-details-1024x454.png)</ph>","pos":[7113,7208],"source":"![Completing the binding](media/GER-Power-BI-format-configuration-mapping-details-1024x454.png)"},{"content":"After it's run, the ER format generates the output result in Excel format.","pos":[7210,7284]},{"content":"It sends the details of the Intrastat transactions to the output result, and separates them as transactions that describe either import activities or export activities.","pos":[7285,7453]},{"content":"Click <bpt id=\"p1\">**</bpt>Run<ept id=\"p1\">**</ept> to test the new ER format for the list of Intrastat transactions on the <bpt id=\"p2\">**</bpt>Intrastat<ept id=\"p2\">**</ept> page (<bpt id=\"p3\">**</bpt>Tax<ept id=\"p3\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Declarations<ept id=\"p4\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p5\">**</bpt>Foreign trade<ept id=\"p5\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p6\">**</bpt>Intrastat<ept id=\"p6\">**</ept>).","pos":[7454,7633],"source":" Click **Run** to test the new ER format for the list of Intrastat transactions on the **Intrastat** page (**Tax** &gt; **Declarations** &gt; **Foreign trade** &gt; **Intrastat**)."},{"content":"<ph id=\"ph1\">![</ph>Intrastat page<ph id=\"ph2\">](media/GER-Power-BI-format-test-run-transactions-1024x322.png)</ph> The following output result is generated.","pos":[7634,7755],"source":"![Intrastat page](media/GER-Power-BI-format-test-run-transactions-1024x322.png) The following output result is generated."},{"content":"The file is named <bpt id=\"p1\">**</bpt>Import and export details.xlsx<ept id=\"p1\">**</ept>, as you specified in the format settings.","pos":[7756,7850],"source":" The file is named **Import and export details.xlsx**, as you specified in the format settings."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Import and export details.xlsx<ept id=\"p1\">](media/GER-Power-BI-format-test-run-output-1024x472.png)](media/GER-Power-BI-format-test-run-output.png)</ept>","pos":[7851,7989],"source":"[![Import and export details.xlsx](media/GER-Power-BI-format-test-run-output-1024x472.png)](media/GER-Power-BI-format-test-run-output.png)"},{"pos":[7994,8022],"content":"Configure the ER destination","linkify":"Configure the ER destination","nodes":[{"content":"Configure the ER destination","pos":[0,28]}]},{"content":"You must configure the ER framework to send the output result of the new ER format configuration in a special way.","pos":[8023,8137]},{"content":"The output result must be sent to the folder of the selected SharePoint Server.","pos":[8143,8222]},{"content":"Each execution of the format configuration must create a new version of same Excel file.","pos":[8227,8315]},{"content":"On the <bpt id=\"p1\">**</bpt>Electronic reporting<ept id=\"p1\">**</ept> page (<bpt id=\"p2\">**</bpt>Organization administration<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Electronic reporting<ept id=\"p3\">**</ept>), click the <bpt id=\"p4\">**</bpt>Electronic reporting destination<ept id=\"p4\">**</ept> item, and add a new destination.","pos":[8317,8498],"source":"On the **Electronic reporting** page (**Organization administration** &gt; **Electronic reporting**), click the **Electronic reporting destination** item, and add a new destination."},{"content":"In the <bpt id=\"p1\">**</bpt>Reference<ept id=\"p1\">**</ept> field, select the <bpt id=\"p2\">**</bpt>Import / export activities<ept id=\"p2\">**</ept> format configuration that you created earlier.","pos":[8499,8615],"source":" In the **Reference** field, select the **Import / export activities** format configuration that you created earlier."},{"content":"Follow these steps to add a new file destination record for the reference.","pos":[8616,8690]},{"pos":[8696,8759],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> field, enter the title of the file destination.","source":"In the **Name** field, enter the title of the file destination."},{"pos":[8764,8866],"content":"In the <bpt id=\"p1\">**</bpt>File name<ept id=\"p1\">**</ept> field, select the name <bpt id=\"p2\">**</bpt>Excel output file<ept id=\"p2\">**</ept> for the Excel file format component.","source":"In the **File name** field, select the name **Excel output file** for the Excel file format component."},{"content":"Click the <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept> button for the new destination record.","pos":[8868,8929],"source":"Click the **Settings** button for the new destination record."},{"content":"Then, in the <bpt id=\"p1\">**</bpt>Destination settings<ept id=\"p1\">**</ept> dialog box, follow these steps.","pos":[8930,8999],"source":" Then, in the **Destination settings** dialog box, follow these steps."},{"pos":[9005,9068],"content":"On the <bpt id=\"p1\">**</bpt>Power BI<ept id=\"p1\">**</ept> tab, set the <bpt id=\"p2\">**</bpt>Enabled<ept id=\"p2\">**</ept> option to <bpt id=\"p3\">**</bpt>Yes<ept id=\"p3\">**</ept>.","source":"On the **Power BI** tab, set the **Enabled** option to **Yes**."},{"pos":[9073,9163],"content":"In the <bpt id=\"p1\">**</bpt>SharePoint<ept id=\"p1\">**</ept> field, select the <bpt id=\"p2\">**</bpt>Shared<ept id=\"p2\">**</ept> document type that you created earlier.","source":"In the **SharePoint** field, select the **Shared** document type that you created earlier."},{"pos":[9168,9214],"content":"Schedule execution of the configured ER format","linkify":"Schedule execution of the configured ER format","nodes":[{"content":"Schedule execution of the configured ER format","pos":[0,46]}]},{"content":"On the <bpt id=\"p1\">**</bpt>Configurations<ept id=\"p1\">**</ept> page (<bpt id=\"p2\">**</bpt>Organization administration<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Electronic reporting<ept id=\"p3\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Configurations<ept id=\"p4\">**</ept>), in the configurations tree, select the <bpt id=\"p5\">**</bpt>Import / export activities<ept id=\"p5\">**</ept> configuration that you created earlier.","pos":[9215,9444],"source":"On the **Configurations** page (**Organization administration** &gt; **Electronic reporting** &gt; **Configurations**), in the configurations tree, select the **Import / export activities** configuration that you created earlier."},{"content":"Change the status of version 1.1 from <bpt id=\"p1\">**</bpt>Draft<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Complete<ept id=\"p2\">**</ept> to make this format available for use.","pos":[9445,9547],"source":" Change the status of version 1.1 from **Draft** to **Complete** to make this format available for use."},{"content":"<ph id=\"ph1\">![</ph>Configurations page<ph id=\"ph2\">](media/GER-Power-BI-format-configuration-complete-1024x401.png)</ph> Select the completed version of the <bpt id=\"p1\">**</bpt>Import / export activities<ept id=\"p1\">**</ept> configuration, and then click <bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept>.","pos":[9548,9739],"source":"![Configurations page](media/GER-Power-BI-format-configuration-complete-1024x401.png) Select the completed version of the **Import / export activities** configuration, and then click **Run**."},{"content":"Note that the configured destination is applied to the output result that is generated in Excel format.","pos":[9740,9843]},{"content":"Set the <bpt id=\"p1\">**</bpt>Batch processing<ept id=\"p1\">**</ept> option to <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept> to run this report in unattended mode.","pos":[9844,9929],"source":" Set the **Batch processing** option to **Yes** to run this report in unattended mode."},{"content":"Click <bpt id=\"p1\">**</bpt>Recurrence<ept id=\"p1\">**</ept> to schedule the required recurrence of this batch execution.","pos":[9930,10011],"source":" Click **Recurrence** to schedule the required recurrence of this batch execution."},{"content":"The recurrence defines how often the updated data will be transferred from Dynamics 365 for Operations to Power BI.","pos":[10012,10127]},{"content":"<ph id=\"ph1\">![</ph>Electronic report parameters dialog box<ph id=\"ph2\">](media/GER-Power-BI-format-configuration-run-to-schedule-1024x413.png)</ph> After it's configured, you can find the ER report execution job on the <bpt id=\"p1\">**</bpt>Batch jobs<ept id=\"p1\">**</ept> page (<bpt id=\"p2\">**</bpt>System administration <ph id=\"ph3\">&amp;gt;</ph> Inquiries <ph id=\"ph4\">&amp;gt;</ph> Batch jobs<ept id=\"p2\">**</ept>).","pos":[10128,10391],"source":"![Electronic report parameters dialog box](media/GER-Power-BI-format-configuration-run-to-schedule-1024x413.png) After it's configured, you can find the ER report execution job on the **Batch jobs** page (**System administration &gt; Inquiries &gt; Batch jobs**)."},{"content":"<ph id=\"ph1\">![</ph>Batch jobs page<ph id=\"ph2\">](media/GER-Power-BI-format-configuration-running-job-1024x410.png)</ph> When this job is run for the first time, the destination creates a new Excel file that has the configured name in the selected SharePoint folder.","pos":[10392,10622],"source":"![Batch jobs page](media/GER-Power-BI-format-configuration-running-job-1024x410.png) When this job is run for the first time, the destination creates a new Excel file that has the configured name in the selected SharePoint folder."},{"content":"Every subsequent time that the job is run, the destination creates a new version of this Excel file.","pos":[10623,10723]},{"content":"<ph id=\"ph1\">![</ph>New version of the Excel file<ph id=\"ph2\">](media/GER-Power-BI-output-file-in-sharepoint-server-folder-2-1024x412.png)</ph>","pos":[10724,10831],"source":"![New version of the Excel file](media/GER-Power-BI-output-file-in-sharepoint-server-folder-2-1024x412.png)"},{"pos":[10836,10905],"content":"Create a Power BI dataset by using the output result of the ER format","linkify":"Create a Power BI dataset by using the output result of the ER format","nodes":[{"content":"Create a Power BI dataset by using the output result of the ER format","pos":[0,69]}]},{"content":"Sign in to Power BI, and either open an existing Power BI group (workspace) or create a new group.","pos":[10906,11004]},{"content":"Either click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> under <bpt id=\"p2\">**</bpt>Files<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">**</bpt>Import or Connect to Data<ept id=\"p3\">**</ept> section, or click the plus sign (<bpt id=\"p4\">**</bpt><ph id=\"ph1\">+</ph><ept id=\"p4\">**</ept>) next to <bpt id=\"p5\">**</bpt>Datasets<ept id=\"p5\">**</ept> in the left pane.","pos":[11005,11157],"source":" Either click **Add** under **Files** in the **Import or Connect to Data** section, or click the plus sign (**+**) next to **Datasets** in the left pane."},{"content":"<ph id=\"ph1\">![</ph>Creating a dataset<ph id=\"ph2\">](media/GER-Power-BI-add-dataset-1024x524.png)</ph> Select the <bpt id=\"p1\">**</bpt>SharePoint – Team sites<ept id=\"p1\">**</ept> option, and then enter the path of SharePoint Server that you're using (<bpt id=\"p2\">**</bpt>https://ax7partner.spoppe.com<ept id=\"p2\">**</ept> in our example).","pos":[11158,11386],"source":"![Creating a dataset](media/GER-Power-BI-add-dataset-1024x524.png) Select the **SharePoint – Team sites** option, and then enter the path of SharePoint Server that you're using (**https://ax7partner.spoppe.com** in our example)."},{"content":"Then browse to the <bpt id=\"p1\">**</bpt>/Shared Documents/GER data/PowerBI<ept id=\"p1\">**</ept> folder, and select the Excel file that you created as the source of data for the new Power BI dataset.","pos":[11387,11547],"source":" Then browse to the **/Shared Documents/GER data/PowerBI** folder, and select the Excel file that you created as the source of data for the new Power BI dataset."},{"content":"<ph id=\"ph1\">![</ph>Selecting the Excel file<ph id=\"ph2\">](media/GER-Power-BI-add-dataset-select-Excel-file-1024x522.png)</ph> Click <bpt id=\"p1\">**</bpt>Connect<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Import<ept id=\"p2\">**</ept>.","pos":[11548,11684],"source":"![Selecting the Excel file](media/GER-Power-BI-add-dataset-select-Excel-file-1024x522.png) Click **Connect**, and then click **Import**."},{"content":"A new dataset is created that is based on the selected Excel file.","pos":[11685,11751]},{"content":"The dataset can also be added automatically to the newly created dashboard.","pos":[11752,11827]},{"content":"<ph id=\"ph1\">![</ph>Dataset on the dashboard<ph id=\"ph2\">](media/GER-Power-BI-added-dataset-1024x489.png)</ph> Configure the refresh schedule for this dataset to force a periodic update.","pos":[11828,11978],"source":"![Dataset on the dashboard](media/GER-Power-BI-added-dataset-1024x489.png) Configure the refresh schedule for this dataset to force a periodic update."},{"content":"Periodic updates enable the consumption of new business data that comes from Dynamics 365 for Operations via periodic execution of the ER report through new versions of the Excel file that are created on the SharePoint Server.","pos":[11979,12205]},{"pos":[12210,12259],"content":"Create a Power BI report by using the new dataset","linkify":"Create a Power BI report by using the new dataset","nodes":[{"content":"Create a Power BI report by using the new dataset","pos":[0,49]}]},{"content":"To create a new Power BI report, click the <bpt id=\"p1\">**</bpt>Import and export details<ept id=\"p1\">**</ept> Power BI dataset that you created.","pos":[12260,12367],"source":"To create a new Power BI report, click the **Import and export details** Power BI dataset that you created."},{"content":"Then configure the visualization.","pos":[12368,12401]},{"content":"For example, select the <bpt id=\"p1\">**</bpt>Filled map<ept id=\"p1\">**</ept> visualization, and configure it as follows:","pos":[12402,12484],"source":" For example, select the **Filled map** visualization, and configure it as follows:"},{"pos":[12490,12584],"content":"Assign the <bpt id=\"p1\">**</bpt>CountryOrigin<ept id=\"p1\">**</ept> dataset field to the <bpt id=\"p2\">**</bpt>Location<ept id=\"p2\">**</ept> field of the map visualization.","source":"Assign the **CountryOrigin** dataset field to the **Location** field of the map visualization."},{"pos":[12589,12684],"content":"Assign the <bpt id=\"p1\">**</bpt>Amount<ept id=\"p1\">**</ept> dataset field to the <bpt id=\"p2\">**</bpt>Color saturation<ept id=\"p2\">**</ept> field of the map visualization.","source":"Assign the **Amount** dataset field to the **Color saturation** field of the map visualization."},{"pos":[12689,12800],"content":"Add the <bpt id=\"p1\">**</bpt>Activity<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Year<ept id=\"p2\">**</ept> dataset fields to the <bpt id=\"p3\">**</bpt>Filters<ept id=\"p3\">**</ept> fields collection of the map visualization.","source":"Add the **Activity** and **Year** dataset fields to the **Filters** fields collection of the map visualization."},{"content":"Save the Power BI report as <bpt id=\"p1\">**</bpt>Import and export details report<ept id=\"p1\">**</ept>.","pos":[12802,12867],"source":"Save the Power BI report as **Import and export details report**."},{"content":"<ph id=\"ph1\">![</ph>Import and export details report<ph id=\"ph2\">](media/GER-Power-BI-added-report-1024x498.png)</ph> Note that the map shows the countries/regions that are mentioned in the Excel file (Austria and Switzerland in this example).","pos":[12868,13075],"source":"![Import and export details report](media/GER-Power-BI-added-report-1024x498.png) Note that the map shows the countries/regions that are mentioned in the Excel file (Austria and Switzerland in this example)."},{"content":"These countries/regions are colored to show the proportion of invoiced amounts for each.","pos":[13076,13164]},{"content":"Update the list of Intrastat transactions.","pos":[13165,13207]},{"content":"The export transaction that originated from Italy is added.","pos":[13208,13267]},{"content":"<ph id=\"ph1\">![</ph>Intrastat transactions list<ph id=\"ph2\">](media/GER-Power-BI-new-run-new-transaction-1024x321.png)</ph> Wait for the next scheduled execution of the ER report and the next scheduled update of the Power BI dataset.","pos":[13268,13465],"source":"![Intrastat transactions list](media/GER-Power-BI-new-run-new-transaction-1024x321.png) Wait for the next scheduled execution of the ER report and the next scheduled update of the Power BI dataset."},{"content":"Then review the Power BI report (select to show import transactions only).","pos":[13466,13540]},{"content":"The updated map now shows Italy.","pos":[13541,13573]},{"content":"<ph id=\"ph1\">![</ph>Updated map<ph id=\"ph2\">](media/GER-Power-BI-new-run-new-map-1024x511.png)</ph>","pos":[13574,13637],"source":"![Updated map](media/GER-Power-BI-new-run-new-map-1024x511.png)"},{"pos":[13642,13695],"content":"Access Power BI report in Dynamics 365 for Operations","linkify":"Access Power BI report in Dynamics 365 for Operations","nodes":[{"content":"Access Power BI report in Dynamics 365 for Operations","pos":[0,53]}]},{"content":"Set up the integration between Dynamics 365 for Operations and Power BI.","pos":[13696,13768]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Configuring Power BI integration for workspaces<ept id=\"p1\">](https://ax.help.dynamics.com/en/wiki/configuring-powerbi-integration/)</ept>.","pos":[13769,13916],"source":" For more information, see [Configuring Power BI integration for workspaces](https://ax.help.dynamics.com/en/wiki/configuring-powerbi-integration/)."},{"content":"On the <bpt id=\"p1\">**</bpt>Electronic reporting<ept id=\"p1\">**</ept> workspace page that supports Power BI integration (<bpt id=\"p2\">**</bpt>Organization administration<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Workspaces<ept id=\"p3\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Electronic reporting workspace<ept id=\"p4\">**</ept>), click <bpt id=\"p5\">**</bpt>Options<ept id=\"p5\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p6\">**</bpt>Open report catalog<ept id=\"p6\">**</ept>.","pos":[13917,14141],"source":" On the **Electronic reporting** workspace page that supports Power BI integration (**Organization administration** &gt; **Workspaces** &gt; **Electronic reporting workspace**), click **Options** &gt; **Open report catalog**."},{"content":"Select the <bpt id=\"p1\">**</bpt>Import and export details<ept id=\"p1\">**</ept> Power BI report that you created, to show that report as an action item on the selected page.","pos":[14142,14276],"source":" Select the **Import and export details** Power BI report that you created, to show that report as an action item on the selected page."},{"content":"Click the action item to open the Dynamics 365 for Operations page that shows the report that you designed in Power BI.","pos":[14277,14396]},{"content":"<ph id=\"ph1\">![</ph>Import and export details report<ph id=\"ph2\">](media/GER-Power-BI-review-BI-report-in-AX-form-1024x586.png)</ph>","pos":[14397,14493],"source":"![Import and export details report](media/GER-Power-BI-review-BI-report-in-AX-form-1024x586.png)"},{"pos":[14495,14503],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[14514,14627],"content":"<bpt id=\"p1\">[</bpt>Electronic reporting destinations<ept id=\"p1\">](http://ax.help.dynamics.com/en/wiki/using-electronic-reporting-destinations/)</ept>","source":"[Electronic reporting destinations](http://ax.help.dynamics.com/en/wiki/using-electronic-reporting-destinations/)"},{"pos":[14629,14732],"content":"<bpt id=\"p1\">[</bpt>Electronic reporting overview<ept id=\"p1\">](https://ax.help.dynamics.com/en/wiki/general-electronic-reporting-ger/)</ept>","source":"[Electronic reporting overview](https://ax.help.dynamics.com/en/wiki/general-electronic-reporting-ger/)"}],"content":"---\n# required metadata\n\ntitle: Use an Electronic reporting configuration to provide Power BI with data from Dynamics 365 for Operations | Microsoft Docs\ndescription: This topic explains how you can use your Electronic reporting (ER) configuration to arrange the transfer of data from your instance of Dynamics 365 for Operations to Power BI services. As an example, this topic uses Intrastat transactions as business data that must be transferred. The Power BI map visualization uses this Intrastat transaction data to present a view for analysis of company import/export activities on the Power BI report.\nauthor: annbe\nmanager: AnnBe\nms.date: 2016-10-31 13:22:29\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# keywords: \n# ROBOTS: \naudience: Application User, Developer, IT Pro\n# ms.devlang: \nms.reviewer: 71\nms.suite: Released- Dynamics 365 for Operations version 1611\n# ms.tgt_pltfrm: \nms.custom: 220314\nms.assetid: 58f62978-92d3-47f9-886d-ae41644a53c8\n# ms.region: \n# ms.industry: \nms.author: kfend\n\n---\n\n# Use an Electronic reporting configuration to provide Power BI with data from Dynamics 365 for Operations\n\nOverview\n--------\n\nMicrosoft Power BI is a collection of software services, apps, and connectors that work together to turn external sources of data into coherent, visually immersive, and interactive insights. Electronic reporting (ER) lets users of Microsoft Dynamics 365 for Operations easily configure data sources and arrange the transfer of data from Dynamics 365 for Operations to Power BI. The data is transferred as files in the OpenXML worksheet (Microsoft Excel workbook file) format. The transferred files are stored on a Microsoft SharePoint Server that has been configured for that purpose. The stored files are used in Power BI to make reports that include visualizations (tables, charts, maps, and so on). Power BI reports are shared with Power BI users, and they are accessed in Power BI dashboards and on Dynamics 365 for Operations pages. This topic explains the following tasks:\n\n-   Configure Dynamics 365 for Operations.\n-   Prepare your ER format configuration to get data from Dynamics 365 for Operations.\n-   Configure the ER environment to transfer data to Power BI.\n-   Use transferred data to create a Power BI report.\n-   Make the Power BI report accessible in Dynamics 365 for Operations.\n\n## Prerequisites\nTo complete the example in this topic, you must have the following access:\n\n-   Access to Dynamics 365 for Operations for one of the following roles:\n    -   Electronic reporting developer\n    -   Electronic reporting functional consultant\n    -   System administrator\n-   Access to the SharePoint Server that is configured for use with Dynamics 365 for Operations\n-   Access to the Power BI framework\n\n## Configure document management parameters\n1.  On the **Document management parameters** page, configure access to the SharePoint Server that will be used in the company that you're signed in to (the DEMF company in this example).\n2.  Test the connection to the SharePoint Server to make sure that you've been granted access. ![Document management parameters page](media/GER-Power-BI-sharepoint-server-setting-1024x369.png)\n3.  Open the configured SharePoint site. Create a new folder where ER will store Excel files that have the business data that the Power BI reports require as a source of Power BI datasets.\n4.  In Dynamics 365 for Operations, on the **Document types** page, create a new document type that will be used to access the SharePoint folder that you just created. Enter **File** in the **Group** field and **SharePoint** in the **Location** field, and then enter the address of the SharePoint folder. ![Document types page](media/GER-Power-BI-sharepoint-document-type-1024x485.png)\n\n## Configure ER parameters\n1.  In the **Electronic reporting** workspace, click the **Electronic reporting parameters** link.\n2.  On the **Attachments** tab, select the **File** document type for all the fields.\n3.  In the **Electronic reporting** workspace, make the required provider active by clicking **Set active**. For more information, play the **ER Select service provider** task guide.\n\n## Use an ER data model as the source of data\nYou must have an ER data model as the source of business data that will be used on Power BI reports. This data model is uploaded from the ER configurations repository. For more information, see [Download Electronic reporting configurations from Lifecycle Services](http://ax.help.dynamics.com/en/wiki/download-electronic-reporting-er-configuration-from-lifecycle-services/), or play the **ER Import a configuration from Lifecycle Services** task guide. Select **Intrastat** as the data model that will be uploaded from the selected ER configurations repository. (In this example, version 1 of the model is used.) You can then access the **Intrastat** ER model configuration on the **Configurations** page. ![Configurations page](media/GER-Power-BI-data-model-1024x371.png)\n\n## Design an ER format configuration\nYou must create a new ER format configuration that uses the **Intrastat** data model as the source of business data. This format configuration must generate output results as electronic documents in OpenXML (Excel file) format. For more information, play the **ER Create a configuration for reports in OPENXML format** task guide. Name the new configuration **Import / export activities**, as shown in the following illustration. Use the [ER data - import and export details](media/ER-data-import-and-export-details.xlsx) Excel file as a template when you design the ER format. (For information about how to import a format template, play the task guide.) [![Import / export activities configuration](media/GER-Power-BI-format-configuration-1024x398.png)](media/GER-Power-BI-format-configuration.png) To modify the **Import / export activities** format configuration, follow these steps.\n\n1.  Click **Designer**.\n2.  On the **Format** tab, name the file element for this format **Excel output file**. ![Excel output file element](media/GER-Power-BI-format-configuration-file-element-name-1024x395.png)\n3.  On the **Mapping** tab, specify the name of the Excel file that will be generated whenever this format is run. Configure the related expression to return the value **Import and export details** (the .xlsx file name extension will be added automatically). ![Format designer](media/GER-Power-BI-format-configuration-output-file-name-1024x396.png)\n4.  Add a new data source item for this format. (This enumeration will be required for further data binding.)\n    1.  Name the data source **direction\\_enum**.\n    2.  Select **Data model enumeration** as the data source type.\n    3.  Refer to the **Direction** data model enumeration.\n\n    [![direction\\_enum](media/GER-Power-BI-format-configuration-mapping-added-enum-1024x454.png)](media/GER-Power-BI-format-configuration-mapping-added-enum.png)\n5.  Complete the binding of elements of the **Intrastat** data model and elements of the designed format, as shown in the following illustration. ![Completing the binding](media/GER-Power-BI-format-configuration-mapping-details-1024x454.png)\n\nAfter it's run, the ER format generates the output result in Excel format. It sends the details of the Intrastat transactions to the output result, and separates them as transactions that describe either import activities or export activities. Click **Run** to test the new ER format for the list of Intrastat transactions on the **Intrastat** page (**Tax** &gt; **Declarations** &gt; **Foreign trade** &gt; **Intrastat**). ![Intrastat page](media/GER-Power-BI-format-test-run-transactions-1024x322.png) The following output result is generated. The file is named **Import and export details.xlsx**, as you specified in the format settings. [![Import and export details.xlsx](media/GER-Power-BI-format-test-run-output-1024x472.png)](media/GER-Power-BI-format-test-run-output.png)\n\n## Configure the ER destination\nYou must configure the ER framework to send the output result of the new ER format configuration in a special way.\n\n-   The output result must be sent to the folder of the selected SharePoint Server.\n-   Each execution of the format configuration must create a new version of same Excel file.\n\nOn the **Electronic reporting** page (**Organization administration** &gt; **Electronic reporting**), click the **Electronic reporting destination** item, and add a new destination. In the **Reference** field, select the **Import / export activities** format configuration that you created earlier. Follow these steps to add a new file destination record for the reference.\n\n1.  In the **Name** field, enter the title of the file destination.\n2.  In the **File name** field, select the name **Excel output file** for the Excel file format component.\n\nClick the **Settings** button for the new destination record. Then, in the **Destination settings** dialog box, follow these steps.\n\n1.  On the **Power BI** tab, set the **Enabled** option to **Yes**.\n2.  In the **SharePoint** field, select the **Shared** document type that you created earlier.\n\n## Schedule execution of the configured ER format\nOn the **Configurations** page (**Organization administration** &gt; **Electronic reporting** &gt; **Configurations**), in the configurations tree, select the **Import / export activities** configuration that you created earlier. Change the status of version 1.1 from **Draft** to **Complete** to make this format available for use. ![Configurations page](media/GER-Power-BI-format-configuration-complete-1024x401.png) Select the completed version of the **Import / export activities** configuration, and then click **Run**. Note that the configured destination is applied to the output result that is generated in Excel format. Set the **Batch processing** option to **Yes** to run this report in unattended mode. Click **Recurrence** to schedule the required recurrence of this batch execution. The recurrence defines how often the updated data will be transferred from Dynamics 365 for Operations to Power BI. ![Electronic report parameters dialog box](media/GER-Power-BI-format-configuration-run-to-schedule-1024x413.png) After it's configured, you can find the ER report execution job on the **Batch jobs** page (**System administration &gt; Inquiries &gt; Batch jobs**). ![Batch jobs page](media/GER-Power-BI-format-configuration-running-job-1024x410.png) When this job is run for the first time, the destination creates a new Excel file that has the configured name in the selected SharePoint folder. Every subsequent time that the job is run, the destination creates a new version of this Excel file. ![New version of the Excel file](media/GER-Power-BI-output-file-in-sharepoint-server-folder-2-1024x412.png)\n\n## Create a Power BI dataset by using the output result of the ER format\nSign in to Power BI, and either open an existing Power BI group (workspace) or create a new group. Either click **Add** under **Files** in the **Import or Connect to Data** section, or click the plus sign (**+**) next to **Datasets** in the left pane. ![Creating a dataset](media/GER-Power-BI-add-dataset-1024x524.png) Select the **SharePoint – Team sites** option, and then enter the path of SharePoint Server that you're using (**https://ax7partner.spoppe.com** in our example). Then browse to the **/Shared Documents/GER data/PowerBI** folder, and select the Excel file that you created as the source of data for the new Power BI dataset. ![Selecting the Excel file](media/GER-Power-BI-add-dataset-select-Excel-file-1024x522.png) Click **Connect**, and then click **Import**. A new dataset is created that is based on the selected Excel file. The dataset can also be added automatically to the newly created dashboard. ![Dataset on the dashboard](media/GER-Power-BI-added-dataset-1024x489.png) Configure the refresh schedule for this dataset to force a periodic update. Periodic updates enable the consumption of new business data that comes from Dynamics 365 for Operations via periodic execution of the ER report through new versions of the Excel file that are created on the SharePoint Server.\n\n## Create a Power BI report by using the new dataset\nTo create a new Power BI report, click the **Import and export details** Power BI dataset that you created. Then configure the visualization. For example, select the **Filled map** visualization, and configure it as follows:\n\n-   Assign the **CountryOrigin** dataset field to the **Location** field of the map visualization.\n-   Assign the **Amount** dataset field to the **Color saturation** field of the map visualization.\n-   Add the **Activity** and **Year** dataset fields to the **Filters** fields collection of the map visualization.\n\nSave the Power BI report as **Import and export details report**. ![Import and export details report](media/GER-Power-BI-added-report-1024x498.png) Note that the map shows the countries/regions that are mentioned in the Excel file (Austria and Switzerland in this example). These countries/regions are colored to show the proportion of invoiced amounts for each. Update the list of Intrastat transactions. The export transaction that originated from Italy is added. ![Intrastat transactions list](media/GER-Power-BI-new-run-new-transaction-1024x321.png) Wait for the next scheduled execution of the ER report and the next scheduled update of the Power BI dataset. Then review the Power BI report (select to show import transactions only). The updated map now shows Italy. ![Updated map](media/GER-Power-BI-new-run-new-map-1024x511.png)\n\n## Access Power BI report in Dynamics 365 for Operations\nSet up the integration between Dynamics 365 for Operations and Power BI. For more information, see [Configuring Power BI integration for workspaces](https://ax.help.dynamics.com/en/wiki/configuring-powerbi-integration/). On the **Electronic reporting** workspace page that supports Power BI integration (**Organization administration** &gt; **Workspaces** &gt; **Electronic reporting workspace**), click **Options** &gt; **Open report catalog**. Select the **Import and export details** Power BI report that you created, to show that report as an action item on the selected page. Click the action item to open the Dynamics 365 for Operations page that shows the report that you designed in Power BI. ![Import and export details report](media/GER-Power-BI-review-BI-report-in-AX-form-1024x586.png)\n\nSee also\n--------\n\n[Electronic reporting destinations](http://ax.help.dynamics.com/en/wiki/using-electronic-reporting-destinations/)\n\n[Electronic reporting overview](https://ax.help.dynamics.com/en/wiki/general-electronic-reporting-ger/)\n\n"}