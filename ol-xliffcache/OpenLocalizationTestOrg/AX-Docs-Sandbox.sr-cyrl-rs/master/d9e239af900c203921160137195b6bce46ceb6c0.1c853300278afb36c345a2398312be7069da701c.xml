{"nodes":[{"pos":[32,51],"content":"Extend the metadata","needQuote":true,"needEscape":true,"nodes":[{"content":"Extend the metadata","pos":[0,19]}]},{"pos":[65,133],"content":"This article provides code to extend the CommerceModelFactory class.","needQuote":true,"needEscape":true,"nodes":[{"content":"This article provides code to extend the CommerceModelFactory class.","pos":[0,68]}]},{"pos":[636,655],"content":"Extend the metadata","linkify":"Extend the metadata","nodes":[{"content":"Extend the metadata","pos":[0,19]}]},{"content":"This article provides code to extend the CommerceModelFactory class.","pos":[657,725]},{"content":"When you use OData together with Microsoft Dynamics AX for Retail, metadata defines the contract between a client and server.","pos":[727,852]},{"content":"The metadata exposes entity definitions and action definitions, so that when you make a change on the server side, you can use a tool on the client side to generate proxy code.","pos":[853,1029]},{"content":"Therefore, the maintenance effort for developers is reduced.","pos":[1030,1090]},{"content":"To consume new or changed entities and actions, you must extend the metadata.","pos":[1091,1168]},{"content":"Retail Server has a default metadata controller that is named <bpt id=\"p1\">**</bpt>CommerceModelFactory<ept id=\"p1\">**</ept>.","pos":[1169,1256],"source":" Retail Server has a default metadata controller that is named **CommerceModelFactory**."},{"content":"To extend the default controller, you create a new class that uses the <bpt id=\"p1\">**</bpt>Export<ept id=\"p1\">**</ept> attribute together with the <bpt id=\"p2\">**</bpt>IEdmModelFactory<ept id=\"p2\">**</ept> interface.","pos":[1257,1398],"source":" To extend the default controller, you create a new class that uses the **Export** attribute together with the **IEdmModelFactory** interface."},{"content":"You can then add and override existing code.","pos":[1399,1443]},{"content":"For example, you can add new entity sets, new actions, new complex types, or new exception types.","pos":[1444,1541]},{"content":"In the following example, the <bpt id=\"p1\">**</bpt>ExtendedEdmModelFactory<ept id=\"p1\">**</ept> class extends the <bpt id=\"p2\">**</bpt>CommerceModelFactory<ept id=\"p2\">**</ept> metadata controller and creates a new action that is named <bpt id=\"p3\">**</bpt>NewAction<ept id=\"p3\">**</ept> and a new entity set that is named <bpt id=\"p4\">**</bpt>NewEntities<ept id=\"p4\">**</ept>.","pos":[1542,1767],"source":" In the following example, the **ExtendedEdmModelFactory** class extends the **CommerceModelFactory** metadata controller and creates a new action that is named **NewAction** and a new entity set that is named **NewEntities**."},{"content":"You can find the sample code from this topic in the Retail software development kit (SDK).","pos":[1768,1858]}],"content":"---\n# required metadata\n\ntitle: Extend the metadata\ndescription: This article provides code to extend the CommerceModelFactory class.\nauthor: kfend\nmanager: AnnBe\nms.date: 2016-02-06 00 - 46 - 00\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: kfend\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 31641\nms.assetid: 89a354aa-bfb7-4bd0-ae4c-ab47f64fbfe1\nms.search.region: Global\n# ms.search.industry: \nms.author: meeram\nms.dyn365.ops.intro: Feb-16\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Extend the metadata\n\nThis article provides code to extend the CommerceModelFactory class.\n\nWhen you use OData together with Microsoft Dynamics AX for Retail, metadata defines the contract between a client and server. The metadata exposes entity definitions and action definitions, so that when you make a change on the server side, you can use a tool on the client side to generate proxy code. Therefore, the maintenance effort for developers is reduced. To consume new or changed entities and actions, you must extend the metadata. Retail Server has a default metadata controller that is named **CommerceModelFactory**. To extend the default controller, you create a new class that uses the **Export** attribute together with the **IEdmModelFactory** interface. You can then add and override existing code. For example, you can add new entity sets, new actions, new complex types, or new exception types. In the following example, the **ExtendedEdmModelFactory** class extends the **CommerceModelFactory** metadata controller and creates a new action that is named **NewAction** and a new entity set that is named **NewEntities**. You can find the sample code from this topic in the Retail software development kit (SDK).\n\n    namespace Microsoft.Dynamics.RetailServer.Samples.Extensions\n    {\n        using System.ComponentModel.Composition;\n        using Microsoft.Dynamics.Retail.StoreServerServiceLibrary;\n        [Export(typeof(IEdmModelFactory))]\n        public class ExtendedEdmModelFactory : CommerceModelFactory\n        {\n            protected override void BuildNonBindableActions()\n            {\n                base.BuildNonBindableActions();\n                var NewAction = BindAction(\"NewAction\");\n                NewAction.Returns<string>();\n            }\n            protected override void BuildEntitySets()\n            {\n                base.BuildEntitySets();\n                BuildEntitySet<NewEntity>(\"NewEntities\");\n            }\n        }\n    }\n\n"}