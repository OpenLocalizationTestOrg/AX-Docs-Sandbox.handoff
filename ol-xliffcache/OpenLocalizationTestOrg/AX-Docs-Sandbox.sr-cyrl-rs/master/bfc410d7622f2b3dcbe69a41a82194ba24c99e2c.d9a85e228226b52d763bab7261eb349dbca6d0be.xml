{"content":"---\n# required metadata\n\ntitle: Office integration troubleshooting\ndescription: This topic provides answers to questions, tips, and troubleshooting information for the Microsoft Office integration capabilities. The questions and issues that are discussed range across user, administration, and development scenarios.\nauthor: ChrisGarty\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\nms.search.form: OfficeAppParameters\n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: annbe\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 72263\nms.assetid: 89588fed-b47f-4f01-9328-325518f016d6\nms.search.region: Global\n# ms.search.industry: \nms.author: cgarty\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Office integration troubleshooting\n\n[!include[banner](../includes/banner.md)]\n\n\nThis topic provides answers to questions, tips, and troubleshooting information about the capabilities of the Microsoft Office integration. The questions and issues that are discussed range across user, administration, and development scenarios.\n\n## Frequently asked questions\n\n### What platforms do the Office Add-ins support?\n\nThe Microsoft Excel Add-in and Microsoft Word Add-in are built by using the Office Web/JavaScript Add-in framework. This framework was originally released for Microsoft Office 2013 but received significant updates in Microsoft Office 2016. For more information, see [Office Add-in host and platform availability](http://dev.office.com/add-in-availability). The Excel Add-in requires ExcelAPI 1.2. Therefore, use the [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) matrix to determine which platforms support the Excel Add-in. For many users, the phrase \"Excel 2016 with the latest updates\" is sufficient.\n\n### Are the Office Add-ins safe?\n\nIn an age of malware, full connectivity, and compliance risks, nothing is completely secure. However, the web add-ins, like other websites, are basically a web application that interacts with the Office client products via a limited application programming interface (API). For more details, see [What can an Office Add-in do?](https://dev.office.com/docs/add-ins/overview/office-add-ins#what-can-an-office-add-in-do)\n\n### Does the Excel Add-in support Office for Mac?\n\nNo. Support for Apple Mac and iOS is currently under development. The Office JavaScript (JS) APIs work differently in Apple Safari and Internet Explorer, especially in respect to authentication. For details about platform support for the Office JS APIs, see [Office Add-in host and platform availability](http://dev.office.com/add-in-availability).\n\n### What version of Office is required for the Excel Add-in to support AD FS?\n\nFor more information, see the \"Troubleshooting issue\" section later in this topic.\n\n### How can I force an update of Office?\n\nIf your Office build isn't updated, you might be on the deferred track ([Microsoft Office 365 ProPlus update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)). In this case, you can [use the Office Deployment Tool to move to the Current channel](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396) or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider) to help guarantee that you have the latest updates. The easiest method is to use the Office Deployment Tool to switch to the Current channel. In this case, the latest updates will be installed immediately.\n\n### Why can't you tell me what version of Office or Excel a particular issue is fixed in?\n\nOffice has many releases. These releases receive updates at different times and have different version numbers that don't correspond. Some frequently used Office versions and update methods are Click to Run (C2R) Current channel, C2R Deferred, C2R First Update Deferred, Office Insider Fast, Office Insider Slow, and MSI/MSO (install from DVD). For more information about Office versions, see the [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page.\n\n### Why am I having trouble signing into the Excel Add-in?\n\nThe Excel Add-in runs inside an Internet Explorer window. By default, the Excel Add-in picks up stored credentials from Internet Explorer, and Internet Explorer provides the current Microsoft Windows credentials if there are no stored credentials. Make sure that you're using the correct credentials to sign in. In the Excel Add-in, explicitly sign out, and then sign in to help guarantee that the correct credentials are used.\n\n### The Excel Add-in seems to be slow when it publishes records. How can I learn more about what is occurring?\n\nMost of the work that the Excel Add-in does should occur on the server. To learn where the time is being spent, you can use [Fiddler (a free download)](http://www.telerik.com/fiddler) to make sure that the Excel Add-in works as you expect.\n\nThe Excel Add-in sends the published records as a request. When those records are processed, the response is sent back from the server. The Excel Add-in then creates another message that contains the next set of records to publish, and sends that request. Five to ten seconds of processing time in the Excel Add-in should be required between the previous response from the server and the next request to the server.\n\nTo check processing time in the Excel Add-in versus the server/service, follow these steps.\n\n1. Start [Fiddler](http://www.telerik.com/fiddler). \n2. Publish a few records to test the process.\n3. Make sure that you can view that request and response in Fiddler ([make sure that HTTPS traffic is being decrypted](http://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/DecryptHTTPS)).\n4. Publish a larger number of records. \n5. In Fiddler, watch the time that is required from a request to its response, and from a response to the next request.\n\n    - If the time from a request to its response is large, the bottleneck is the server/service.\n    - If the time from a response to the next request is large, the bottleneck is the Excel Add-in (that is, the client).\n\n## Troubleshooting issues\n\n### \\[Fixed\\] Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"\n\n**Issue:** During sign in to the Excel Add-in, you receive the following error message: \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ.\"\n\n**Explanation:** Typically, this issue occurs because Microsoft Azure Active Directory (Azure AD) can't find the Azure AD application that represents the Excel Add-in. That issue occurs because, during the [configuration of Microsoft Power BI](..\\analytics\\configure-power-bi-integration.md), an Azure AD application was added that has the App ID URI set to the environment URL. \n\n**Fix:** Make sure that no Azure AD apps have the App ID URI set to the environment URL. App ID URIs should be fabricated, unique URIs, such as `https://contosoAXPowerBI`.\n\n### \\[Fixed\\] Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"\n\n**Issue:** During sign-in to the Excel Add-in, you receive the following error message: \"AADSTS50001: The application named ABC was not found in the tenant named XYZ.\"\n\n**Explanation:** This issue probably occurs because an error in the deployment system caused the environment to get a URL that wasn't added to the configured list of service principals for the tenant. \n\n**Fix:** File a support issue for your environment, so that the problem can be investigated and the configuration can be adjusted.\n\n### \\[Fixed\\] Issue: After the Excel Add-in starts and updates data, I receive the following error message: \"An error occurred while writing to the data cache\"\n\n**Issue:** After the Excel Add-in starts and updates data, you receive the following error message: \"An error occurred while writing to the data cache.\" The details of the error state, \"The argument is invalid or missing or has an incorrect format.\" \n\n**Explanation:** You receive this error message if the client is open in Internet Explorer, and the user clicks **Open** immediately after he or she selects the **Open in Excel** option. The way that Internet Explorer handles temporary Internet files causes an issue in Excel. This issue, in turn, causes API calls to fail. \n\n**Workaround:** In Internet Explorer, when you open a workbook, click **Save** first, and then click **Open**. The file will then be opened from your Downloads folder. Alternately, use the Edge or Google Chrome browser. By default, both these browsers save files to a Downloads folder. Therefore, the issue doesn't occur. \n\n**Long-term fix:** We are working with the Office team to understand this issue so that it can be fixed in Excel.\n\n### Issue: When I send email by using SMTP, the server response is \"5.7.60 SMTP; Client does not have permissions to send as this sender\"\n\n**Issue:** When you send email by using Simple Mail Transfer Protocol (SMTP), you might receive an error message that states that the server response was \"5.7.60 SMTP; Client does not have permissions to send as this sender.\" Alternatively, the error message might state, \"Something went wrong while generating the report.\"\n\n**Explanation:** This issue is usually caused by incorrect setup of the Send As permissions for the email account. \n\n**Fix:** You can configure Send As permissions in the Office 365 admin center (portal.office.com/Admin). Click **Users** > **Active users** > **User** > **Edit mailbox permissions** > **Send email from this mailbox**. For more information, see [Give mailbox permissions to another user in Office 365 - Admin Help](https://support.office.com/en-us/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E). \n\nThe following illustration shows the setup of SMTP on the **Email parameters** page. Here, you must provide the outgoing mail server, port, user name, password, and Secure Sockets Layer (SSL) requirements. \n\n[![SMTP settings tab on the Email parameters page](./media/smtp.png)](./media/smtp.png)\n\nThe permissions SMTP user account is `serviceacct@d365forops.onmicrosoft.com1`. \n\n> [!IMPORTANT]\n> All users must give the SMTP account Send As permissions on their email setup in Office 365. This configuration is done in the mailbox permissions in Microsoft Exchange or in the Office 365 Admin portal. The following illustration shows the setup for the Test User account, where the STMP service account is added in the **Send As** section. \n\n[![SMTP account that is granted Send As permissions in Office 365](./media/o365.png)](./media/o365.png)\n\n### \\[Fixed\\] Issue: The Office Add-ins don't yet support AD FS\n\n**Affected versions:** CTP8 and the February 2016 releases \n\n**Issue:** When users from an Azure AD tenant that uses Active Directory Federation Services (AD FS) try to sign in to the Office Add-ins (in other words, when the users enter their account, and then press Tab or click in the field to enter their password), a separate browser window opens. This browser window usually has a URL that starts with `https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\\#id\\_token=`. The user can't sign in. \n\n**Explanation:** During sign-in to the Office add-ins (both the Excel Add-in and the Word Add-in), a redirect to the AD FS site for the tenant occurs. However, that site is an unknown and therefore disallowed application domain (AppDomain). \n\n**Long-term fix:** The long-term fix for this issue was put in place on May 10, 2016. The Office Add-ins now use a new Dialog API that the Office team added. \n\n**Taking advantage of the add-in updates that support AD FS:** All Office installations should be updated via **File** > **Account** > **Updates** (for click-to-run installations) or via Windows Update (for MSI installations). The AD FS Dialog API was included in the May update ([16.0.6868.2060](http://answers.microsoft.com/en-us/office/forum/office_2016-office_install/may-update-16068682060-for-office-2016-on-windows/ea082237-7ec3-4b06-895b-83490980e6d2?auth=1)). For information about updates, see the [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page. \n\nIf your Office build isn't updated, you might be on the deferred track ([Microsoft Office 365 ProPlus update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)). In this case, you can [use the Office Deployment Tool to move to the Current channel](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396) or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider) to help guarantee that you have the latest updates. Additionally, see [Install the latest version of Office 2016](https://dev.office.com/docs/add-ins/develop/install-latest-office-version) and [Office 2016 Deployment Guides for Admins](https://technet.microsoft.com/en-us/library/cc303401(v=office.16).aspx). \n\nIf Office updates can't be installed, the following workaround can unblock users.\n\n#### Workaround: Use Internet Explorer to sign in to the client before you use the Office Add-ins\n\nThis workaround requires user knowledge and extra steps. After users have been educated about this workaround, it should be straightforward for them. \n\n**User steps:** Before users open Excel (or Word), they should sign in to the client by using Internet Explorer. \n\n**Explanation:** The Excel or Word Add-in will use the sign-in context, and no redirect will be required. The earlier sign-in must occur in Internet Explorer, because the Office Add-ins run inside an Internet Explorer window in Excel and Word. The sign-in context lasts 6 to 24 hours, depending on policies. Therefore, a new sign-in through Internet Explorer is required only occasionally.\n\n1.  Exit Internet Explorer and Excel.\n2.  Start Internet Explorer, and sign in to the client.\n3.  Test the Excel Add-in by using an Open in Excel experience. (For example, click **Fleet Management** &gt; **Customers** &gt; **Customer** &gt; **Open in Microsoft Office** &gt; **Open in Excel** &gt; **Fleet Management Customers**.)\n\n### \\[Fixed\\] Issue: The Excel Add-in doesn't correctly run or enable sign-in\n\n**Issue:** When users try to sign into the Excel Add-in, a blank authentication dialog box appears, or an error message is shown instead of the authentication page. The user can't sign in. \n\n**Explanation:** The Excel Add-in relies on the Office Web JS Add-in platform and uses Azure AD for authentication. If a proxy is used, several URLs must be accessible for users to run and sign in to the Excel Add-in. Additionally, if AD FS is used, the AD FS URL must use HTTPS. \n\n**Solution:** Because this issue is a customer-specific network issue, it requires a customer-specific resolution. If AD FS is used, make sure that the AD FS URL uses HTTPS. Additionally, make sure that all the following URLs are accessible from the user's computer.\n\nThe following URLs are accessed for loading:\n\n- `http://az689774.vo.msecnd.net:443`\n- `https://az689774.vo.msecnd.net`\n- `http://appsforoffice.microsoft.com:443`\n- `https://appsforoffice.microsoft.com`\n- `http://secure.aadcdn.microsoftonline-p.com:443`\n- `https://secure.aadcdn.microsoftonline-p.com`\n- `http://az416426.vo.msecnd.net:443`\n- `https://az416426.vo.msecnd.net`\n- `http://telemetryservice.firstpartyapps.oaspapps.com:443`\n- `https://telemetryservice.firstpartyapps.oaspapps.com`\n- `http://nexus.officeapps.live.com:443`\n- `https://nexus.officeapps.live.com`\n- `http://browser.pipe.aria.microsoft.com:443`\n- `https://browser.pipe.aria.microsoft.com`\n- `http://schemas.microsoft.com`\n\nThe following URLs are accessed for authentication:\n\n- `http://login.windows.net:443`\n- `https://login.windows.net`\n- `http://login.microsoftonline.com:443`\n- `https://login.microsoftonline.com`\n\n## See also\n\n[Office integration](office-integration.md)\n\n[Office integration tutorial](office-integration-tutorial.md)\n\n[Configuring Power BI integration](..\\analytics\\configure-power-bi-integration.md)\n","nodes":[{"pos":[4,850],"content":"# required metadata\n\ntitle: Office integration troubleshooting\ndescription: This topic provides answers to questions, tips, and troubleshooting information for the Microsoft Office integration capabilities. The questions and issues that are discussed range across user, administration, and development scenarios.\nauthor: ChrisGarty\nmanager: AnnBe\nms.date: 06/20/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\nms.search.form: OfficeAppParameters\n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: annbe\nms.search.scope: AX 7.0.0, Operations, UnifiedOperations\n# ms.tgt_pltfrm: \nms.custom: 72263\nms.assetid: 89588fed-b47f-4f01-9328-325518f016d6\nms.search.region: Global\n# ms.search.industry: \nms.author: cgarty\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n","nodes":[{"content":"Office integration troubleshooting","nodes":[{"pos":[0,34],"content":"Office integration troubleshooting","nodes":[{"content":"Office integration troubleshooting","pos":[0,34]}]}],"path":["title"]},{"content":"This topic provides answers to questions, tips, and troubleshooting information for the Microsoft Office integration capabilities. The questions and issues that are discussed range across user, administration, and development scenarios.","nodes":[{"pos":[0,236],"content":"This topic provides answers to questions, tips, and troubleshooting information for the Microsoft Office integration capabilities. The questions and issues that are discussed range across user, administration, and development scenarios.","nodes":[{"content":"This topic provides answers to questions, tips, and troubleshooting information for the Microsoft Office integration capabilities. The questions and issues that are discussed range across user, administration, and development scenarios.","pos":[0,236],"nodes":[{"content":"This topic provides answers to questions, tips, and troubleshooting information for the Microsoft Office integration capabilities.","pos":[0,130]},{"content":"The questions and issues that are discussed range across user, administration, and development scenarios.","pos":[131,236]}]}]}],"path":["description"]}],"header":"# required metadata\n","yml":true},{"pos":[858,892],"content":"Office integration troubleshooting","linkify":"Office integration troubleshooting","nodes":[{"content":"Office integration troubleshooting","pos":[0,34]}]},{"content":"This topic provides answers to questions, tips, and troubleshooting information about the capabilities of the Microsoft Office integration.","pos":[938,1077]},{"content":"The questions and issues that are discussed range across user, administration, and development scenarios.","pos":[1078,1183]},{"pos":[1188,1214],"content":"Frequently asked questions","linkify":"Frequently asked questions","nodes":[{"content":"Frequently asked questions","pos":[0,26]}]},{"pos":[1220,1265],"content":"What platforms do the Office Add-ins support?","linkify":"What platforms do the Office Add-ins support?","nodes":[{"content":"What platforms do the Office Add-ins support?","pos":[0,45]}]},{"content":"The Microsoft Excel Add-in and Microsoft Word Add-in are built by using the Office Web/JavaScript Add-in framework.","pos":[1267,1382]},{"content":"This framework was originally released for Microsoft Office 2013 but received significant updates in Microsoft Office 2016.","pos":[1383,1506]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Office Add-in host and platform availability<ept id=\"p1\">](http://dev.office.com/add-in-availability)</ept>.","pos":[1507,1623],"source":" For more information, see [Office Add-in host and platform availability](http://dev.office.com/add-in-availability)."},{"content":"The Excel Add-in requires ExcelAPI 1.2.","pos":[1624,1663]},{"content":"Therefore, use the <bpt id=\"p1\">[</bpt>Office Add-in host and platform availability<ept id=\"p1\">](http://dev.office.com/add-in-availability)</ept> matrix to determine which platforms support the Excel Add-in.","pos":[1664,1834],"source":" Therefore, use the [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) matrix to determine which platforms support the Excel Add-in."},{"content":"For many users, the phrase \"Excel 2016 with the latest updates\" is sufficient.","pos":[1835,1913]},{"pos":[1919,1947],"content":"Are the Office Add-ins safe?","linkify":"Are the Office Add-ins safe?","nodes":[{"content":"Are the Office Add-ins safe?","pos":[0,28]}]},{"content":"In an age of malware, full connectivity, and compliance risks, nothing is completely secure.","pos":[1949,2041]},{"content":"However, the web add-ins, like other websites, are basically a web application that interacts with the Office client products via a limited application programming interface (API).","pos":[2042,2222]},{"content":"For more details, see <bpt id=\"p1\">[</bpt>What can an Office Add-in do?<ept id=\"p1\">](https://dev.office.com/docs/add-ins/overview/office-add-ins#what-can-an-office-add-in-do)</ept>","pos":[2223,2366],"source":" For more details, see [What can an Office Add-in do?](https://dev.office.com/docs/add-ins/overview/office-add-ins#what-can-an-office-add-in-do)"},{"pos":[2372,2417],"content":"Does the Excel Add-in support Office for Mac?","linkify":"Does the Excel Add-in support Office for Mac?","nodes":[{"content":"Does the Excel Add-in support Office for Mac?","pos":[0,45]}]},{"content":"No.","pos":[2419,2422]},{"content":"Support for Apple Mac and iOS is currently under development.","pos":[2423,2484]},{"content":"The Office JavaScript (JS) APIs work differently in Apple Safari and Internet Explorer, especially in respect to authentication.","pos":[2485,2613]},{"content":"For details about platform support for the Office JS APIs, see <bpt id=\"p1\">[</bpt>Office Add-in host and platform availability<ept id=\"p1\">](http://dev.office.com/add-in-availability)</ept>.","pos":[2614,2767],"source":" For details about platform support for the Office JS APIs, see [Office Add-in host and platform availability](http://dev.office.com/add-in-availability)."},{"pos":[2773,2846],"content":"What version of Office is required for the Excel Add-in to support AD FS?","linkify":"What version of Office is required for the Excel Add-in to support AD FS?","nodes":[{"content":"What version of Office is required for the Excel Add-in to support AD FS?","pos":[0,73]}]},{"content":"For more information, see the \"Troubleshooting issue\" section later in this topic.","pos":[2848,2930]},{"pos":[2936,2972],"content":"How can I force an update of Office?","linkify":"How can I force an update of Office?","nodes":[{"content":"How can I force an update of Office?","pos":[0,36]}]},{"content":"If your Office build isn't updated, you might be on the deferred track (<bpt id=\"p1\">[</bpt>Microsoft Office 365 ProPlus update channel option<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/mt455210.aspx)</ept>).","pos":[2974,3159],"source":"If your Office build isn't updated, you might be on the deferred track ([Microsoft Office 365 ProPlus update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx))."},{"content":"In this case, you can <bpt id=\"p1\">[</bpt>use the Office Deployment Tool to move to the Current channel<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&amp;MSPPError=-2147217396)</ept> or sign up for the <bpt id=\"p2\">[</bpt>Office Insider program<ept id=\"p2\">](https://products.office.com/en-us/office-insider)</ept> to help guarantee that you have the latest updates.","pos":[3160,3478],"source":" In this case, you can [use the Office Deployment Tool to move to the Current channel](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396) or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider) to help guarantee that you have the latest updates."},{"content":"The easiest method is to use the Office Deployment Tool to switch to the Current channel.","pos":[3479,3568]},{"content":"In this case, the latest updates will be installed immediately.","pos":[3569,3632]},{"pos":[3638,3723],"content":"Why can't you tell me what version of Office or Excel a particular issue is fixed in?","linkify":"Why can't you tell me what version of Office or Excel a particular issue is fixed in?","nodes":[{"content":"Why can't you tell me what version of Office or Excel a particular issue is fixed in?","pos":[0,85]}]},{"content":"Office has many releases.","pos":[3725,3750]},{"content":"These releases receive updates at different times and have different version numbers that don't correspond.","pos":[3751,3858]},{"content":"Some frequently used Office versions and update methods are Click to Run (C2R) Current channel, C2R Deferred, C2R First Update Deferred, Office Insider Fast, Office Insider Slow, and MSI/MSO (install from DVD).","pos":[3859,4069]},{"content":"For more information about Office versions, see the <bpt id=\"p1\">[</bpt>Office 365 client update channel releases<ept id=\"p1\">](https://technet.microsoft.com/en-us/office/mt465751?f=255&amp;MSPPError=-2147217396)</ept> page.","pos":[4070,4252],"source":" For more information about Office versions, see the [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page."},{"pos":[4258,4312],"content":"Why am I having trouble signing into the Excel Add-in?","linkify":"Why am I having trouble signing into the Excel Add-in?","nodes":[{"content":"Why am I having trouble signing into the Excel Add-in?","pos":[0,54]}]},{"content":"The Excel Add-in runs inside an Internet Explorer window.","pos":[4314,4371]},{"content":"By default, the Excel Add-in picks up stored credentials from Internet Explorer, and Internet Explorer provides the current Microsoft Windows credentials if there are no stored credentials.","pos":[4372,4561]},{"content":"Make sure that you're using the correct credentials to sign in.","pos":[4562,4625]},{"content":"In the Excel Add-in, explicitly sign out, and then sign in to help guarantee that the correct credentials are used.","pos":[4626,4741]},{"pos":[4747,4853],"content":"The Excel Add-in seems to be slow when it publishes records. How can I learn more about what is occurring?","linkify":"The Excel Add-in seems to be slow when it publishes records. How can I learn more about what is occurring?","nodes":[{"content":"The Excel Add-in seems to be slow when it publishes records. How can I learn more about what is occurring?","pos":[0,106],"nodes":[{"content":"The Excel Add-in seems to be slow when it publishes records.","pos":[0,60]},{"content":"How can I learn more about what is occurring?","pos":[61,106]}]}]},{"content":"Most of the work that the Excel Add-in does should occur on the server.","pos":[4855,4926]},{"content":"To learn where the time is being spent, you can use <bpt id=\"p1\">[</bpt>Fiddler (a free download)<ept id=\"p1\">](http://www.telerik.com/fiddler)</ept> to make sure that the Excel Add-in works as you expect.","pos":[4927,5094],"source":" To learn where the time is being spent, you can use [Fiddler (a free download)](http://www.telerik.com/fiddler) to make sure that the Excel Add-in works as you expect."},{"content":"The Excel Add-in sends the published records as a request.","pos":[5096,5154]},{"content":"When those records are processed, the response is sent back from the server.","pos":[5155,5231]},{"content":"The Excel Add-in then creates another message that contains the next set of records to publish, and sends that request.","pos":[5232,5351]},{"content":"Five to ten seconds of processing time in the Excel Add-in should be required between the previous response from the server and the next request to the server.","pos":[5352,5511]},{"content":"To check processing time in the Excel Add-in versus the server/service, follow these steps.","pos":[5513,5604]},{"pos":[5609,5657],"content":"Start <bpt id=\"p1\">[</bpt>Fiddler<ept id=\"p1\">](http://www.telerik.com/fiddler)</ept>.","source":"Start [Fiddler](http://www.telerik.com/fiddler)."},{"content":"Publish a few records to test the process.","pos":[5662,5704]},{"pos":[5708,5895],"content":"Make sure that you can view that request and response in Fiddler (<bpt id=\"p1\">[</bpt>make sure that HTTPS traffic is being decrypted<ept id=\"p1\">](http://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/DecryptHTTPS)</ept>).","source":"Make sure that you can view that request and response in Fiddler ([make sure that HTTPS traffic is being decrypted](http://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/DecryptHTTPS))."},{"content":"Publish a larger number of records.","pos":[5899,5934]},{"content":"In Fiddler, watch the time that is required from a request to its response, and from a response to the next request.","pos":[5939,6055]},{"content":"If the time from a request to its response is large, the bottleneck is the server/service.","pos":[6063,6153]},{"content":"If the time from a response to the next request is large, the bottleneck is the Excel Add-in (that is, the client).","pos":[6160,6275]},{"pos":[6280,6302],"content":"Troubleshooting issues","linkify":"Troubleshooting issues","nodes":[{"content":"Troubleshooting issues","pos":[0,22]}]},{"pos":[6308,6493],"content":"\\[Fixed\\] Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"","linkify":"\\[Fixed\\] Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"","pos":[0,185],"source":"\\[Fixed\\] Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\""}]},{"pos":[6495,6677],"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> During sign in to the Excel Add-in, you receive the following error message: \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ.\"","source":"**Issue:** During sign in to the Excel Add-in, you receive the following error message: \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ.\""},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> Typically, this issue occurs because Microsoft Azure Active Directory (Azure AD) can't find the Azure AD application that represents the Excel Add-in.","pos":[6679,6846],"source":"**Explanation:** Typically, this issue occurs because Microsoft Azure Active Directory (Azure AD) can't find the Azure AD application that represents the Excel Add-in."},{"content":"That issue occurs because, during the <bpt id=\"p1\">[</bpt>configuration of Microsoft Power BI<ept id=\"p1\">](..\\analytics\\configure-power-bi-integration.md)</ept>, an Azure AD application was added that has the App ID URI set to the environment URL.","pos":[6847,7057],"source":" That issue occurs because, during the [configuration of Microsoft Power BI](..\\analytics\\configure-power-bi-integration.md), an Azure AD application was added that has the App ID URI set to the environment URL."},{"content":"<bpt id=\"p1\">**</bpt>Fix:<ept id=\"p1\">**</ept> Make sure that no Azure AD apps have the App ID URI set to the environment URL.","pos":[7060,7148],"source":"**Fix:** Make sure that no Azure AD apps have the App ID URI set to the environment URL."},{"content":"App ID URIs should be fabricated, unique URIs, such as <ph id=\"ph1\">`https://contosoAXPowerBI`</ph>.","pos":[7149,7231],"source":" App ID URIs should be fabricated, unique URIs, such as `https://contosoAXPowerBI`."},{"pos":[7237,7407],"content":"\\[Fixed\\] Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"","linkify":"\\[Fixed\\] Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"","pos":[0,170],"source":"\\[Fixed\\] Issue: During sign-in to the Excel Add-in, I receive the following error message: \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\""}]},{"pos":[7409,7576],"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> During sign-in to the Excel Add-in, you receive the following error message: \"AADSTS50001: The application named ABC was not found in the tenant named XYZ.\"","source":"**Issue:** During sign-in to the Excel Add-in, you receive the following error message: \"AADSTS50001: The application named ABC was not found in the tenant named XYZ.\""},{"pos":[7578,7778],"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> This issue probably occurs because an error in the deployment system caused the environment to get a URL that wasn't added to the configured list of service principals for the tenant.","source":"**Explanation:** This issue probably occurs because an error in the deployment system caused the environment to get a URL that wasn't added to the configured list of service principals for the tenant."},{"pos":[7781,7911],"content":"<bpt id=\"p1\">**</bpt>Fix:<ept id=\"p1\">**</ept> File a support issue for your environment, so that the problem can be investigated and the configuration can be adjusted.","source":"**Fix:** File a support issue for your environment, so that the problem can be investigated and the configuration can be adjusted."},{"pos":[7917,8072],"content":"\\[Fixed\\] Issue: After the Excel Add-in starts and updates data, I receive the following error message: \"An error occurred while writing to the data cache\"","linkify":"\\[Fixed\\] Issue: After the Excel Add-in starts and updates data, I receive the following error message: \"An error occurred while writing to the data cache\"","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: After the Excel Add-in starts and updates data, I receive the following error message: \"An error occurred while writing to the data cache\"","pos":[0,155],"source":"\\[Fixed\\] Issue: After the Excel Add-in starts and updates data, I receive the following error message: \"An error occurred while writing to the data cache\""}]},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> After the Excel Add-in starts and updates data, you receive the following error message: \"An error occurred while writing to the data cache.\"","pos":[8074,8226],"source":"**Issue:** After the Excel Add-in starts and updates data, you receive the following error message: \"An error occurred while writing to the data cache.\""},{"content":"The details of the error state, \"The argument is invalid or missing or has an incorrect format.\"","pos":[8227,8323]},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> You receive this error message if the client is open in Internet Explorer, and the user clicks <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> immediately after he or she selects the <bpt id=\"p3\">**</bpt>Open in Excel<ept id=\"p3\">**</ept> option.","pos":[8326,8512],"source":"**Explanation:** You receive this error message if the client is open in Internet Explorer, and the user clicks **Open** immediately after he or she selects the **Open in Excel** option."},{"content":"The way that Internet Explorer handles temporary Internet files causes an issue in Excel.","pos":[8513,8602]},{"content":"This issue, in turn, causes API calls to fail.","pos":[8603,8649]},{"content":"<bpt id=\"p1\">**</bpt>Workaround:<ept id=\"p1\">**</ept> In Internet Explorer, when you open a workbook, click <bpt id=\"p2\">**</bpt>Save<ept id=\"p2\">**</ept> first, and then click <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept>.","pos":[8652,8762],"source":"**Workaround:** In Internet Explorer, when you open a workbook, click **Save** first, and then click **Open**."},{"content":"The file will then be opened from your Downloads folder.","pos":[8763,8819]},{"content":"Alternately, use the Edge or Google Chrome browser.","pos":[8820,8871]},{"content":"By default, both these browsers save files to a Downloads folder.","pos":[8872,8937]},{"content":"Therefore, the issue doesn't occur.","pos":[8938,8973]},{"pos":[8976,9089],"content":"<bpt id=\"p1\">**</bpt>Long-term fix:<ept id=\"p1\">**</ept> We are working with the Office team to understand this issue so that it can be fixed in Excel.","source":"**Long-term fix:** We are working with the Office team to understand this issue so that it can be fixed in Excel."},{"pos":[9095,9228],"content":"Issue: When I send email by using SMTP, the server response is \"5.7.60 SMTP; Client does not have permissions to send as this sender\"","linkify":"Issue: When I send email by using SMTP, the server response is \"5.7.60 SMTP; Client does not have permissions to send as this sender\"","nodes":[{"content":"Issue: When I send email by using SMTP, the server response is \"5.7.60 SMTP; Client does not have permissions to send as this sender\"","pos":[0,133]}]},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> When you send email by using Simple Mail Transfer Protocol (SMTP), you might receive an error message that states that the server response was \"5.7.60 SMTP; Client does not have permissions to send as this sender.\"","pos":[9230,9455],"source":"**Issue:** When you send email by using Simple Mail Transfer Protocol (SMTP), you might receive an error message that states that the server response was \"5.7.60 SMTP; Client does not have permissions to send as this sender.\""},{"content":"Alternatively, the error message might state, \"Something went wrong while generating the report.\"","pos":[9456,9553]},{"pos":[9555,9669],"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> This issue is usually caused by incorrect setup of the Send As permissions for the email account.","source":"**Explanation:** This issue is usually caused by incorrect setup of the Send As permissions for the email account."},{"content":"<bpt id=\"p1\">**</bpt>Fix:<ept id=\"p1\">**</ept> You can configure Send As permissions in the Office 365 admin center (portal.office.com/Admin).","pos":[9672,9776],"source":"**Fix:** You can configure Send As permissions in the Office 365 admin center (portal.office.com/Admin)."},{"content":"Click <bpt id=\"p1\">**</bpt>Users<ept id=\"p1\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p2\">**</bpt>Active users<ept id=\"p2\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p3\">**</bpt>User<ept id=\"p3\">**</ept><ph id=\"ph3\"> &gt; </ph><bpt id=\"p4\">**</bpt>Edit mailbox permissions<ept id=\"p4\">**</ept><ph id=\"ph4\"> &gt; </ph><bpt id=\"p5\">**</bpt>Send email from this mailbox<ept id=\"p5\">**</ept>.","pos":[9777,9889],"source":" Click **Users** > **Active users** > **User** > **Edit mailbox permissions** > **Send email from this mailbox**."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Give mailbox permissions to another user in Office 365 - Admin Help<ept id=\"p1\">](https://support.office.com/en-us/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E)</ept>.","pos":[9890,10128],"source":" For more information, see [Give mailbox permissions to another user in Office 365 - Admin Help](https://support.office.com/en-us/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E)."},{"content":"The following illustration shows the setup of SMTP on the <bpt id=\"p1\">**</bpt>Email parameters<ept id=\"p1\">**</ept> page.","pos":[10131,10215],"source":"The following illustration shows the setup of SMTP on the **Email parameters** page."},{"content":"Here, you must provide the outgoing mail server, port, user name, password, and Secure Sockets Layer (SSL) requirements.","pos":[10216,10336]},{"pos":[10339,10426],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>SMTP settings tab on the Email parameters page<ept id=\"p1\">](./media/smtp.png)](./media/smtp.png)</ept>","source":"[![SMTP settings tab on the Email parameters page](./media/smtp.png)](./media/smtp.png)"},{"pos":[10428,10507],"content":"The permissions SMTP user account is <ph id=\"ph1\">`serviceacct@d365forops.onmicrosoft.com1`</ph>.","source":"The permissions SMTP user account is `serviceacct@d365forops.onmicrosoft.com1`."},{"pos":[10512,10868],"content":"[!IMPORTANT]\nAll users must give the SMTP account Send As permissions on their email setup in Office 365. This configuration is done in the mailbox permissions in Microsoft Exchange or in the Office 365 Admin portal. The following illustration shows the setup for the Test User account, where the STMP service account is added in the **Send As** section.","leadings":["","> "],"nodes":[{"content":"All users must give the SMTP account Send As permissions on their email setup in Office 365. This configuration is done in the mailbox permissions in Microsoft Exchange or in the Office 365 Admin portal. The following illustration shows the setup for the Test User account, where the STMP service account is added in the **Send As** section.","pos":[13,354],"nodes":[{"content":"All users must give the SMTP account Send As permissions on their email setup in Office 365.","pos":[0,92]},{"content":"This configuration is done in the mailbox permissions in Microsoft Exchange or in the Office 365 Admin portal.","pos":[93,203]},{"content":"The following illustration shows the setup for the Test User account, where the STMP service account is added in the <bpt id=\"p1\">**</bpt>Send As<ept id=\"p1\">**</ept> section.","pos":[204,341],"source":" The following illustration shows the setup for the Test User account, where the STMP service account is added in the **Send As** section."}]}]},{"pos":[10871,10974],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>SMTP account that is granted Send As permissions in Office 365<ept id=\"p1\">](./media/o365.png)](./media/o365.png)</ept>","source":"[![SMTP account that is granted Send As permissions in Office 365](./media/o365.png)](./media/o365.png)"},{"pos":[10980,11039],"content":"\\[Fixed\\] Issue: The Office Add-ins don't yet support AD FS","linkify":"\\[Fixed\\] Issue: The Office Add-ins don't yet support AD FS","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: The Office Add-ins don't yet support AD FS","pos":[0,59],"source":"\\[Fixed\\] Issue: The Office Add-ins don't yet support AD FS"}]},{"pos":[11041,11099],"content":"<bpt id=\"p1\">**</bpt>Affected versions:<ept id=\"p1\">**</ept> CTP8 and the February 2016 releases","source":"**Affected versions:** CTP8 and the February 2016 releases"},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> When users from an Azure AD tenant that uses Active Directory Federation Services (AD FS) try to sign in to the Office Add-ins (in other words, when the users enter their account, and then press Tab or click in the field to enter their password), a separate browser window opens.","pos":[11102,11392],"source":"**Issue:** When users from an Azure AD tenant that uses Active Directory Federation Services (AD FS) try to sign in to the Office Add-ins (in other words, when the users enter their account, and then press Tab or click in the field to enter their password), a separate browser window opens."},{"content":"This browser window usually has a URL that starts with <ph id=\"ph1\">`https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\\#id\\_token=`</ph>.","pos":[11393,11541],"source":" This browser window usually has a URL that starts with `https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\\#id\\_token=`."},{"content":"The user can't sign in.","pos":[11542,11565]},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> During sign-in to the Office add-ins (both the Excel Add-in and the Word Add-in), a redirect to the AD FS site for the tenant occurs.","pos":[11568,11718],"source":"**Explanation:** During sign-in to the Office add-ins (both the Excel Add-in and the Word Add-in), a redirect to the AD FS site for the tenant occurs."},{"content":"However, that site is an unknown and therefore disallowed application domain (AppDomain).","pos":[11719,11808]},{"content":"<bpt id=\"p1\">**</bpt>Long-term fix:<ept id=\"p1\">**</ept> The long-term fix for this issue was put in place on May 10, 2016.","pos":[11811,11896],"source":"**Long-term fix:** The long-term fix for this issue was put in place on May 10, 2016."},{"content":"The Office Add-ins now use a new Dialog API that the Office team added.","pos":[11897,11968]},{"content":"<bpt id=\"p1\">**</bpt>Taking advantage of the add-in updates that support AD FS:<ept id=\"p1\">**</ept> All Office installations should be updated via <bpt id=\"p2\">**</bpt>File<ept id=\"p2\">**</ept><ph id=\"ph1\"> &gt; </ph><bpt id=\"p3\">**</bpt>Account<ept id=\"p3\">**</ept><ph id=\"ph2\"> &gt; </ph><bpt id=\"p4\">**</bpt>Updates<ept id=\"p4\">**</ept> (for click-to-run installations) or via Windows Update (for MSI installations).","pos":[11971,12197],"source":"**Taking advantage of the add-in updates that support AD FS:** All Office installations should be updated via **File** > **Account** > **Updates** (for click-to-run installations) or via Windows Update (for MSI installations)."},{"content":"The AD FS Dialog API was included in the May update (<bpt id=\"p1\">[</bpt>16.0.6868.2060<ept id=\"p1\">](http://answers.microsoft.com/en-us/office/forum/office_2016-office_install/may-update-16068682060-for-office-2016-on-windows/ea082237-7ec3-4b06-895b-83490980e6d2?auth=1)</ept>).","pos":[12198,12439],"source":" The AD FS Dialog API was included in the May update ([16.0.6868.2060](http://answers.microsoft.com/en-us/office/forum/office_2016-office_install/may-update-16068682060-for-office-2016-on-windows/ea082237-7ec3-4b06-895b-83490980e6d2?auth=1))."},{"content":"For information about updates, see the <bpt id=\"p1\">[</bpt>Office 365 client update channel releases<ept id=\"p1\">](https://technet.microsoft.com/en-us/office/mt465751?f=255&amp;MSPPError=-2147217396)</ept> page.","pos":[12440,12609],"source":" For information about updates, see the [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page."},{"content":"If your Office build isn't updated, you might be on the deferred track (<bpt id=\"p1\">[</bpt>Microsoft Office 365 ProPlus update channel option<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/mt455210.aspx)</ept>).","pos":[12612,12797],"source":"If your Office build isn't updated, you might be on the deferred track ([Microsoft Office 365 ProPlus update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx))."},{"content":"In this case, you can <bpt id=\"p1\">[</bpt>use the Office Deployment Tool to move to the Current channel<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&amp;MSPPError=-2147217396)</ept> or sign up for the <bpt id=\"p2\">[</bpt>Office Insider program<ept id=\"p2\">](https://products.office.com/en-us/office-insider)</ept> to help guarantee that you have the latest updates.","pos":[12798,13116],"source":" In this case, you can [use the Office Deployment Tool to move to the Current channel](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396) or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider) to help guarantee that you have the latest updates."},{"content":"Additionally, see <bpt id=\"p1\">[</bpt>Install the latest version of Office 2016<ept id=\"p1\">](https://dev.office.com/docs/add-ins/develop/install-latest-office-version)</ept> and <bpt id=\"p2\">[</bpt>Office 2016 Deployment Guides for Admins<ept id=\"p2\">](https://technet.microsoft.com/en-us/library/cc303401(v=office.16).aspx)</ept>.","pos":[13117,13373],"source":" Additionally, see [Install the latest version of Office 2016](https://dev.office.com/docs/add-ins/develop/install-latest-office-version) and [Office 2016 Deployment Guides for Admins](https://technet.microsoft.com/en-us/library/cc303401(v=office.16).aspx)."},{"content":"If Office updates can't be installed, the following workaround can unblock users.","pos":[13376,13457]},{"pos":[13464,13556],"content":"Workaround: Use Internet Explorer to sign in to the client before you use the Office Add-ins","linkify":"Workaround: Use Internet Explorer to sign in to the client before you use the Office Add-ins","nodes":[{"content":"Workaround: Use Internet Explorer to sign in to the client before you use the Office Add-ins","pos":[0,92]}]},{"content":"This workaround requires user knowledge and extra steps.","pos":[13558,13614]},{"content":"After users have been educated about this workaround, it should be straightforward for them.","pos":[13615,13707]},{"pos":[13710,13822],"content":"<bpt id=\"p1\">**</bpt>User steps:<ept id=\"p1\">**</ept> Before users open Excel (or Word), they should sign in to the client by using Internet Explorer.","source":"**User steps:** Before users open Excel (or Word), they should sign in to the client by using Internet Explorer."},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> The Excel or Word Add-in will use the sign-in context, and no redirect will be required.","pos":[13825,13930],"source":"**Explanation:** The Excel or Word Add-in will use the sign-in context, and no redirect will be required."},{"content":"The earlier sign-in must occur in Internet Explorer, because the Office Add-ins run inside an Internet Explorer window in Excel and Word.","pos":[13931,14068]},{"content":"The sign-in context lasts 6 to 24 hours, depending on policies.","pos":[14069,14132]},{"content":"Therefore, a new sign-in through Internet Explorer is required only occasionally.","pos":[14133,14214]},{"content":"Exit Internet Explorer and Excel.","pos":[14220,14253]},{"content":"Start Internet Explorer, and sign in to the client.","pos":[14258,14309]},{"content":"Test the Excel Add-in by using an Open in Excel experience.","pos":[14314,14373]},{"content":"(For example, click <bpt id=\"p1\">**</bpt>Fleet Management<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Customers<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Customer<ept id=\"p3\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Open in Microsoft Office<ept id=\"p4\">**</ept> <ph id=\"ph4\">&amp;gt;</ph> <bpt id=\"p5\">**</bpt>Open in Excel<ept id=\"p5\">**</ept> <ph id=\"ph5\">&amp;gt;</ph> <bpt id=\"p6\">**</bpt>Fleet Management Customers<ept id=\"p6\">**</ept>.)","pos":[14374,14546],"source":" (For example, click **Fleet Management** &gt; **Customers** &gt; **Customer** &gt; **Open in Microsoft Office** &gt; **Open in Excel** &gt; **Fleet Management Customers**.)"},{"pos":[14552,14625],"content":"\\[Fixed\\] Issue: The Excel Add-in doesn't correctly run or enable sign-in","linkify":"\\[Fixed\\] Issue: The Excel Add-in doesn't correctly run or enable sign-in","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: The Excel Add-in doesn't correctly run or enable sign-in","pos":[0,73],"source":"\\[Fixed\\] Issue: The Excel Add-in doesn't correctly run or enable sign-in"}]},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> When users try to sign into the Excel Add-in, a blank authentication dialog box appears, or an error message is shown instead of the authentication page.","pos":[14627,14791],"source":"**Issue:** When users try to sign into the Excel Add-in, a blank authentication dialog box appears, or an error message is shown instead of the authentication page."},{"content":"The user can't sign in.","pos":[14792,14815]},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> The Excel Add-in relies on the Office Web JS Add-in platform and uses Azure AD for authentication.","pos":[14818,14933],"source":"**Explanation:** The Excel Add-in relies on the Office Web JS Add-in platform and uses Azure AD for authentication."},{"content":"If a proxy is used, several URLs must be accessible for users to run and sign in to the Excel Add-in.","pos":[14934,15035]},{"content":"Additionally, if AD FS is used, the AD FS URL must use HTTPS.","pos":[15036,15097]},{"content":"<bpt id=\"p1\">**</bpt>Solution:<ept id=\"p1\">**</ept> Because this issue is a customer-specific network issue, it requires a customer-specific resolution.","pos":[15100,15214],"source":"**Solution:** Because this issue is a customer-specific network issue, it requires a customer-specific resolution."},{"content":"If AD FS is used, make sure that the AD FS URL uses HTTPS.","pos":[15215,15273]},{"content":"Additionally, make sure that all the following URLs are accessible from the user's computer.","pos":[15274,15366]},{"content":"The following URLs are accessed for loading:","pos":[15368,15412]},{"content":"The following URLs are accessed for authentication:","pos":[16063,16114]},{"pos":[16262,16270],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[16272,16315],"content":"<bpt id=\"p1\">[</bpt>Office integration<ept id=\"p1\">](office-integration.md)</ept>","source":"[Office integration](office-integration.md)"},{"pos":[16317,16378],"content":"<bpt id=\"p1\">[</bpt>Office integration tutorial<ept id=\"p1\">](office-integration-tutorial.md)</ept>","source":"[Office integration tutorial](office-integration-tutorial.md)"},{"pos":[16380,16462],"content":"<bpt id=\"p1\">[</bpt>Configuring Power BI integration<ept id=\"p1\">](..\\analytics\\configure-power-bi-integration.md)</ept>","source":"[Configuring Power BI integration](..\\analytics\\configure-power-bi-integration.md)"}]}