{"content":"---\n# required metadata\n\ntitle: Office integration troubleshooting\ndescription: This article provides answers to questions, tips, and troubleshooting information for the Microsoft Dynamics 365 for Operations Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.\nauthor: ChrisGarty\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\nms.search.form: OfficeAppParameters\n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: annbe\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 72263\nms.assetid: 89588fed-b47f-4f01-9328-325518f016d6\nms.search.region: Global\n# ms.search.industry: \nms.author: cgarty\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Office integration troubleshooting\n\n[!include[banner](../includes/banner.md)]\n\n\nThis article provides answers to questions, tips, and troubleshooting information for the Microsoft Dynamics 365 for Operations Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.\n\nFrequently asked questions\n--------------------------\n\n### What platforms are supported for the Office Add-ins?\n\nThe Excel Add-in and Word Add-in are built using the Office Web/JavaScript Add-in framework that was initially released for Office 2013, but received significant updates in Office 2016. If needed, read details about [Office Add-in host and platform availability](http://dev.office.com/add-in-availability). The Excel Add-in requires the ExcelAPI 1.2, so use the [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) matrix to view which platforms it is supported on. For many users, the phrase \"Excel 2016 with the latest updates\" is sufficient.\n\n### Is Office for Mac supported for the Excel Add-in?\n\nYes. The Excel Add-in requires the ExcelAPI 1.2, so use the [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) matrix to view which platforms it is supported on.\n\n### What version of Office is needed to allow the Excel Add-in to support ADFS?\n\nRead more about that in the troubleshooting section below.\n\n### How can Office be forced into updating?\n\nIf your Office build does not update then it might be because you are on the deferred track ([a \"Microsoft Office 365 ProPlus\" update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)), in which case you could [use the \"Office Deployment Tool\" to move to the Current channel ](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396)or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider)to ensure you have the latest updates. The easiest path is using the Office Deployment Tool to switch to the Current channel which will cause the latest updates to install immediately.\n\n### Why can't you tell me what version of Office/Excel a particular issue is fixed in?\n\nOffice has a large number of different releases which receive updates at different times and have different version numbers that don't correspond. Some of the more common Office versions and update methods are Click to Run (C2R) Current channel, C2R Deferred, C2R First Update Deferred, Office Insider Fast, Office Insider Slow, and MSI/MSO (install from DVD). The [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page has more information about Office versions.\n\n### Why am I having trouble signing into the Excel Add-in?\n\nThe Excel Add-in runs inside an Internet Explorer (IE) window. The Excel Add-in will pick up stored credentials from IE by default, and IE will provide the current Windows credentials if there are no stored credentials. The most common problem people have when signing-in is IE using the wrong credentials. Ensure you are trying to sign in with the correct credentials. In the Excel Add-in, explicitly sign out and then sign in to ensure that the desired credentials are in use.\n\n## Troubleshooting Issues\n### \\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"\n\n**Issue:** During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\". **Explanation:** This is usually caused when AAD cannot find the AAD application representing the Excel Add-in because during [PowerBI configuration](..\\analytics\\configure-power-bi-integration.md) an AAD application was added that has the App ID URI set to the environment URL. **Fix:** Ensure that there are no AAD App ID URI's set to the environment URI. App ID URI's should be a made up unique URI like https://contosoAXPowerBI.\n\n### \\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"\n\n**Issue:** During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\". **Explanation:** This is likely a failure in the deployment system that caused the environment to get a URL that was not added in the configured list of Service Principals for the tenant. **Fix:** File a support issue for your environment so the problem can be investigated further and the configuration can be adjusted.\n\n### \\[Fixed\\] Issue: After the Excel Add-in opens and is refreshing data, an error appears \"An error occurred while writing to the data cache\"\n\n**Issue:** After the Excel Add-in opens and is refreshing data, an error appears \"An error occurred while writing to the data cache\" with details of \"The argument is invalid or missing or has an incorrect format\". **Explanation:** This error will appear if the Dynamics 365 for Operations Client is open in Internet Explorer (IE) and after doing an \"Open in Excel\" option the user clicks \"Open\" immediately. The way IE handles Temporary Internet Files then causes an issue inside Excel which causes some API calls to fail. **Workaround:** For IE, when opening a workbook... click Save first, then click Open. The file will then open from your Downloads folder. Alternately, Edge and Chrome will both not showcase this problem since they save files to a Downloads folder automatically. **Long term fix:** We are helping the Office team understand and reproduce this issue so it can be fixed in Excel.\n\n### Issue: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender\n\n**Issue:** When sending email using SMTP you may see the error: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender or Something went wrong while generating the report **Explanation:** This is usually caused by incorrect setup of the Send as permissions setup for the email account **Fix:** Send As permissions can be configured on the Office 365 admin center (portal.office.com/Admin) &gt; Users &gt; Active users &gt; User &gt; Edit mailbox permissions &gt; Send email from this mailbox ([Office 365 Help on Send email from another user’s mailbox](https://support.office.com/en-us/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E)).SMTP setup Example: Below you see the Email parameters form where you need to provide the Outgoing mail server, port, User name, Password, and SSL requirements. [![smtp](./media/smtp.jpg)](./media/smtp.jpg)   Permissions SMTP User account is serviceacct@d365forops.onmicrosoft.com Important: All Users like the example Test User below will need to allow the SMTP account to have SEND AS permissions on their email setup in O365. This is done in the Mailbox permissions in Exchange or in the Office 365 Admin portal. The screen shot below shows the setup for the test user account with the STMP service account added in the Send As section [![o365](./media/o365.png)](./media/o365.png)  \n\n### \\[Fixed\\] Issue: The Dynamics 365 for Operations Office Add-ins don't yet support ADFS\n\n**Affected Microsoft Dynamics 365 for Operations versions:** CTP8 and the February 2016 releases. **Issue:** When users from a Microsoft Azure Active Directory (Azure AD) tenant that uses Active Directory Federation Services (AD FS) try to sign in to the Microsoft Dynamics 365 for Operations Office Add-ins (that is, when the users enter their account, and then press tab or click to enter their password), a separate browser window opens. This browser window usually has a URL that starts with **https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\\#id\\_token=**. Nothing that the users do lets them sign in. **Explanation:** The issue that the Microsoft Office add-ins (both Microsoft Excel and Microsoft Word) have with ADFS is that a redirect to the ADFS site for the tenant occurs during sign-in. However, that site is an unknown (and therefore disallowed) application domain (AppDomain). **Long-term fix:** The long-term fix for this issue was put in place 5/10/2016. The long-term fix was for the Dynamics 365 for Operations Office Add-ins to use a new Dialog API that the Office team just added. **To take advantage of the Add-in updates that support ADFS, all Office installations should be updated** via File &gt; Account &gt; Updates (for click to run installations) or via Windows Update (for MSI installations) . The ADFS Dialog API was definitely in the May Update [16.0.6868.2060](http://answers.microsoft.com/en-us/office/forum/office_2016-office_install/may-update-16068682060-for-office-2016-on-windows/ea082237-7ec3-4b06-895b-83490980e6d2?auth=1). The [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page provides information about updates. If your Office build does not update then it might be because you are on the deferred track ([a \"Microsoft Office 365 ProPlus\" update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)), in which case you could [use the \"Office Deployment Tool\" to move to the Current channel ](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396)or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider)to ensure you have the latest updates. See also: [Install the latest version of Office 2016](https://dev.office.com/docs/add-ins/develop/install-latest-office-version) and [Office 2016 Deployment Guides for Admins](https://technet.microsoft.com/en-us/library/cc303401(v=office.16).aspx). If Office updates cannot be installed then there is a workaround that can unblock users.\n\n#### Workaround: Use Internet Explorer to sign in to the Dynamics 365 for Operations client before you use the Office add-ins\n\nThis workaround requires user knowledge and extra steps. After users have been educated about this workaround, it should be straightforward for them. **User steps:** Before users open Excel (or Word), they should first sign in to the Dynamics 365 for Operations client by using Internet Explorer. **Explanation:** The sign-in context will be used by the Excel (or Word) add-in, and no redirect will be required. The earlier sign-in must occur in Internet Explorer, because the Office add-ins run inside an Internet Explorer window in Excel and Word. The sign-in context lasts 6 to 24 hours, depending on policies. Therefore, a new sign-in through Internet Explorer is required only occasionally. Steps:\n\n1.  Close Internet Explorer and Excel\n2.  Open Internet Explorer and sign into the Dynamics 365 for Operations\n3.  Test the Excel add-in using an Open in Excel experience. (For example, click **Fleet Management** &gt; **Customers** &gt; **Customer** &gt; **Open in Microsoft Office** &gt; **Open in Excel** &gt; **Fleet Management Customers**.)\n\n\nSee also\n--------\n\n[Office Integration](office-integration.md)\n\n[Office Integration lab and walkthroughs](office-integration-tutorial.md)\n\n[Configuring PowerBI Integration](..\\analytics\\configure-power-bi-integration.md)\n\n\n\n","nodes":[{"pos":[4,853],"content":"# required metadata\n\ntitle: Office integration troubleshooting\ndescription: This article provides answers to questions, tips, and troubleshooting information for the Microsoft Dynamics 365 for Operations Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.\nauthor: ChrisGarty\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\nms.search.form: OfficeAppParameters\n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: annbe\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 72263\nms.assetid: 89588fed-b47f-4f01-9328-325518f016d6\nms.search.region: Global\n# ms.search.industry: \nms.author: cgarty\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n","nodes":[{"content":"Office integration troubleshooting","nodes":[{"pos":[0,34],"content":"Office integration troubleshooting","nodes":[{"content":"Office integration troubleshooting","pos":[0,34]}]}],"path":["title"]},{"content":"This article provides answers to questions, tips, and troubleshooting information for the Microsoft Dynamics 365 for Operations Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.","nodes":[{"pos":[0,257],"content":"This article provides answers to questions, tips, and troubleshooting information for the Microsoft Dynamics 365 for Operations Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.","nodes":[{"content":"This article provides answers to questions, tips, and troubleshooting information for the Microsoft Dynamics 365 for Operations Office integration capabilities. The questions and issues discussed range across user, administration, and development scenarios.","pos":[0,257],"nodes":[{"content":"This article provides answers to questions, tips, and troubleshooting information for the Microsoft Dynamics 365 for Operations Office integration capabilities.","pos":[0,160]},{"content":"The questions and issues discussed range across user, administration, and development scenarios.","pos":[161,257]}]}]}],"path":["description"]}],"header":"# required metadata\n","yml":true},{"pos":[861,895],"content":"Office integration troubleshooting","linkify":"Office integration troubleshooting","nodes":[{"content":"Office integration troubleshooting","pos":[0,34]}]},{"content":"This article provides answers to questions, tips, and troubleshooting information for the Microsoft Dynamics 365 for Operations Office integration capabilities.","pos":[941,1101]},{"content":"The questions and issues discussed range across user, administration, and development scenarios.","pos":[1102,1198]},{"pos":[1200,1226],"content":"Frequently asked questions","linkify":"Frequently asked questions","nodes":[{"content":"Frequently asked questions","pos":[0,26]}]},{"pos":[1259,1311],"content":"What platforms are supported for the Office Add-ins?","linkify":"What platforms are supported for the Office Add-ins?","nodes":[{"content":"What platforms are supported for the Office Add-ins?","pos":[0,52]}]},{"content":"The Excel Add-in and Word Add-in are built using the Office Web/JavaScript Add-in framework that was initially released for Office 2013, but received significant updates in Office 2016.","pos":[1313,1498]},{"content":"If needed, read details about <bpt id=\"p1\">[</bpt>Office Add-in host and platform availability<ept id=\"p1\">](http://dev.office.com/add-in-availability)</ept>.","pos":[1499,1619],"source":" If needed, read details about [Office Add-in host and platform availability](http://dev.office.com/add-in-availability)."},{"content":"The Excel Add-in requires the ExcelAPI 1.2, so use the <bpt id=\"p1\">[</bpt>Office Add-in host and platform availability<ept id=\"p1\">](http://dev.office.com/add-in-availability)</ept> matrix to view which platforms it is supported on.","pos":[1620,1815],"source":" The Excel Add-in requires the ExcelAPI 1.2, so use the [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) matrix to view which platforms it is supported on."},{"content":"For many users, the phrase \"Excel 2016 with the latest updates\" is sufficient.","pos":[1816,1894]},{"pos":[1900,1949],"content":"Is Office for Mac supported for the Excel Add-in?","linkify":"Is Office for Mac supported for the Excel Add-in?","nodes":[{"content":"Is Office for Mac supported for the Excel Add-in?","pos":[0,49]}]},{"content":"Yes.","pos":[1951,1955]},{"content":"The Excel Add-in requires the ExcelAPI 1.2, so use the <bpt id=\"p1\">[</bpt>Office Add-in host and platform availability<ept id=\"p1\">](http://dev.office.com/add-in-availability)</ept> matrix to view which platforms it is supported on.","pos":[1956,2151],"source":" The Excel Add-in requires the ExcelAPI 1.2, so use the [Office Add-in host and platform availability](http://dev.office.com/add-in-availability) matrix to view which platforms it is supported on."},{"pos":[2157,2232],"content":"What version of Office is needed to allow the Excel Add-in to support ADFS?","linkify":"What version of Office is needed to allow the Excel Add-in to support ADFS?","nodes":[{"content":"What version of Office is needed to allow the Excel Add-in to support ADFS?","pos":[0,75]}]},{"content":"Read more about that in the troubleshooting section below.","pos":[2234,2292]},{"pos":[2298,2337],"content":"How can Office be forced into updating?","linkify":"How can Office be forced into updating?","nodes":[{"content":"How can Office be forced into updating?","pos":[0,39]}]},{"content":"If your Office build does not update then it might be because you are on the deferred track (<bpt id=\"p1\">[</bpt>a \"Microsoft Office 365 ProPlus\" update channel option<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/mt455210.aspx)</ept>), in which case you could <bpt id=\"p2\">[</bpt>use the \"Office Deployment Tool\" to move to the Current channel <ept id=\"p2\">](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&amp;MSPPError=-2147217396)</ept>or sign up for the <bpt id=\"p3\">[</bpt>Office Insider program<ept id=\"p3\">](https://products.office.com/en-us/office-insider)</ept>to ensure you have the latest updates.","pos":[2339,2858],"source":"If your Office build does not update then it might be because you are on the deferred track ([a \"Microsoft Office 365 ProPlus\" update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)), in which case you could [use the \"Office Deployment Tool\" to move to the Current channel ](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396)or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider)to ensure you have the latest updates."},{"content":"The easiest path is using the Office Deployment Tool to switch to the Current channel which will cause the latest updates to install immediately.","pos":[2859,3004]},{"pos":[3010,3092],"content":"Why can't you tell me what version of Office/Excel a particular issue is fixed in?","linkify":"Why can't you tell me what version of Office/Excel a particular issue is fixed in?","nodes":[{"content":"Why can't you tell me what version of Office/Excel a particular issue is fixed in?","pos":[0,82]}]},{"content":"Office has a large number of different releases which receive updates at different times and have different version numbers that don't correspond.","pos":[3094,3240]},{"content":"Some of the more common Office versions and update methods are Click to Run (C2R) Current channel, C2R Deferred, C2R First Update Deferred, Office Insider Fast, Office Insider Slow, and MSI/MSO (install from DVD).","pos":[3241,3454]},{"content":"The <bpt id=\"p1\">[</bpt>Office 365 client update channel releases<ept id=\"p1\">](https://technet.microsoft.com/en-us/office/mt465751?f=255&amp;MSPPError=-2147217396)</ept> page has more information about Office versions.","pos":[3455,3632],"source":" The [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page has more information about Office versions."},{"pos":[3638,3692],"content":"Why am I having trouble signing into the Excel Add-in?","linkify":"Why am I having trouble signing into the Excel Add-in?","nodes":[{"content":"Why am I having trouble signing into the Excel Add-in?","pos":[0,54]}]},{"content":"The Excel Add-in runs inside an Internet Explorer (IE) window.","pos":[3694,3756]},{"content":"The Excel Add-in will pick up stored credentials from IE by default, and IE will provide the current Windows credentials if there are no stored credentials.","pos":[3757,3913]},{"content":"The most common problem people have when signing-in is IE using the wrong credentials.","pos":[3914,4000]},{"content":"Ensure you are trying to sign in with the correct credentials.","pos":[4001,4063]},{"content":"In the Excel Add-in, explicitly sign out and then sign in to ensure that the desired credentials are in use.","pos":[4064,4172]},{"pos":[4177,4199],"content":"Troubleshooting Issues","linkify":"Troubleshooting Issues","nodes":[{"content":"Troubleshooting Issues","pos":[0,22]}]},{"pos":[4204,4360],"content":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"","linkify":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"","pos":[0,156],"source":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\""}]},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\".","pos":[4362,4513],"source":"**Issue:** During Excel Add-in sign-in, an error appears \"AADSTS65001: The user or administrator has not consented to use the application with ID XYZ\"."},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> This is usually caused when AAD cannot find the AAD application representing the Excel Add-in because during <bpt id=\"p2\">[</bpt>PowerBI configuration<ept id=\"p2\">](..\\analytics\\configure-power-bi-integration.md)</ept> an AAD application was added that has the App ID URI set to the environment URL.","pos":[4514,4792],"source":"**Explanation:** This is usually caused when AAD cannot find the AAD application representing the Excel Add-in because during [PowerBI configuration](..\\analytics\\configure-power-bi-integration.md) an AAD application was added that has the App ID URI set to the environment URL."},{"content":"<bpt id=\"p1\">**</bpt>Fix:<ept id=\"p1\">**</ept> Ensure that there are no AAD App ID URI's set to the environment URI.","pos":[4793,4871],"source":"**Fix:** Ensure that there are no AAD App ID URI's set to the environment URI."},{"content":"App ID URI's should be a made up unique URI like https://contosoAXPowerBI.","pos":[4872,4946]},{"pos":[4952,5093],"content":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"","linkify":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"","pos":[0,141],"source":"\\[Fixed\\] Issue: During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\""}]},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\".","pos":[5095,5231],"source":"**Issue:** During Excel Add-in sign-in, an error appears \"AADSTS50001: The application named ABC was not found in the tenant named XYZ\"."},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> This is likely a failure in the deployment system that caused the environment to get a URL that was not added in the configured list of Service Principals for the tenant.","pos":[5232,5419],"source":"**Explanation:** This is likely a failure in the deployment system that caused the environment to get a URL that was not added in the configured list of Service Principals for the tenant."},{"content":"<bpt id=\"p1\">**</bpt>Fix:<ept id=\"p1\">**</ept> File a support issue for your environment so the problem can be investigated further and the configuration can be adjusted.","pos":[5420,5552],"source":"**Fix:** File a support issue for your environment so the problem can be investigated further and the configuration can be adjusted."},{"pos":[5558,5696],"content":"\\[Fixed\\] Issue: After the Excel Add-in opens and is refreshing data, an error appears \"An error occurred while writing to the data cache\"","linkify":"\\[Fixed\\] Issue: After the Excel Add-in opens and is refreshing data, an error appears \"An error occurred while writing to the data cache\"","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: After the Excel Add-in opens and is refreshing data, an error appears \"An error occurred while writing to the data cache\"","pos":[0,138],"source":"\\[Fixed\\] Issue: After the Excel Add-in opens and is refreshing data, an error appears \"An error occurred while writing to the data cache\""}]},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> After the Excel Add-in opens and is refreshing data, an error appears \"An error occurred while writing to the data cache\" with details of \"The argument is invalid or missing or has an incorrect format\".","pos":[5698,5911],"source":"**Issue:** After the Excel Add-in opens and is refreshing data, an error appears \"An error occurred while writing to the data cache\" with details of \"The argument is invalid or missing or has an incorrect format\"."},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> This error will appear if the Dynamics 365 for Operations Client is open in Internet Explorer (IE) and after doing an \"Open in Excel\" option the user clicks \"Open\" immediately.","pos":[5912,6105],"source":"**Explanation:** This error will appear if the Dynamics 365 for Operations Client is open in Internet Explorer (IE) and after doing an \"Open in Excel\" option the user clicks \"Open\" immediately."},{"content":"The way IE handles Temporary Internet Files then causes an issue inside Excel which causes some API calls to fail.","pos":[6106,6220]},{"content":"<bpt id=\"p1\">**</bpt>Workaround:<ept id=\"p1\">**</ept> For IE, when opening a workbook... click Save first, then click Open.","pos":[6221,6306],"source":"**Workaround:** For IE, when opening a workbook... click Save first, then click Open."},{"content":"The file will then open from your Downloads folder.","pos":[6307,6358]},{"content":"Alternately, Edge and Chrome will both not showcase this problem since they save files to a Downloads folder automatically.","pos":[6359,6482]},{"content":"<bpt id=\"p1\">**</bpt>Long term fix:<ept id=\"p1\">**</ept> We are helping the Office team understand and reproduce this issue so it can be fixed in Excel.","pos":[6483,6597],"source":"**Long term fix:** We are helping the Office team understand and reproduce this issue so it can be fixed in Excel."},{"pos":[6603,6703],"content":"Issue: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender","linkify":"Issue: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender","nodes":[{"content":"Issue: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender","pos":[0,100]}]},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> When sending email using SMTP you may see the error: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender or Something went wrong while generating the report <bpt id=\"p2\">**</bpt>Explanation:<ept id=\"p2\">**</ept> This is usually caused by incorrect setup of the Send as permissions setup for the email account <bpt id=\"p3\">**</bpt>Fix:<ept id=\"p3\">**</ept> Send As permissions can be configured on the Office 365 admin center (portal.office.com/Admin) <ph id=\"ph1\">&amp;gt;</ph> Users <ph id=\"ph2\">&amp;gt;</ph> Active users <ph id=\"ph3\">&amp;gt;</ph> User <ph id=\"ph4\">&amp;gt;</ph> Edit mailbox permissions <ph id=\"ph5\">&amp;gt;</ph> Send email from this mailbox (<bpt id=\"p4\">[</bpt>Office 365 Help on Send email from another user’s mailbox<ept id=\"p4\">](https://support.office.com/en-us/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E)</ept>).SMTP setup Example: Below you see the Email parameters form where you need to provide the Outgoing mail server, port, User name, Password, and SSL requirements.","pos":[6705,7600],"source":"**Issue:** When sending email using SMTP you may see the error: The server response was: 5.7.60 SMTP; Client does not have permissions to send as this sender or Something went wrong while generating the report **Explanation:** This is usually caused by incorrect setup of the Send as permissions setup for the email account **Fix:** Send As permissions can be configured on the Office 365 admin center (portal.office.com/Admin) &gt; Users &gt; Active users &gt; User &gt; Edit mailbox permissions &gt; Send email from this mailbox ([Office 365 Help on Send email from another user’s mailbox](https://support.office.com/en-us/article/Enable-sending-email-from-another-user-s-mailbox-in-Office-365-2B828C5F-41AB-4904-97B9-3B63D8129C4E)).SMTP setup Example: Below you see the Email parameters form where you need to provide the Outgoing mail server, port, User name, Password, and SSL requirements."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>smtp<ept id=\"p1\">](./media/smtp.jpg)](./media/smtp.jpg)</ept>   Permissions SMTP User account is <ph id=\"ph2\">serviceacct@d365forops.onmicrosoft.com</ph> Important: All Users like the example Test User below will need to allow the SMTP account to have SEND AS permissions on their email setup in O365.","pos":[7601,7868],"source":"[![smtp](./media/smtp.jpg)](./media/smtp.jpg)   Permissions SMTP User account is serviceacct@d365forops.onmicrosoft.com Important: All Users like the example Test User below will need to allow the SMTP account to have SEND AS permissions on their email setup in O365."},{"content":"This is done in the Mailbox permissions in Exchange or in the Office 365 Admin portal.","pos":[7869,7955]},{"content":"The screen shot below shows the setup for the test user account with the STMP service account added in the Send As section <bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>o365<ept id=\"p1\">](./media/o365.png)](./media/o365.png)</ept>","pos":[7956,8124],"source":" The screen shot below shows the setup for the test user account with the STMP service account added in the Send As section [![o365](./media/o365.png)](./media/o365.png)"},{"pos":[8132,8218],"content":"\\[Fixed\\] Issue: The Dynamics 365 for Operations Office Add-ins don't yet support ADFS","linkify":"\\[Fixed\\] Issue: The Dynamics 365 for Operations Office Add-ins don't yet support ADFS","nodes":[{"content":"<ph id=\"ph1\">\\[</ph>Fixed<ph id=\"ph2\">\\]</ph> Issue: The Dynamics 365 for Operations Office Add-ins don't yet support ADFS","pos":[0,86],"source":"\\[Fixed\\] Issue: The Dynamics 365 for Operations Office Add-ins don't yet support ADFS"}]},{"content":"<bpt id=\"p1\">**</bpt>Affected Microsoft Dynamics 365 for Operations versions:<ept id=\"p1\">**</ept> CTP8 and the February 2016 releases.","pos":[8220,8317],"source":"**Affected Microsoft Dynamics 365 for Operations versions:** CTP8 and the February 2016 releases."},{"content":"<bpt id=\"p1\">**</bpt>Issue:<ept id=\"p1\">**</ept> When users from a Microsoft Azure Active Directory (Azure AD) tenant that uses Active Directory Federation Services (AD FS) try to sign in to the Microsoft Dynamics 365 for Operations Office Add-ins (that is, when the users enter their account, and then press tab or click to enter their password), a separate browser window opens.","pos":[8318,8660],"source":"**Issue:** When users from a Microsoft Azure Active Directory (Azure AD) tenant that uses Active Directory Federation Services (AD FS) try to sign in to the Microsoft Dynamics 365 for Operations Office Add-ins (that is, when the users enter their account, and then press tab or click to enter their password), a separate browser window opens."},{"content":"This browser window usually has a URL that starts with <bpt id=\"p1\">**</bpt>https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html<ph id=\"ph1\">\\#</ph>id<ph id=\"ph2\">\\_</ph>token=<ept id=\"p1\">**</ept>.","pos":[8661,8811],"source":" This browser window usually has a URL that starts with **https://az689774.vo.msecnd.net/dynamicsofficeapp/v1.2.1.0/App/DynamicsApp.html\\#id\\_token=**."},{"content":"Nothing that the users do lets them sign in.","pos":[8812,8856]},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> The issue that the Microsoft Office add-ins (both Microsoft Excel and Microsoft Word) have with ADFS is that a redirect to the ADFS site for the tenant occurs during sign-in.","pos":[8857,9048],"source":"**Explanation:** The issue that the Microsoft Office add-ins (both Microsoft Excel and Microsoft Word) have with ADFS is that a redirect to the ADFS site for the tenant occurs during sign-in."},{"content":"However, that site is an unknown (and therefore disallowed) application domain (AppDomain).","pos":[9049,9140]},{"content":"<bpt id=\"p1\">**</bpt>Long-term fix:<ept id=\"p1\">**</ept> The long-term fix for this issue was put in place 5/10/2016.","pos":[9141,9220],"source":"**Long-term fix:** The long-term fix for this issue was put in place 5/10/2016."},{"content":"The long-term fix was for the Dynamics 365 for Operations Office Add-ins to use a new Dialog API that the Office team just added.","pos":[9221,9350]},{"content":"<bpt id=\"p1\">**</bpt>To take advantage of the Add-in updates that support ADFS, all Office installations should be updated<ept id=\"p1\">**</ept> via File <ph id=\"ph1\">&amp;gt;</ph> Account <ph id=\"ph2\">&amp;gt;</ph> Updates (for click to run installations) or via Windows Update (for MSI installations) .","pos":[9351,9572],"source":"**To take advantage of the Add-in updates that support ADFS, all Office installations should be updated** via File &gt; Account &gt; Updates (for click to run installations) or via Windows Update (for MSI installations) ."},{"content":"The ADFS Dialog API was definitely in the May Update <bpt id=\"p1\">[</bpt>16.0.6868.2060<ept id=\"p1\">](http://answers.microsoft.com/en-us/office/forum/office_2016-office_install/may-update-16068682060-for-office-2016-on-windows/ea082237-7ec3-4b06-895b-83490980e6d2?auth=1)</ept>.","pos":[9573,9813],"source":" The ADFS Dialog API was definitely in the May Update [16.0.6868.2060](http://answers.microsoft.com/en-us/office/forum/office_2016-office_install/may-update-16068682060-for-office-2016-on-windows/ea082237-7ec3-4b06-895b-83490980e6d2?auth=1)."},{"content":"The <bpt id=\"p1\">[</bpt>Office 365 client update channel releases<ept id=\"p1\">](https://technet.microsoft.com/en-us/office/mt465751?f=255&amp;MSPPError=-2147217396)</ept> page provides information about updates.","pos":[9814,9983],"source":" The [Office 365 client update channel releases](https://technet.microsoft.com/en-us/office/mt465751?f=255&MSPPError=-2147217396) page provides information about updates."},{"content":"If your Office build does not update then it might be because you are on the deferred track (<bpt id=\"p1\">[</bpt>a \"Microsoft Office 365 ProPlus\" update channel option<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/mt455210.aspx)</ept>), in which case you could <bpt id=\"p2\">[</bpt>use the \"Office Deployment Tool\" to move to the Current channel <ept id=\"p2\">](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&amp;MSPPError=-2147217396)</ept>or sign up for the <bpt id=\"p3\">[</bpt>Office Insider program<ept id=\"p3\">](https://products.office.com/en-us/office-insider)</ept>to ensure you have the latest updates.","pos":[9984,10503],"source":" If your Office build does not update then it might be because you are on the deferred track ([a \"Microsoft Office 365 ProPlus\" update channel option](https://technet.microsoft.com/en-us/library/mt455210.aspx)), in which case you could [use the \"Office Deployment Tool\" to move to the Current channel ](https://technet.microsoft.com/en-us/library/jj219422.aspx?f=255&MSPPError=-2147217396)or sign up for the [Office Insider program](https://products.office.com/en-us/office-insider)to ensure you have the latest updates."},{"content":"See also: <bpt id=\"p1\">[</bpt>Install the latest version of Office 2016<ept id=\"p1\">](https://dev.office.com/docs/add-ins/develop/install-latest-office-version)</ept> and <bpt id=\"p2\">[</bpt>Office 2016 Deployment Guides for Admins<ept id=\"p2\">](https://technet.microsoft.com/en-us/library/cc303401(v=office.16).aspx)</ept>.","pos":[10504,10752],"source":" See also: [Install the latest version of Office 2016](https://dev.office.com/docs/add-ins/develop/install-latest-office-version) and [Office 2016 Deployment Guides for Admins](https://technet.microsoft.com/en-us/library/cc303401(v=office.16).aspx)."},{"content":"If Office updates cannot be installed then there is a workaround that can unblock users.","pos":[10753,10841]},{"pos":[10848,10968],"content":"Workaround: Use Internet Explorer to sign in to the Dynamics 365 for Operations client before you use the Office add-ins","linkify":"Workaround: Use Internet Explorer to sign in to the Dynamics 365 for Operations client before you use the Office add-ins","nodes":[{"content":"Workaround: Use Internet Explorer to sign in to the Dynamics 365 for Operations client before you use the Office add-ins","pos":[0,120]}]},{"content":"This workaround requires user knowledge and extra steps.","pos":[10970,11026]},{"content":"After users have been educated about this workaround, it should be straightforward for them.","pos":[11027,11119]},{"content":"<bpt id=\"p1\">**</bpt>User steps:<ept id=\"p1\">**</ept> Before users open Excel (or Word), they should first sign in to the Dynamics 365 for Operations client by using Internet Explorer.","pos":[11120,11266],"source":"**User steps:** Before users open Excel (or Word), they should first sign in to the Dynamics 365 for Operations client by using Internet Explorer."},{"content":"<bpt id=\"p1\">**</bpt>Explanation:<ept id=\"p1\">**</ept> The sign-in context will be used by the Excel (or Word) add-in, and no redirect will be required.","pos":[11267,11381],"source":"**Explanation:** The sign-in context will be used by the Excel (or Word) add-in, and no redirect will be required."},{"content":"The earlier sign-in must occur in Internet Explorer, because the Office add-ins run inside an Internet Explorer window in Excel and Word.","pos":[11382,11519]},{"content":"The sign-in context lasts 6 to 24 hours, depending on policies.","pos":[11520,11583]},{"content":"Therefore, a new sign-in through Internet Explorer is required only occasionally.","pos":[11584,11665]},{"content":"Steps:","pos":[11666,11672]},{"content":"Close Internet Explorer and Excel","pos":[11678,11711]},{"content":"Open Internet Explorer and sign into the Dynamics 365 for Operations","pos":[11716,11784]},{"content":"Test the Excel add-in using an Open in Excel experience.","pos":[11789,11845]},{"content":"(For example, click <bpt id=\"p1\">**</bpt>Fleet Management<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Customers<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Customer<ept id=\"p3\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Open in Microsoft Office<ept id=\"p4\">**</ept> <ph id=\"ph4\">&amp;gt;</ph> <bpt id=\"p5\">**</bpt>Open in Excel<ept id=\"p5\">**</ept> <ph id=\"ph5\">&amp;gt;</ph> <bpt id=\"p6\">**</bpt>Fleet Management Customers<ept id=\"p6\">**</ept>.)","pos":[11846,12018],"source":" (For example, click **Fleet Management** &gt; **Customers** &gt; **Customer** &gt; **Open in Microsoft Office** &gt; **Open in Excel** &gt; **Fleet Management Customers**.)"},{"pos":[12021,12029],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[12040,12083],"content":"<bpt id=\"p1\">[</bpt>Office Integration<ept id=\"p1\">](office-integration.md)</ept>","source":"[Office Integration](office-integration.md)"},{"pos":[12085,12158],"content":"<bpt id=\"p1\">[</bpt>Office Integration lab and walkthroughs<ept id=\"p1\">](office-integration-tutorial.md)</ept>","source":"[Office Integration lab and walkthroughs](office-integration-tutorial.md)"},{"pos":[12160,12241],"content":"<bpt id=\"p1\">[</bpt>Configuring PowerBI Integration<ept id=\"p1\">](..\\analytics\\configure-power-bi-integration.md)</ept>","source":"[Configuring PowerBI Integration](..\\analytics\\configure-power-bi-integration.md)"}]}