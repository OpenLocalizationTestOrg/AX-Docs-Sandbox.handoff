{"nodes":[{"pos":[32,93],"content":"Install and run System diagnostics (AX 2012) | Microsoft Docs","needQuote":true,"needEscape":true,"nodes":[{"content":"Install and run System diagnostics (AX 2012) | Microsoft Docs","pos":[0,61]}]},{"pos":[107,320],"content":"In Microsoft Dynamics Lifecycle Services, System diagnostics includes an on-premises component that must be installed before you can use the service to discover Microsoft Dynamics AX environments and collect data.","needQuote":true,"needEscape":true,"nodes":[{"content":"In Microsoft Dynamics Lifecycle Services, System diagnostics includes an on-premises component that must be installed before you can use the service to discover Microsoft Dynamics AX environments and collect data.","pos":[0,213]}]},{"pos":[727,771],"content":"Install and run System diagnostics (AX 2012)","linkify":"Install and run System diagnostics (AX 2012)","nodes":[{"content":"Install and run System diagnostics (AX 2012)","pos":[0,44]}]},{"content":"In Microsoft Dynamics Lifecycle Services, System diagnostics includes an on-premises component that must be installed before you can use the service to discover Microsoft Dynamics AX environments and collect data.","pos":[773,986]},{"pos":[988,1040],"content":"Install the System diagnostics on-premises component","linkify":"Install the System diagnostics on-premises component","nodes":[{"content":"Install the System diagnostics on-premises component","pos":[0,52]}]},{"content":"To install the System diagnostics on-premises component, the following is required:","pos":[1095,1178]},{"content":"A service account with specific permissions on the local computer and the Microsoft Dynamics AX business database.","pos":[1184,1298]},{"content":"An X509 certificate .","pos":[1303,1324]},{"content":"You can either use an existing certificate, or have the installer create one for you.","pos":[1325,1410]},{"content":"Each X509 certificate is associated with a single project.","pos":[1411,1469]},{"content":"Diagnostics from an environment can be uploaded to only one project.","pos":[1470,1538]},{"content":"Microsoft .NET 4.5 or 4.5.1","pos":[1543,1570]},{"pos":[1576,1628],"content":"Configure the service account for System diagnostics","linkify":"Configure the service account for System diagnostics","nodes":[{"content":"Configure the service account for System diagnostics","pos":[0,52]}]},{"content":"This section describes the permissions that are required for the service account that the Lifecycle Services Diagnostic Service (LCSDiagFXService.exe) runs as.","pos":[1630,1789]},{"content":"The service account must be a domain account that is a user in Microsoft Dynamics AX and a member of the <bpt id=\"p1\">**</bpt>BusinessConnector<ept id=\"p1\">**</ept> role.We strongly recommend that, if possible, the account be the same account used for the .NET Business Connector proxy.","pos":[1795,2043],"source":"The service account must be a domain account that is a user in Microsoft Dynamics AX and a member of the **BusinessConnector** role.We strongly recommend that, if possible, the account be the same account used for the .NET Business Connector proxy."},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Specify the .NET Business Connector proxy account<ept id=\"p1\">](http://technet.microsoft.com/library/3e46dc0a-2ff4-4a06-ae61-041e52dcc774(AX.60).aspx)</ept> and <bpt id=\"p2\">[</bpt>Assign users to security roles<ept id=\"p2\">](http://technet.microsoft.com/library/214ee45b-5b99-4ea8-9454-f4297f68e38c(AX.60).aspx)</ept>.","pos":[2044,2333],"source":" For more information, see [Specify the .NET Business Connector proxy account](http://technet.microsoft.com/library/3e46dc0a-2ff4-4a06-ae61-041e52dcc774(AX.60).aspx) and [Assign users to security roles](http://technet.microsoft.com/library/214ee45b-5b99-4ea8-9454-f4297f68e38c(AX.60).aspx)."},{"pos":[2340,2348],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>","source":"**Note**"},{"pos":[2606,2730],"content":"If you reuse the .NET Business connector proxy account, you must still add it as a member of the <bpt id=\"p1\">**</bpt>BusinessConnector<ept id=\"p1\">**</ept> role.","source":"If you reuse the .NET Business connector proxy account, you must still add it as a member of the **BusinessConnector** role."},{"content":"The service account must have read access to specific registry keys in the HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE hive on all of the computers that run AOS instances and host Microsoft Dynamics AX business databases, so that the Lifecycle Services Diagnostic Service can discover environments and collect data.","pos":[2738,3030],"source":"The service account must have read access to specific registry keys in the HKEY\\_LOCAL\\_MACHINE hive on all of the computers that run AOS instances and host Microsoft Dynamics AX business databases, so that the Lifecycle Services Diagnostic Service can discover environments and collect data."},{"pos":[3035,3230],"content":"The service account must be a member of the <bpt id=\"p1\">**</bpt>Event Log Readers<ept id=\"p1\">**</ept> local group on each server in the environment, so that the Lifecycle Services Diagnostic Service can read the Windows event logs.","source":"The service account must be a member of the **Event Log Readers** local group on each server in the environment, so that the Lifecycle Services Diagnostic Service can read the Windows event logs."},{"pos":[3235,3519],"content":"The service account must have read access to the Microsoft Dynamics AX business database (<bpt id=\"p1\">**</bpt>db<ph id=\"ph1\">\\_</ph>datareader<ept id=\"p1\">**</ept>), and must have VIEW SERVER STATE permission for the SQL Server instance, so that Lifecycle Services Diagnostic Service can run default dynamic management views in SQL Server.","source":"The service account must have read access to the Microsoft Dynamics AX business database (**db\\_datareader**), and must have VIEW SERVER STATE permission for the SQL Server instance, so that Lifecycle Services Diagnostic Service can run default dynamic management views in SQL Server."},{"pos":[3526,3568],"content":"Configure read permissions to the registry","linkify":"Configure read permissions to the registry","nodes":[{"content":"Configure read permissions to the registry","pos":[0,42]}]},{"content":"On each server in your environment that hosts an AOS instance or Microsoft Dynamics AX SQL Server business database, you must grant read access to a registry key in the HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE hive to the service account for the System diagnostics.","pos":[3570,3815],"source":"On each server in your environment that hosts an AOS instance or Microsoft Dynamics AX SQL Server business database, you must grant read access to a registry key in the HKEY\\_LOCAL\\_MACHINE hive to the service account for the System diagnostics."},{"pos":[3818,3829],"content":"<bpt id=\"p1\">**</bpt>Caution<ept id=\"p1\">**</ept>","source":"**Caution**"},{"content":"The following procedure includes editing the Windows Registry.","pos":[4580,4642]},{"content":"Editing the registry incorrectly can cause serious problems that may require you to reinstall Windows.","pos":[4643,4745]},{"content":"Microsoft cannot guarantee that problems resulting from incorrectly editing the registry can be solved.You should make a backup copy of the registry files (System.dat and User.dat) before you edit the registry.","pos":[4746,4956]},{"content":"To grant access to collect data from the Windows registry on the server that hosts the SQL Server business database:","pos":[4960,5076]},{"pos":[5081,5156],"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept>, type <bpt id=\"p3\">**</bpt>regedit<ept id=\"p3\">**</ept>, and then press <bpt id=\"p4\">**</bpt>Enter<ept id=\"p4\">**</ept>.","source":"Click **Start**, click **Run**, type **regedit**, and then press **Enter**."},{"pos":[5161,5310],"content":"Expand <bpt id=\"p1\">**</bpt>HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE<ept id=\"p1\">**</ept>, navigate to the subkey <bpt id=\"p2\">**</bpt>SystemCurrentControlSetControlPriorityControl<ept id=\"p2\">**</ept>, right-click it and select <bpt id=\"p3\">**</bpt>Permissions<ept id=\"p3\">**</ept>.","source":"Expand **HKEY\\_LOCAL\\_MACHINE**, navigate to the subkey **SystemCurrentControlSetControlPriorityControl**, right-click it and select **Permissions**."},{"content":"Add the user that you want to associate with the Lifecycle Services Diagnostic Service.","pos":[5315,5402]},{"content":"Select the user that you added, and then allow read permissions.","pos":[5407,5471]},{"pos":[5476,5586],"content":"Click <bpt id=\"p1\">**</bpt>Advanced Security Settings<ept id=\"p1\">**</ept>, and then ensure that the permissions are inherited by the child objects.","source":"Click **Advanced Security Settings**, and then ensure that the permissions are inherited by the child objects."},{"content":"To grant access to collect data from the Windows registry on a server that hosts one or more AOS instances:","pos":[5588,5695]},{"pos":[5700,5770],"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept>, type <bpt id=\"p3\">**</bpt>regedit<ept id=\"p3\">**</ept>, and press <bpt id=\"p4\">**</bpt>Enter<ept id=\"p4\">**</ept>.","source":"Click **Start**, click **Run**, type **regedit**, and press **Enter**."},{"pos":[5775,5928],"content":"Expand <bpt id=\"p1\">**</bpt>HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE<ept id=\"p1\">**</ept>, navigate to the subkey <bpt id=\"p2\">**</bpt>SystemCurrentControlSetServicesDynamics Server6.0<ept id=\"p2\">**</ept>, right-click it and select <bpt id=\"p3\">**</bpt>Permissions<ept id=\"p3\">**</ept>.","source":"Expand **HKEY\\_LOCAL\\_MACHINE**, navigate to the subkey **SystemCurrentControlSetServicesDynamics Server6.0**, right-click it and select **Permissions**."},{"content":"Add the user that you want to associate with the Lifecycle Services Diagnostic Service.","pos":[5933,6020]},{"content":"Select the user that you added, and then allow read permissions.","pos":[6025,6089]},{"pos":[6094,6204],"content":"Click <bpt id=\"p1\">**</bpt>Advanced Security Settings<ept id=\"p1\">**</ept>, and then ensure that the permissions are inherited by the child objects.","source":"Click **Advanced Security Settings**, and then ensure that the permissions are inherited by the child objects."},{"content":"Repeat for all AOS instances in each environment that you want to collect data from.","pos":[6209,6293]},{"content":"<bpt id=\"p1\">&lt;strong&gt;</bpt>Important<ept id=\"p1\">&lt;/strong&gt;</ept>","pos":[6379,6405],"source":"<strong>Important</strong>"},{"content":"As you are configuring rights in the registry, do not reduce account privileges that already exist.For more information about Advanced security settings, see:","pos":[6455,6613],"source":"As you are configuring rights in the registry, do not reduce account privileges that already exist.For more information about Advanced security settings, see:\n"},{"content":"<bpt id=\"p1\">&lt;a href=\"http://technet.microsoft.com/en-us/library/jj134043.aspx\"&gt;</bpt>Windows Server 2012 Access Control and Authorization Overview<ept id=\"p1\">&lt;/a&gt;</ept>","pos":[6623,6755],"source":"<a href=\"http://technet.microsoft.com/en-us/library/jj134043.aspx\">Windows Server 2012 Access Control and Authorization Overview</a>"},{"content":"<bpt id=\"p1\">&lt;a href=\"http://technet.microsoft.com/en-us/library/cc730772.aspx\"&gt;</bpt>Windows Server 2008 R2 Advanced Security Settings Properties Page - Permissions Tab<ept id=\"p1\">&lt;/a&gt;</ept>","pos":[6765,6919],"source":"<a href=\"http://technet.microsoft.com/en-us/library/cc730772.aspx\">Windows Server 2008 R2 Advanced Security Settings Properties Page - Permissions Tab</a>"},{"pos":[6966,6998],"content":"Edit the Group Policy on the AOS","linkify":"Edit the Group Policy on the AOS","nodes":[{"content":"Edit the Group Policy on the AOS","pos":[0,32]}]},{"content":"You must make the services of the AOS remotely accessible in Group Policy.","pos":[7000,7074]},{"pos":[7080,7198],"content":"On the computer running the AOS instance, click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept>, type <bpt id=\"p3\">**</bpt>gpedit.msc<ept id=\"p3\">**</ept>, and then press <bpt id=\"p4\">**</bpt>Enter<ept id=\"p4\">**</ept>.","source":"On the computer running the AOS instance, click **Start** &gt; **Run**, type **gpedit.msc**, and then press **Enter**."},{"pos":[7203,7358],"content":"In the left pane, expand <bpt id=\"p1\">**</bpt>Computer Configuration<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Windows settings<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Security settings<ept id=\"p3\">**</ept> <ph id=\"ph3\">&amp;gt;</ph> <bpt id=\"p4\">**</bpt>Local policies<ept id=\"p4\">**</ept> <ph id=\"ph4\">&amp;gt;</ph> <bpt id=\"p5\">**</bpt>Security options<ept id=\"p5\">**</ept>.","source":"In the left pane, expand **Computer Configuration** &gt; **Windows settings** &gt; **Security settings** &gt; **Local policies** &gt; **Security options**."},{"pos":[7363,7464],"content":"In the right pane, double-click <bpt id=\"p1\">**</bpt>Network access: Remotely accessible registry paths and sub-paths<ept id=\"p1\">**</ept>.","source":"In the right pane, double-click **Network access: Remotely accessible registry paths and sub-paths**."},{"pos":[7469,7567],"content":"If the following paths are not in the list, add them to the end of the list and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","source":"If the following paths are not in the list, add them to the end of the list and then click **OK**."},{"content":"SystemCurrentControlSetControlPriorityControl","pos":[7576,7621]},{"content":"SystemCurrentControlSetservicesDynamics Server6.0","pos":[7630,7679]},{"pos":[7686,7733],"content":"Configure Windows event log and WMI permissions","linkify":"Configure Windows event log and WMI permissions","nodes":[{"content":"Configure Windows event log and WMI permissions","pos":[0,47]}]},{"content":"The service account must be able to read the Windows event logs on each server in the environment, and must be able to monitor remote Windows Management Instrumentation connections.","pos":[7735,7916]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Add a member to a local group<ept id=\"p1\">](http://technet.microsoft.com/en-us/library/cc772524(v=WS.10).aspx)</ept>.","pos":[7917,8042],"source":" For more information, see [Add a member to a local group](http://technet.microsoft.com/en-us/library/cc772524(v=WS.10).aspx)."},{"pos":[8048,8241],"content":"On each server in the environment, add the service account to the <bpt id=\"p1\">**</bpt>Event Log Readers<ept id=\"p1\">**</ept> local group, the <bpt id=\"p2\">**</bpt>Distributed COM Users<ept id=\"p2\">**</ept> local group and the <bpt id=\"p3\">**</bpt>Performance Monitor Users<ept id=\"p3\">**</ept> local group.","source":"On each server in the environment, add the service account to the **Event Log Readers** local group, the **Distributed COM Users** local group and the **Performance Monitor Users** local group."},{"pos":[8248,8312],"content":"Secure the remote Windows Management Instrumentation connections","linkify":"Secure the remote Windows Management Instrumentation connections","nodes":[{"content":"Secure the remote Windows Management Instrumentation connections","pos":[0,64]}]},{"content":"On each server in your environment that hosts an AOS instance or Microsoft Dynamics AX SQL Server business database, ensure that you secure the remote Windows Management Instrumentation (WMI) connection.","pos":[8314,8517]},{"pos":[8523,8594],"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept>, type <bpt id=\"p3\">**</bpt>DCOMCNFG<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","source":"Click **Start** &gt; **Run**, type **DCOMCNFG**, and then click **OK**."},{"pos":[8599,8756],"content":"In the <bpt id=\"p1\">**</bpt>Component Services<ept id=\"p1\">**</ept> dialog box, expand <bpt id=\"p2\">**</bpt>Component Services<ept id=\"p2\">**</ept>, expand <bpt id=\"p3\">**</bpt>Computers<ept id=\"p3\">**</ept>, and then right-click <bpt id=\"p4\">**</bpt>My Computer<ept id=\"p4\">**</ept> and click <bpt id=\"p5\">**</bpt>Properties<ept id=\"p5\">**</ept>.","source":"In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**."},{"pos":[8761,8838],"content":"In the <bpt id=\"p1\">**</bpt>My Computer Properties<ept id=\"p1\">**</ept> dialog box, click the <bpt id=\"p2\">**</bpt>COM Security<ept id=\"p2\">**</ept> tab.","source":"In the **My Computer Properties** dialog box, click the **COM Security** tab."},{"pos":[8843,8910],"content":"Under <bpt id=\"p1\">**</bpt>Launch and Activation Permissions<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Edit Limits<ept id=\"p2\">**</ept>.","source":"Under **Launch and Activation Permissions**, click **Edit Limits**."},{"pos":[8915,9055],"content":"In the <bpt id=\"p1\">**</bpt>Launch Permission<ept id=\"p1\">**</ept> dialog box, follow these steps if your name or your group does not appear in the <bpt id=\"p2\">**</bpt>Groups or user names<ept id=\"p2\">**</ept> list:","source":"In the **Launch Permission** dialog box, follow these steps if your name or your group does not appear in the **Groups or user names** list:"},{"pos":[9064,9119],"content":"In the <bpt id=\"p1\">**</bpt>Launch Permission<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>.","source":"In the **Launch Permission** dialog box, click **Add**."},{"pos":[9128,9312],"content":"In the <bpt id=\"p1\">**</bpt>Select Users, Computers, or Groups<ept id=\"p1\">**</ept> dialog box, in the <bpt id=\"p2\">**</bpt>Enter the object names to select<ept id=\"p2\">**</ept> box, type <bpt id=\"p3\">**</bpt>Distributed COM Users<ept id=\"p3\">**</ept>, click <bpt id=\"p4\">**</bpt>Check Names<ept id=\"p4\">**</ept>, and then click <bpt id=\"p5\">**</bpt>OK<ept id=\"p5\">**</ept>.","source":"In the **Select Users, Computers, or Groups** dialog box, in the **Enter the object names to select** box, type **Distributed COM Users**, click **Check Names**, and then click **OK**."},{"pos":[9321,9335],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","source":"Click **Add**."},{"pos":[9344,9474],"content":"In the <bpt id=\"p1\">**</bpt>Enter the object names to select<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>Performance Monitor Users<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>Check Names<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","source":"In the **Enter the object names to select** box, type **Performance Monitor Users**, click **Check Names**, and then click **OK**."},{"pos":[9483,9643],"content":"Select <bpt id=\"p1\">**</bpt>Allow<ept id=\"p1\">**</ept> for each of the permissions (Local Launch, Remote Launch, Local Activation, Remote Activation) for each of these groups, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"Select **Allow** for each of the permissions (Local Launch, Remote Launch, Local Activation, Remote Activation) for each of these groups, and then click **OK**."},{"content":"Apply the WMI control security settings to all namespaces:","pos":[9649,9707]},{"pos":[9716,9790],"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Run<ept id=\"p2\">**</ept>, type <bpt id=\"p3\">**</bpt>wmimgmt.msc<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","source":"Click **Start** &gt; **Run**, type **wmimgmt.msc**, and then click **OK**."},{"pos":[9799,9866],"content":"Right-click <bpt id=\"p1\">**</bpt>WMI Control (Local)<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>.","source":"Right-click **WMI Control (Local)**, and then click **Properties**."},{"pos":[9875,9959],"content":"On the <bpt id=\"p1\">**</bpt>Security<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>Root<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>Security<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>Add<ept id=\"p4\">**</ept>.","source":"On the **Security** tab, click **Root**, click **Security**, and then click **Add**."},{"pos":[9968,10085],"content":"Under <bpt id=\"p1\">**</bpt>Enter the object names to select<ept id=\"p1\">**</ept>, type Distributed COM users, click <bpt id=\"p2\">**</bpt>Check Names<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","source":"Under **Enter the object names to select**, type Distributed COM users, click **Check Names**, and then click **OK**."},{"pos":[10094,10113],"content":"Click <bpt id=\"p1\">**</bpt>Advanced<ept id=\"p1\">**</ept>.","source":"Click **Advanced**."},{"pos":[10122,10179],"content":"Select <bpt id=\"p1\">**</bpt>Distributed COM Users<ept id=\"p1\">**</ept> and then click <bpt id=\"p2\">**</bpt>Edit<ept id=\"p2\">**</ept>.","source":"Select **Distributed COM Users** and then click **Edit**."},{"pos":[10188,10232],"content":"Select <bpt id=\"p1\">**</bpt>This namespace and subnamespaces<ept id=\"p1\">**</ept>.","source":"Select **This namespace and subnamespaces**."},{"pos":[10241,10363],"content":"Select <bpt id=\"p1\">**</bpt>Allow<ept id=\"p1\">**</ept> for the following permissions: Execute Methods, Enable Account, and Remote Enable, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","source":"Select **Allow** for the following permissions: Execute Methods, Enable Account, and Remote Enable, and then click **OK**."},{"content":"Repeat step 6 for the Performance Monitor Users group, and then close all windows.","pos":[10369,10451]},{"pos":[10453,10594],"content":"For more information, see <bpt id=\"p1\">[</bpt>Securing a Remote WMI Connection<ept id=\"p1\">](http://msdn.microsoft.com/en-us/library/windows/desktop/aa393266(v=vs.85).aspx)</ept>.","source":"For more information, see [Securing a Remote WMI Connection](http://msdn.microsoft.com/en-us/library/windows/desktop/aa393266(v=vs.85).aspx)."},{"pos":[10601,10633],"content":"Configure SQL Server permissions","linkify":"Configure SQL Server permissions","nodes":[{"content":"Configure SQL Server permissions","pos":[0,32]}]},{"content":"The service account must be able to read the data in the Microsoft Dynamics AX business database and must have access to the default dynamic management views in SQL Server.","pos":[10635,10807]},{"pos":[10813,11062],"content":"Add the service account as a login to the SQL Server instance where the Microsoft Dynamics AX business database is installed.For information about how to perform this step, see <bpt id=\"p1\">[</bpt>Create a Login<ept id=\"p1\">](http://msdn.microsoft.com/en-us/library/aa337562.aspx)</ept>.","source":"Add the service account as a login to the SQL Server instance where the Microsoft Dynamics AX business database is installed.For information about how to perform this step, see [Create a Login](http://msdn.microsoft.com/en-us/library/aa337562.aspx)."},{"pos":[11067,11258],"content":"Add the account as a user of the business database.For information about how to perform this step, see <bpt id=\"p1\">[</bpt>How to: Create a Database User<ept id=\"p1\">](http://msdn.microsoft.com/en-us/library/aa337545.aspx)</ept>.","source":"Add the account as a user of the business database.For information about how to perform this step, see [How to: Create a Database User](http://msdn.microsoft.com/en-us/library/aa337545.aspx)."},{"pos":[11263,11460],"content":"Add the service account to the db<ph id=\"ph1\">\\_</ph>datareader role in the business database.For information about how to perform this step, see <bpt id=\"p1\">[</bpt>Join a Role<ept id=\"p1\">](http://msdn.microsoft.com/en-us/library/ff877886.aspx)</ept>.","source":"Add the service account to the db\\_datareader role in the business database.For information about how to perform this step, see [Join a Role](http://msdn.microsoft.com/en-us/library/ff877886.aspx)."},{"content":"Grant the service account the VIEW SERVER STATE permission in the SQL Server instance.","pos":[11465,11551]},{"pos":[11560,11697],"content":"In SQL Server Management Studio, expand <bpt id=\"p1\">**</bpt>Databases<ept id=\"p1\">**</ept>, right-click the <bpt id=\"p2\">**</bpt>Microsoft Dynamics AX<ept id=\"p2\">**</ept> database, and then click <bpt id=\"p3\">**</bpt>Properties<ept id=\"p3\">**</ept>.","source":"In SQL Server Management Studio, expand **Databases**, right-click the **Microsoft Dynamics AX** database, and then click **Properties**."},{"pos":[11706,11772],"content":"Click <bpt id=\"p1\">**</bpt>Permissions<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>View server permissions<ept id=\"p2\">**</ept>.","source":"Click **Permissions**, and then click **View server permissions**."},{"pos":[11781,11870],"content":"In the <bpt id=\"p1\">**</bpt>Logins or Roles<ept id=\"p1\">**</ept> list, click the user to whom you want to grant the permission.","source":"In the **Logins or Roles** list, click the user to whom you want to grant the permission."},{"pos":[11879,11998],"content":"In the <bpt id=\"p1\">**</bpt>Explicit permissions for user<ept id=\"p1\">**</ept> list, select the <bpt id=\"p2\">**</bpt>Grant<ept id=\"p2\">**</ept> check box next to <bpt id=\"p3\">**</bpt>View server state permission<ept id=\"p3\">**</ept>.","source":"In the **Explicit permissions for user** list, select the **Grant** check box next to **View server state permission**."},{"pos":[12004,12081],"content":"Verify that the .NET Business connector service is running in the environment","linkify":"Verify that the .NET Business connector service is running in the environment","nodes":[{"content":"Verify that the .NET Business connector service is running in the environment","pos":[0,77]}]},{"content":"The Business Connector service must be running on the host where the Lifecycle Services Diagnostic Service is installed.","pos":[12083,12203]},{"content":"If more than one environment is to be discovered, the .Net Business Connector proxy account must be the same for each server that is running a Microsoft Dynamics AX Application Object Server (AOS) instance.","pos":[12204,12410]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Install the .NET Business Connector<ept id=\"p1\">](http://technet.microsoft.com/library/c67944e8-73c5-4434-94d6-84484c810333(AX.60).aspx)</ept>.","pos":[12411,12562],"source":" For more information, see [Install the .NET Business Connector](http://technet.microsoft.com/library/c67944e8-73c5-4434-94d6-84484c810333(AX.60).aspx)."},{"pos":[12568,12636],"content":"Install the Microsoft Dynamics Lifecycle Services System diagnostics","linkify":"Install the Microsoft Dynamics Lifecycle Services System diagnostics","nodes":[{"content":"Install the Microsoft Dynamics Lifecycle Services System diagnostics","pos":[0,68]}]},{"content":"To install the on-premises component of System diagnostics, you must be a member of the Administrator group on the local computer.","pos":[12638,12768]},{"pos":[12774,12827],"content":"<bpt id=\"p1\">[</bpt>Go to Lifecycle Services<ept id=\"p1\">](https://lcs.dynamics.com)</ept>.","source":"[Go to Lifecycle Services](https://lcs.dynamics.com)."},{"pos":[12832,12889],"content":"Open a project and click the <bpt id=\"p1\">**</bpt>System diagnostics<ept id=\"p1\">**</ept> tile.","source":"Open a project and click the **System diagnostics** tile."},{"pos":[12894,12977],"content":"On the <bpt id=\"p1\">**</bpt>Admin<ept id=\"p1\">**</ept> page, download the compressed installer (<bpt id=\"p2\">**</bpt>LCSDiagFX<ph id=\"ph1\">\\_</ph>x64.zip.<ept id=\"p2\">**</ept>).","source":"On the **Admin** page, download the compressed installer (**LCSDiagFX\\_x64.zip.**)."},{"content":"Extract the installer to a computer that is running a Microsoft Dynamics AX client.The computer must have network access to all other servers in the environment, and must be running the .NET Business Connector if you are using the NET Business Connector proxy account as a service account.","pos":[12982,13271]},{"pos":[13278,13291],"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept>","source":"**Important**"},{"content":"In a production environment, we recommend that you install the on-premises component on a computer that is running only a client, not on computers that are also running an AOS instance or a SQL Server instance.","pos":[13716,13926]},{"pos":[13934,13952],"content":"Run <bpt id=\"p1\">**</bpt>Setup.exe<ept id=\"p1\">**</ept>.","source":"Run **Setup.exe**."},{"pos":[13959,13967],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>","source":"**Note**"},{"content":"Do not run the .msi file directly.","pos":[14045,14079]},{"content":"Accept the license terms.","pos":[14087,14112]},{"content":"If you have an existing local X509 certificate, on the <bpt id=\"p1\">**</bpt>Select the certificate type<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Use existing<ept id=\"p2\">**</ept>.","pos":[14117,14233],"source":"If you have an existing local X509 certificate, on the **Select the certificate type** page, click **Use existing**."},{"content":"If you do not have an X509 certificate, perform the following steps:","pos":[14234,14302]},{"pos":[14311,14377],"content":"On the <bpt id=\"p1\">**</bpt>Select the certificate type<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Create new<ept id=\"p2\">**</ept>.","source":"On the **Select the certificate type** page, click **Create new**."},{"content":"Enter a prefix to be used in the certificate name.","pos":[14386,14436]},{"pos":[14445,14486],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> to create the certificate.","source":"Click **Next** to create the certificate."},{"content":"Verify that the new certificate has been created in the specified location.","pos":[14495,14570]},{"pos":[14576,14683],"content":"Return to the <bpt id=\"p1\">**</bpt>System diagnostics<ept id=\"p1\">**</ept> page, browse to the location of the certificate, and click <bpt id=\"p2\">**</bpt>Upload<ept id=\"p2\">**</ept>.","source":"Return to the **System diagnostics** page, browse to the location of the certificate, and click **Upload**."},{"pos":[14688,14886],"content":"Return to the <bpt id=\"p1\">**</bpt>Upload the new certificate<ept id=\"p1\">**</ept> page of the <bpt id=\"p2\">**</bpt>Microsoft Dynamics Lifecycle Services Diagnostic Service Setup Wizard<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>Certificate file has been uploaded<ept id=\"p3\">**</ept>, and click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>.","source":"Return to the **Upload the new certificate** page of the **Microsoft Dynamics Lifecycle Services Diagnostic Service Setup Wizard**, select **Certificate file has been uploaded**, and click **Next**."},{"content":"On the <bpt id=\"p1\">**</bpt>Select private certificate<ept id=\"p1\">**</ept> page, the name of the certificate is displayed.","pos":[14891,14976],"source":"On the **Select private certificate** page, the name of the certificate is displayed."},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[14977,14992],"source":" Click **Next**."},{"pos":[14997,15102],"content":"On the <bpt id=\"p1\">**</bpt>Specify service account<ept id=\"p1\">**</ept> page, enter the service account and password, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"On the **Specify service account** page, enter the service account and password, and then click **Next**."},{"pos":[15107,15273],"content":"On the <bpt id=\"p1\">**</bpt>Change destination folder<ept id=\"p1\">**</ept> page, enter the location where you want to store the logs that were collected by the System diagnostics, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"On the **Change destination folder** page, enter the location where you want to store the logs that were collected by the System diagnostics, and then click **Next**."},{"pos":[15278,15362],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to install and start the System diagnostics, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>.","source":"Click **OK** to install and start the System diagnostics, and then click **Finish**."},{"content":"Two executable programs are installed: LCSDiagFXDiscovery.exe and LCSDiagFXCollector.exe.","pos":[15364,15453]},{"pos":[15458,15479],"content":"Discover environments","linkify":"Discover environments","nodes":[{"content":"Discover environments","pos":[0,21]}]},{"pos":[15484,15590],"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Microsoft Dynamics AX Lifecycle Services Diagnostic Service Discovery.<ept id=\"p2\">**</ept>","source":"Click **Start**, and then click **Microsoft Dynamics AX Lifecycle Services Diagnostic Service Discovery.**"},{"pos":[15595,15764],"content":"In the <bpt id=\"p1\">**</bpt>Environment Discovery<ept id=\"p1\">**</ept> window, enter a name for the environment, the fully-qualified name of the SQL Server instance and database, and then click <bpt id=\"p2\">**</bpt>Discover<ept id=\"p2\">**</ept>.","source":"In the **Environment Discovery** window, enter a name for the environment, the fully-qualified name of the SQL Server instance and database, and then click **Discover**."},{"pos":[15769,15941],"content":"At the bottom of the Window, click the <bpt id=\"p1\">**</bpt>Test permissions<ept id=\"p1\">**</ept> button <ph id=\"ph1\">![</ph>Test permissions button for System diagnostics<ph id=\"ph2\">](./media/testpermissions.jpg)</ph> at the bottom of the page.","source":"At the bottom of the Window, click the **Test permissions** button ![Test permissions button for System diagnostics](./media/testpermissions.jpg) at the bottom of the page."},{"pos":[15946,16112],"content":"On the <bpt id=\"p1\">**</bpt>Change destination folder<ept id=\"p1\">**</ept> page, enter the location where you want to store the logs that were collected by the System diagnostics, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","source":"On the **Change destination folder** page, enter the location where you want to store the logs that were collected by the System diagnostics, and then click **Next**."},{"pos":[16117,16129],"content":"Collect data","linkify":"Collect data","nodes":[{"content":"Collect data","pos":[0,12]}]},{"content":"You can collect data on demand from the <bpt id=\"p1\">**</bpt>Environment Discovery<ept id=\"p1\">**</ept> window.","pos":[16130,16203],"source":"You can collect data on demand from the **Environment Discovery** window."},{"content":"We recommend that you schedule a job to collect data regularly.","pos":[16204,16267]},{"content":"Data collection typically takes between 5 and 15 minutes.","pos":[16268,16325]},{"content":"Errors that are encountered during data collection are logged in the Windows Application event log, as well as in a log file in the location that you specified during installation.","pos":[16326,16506]},{"content":"To run an initial data collection in the <bpt id=\"p1\">**</bpt>Environment Discovery<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>Collect now<ept id=\"p2\">**</ept>.","pos":[16512,16609],"source":"To run an initial data collection in the **Environment Discovery** window, click **Collect now**."},{"content":"We recommend that you run an initial collection immediately after discovering an environment for the first time.","pos":[16610,16722]},{"pos":[16727,16844],"content":"To generate a collection command that you can use to schedule collection jobs, click <bpt id=\"p1\">**</bpt>Generate collection command<ept id=\"p1\">**</ept>.","source":"To generate a collection command that you can use to schedule collection jobs, click **Generate collection command**."},{"content":"Copy the generated command to the clipboard.","pos":[16849,16893]},{"content":"Schedule the command to run by using a scheduling engine, such as <bpt id=\"p1\">**</bpt>Windows Task Scheduler<ept id=\"p1\">**</ept>.","pos":[16898,16991],"source":"Schedule the command to run by using a scheduling engine, such as **Windows Task Scheduler**."},{"content":"For more information about using <bpt id=\"p1\">**</bpt>Task Scheduler<ept id=\"p1\">**</ept>, see <bpt id=\"p2\">[</bpt>Schedule a task<ept id=\"p2\">](http://technet.microsoft.com/en-us/library/cc766428.aspx)</ept>.","pos":[16992,17125],"source":" For more information about using **Task Scheduler**, see [Schedule a task](http://technet.microsoft.com/en-us/library/cc766428.aspx)."},{"pos":[17130,17176],"content":"Use same X509 certificate for all environments","linkify":"Use same X509 certificate for all environments","nodes":[{"content":"Use same X509 certificate for all environments","pos":[0,46]}]},{"content":"First time let setup generate certificate as usual","pos":[17183,17233]},{"content":"Run MMC (Microsoft management console) as admin","pos":[17238,17285]},{"pos":[17290,17329],"content":"File -<ph id=\"ph1\">&amp;gt;</ph> \"<bpt id=\"p1\">**</bpt>Add or Remove Snap-ins<ept id=\"p1\">**</ept>\"","source":"File -&gt; \"**Add or Remove Snap-ins**\""},{"pos":[17334,17424],"content":"Double click <bpt id=\"p1\">**</bpt>Certificates<ept id=\"p1\">**</ept> item and choose computer account then next-<ph id=\"ph1\">&amp;gt;</ph>finish-<ph id=\"ph2\">&amp;gt;</ph>ok","source":"Double click **Certificates** item and choose computer account then next-&gt;finish-&gt;ok"},{"pos":[17429,17500],"content":"Expand Certificates (Local Computer)-<ph id=\"ph1\">&amp;gt;</ph><bpt id=\"p1\">**</bpt>Personal<ept id=\"p1\">**</ept><ph id=\"ph2\">-</ph><ph id=\"ph3\">&amp;gt;</ph>Certificates:","source":"Expand Certificates (Local Computer)-&gt;**Personal**-&gt;Certificates:"},{"pos":[17505,17642],"content":"Right click on certificate generated on first step -<ph id=\"ph1\">&amp;gt;</ph> All tasks -<ph id=\"ph2\">&amp;gt;</ph> Export -<ph id=\"ph3\">&amp;gt;</ph> Next -<ph id=\"ph4\">&amp;gt;</ph> Choose \"<bpt id=\"p1\">**</bpt>Yes, export the private key<ept id=\"p1\">**</ept>\"","source":"Right click on certificate generated on first step -&gt; All tasks -&gt; Export -&gt; Next -&gt; Choose \"**Yes, export the private key**\""},{"content":"Leave default values in <ph id=\"ph1\">\\*</ph>.pfx export setup","pos":[17647,17690],"source":"Leave default values in \\*.pfx export setup"},{"content":"In security step Use domain account or password for securing your exported file","pos":[17695,17774]},{"content":"Export files in next steps","pos":[17779,17805]},{"pos":[17810,17883],"content":"Copy exported file to new environment click it and choose <bpt id=\"p1\">**</bpt>Install PFX<ept id=\"p1\">**</ept>","source":"Copy exported file to new environment click it and choose **Install PFX**"},{"pos":[17888,17912],"content":"Choose <bpt id=\"p1\">**</bpt>Local Machine<ept id=\"p1\">**</ept>","source":"Choose **Local Machine**"},{"content":"Click next -<ph id=\"ph1\">&amp;gt;</ph> And in following screen make sure that <bpt id=\"p1\">**</bpt>Mark this key as exportable<ept id=\"p1\">**</ept> is set.","pos":[17917,18012],"source":"Click next -&gt; And in following screen make sure that **Mark this key as exportable** is set."},{"content":"Click next and finish","pos":[18013,18034]},{"content":"Now when running Lifecycle services system diagnostics setup choose on new environment use an existing certificate","pos":[18039,18153]},{"content":"Certificate generated in first step should be present in client certificates lookup choose it and continue as usual:","pos":[18158,18274]}],"content":"---\n# required metadata\n\ntitle: Install and run System diagnostics (AX 2012) | Microsoft Docs\ndescription: In Microsoft Dynamics Lifecycle Services, System diagnostics includes an on-premises component that must be installed before you can use the service to discover Microsoft Dynamics AX environments and collect data.\nauthor: kfend\nmanager: AnnBe\nms.date: 2015-12-05 23:06:13\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# keywords: \n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: kfend\nms.suite: AX 2012\n# ms.tgt_pltfrm: \nms.custom: 18861\nms.assetid: 62035a79-9347-43d9-95db-431c14cd3211\nms.region: Global\n# ms.industry: \nms.author: manado\n\n---\n\n# Install and run System diagnostics (AX 2012)\n\nIn Microsoft Dynamics Lifecycle Services, System diagnostics includes an on-premises component that must be installed before you can use the service to discover Microsoft Dynamics AX environments and collect data.\n\nInstall the System diagnostics on-premises component\n----------------------------------------------------\n\nTo install the System diagnostics on-premises component, the following is required:\n\n-   A service account with specific permissions on the local computer and the Microsoft Dynamics AX business database.\n-   An X509 certificate . You can either use an existing certificate, or have the installer create one for you. Each X509 certificate is associated with a single project. Diagnostics from an environment can be uploaded to only one project.\n-   Microsoft .NET 4.5 or 4.5.1\n\n### Configure the service account for System diagnostics\n\nThis section describes the permissions that are required for the service account that the Lifecycle Services Diagnostic Service (LCSDiagFXService.exe) runs as.\n\n-   The service account must be a domain account that is a user in Microsoft Dynamics AX and a member of the **BusinessConnector** role.We strongly recommend that, if possible, the account be the same account used for the .NET Business Connector proxy. For more information, see [Specify the .NET Business Connector proxy account](http://technet.microsoft.com/library/3e46dc0a-2ff4-4a06-ae61-041e52dcc774(AX.60).aspx) and [Assign users to security roles](http://technet.microsoft.com/library/214ee45b-5b99-4ea8-9454-f4297f68e38c(AX.60).aspx).\n    | **Note**                                                                                                                     |\n    |------------------------------------------------------------------------------------------------------------------------------|\n    | If you reuse the .NET Business connector proxy account, you must still add it as a member of the **BusinessConnector** role. |\n\n-   The service account must have read access to specific registry keys in the HKEY\\_LOCAL\\_MACHINE hive on all of the computers that run AOS instances and host Microsoft Dynamics AX business databases, so that the Lifecycle Services Diagnostic Service can discover environments and collect data.\n-   The service account must be a member of the **Event Log Readers** local group on each server in the environment, so that the Lifecycle Services Diagnostic Service can read the Windows event logs.\n-   The service account must have read access to the Microsoft Dynamics AX business database (**db\\_datareader**), and must have VIEW SERVER STATE permission for the SQL Server instance, so that Lifecycle Services Diagnostic Service can run default dynamic management views in SQL Server.\n\n#### Configure read permissions to the registry\n\nOn each server in your environment that hosts an AOS instance or Microsoft Dynamics AX SQL Server business database, you must grant read access to a registry key in the HKEY\\_LOCAL\\_MACHINE hive to the service account for the System diagnostics.\n| **Caution**                                                                                                                                                                                                                                                                                                                                                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| The following procedure includes editing the Windows Registry. Editing the registry incorrectly can cause serious problems that may require you to reinstall Windows. Microsoft cannot guarantee that problems resulting from incorrectly editing the registry can be solved.You should make a backup copy of the registry files (System.dat and User.dat) before you edit the registry. |\n\nTo grant access to collect data from the Windows registry on the server that hosts the SQL Server business database:\n1.  Click **Start**, click **Run**, type **regedit**, and then press **Enter**.\n2.  Expand **HKEY\\_LOCAL\\_MACHINE**, navigate to the subkey **SystemCurrentControlSetControlPriorityControl**, right-click it and select **Permissions**.\n3.  Add the user that you want to associate with the Lifecycle Services Diagnostic Service.\n4.  Select the user that you added, and then allow read permissions.\n5.  Click **Advanced Security Settings**, and then ensure that the permissions are inherited by the child objects.\n\nTo grant access to collect data from the Windows registry on a server that hosts one or more AOS instances:\n1.  Click **Start**, click **Run**, type **regedit**, and press **Enter**.\n2.  Expand **HKEY\\_LOCAL\\_MACHINE**, navigate to the subkey **SystemCurrentControlSetServicesDynamics Server6.0**, right-click it and select **Permissions**.\n3.  Add the user that you want to associate with the Lifecycle Services Diagnostic Service.\n4.  Select the user that you added, and then allow read permissions.\n5.  Click **Advanced Security Settings**, and then ensure that the permissions are inherited by the child objects.\n6.  Repeat for all AOS instances in each environment that you want to collect data from.\n\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th><strong>Important</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>As you are configuring rights in the registry, do not reduce account privileges that already exist.For more information about Advanced security settings, see:\n<ul>\n<li><a href=\"http://technet.microsoft.com/en-us/library/jj134043.aspx\">Windows Server 2012 Access Control and Authorization Overview</a></li>\n<li><a href=\"http://technet.microsoft.com/en-us/library/cc730772.aspx\">Windows Server 2008 R2 Advanced Security Settings Properties Page - Permissions Tab</a></li>\n</ul></td>\n</tr>\n</tbody>\n</table>\n\n#### Edit the Group Policy on the AOS\n\nYou must make the services of the AOS remotely accessible in Group Policy.\n\n1.  On the computer running the AOS instance, click **Start** &gt; **Run**, type **gpedit.msc**, and then press **Enter**.\n2.  In the left pane, expand **Computer Configuration** &gt; **Windows settings** &gt; **Security settings** &gt; **Local policies** &gt; **Security options**.\n3.  In the right pane, double-click **Network access: Remotely accessible registry paths and sub-paths**.\n4.  If the following paths are not in the list, add them to the end of the list and then click **OK**.\n    -   SystemCurrentControlSetControlPriorityControl\n    -   SystemCurrentControlSetservicesDynamics Server6.0\n\n#### Configure Windows event log and WMI permissions\n\nThe service account must be able to read the Windows event logs on each server in the environment, and must be able to monitor remote Windows Management Instrumentation connections. For more information, see [Add a member to a local group](http://technet.microsoft.com/en-us/library/cc772524(v=WS.10).aspx).\n\n-   On each server in the environment, add the service account to the **Event Log Readers** local group, the **Distributed COM Users** local group and the **Performance Monitor Users** local group.\n\n#### Secure the remote Windows Management Instrumentation connections\n\nOn each server in your environment that hosts an AOS instance or Microsoft Dynamics AX SQL Server business database, ensure that you secure the remote Windows Management Instrumentation (WMI) connection.\n\n1.  Click **Start** &gt; **Run**, type **DCOMCNFG**, and then click **OK**.\n2.  In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.\n3.  In the **My Computer Properties** dialog box, click the **COM Security** tab.\n4.  Under **Launch and Activation Permissions**, click **Edit Limits**.\n5.  In the **Launch Permission** dialog box, follow these steps if your name or your group does not appear in the **Groups or user names** list:\n    1.  In the **Launch Permission** dialog box, click **Add**.\n    2.  In the **Select Users, Computers, or Groups** dialog box, in the **Enter the object names to select** box, type **Distributed COM Users**, click **Check Names**, and then click **OK**.\n    3.  Click **Add**.\n    4.  In the **Enter the object names to select** box, type **Performance Monitor Users**, click **Check Names**, and then click **OK**.\n    5.  Select **Allow** for each of the permissions (Local Launch, Remote Launch, Local Activation, Remote Activation) for each of these groups, and then click **OK**.\n\n6.  Apply the WMI control security settings to all namespaces:\n    1.  Click **Start** &gt; **Run**, type **wmimgmt.msc**, and then click **OK**.\n    2.  Right-click **WMI Control (Local)**, and then click **Properties**.\n    3.  On the **Security** tab, click **Root**, click **Security**, and then click **Add**.\n    4.  Under **Enter the object names to select**, type Distributed COM users, click **Check Names**, and then click **OK**.\n    5.  Click **Advanced**.\n    6.  Select **Distributed COM Users** and then click **Edit**.\n    7.  Select **This namespace and subnamespaces**.\n    8.  Select **Allow** for the following permissions: Execute Methods, Enable Account, and Remote Enable, and then click **OK**.\n\n7.  Repeat step 6 for the Performance Monitor Users group, and then close all windows.\n\nFor more information, see [Securing a Remote WMI Connection](http://msdn.microsoft.com/en-us/library/windows/desktop/aa393266(v=vs.85).aspx).\n\n#### Configure SQL Server permissions\n\nThe service account must be able to read the data in the Microsoft Dynamics AX business database and must have access to the default dynamic management views in SQL Server.\n\n1.  Add the service account as a login to the SQL Server instance where the Microsoft Dynamics AX business database is installed.For information about how to perform this step, see [Create a Login](http://msdn.microsoft.com/en-us/library/aa337562.aspx).\n2.  Add the account as a user of the business database.For information about how to perform this step, see [How to: Create a Database User](http://msdn.microsoft.com/en-us/library/aa337545.aspx).\n3.  Add the service account to the db\\_datareader role in the business database.For information about how to perform this step, see [Join a Role](http://msdn.microsoft.com/en-us/library/ff877886.aspx).\n4.  Grant the service account the VIEW SERVER STATE permission in the SQL Server instance.\n    1.  In SQL Server Management Studio, expand **Databases**, right-click the **Microsoft Dynamics AX** database, and then click **Properties**.\n    2.  Click **Permissions**, and then click **View server permissions**.\n    3.  In the **Logins or Roles** list, click the user to whom you want to grant the permission.\n    4.  In the **Explicit permissions for user** list, select the **Grant** check box next to **View server state permission**.\n\n### Verify that the .NET Business connector service is running in the environment\n\nThe Business Connector service must be running on the host where the Lifecycle Services Diagnostic Service is installed. If more than one environment is to be discovered, the .Net Business Connector proxy account must be the same for each server that is running a Microsoft Dynamics AX Application Object Server (AOS) instance. For more information, see [Install the .NET Business Connector](http://technet.microsoft.com/library/c67944e8-73c5-4434-94d6-84484c810333(AX.60).aspx).\n\n### Install the Microsoft Dynamics Lifecycle Services System diagnostics\n\nTo install the on-premises component of System diagnostics, you must be a member of the Administrator group on the local computer.\n\n1.  [Go to Lifecycle Services](https://lcs.dynamics.com).\n2.  Open a project and click the **System diagnostics** tile.\n3.  On the **Admin** page, download the compressed installer (**LCSDiagFX\\_x64.zip.**).\n4.  Extract the installer to a computer that is running a Microsoft Dynamics AX client.The computer must have network access to all other servers in the environment, and must be running the .NET Business Connector if you are using the NET Business Connector proxy account as a service account.\n    | **Important**                                                                                                                                                                                                      |\n    |--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n    | In a production environment, we recommend that you install the on-premises component on a computer that is running only a client, not on computers that are also running an AOS instance or a SQL Server instance. |\n\n5.  Run **Setup.exe**.\n    | **Note**                           |\n    |------------------------------------|\n    | Do not run the .msi file directly. |\n\n6.  Accept the license terms.\n7.  If you have an existing local X509 certificate, on the **Select the certificate type** page, click **Use existing**. If you do not have an X509 certificate, perform the following steps:\n    1.  On the **Select the certificate type** page, click **Create new**.\n    2.  Enter a prefix to be used in the certificate name.\n    3.  Click **Next** to create the certificate.\n    4.  Verify that the new certificate has been created in the specified location.\n\n8.  Return to the **System diagnostics** page, browse to the location of the certificate, and click **Upload**.\n9.  Return to the **Upload the new certificate** page of the **Microsoft Dynamics Lifecycle Services Diagnostic Service Setup Wizard**, select **Certificate file has been uploaded**, and click **Next**.\n10. On the **Select private certificate** page, the name of the certificate is displayed. Click **Next**.\n11. On the **Specify service account** page, enter the service account and password, and then click **Next**.\n12. On the **Change destination folder** page, enter the location where you want to store the logs that were collected by the System diagnostics, and then click **Next**.\n13. Click **OK** to install and start the System diagnostics, and then click **Finish**.\n\nTwo executable programs are installed: LCSDiagFXDiscovery.exe and LCSDiagFXCollector.exe.\n\n## Discover environments\n1.  Click **Start**, and then click **Microsoft Dynamics AX Lifecycle Services Diagnostic Service Discovery.**\n2.  In the **Environment Discovery** window, enter a name for the environment, the fully-qualified name of the SQL Server instance and database, and then click **Discover**.\n3.  At the bottom of the Window, click the **Test permissions** button ![Test permissions button for System diagnostics](./media/testpermissions.jpg) at the bottom of the page.\n4.  On the **Change destination folder** page, enter the location where you want to store the logs that were collected by the System diagnostics, and then click **Next**.\n\n## Collect data\nYou can collect data on demand from the **Environment Discovery** window. We recommend that you schedule a job to collect data regularly. Data collection typically takes between 5 and 15 minutes. Errors that are encountered during data collection are logged in the Windows Application event log, as well as in a log file in the location that you specified during installation.\n\n1.  To run an initial data collection in the **Environment Discovery** window, click **Collect now**. We recommend that you run an initial collection immediately after discovering an environment for the first time.\n2.  To generate a collection command that you can use to schedule collection jobs, click **Generate collection command**.\n3.  Copy the generated command to the clipboard.\n4.  Schedule the command to run by using a scheduling engine, such as **Windows Task Scheduler**. For more information about using **Task Scheduler**, see [Schedule a task](http://technet.microsoft.com/en-us/library/cc766428.aspx).\n\n## Use same X509 certificate for all environments\n \n1.  First time let setup generate certificate as usual\n2.  Run MMC (Microsoft management console) as admin\n3.  File -&gt; \"**Add or Remove Snap-ins**\"\n4.  Double click **Certificates** item and choose computer account then next-&gt;finish-&gt;ok\n5.  Expand Certificates (Local Computer)-&gt;**Personal**-&gt;Certificates:\n6.  Right click on certificate generated on first step -&gt; All tasks -&gt; Export -&gt; Next -&gt; Choose \"**Yes, export the private key**\"\n7.  Leave default values in \\*.pfx export setup\n8.  In security step Use domain account or password for securing your exported file\n9.  Export files in next steps\n10. Copy exported file to new environment click it and choose **Install PFX**\n11. Choose **Local Machine**\n12. Click next -&gt; And in following screen make sure that **Mark this key as exportable** is set. Click next and finish\n13. Now when running Lifecycle services system diagnostics setup choose on new environment use an existing certificate\n14. Certificate generated in first step should be present in client certificates lookup choose it and continue as usual:\n\n\n\n"}