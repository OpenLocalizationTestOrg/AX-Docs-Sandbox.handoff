{"content":"---\n# required metadata\n\ntitle: Office integration\ndescription: This topic reviews Microsoft Office integration concepts and features.\nauthor: ChrisGarty\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \n# ms.reviewer: 61\nms.search.scope: AX 7.0.0, Operations\n# ms.tgt_pltfrm: \nms.custom: 25511\nms.assetid: 36ba2da0-ee9b-4f84-b705-751303ccec33\nms.search.region: Global\n# ms.search.industry: \nms.author: cgarty\nms.search.validFrom: 2016-02-28\nms.dyn365.ops.version: AX 7.0.0\n\n---\n\n# Office integration\n\n[!include[banner](../includes/banner.md)]\n\n\nThis topic reviews Microsoft Office integration concepts and features. The integration depends on several technologies:\n\n-   Working in Microsoft Azure\n-   Working with Azure Active Directory (Azure AD)\n-   Running a web client in multiple browsers\n\nThe Microsoft Office integration capabilities provide users with a productive environment that helps them get the job done by using Office products.\n\n## Excel Data Connector Addin\nMicrosoft Excel can change and quickly analyze data. The Excel Data Connector app interacts with Excel workbooks and OData services that are created for publicly exposed data entities. The Excel Data Connector add-in enables Excel to become a seamless part of the user experience. The Excel Data Connector add-in is built by using the Office Web Add-ins framework. The add-in runs in a task pane. Office Web Add-ins are web applications that run inside an embedded Internet Explorer browser window. \n\n[![1\\_Office](./media/1_office.png)](./media/1_office.png)\n\n### Microsoft Dynamics AX 2012 architecture vs. Microsoft Dynamics 365 for Finance and Operations, Enterprise edition architecture\n\nThere are several differences between versions. For both, we built lightweight add-ins that run in Excel and use services to connect to the application.\n\n#### Dynamics AX 2012\n\nExcel &gt; VSTO (.NET) Add-in &gt; Windows Communication foundation (WCF) &gt; Authentication through Active Directory (AD) &gt; AIF SOAP services on the AOS &gt; AX Services and Tables &gt; AX query engine &gt; Database\n\n#### Dynamics 365 for Operations\n\nExcel &gt; Office Web Add-in (JS + HTML) &gt; JavaScript OData API (Olingo) &gt; Authentication through Azure Active Directory (AAD) &gt; AX OData services on the AOS &gt; AX Entities &gt; AX LINQ provider &gt; AX Database\n\n### Office Add-in explained\n\nThe Excel Data Connector app is located in a task pane on the right side of a workbook. [![2\\_Office](./media/2_office.png)](./media/2_office.png) The following table describes the parts of the add-in. The numbers correspond to the numbers in the preceding screen shot.\n\n| Number | Name                             | Description                                                                                                                                                                                                                                                                          |\n|--------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| 1      | Add-in primary title             | The title of the add-in that is provided to the Office Web Add-ins framework.                                                                                                                                                                                                        |\n| 2      | Add-in secondary title           | The title of the add-in that is provided by the add-in.                                                                                                                                                                                                                              |\n| 3      | Source name                      | The label of the entity that provides data for the selected data table. You can hover over the label to see the corresponding name.                                                                                                                                                  |\n| 4      | Field name                       | The label of the field that provides data for the selected data table column. You can hover over the label to see the corresponding name and type.                                                                                                                                   |\n| 5      | Refresh button                   | Refresh the data in the workbook.                                                                                                                                                                                                                                                    |\n| 6      | Publish button                   | Publish the data changes in the workbook.                                                                                                                                                                                                                                            |\n| 7      | Design button                    | Open the design-time experience.                                                                                                                                                                                                                                                     |\n| 8      | Status bar                       | The status bar provides brief temporary information alerts. Information that is appears in the status bar also appears in the **Messages** dialog box.                                                                                                                               |\n| 9      | Options button                   | Open the **Options** dialog box.                                                                                                                                                                                                                                                     |\n| 10     | Messages button                  | Open the **Messages** dialog box, which displays the information messages, warnings, and errors that the program provides to the user. A number sometimes appears next to the **Messages** button to provide a count of the warnings or errors that the user might be interested in. |\n| 11     | Excel data table containing data | The filter and sort controls in the columns headers can be used on this data. The filters must be removed before data changes are published.                                                                                                                                         |\n| 12     | Office Web Add-ins menu          | The Office Web Add-ins menu button provides several standard links. The most important of the links is used to reload the add-in. When the add-in is reloaded, it updates all the data for the workbook that is contained in tables that are associated with the add-in.             |\n\n### Authentication\n\nOData sits on the same authentication stack as the server. The add-in uses OAuth to facilitate authentication.\n\n### Lookups and drop-down lists\n\nWhen you clicking in a table cell, any lookup, enumeration drop-down list, or date picker that is associated with that cell be shown inside the add-in, underneath the source and field information. Any value that you select inside the add-in is put into the currently selected table cell.\n\n### Adding and deleting records\n\nTo add a record, either start typing in a row directly below a table, or use the Tab key to tab away from the last cell of the last row in the table. To delete a record, select the row by clicking the row label (1, 2, 3, and so on), and delete all the cells in that row. To publish the changes, click **Publish**. The **Messages** dialog box show how many records were added, edited, and deleted.\n\n## Workbook Designer\nYou can use the **Workbook Designer** page to design an editable custom export workbook that contains an entity and a set of fields. To open the **Workbook Designer** (**ExportToExcelWorkbookDesigner**) page, click **Common &gt; Common &gt; Office Integration &gt; Excel workbook designer**. Before you can publish data edits, all the key fields of the entity must be in the Excel table. Key fields have a key symbol next to them. To successfully create or update a record, must have all the mandatory fields in the Excel table. Mandatory fields have an asterisk (\\*) next to them. \n\n[![3\\_Office](./media/3_office.png)](./media/3_office.png) \n\nTo retrieve the resulting workbook, click **Create workbook** in the app bar. \n\nClick **View related form** to see the data that the entity exposes. This button is only enabled for entities that have a **FormRef** property value.\n\n## Export API\n### The Open in Microsoft Office menu and static exports\n\nThe **Open in Microsoft Office** menu is available on any page that has a data source. The **Open in Microsoft Office** menu provides three types of options:\n\n-   **Open in Excel** options that are automatically added for entities and entity-based templates that share the same root data source as the current page. These options make it easier to read data into Excel and publish data changes back to the OData services for those entities.\n-   **Open in Excel** options that are manually added via the Export API. These options can be custom-generated exports or custom template exports.\n-   **Export to Excel** options that are automatically added for all the visible grids on the page. These options are static exports of data from a grid.\n\n### Export API\n\nThe Export API is used on a page to provide custom export options for that page. The Export API consists of three parts that let a developer perform the following tasks:\n\n-   Provide a set of custom export options that appear on the **Export** menu on a page.\n-   Provide the context for a custom-generated export.\n-   Provide the template for a custom template export.\n\n### Custom-generated exports\n\nTo provide a custom-generated export, implement the ExporttoExcelIGeneratedCustomExport interface. Here is an example.\n\n    public class FMCustomer extends FormRun implements ExportToExcelIGeneratedCustomExport\n\nAdd an export option by implementing the **getExportOptions** method and adding an export option to the list that is returned. Here is an example.\n\n    public List getExportOptions()\n    {\n        List exportOptions = new List(Types::Class); \n        ExportToExcelExportOption exportOption = ExportToExcelExportOption::construct(ExportToExcelExportType::CustomGenerated);\n        exportOption.setDisplayNameWithDataEntity(tablestr(FMCustomerEntity));\n        exportOptions.addEnd(exportOption); \n        return exportOptions;\n    }\n\nProvide the export context by implementing the **getDataEntityContext** method and returning an **ExportToExcelDataEntityContext** for the appropriate **exportOption** after the **ExportToExcelExportOption.id** method is checked. The context specifies the data entity and fields to include in the workbook that is generated. Here is an example.\n\n    public ExportToExcelDataEntityContext getDataEntityContext(ExportToExcelExportOption _exportOption)\n    {\n        ExportToExcelDataEntityContext context = null;\n        if (_exportOption.id() == ExportToExcelExportOption::DefaultId)\n        {\n            context = ExportToExcelDataEntityContext::construct(tablestr(FMCustomerEntity), tablefieldgroupstr(FMCustomerEntity, AutoReport));\n        }\n         return context;\n    }\n\n### Custom template exports\n\nTo provide a custom template export, implement the ExportToExcelITemplateCustomExport interface. Here is an example.\n\n    public class FMRental extends FormRun implements ExportToExcelIGeneratedCustomExport, ExportToExcelITemplateCustomExport\n\nAdd an export option by implementing the **getExportOptions** method and adding an export option to the list that is returned. Here is an example.\n\n    public List getExportOptions()\n    {\n        List exportOptions = new List(Types::Class);\n        //Other options...\n        ExportToExcelExportOption exportOption2 = ExportToExcelExportOption::construct(ExportToExcelExportType::CustomTemplate, int2str(2));\n        exportOption2.displayName(\"Analyze rentals\");\n        exportOptions.addEnd(exportOption2);        \n        return exportOptions;\n    }\n\nProvide the export template by implementing the **getTemplate** method and returning a **System.IO.Stream** for the appropriate **exportOption** after the **ExportToExcelExportOption.id** method is checked. Templates can be stored as Application Object Tree (AOT) resources and retrieved at run time by using the **Microsoft.Dynamics.Ax.Xpp.MetadataSupport::GetResourceContentStream** method. Here is an example.\n\n    public System.IO.Stream getTemplate(ExportToExcelExportOption _exportOption)\n    {\n        System.IO.Stream stream = null;\n        if (_exportOption.id() == int2str(2))\n        {\n            stream = Microsoft.Dynamics.Ax.Xpp.MetadataSupport::GetResourceContentStream(resourcestr(FMRentalEditableExportTemplate));\n        }\n        return stream;\n    }\n\nYou must also implement the **updateTemplateSettings** method to satisfy the interface. Eventually, this method will be used to provide filtering information, but that capability is still under development. Here is an example.\n\n    public void updateTemplateSettings(ExportToExcelExportOption _exportOption, Microsoft.Dynamics.Platform.Integration.Office.ExportToExcelHelper.SettingsEditor _settingsEditor)\n    {\n    }\n\n## Document management\nDocument management supports saving record attachments in Azure Blob storage and SharePoint Online. Database storage is deprecated. Azure Blob storage is equivalent to storage in the database since documents can only be accessed through the application and it provides the added benefit of providing storage that doesn't negatively affect the performance of the database. Azure blob storage is the default and works immediately. SharePoint storage will work immediately if you have an O365 license since we auto-discover the SharePoint tenant e.g. a user on the TenantA.onmicrosoft.com O365/AAD tenant gets TenantA.sharepoint.com as the SharePoint site. If document management has been turned off by the user, turn it on by clicking **Options &gt; General &gt; Miscellaneous** and setting **Document handling active** to **Yes**. \n\n[![4\\_Office](./media/4_office.png)](./media/4_office.png) \n\nOn any page that has data, an **Attach** button will be available in the upper-right corner. \n\n[![5\\_Office](./media/5_office.png)](./media/5_office.png) \n\nThe **Attachments** page provides a view of the attachments (documents) that are associated with the record that was selected on the previous page. You can add new attachments to the record by clicking the **New** button (**+**) in the app bar. For the **File** and ****Image**** document types, you will be prompted to provide the associated file.\n\n### Document preview\n\nA preview for supported file types is provided on the **Preview** FastTab. Basic document types, such as PNG images and text files, are supported by default. Office document types, such as Microsoft Word, Excel, and PowerPoint files, must use a production Office Web Apps Server, which might not be available in a OneBox configuration.\n\n## Frequently asked questions\n### Office Licensing\n\n#### What Office 365 licenses are available?\n\nThere are lots of [Office 365 license options](https://products.office.com/en-us/business/compare-office-365-for-business-plans). You should select the license that makes sense for your organization.\n\n#### After purchasing an Office 365 license, what needs to be done to set up SharePoint storage for attachments?\n\nOpen the Document Parameters form and ensure that the SharePoint server has been automatically discovered and set. Now open or create a Document Type, set the Document Type's location to \"SharePoint\" and select the folder that the files should be stored in.\n\nSee also\n--------\n\n[Office Integration lab and walkthroughs](office-integration-tutorial.md)\n\n[Office Integration Troubleshooting](office-integration-troubleshooting.md)\n\n[Application stack and server architecture](../dev-tools/application-stack-server-architecture.md)\n\n\n\n","nodes":[{"pos":[32,50],"content":"Office integration","needQuote":true,"needEscape":true,"nodes":[{"content":"Office integration","pos":[0,18]}]},{"pos":[64,134],"content":"This topic reviews Microsoft Office integration concepts and features.","needQuote":true,"needEscape":true,"nodes":[{"content":"This topic reviews Microsoft Office integration concepts and features.","pos":[0,70]}]},{"pos":[631,649],"content":"Office integration","linkify":"Office integration","nodes":[{"content":"Office integration","pos":[0,18]}]},{"content":"This topic reviews Microsoft Office integration concepts and features.","pos":[695,765]},{"content":"The integration depends on several technologies:","pos":[766,814]},{"content":"Working in Microsoft Azure","pos":[820,846]},{"content":"Working with Azure Active Directory (Azure AD)","pos":[851,897]},{"content":"Running a web client in multiple browsers","pos":[902,943]},{"content":"The Microsoft Office integration capabilities provide users with a productive environment that helps them get the job done by using Office products.","pos":[945,1093]},{"pos":[1098,1124],"content":"Excel Data Connector Addin","linkify":"Excel Data Connector Addin","nodes":[{"content":"Excel Data Connector Addin","pos":[0,26]}]},{"content":"Microsoft Excel can change and quickly analyze data.","pos":[1125,1177]},{"content":"The Excel Data Connector app interacts with Excel workbooks and OData services that are created for publicly exposed data entities.","pos":[1178,1309]},{"content":"The Excel Data Connector add-in enables Excel to become a seamless part of the user experience.","pos":[1310,1405]},{"content":"The Excel Data Connector add-in is built by using the Office Web Add-ins framework.","pos":[1406,1489]},{"content":"The add-in runs in a task pane.","pos":[1490,1521]},{"content":"Office Web Add-ins are web applications that run inside an embedded Internet Explorer browser window.","pos":[1522,1623]},{"pos":[1626,1684],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>1<ph id=\"ph2\">\\_</ph>Office<ept id=\"p1\">](./media/1_office.png)](./media/1_office.png)</ept>","source":"[![1\\_Office](./media/1_office.png)](./media/1_office.png)"},{"pos":[1690,1816],"content":"Microsoft Dynamics AX 2012 architecture vs. Microsoft Dynamics 365 for Finance and Operations, Enterprise edition architecture","linkify":"Microsoft Dynamics AX 2012 architecture vs. Microsoft Dynamics 365 for Finance and Operations, Enterprise edition architecture","nodes":[{"content":"Microsoft Dynamics AX 2012 architecture vs. Microsoft Dynamics 365 for Finance and Operations, Enterprise edition architecture","pos":[0,126]}]},{"content":"There are several differences between versions.","pos":[1818,1865]},{"content":"For both, we built lightweight add-ins that run in Excel and use services to connect to the application.","pos":[1866,1970]},{"pos":[1977,1993],"content":"Dynamics AX 2012","linkify":"Dynamics AX 2012","nodes":[{"content":"Dynamics AX 2012","pos":[0,16]}]},{"content":"Excel <ph id=\"ph1\">&amp;gt;</ph> VSTO (.NET) Add-in <ph id=\"ph2\">&amp;gt;</ph> Windows Communication foundation (WCF) <ph id=\"ph3\">&amp;gt;</ph> Authentication through Active Directory (AD) <ph id=\"ph4\">&amp;gt;</ph> AIF SOAP services on the AOS <ph id=\"ph5\">&amp;gt;</ph> AX Services and Tables <ph id=\"ph6\">&amp;gt;</ph> AX query engine <ph id=\"ph7\">&amp;gt;</ph> Database","pos":[1995,2215],"source":"Excel &gt; VSTO (.NET) Add-in &gt; Windows Communication foundation (WCF) &gt; Authentication through Active Directory (AD) &gt; AIF SOAP services on the AOS &gt; AX Services and Tables &gt; AX query engine &gt; Database"},{"pos":[2222,2249],"content":"Dynamics 365 for Operations","linkify":"Dynamics 365 for Operations","nodes":[{"content":"Dynamics 365 for Operations","pos":[0,27]}]},{"content":"Excel <ph id=\"ph1\">&amp;gt;</ph> Office Web Add-in (JS + HTML) <ph id=\"ph2\">&amp;gt;</ph> JavaScript OData API (Olingo) <ph id=\"ph3\">&amp;gt;</ph> Authentication through Azure Active Directory (AAD) <ph id=\"ph4\">&amp;gt;</ph> AX OData services on the AOS <ph id=\"ph5\">&amp;gt;</ph> AX Entities <ph id=\"ph6\">&amp;gt;</ph> AX LINQ provider <ph id=\"ph7\">&amp;gt;</ph> AX Database","pos":[2251,2473],"source":"Excel &gt; Office Web Add-in (JS + HTML) &gt; JavaScript OData API (Olingo) &gt; Authentication through Azure Active Directory (AAD) &gt; AX OData services on the AOS &gt; AX Entities &gt; AX LINQ provider &gt; AX Database"},{"pos":[2479,2502],"content":"Office Add-in explained","linkify":"Office Add-in explained","nodes":[{"content":"Office Add-in explained","pos":[0,23]}]},{"content":"The Excel Data Connector app is located in a task pane on the right side of a workbook.","pos":[2504,2591]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>2<ph id=\"ph2\">\\_</ph>Office<ept id=\"p1\">](./media/2_office.png)](./media/2_office.png)</ept> The following table describes the parts of the add-in.","pos":[2592,2705],"source":"[![2\\_Office](./media/2_office.png)](./media/2_office.png) The following table describes the parts of the add-in."},{"content":"The numbers correspond to the numbers in the preceding screen shot.","pos":[2706,2773]},{"content":"Number","pos":[2777,2783]},{"content":"Name","pos":[2786,2790]},{"content":"Description","pos":[2821,2832]},{"content":"1","pos":[3427,3428]},{"content":"Add-in primary title","pos":[3436,3456]},{"content":"The title of the add-in that is provided to the Office Web Add-ins framework.","pos":[3471,3548]},{"content":"2","pos":[3752,3753]},{"content":"Add-in secondary title","pos":[3761,3783]},{"content":"The title of the add-in that is provided by the add-in.","pos":[3796,3851]},{"content":"3","pos":[4077,4078]},{"content":"Source name","pos":[4086,4097]},{"content":"The label of the entity that provides data for the selected data table.","pos":[4121,4192]},{"content":"You can hover over the label to see the corresponding name.","pos":[4193,4252]},{"content":"4","pos":[4402,4403]},{"content":"Field name","pos":[4411,4421]},{"content":"The label of the field that provides data for the selected data table column.","pos":[4446,4523]},{"content":"You can hover over the label to see the corresponding name and type.","pos":[4524,4592]},{"content":"5","pos":[4727,4728]},{"content":"Refresh button","pos":[4736,4750]},{"content":"Refresh the data in the workbook.","pos":[4771,4804]},{"content":"6","pos":[5052,5053]},{"content":"Publish button","pos":[5061,5075]},{"content":"Publish the data changes in the workbook.","pos":[5096,5137]},{"content":"7","pos":[5377,5378]},{"content":"Design button","pos":[5386,5399]},{"content":"Open the design-time experience.","pos":[5421,5453]},{"content":"8","pos":[5702,5703]},{"content":"Status bar","pos":[5711,5721]},{"content":"The status bar provides brief temporary information alerts.","pos":[5746,5805]},{"content":"Information that is appears in the status bar also appears in the <bpt id=\"p1\">**</bpt>Messages<ept id=\"p1\">**</ept> dialog box.","pos":[5806,5896],"source":" Information that is appears in the status bar also appears in the **Messages** dialog box."},{"content":"9","pos":[6027,6028]},{"content":"Options button","pos":[6036,6050]},{"pos":[6071,6103],"content":"Open the <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> dialog box.","source":"Open the **Options** dialog box."},{"content":"10","pos":[6352,6354]},{"content":"Messages button","pos":[6361,6376]},{"content":"Open the <bpt id=\"p1\">**</bpt>Messages<ept id=\"p1\">**</ept> dialog box, which displays the information messages, warnings, and errors that the program provides to the user.","pos":[6396,6530],"source":"Open the **Messages** dialog box, which displays the information messages, warnings, and errors that the program provides to the user."},{"content":"A number sometimes appears next to the <bpt id=\"p1\">**</bpt>Messages<ept id=\"p1\">**</ept> button to provide a count of the warnings or errors that the user might be interested in.","pos":[6531,6672],"source":" A number sometimes appears next to the **Messages** button to provide a count of the warnings or errors that the user might be interested in."},{"content":"11","pos":[6677,6679]},{"content":"Excel data table containing data","pos":[6686,6718]},{"content":"The filter and sort controls in the columns headers can be used on this data.","pos":[6721,6798]},{"content":"The filters must be removed before data changes are published.","pos":[6799,6861]},{"content":"12","pos":[7002,7004]},{"content":"Office Web Add-ins menu","pos":[7011,7034]},{"content":"The Office Web Add-ins menu button provides several standard links.","pos":[7046,7113]},{"content":"The most important of the links is used to reload the add-in.","pos":[7114,7175]},{"content":"When the add-in is reloaded, it updates all the data for the workbook that is contained in tables that are associated with the add-in.","pos":[7176,7310]},{"pos":[7330,7344],"content":"Authentication","linkify":"Authentication","nodes":[{"content":"Authentication","pos":[0,14]}]},{"content":"OData sits on the same authentication stack as the server.","pos":[7346,7404]},{"content":"The add-in uses OAuth to facilitate authentication.","pos":[7405,7456]},{"pos":[7462,7489],"content":"Lookups and drop-down lists","linkify":"Lookups and drop-down lists","nodes":[{"content":"Lookups and drop-down lists","pos":[0,27]}]},{"content":"When you clicking in a table cell, any lookup, enumeration drop-down list, or date picker that is associated with that cell be shown inside the add-in, underneath the source and field information.","pos":[7491,7687]},{"content":"Any value that you select inside the add-in is put into the currently selected table cell.","pos":[7688,7778]},{"pos":[7784,7811],"content":"Adding and deleting records","linkify":"Adding and deleting records","nodes":[{"content":"Adding and deleting records","pos":[0,27]}]},{"content":"To add a record, either start typing in a row directly below a table, or use the Tab key to tab away from the last cell of the last row in the table.","pos":[7813,7962]},{"content":"To delete a record, select the row by clicking the row label (1, 2, 3, and so on), and delete all the cells in that row.","pos":[7963,8083]},{"content":"To publish the changes, click <bpt id=\"p1\">**</bpt>Publish<ept id=\"p1\">**</ept>.","pos":[8084,8126],"source":" To publish the changes, click **Publish**."},{"content":"The <bpt id=\"p1\">**</bpt>Messages<ept id=\"p1\">**</ept> dialog box show how many records were added, edited, and deleted.","pos":[8127,8209],"source":" The **Messages** dialog box show how many records were added, edited, and deleted."},{"pos":[8214,8231],"content":"Workbook Designer","linkify":"Workbook Designer","nodes":[{"content":"Workbook Designer","pos":[0,17]}]},{"content":"You can use the <bpt id=\"p1\">**</bpt>Workbook Designer<ept id=\"p1\">**</ept> page to design an editable custom export workbook that contains an entity and a set of fields.","pos":[8232,8364],"source":"You can use the **Workbook Designer** page to design an editable custom export workbook that contains an entity and a set of fields."},{"content":"To open the <bpt id=\"p1\">**</bpt>Workbook Designer<ept id=\"p1\">**</ept> (<bpt id=\"p2\">**</bpt>ExportToExcelWorkbookDesigner<ept id=\"p2\">**</ept>) page, click <bpt id=\"p3\">**</bpt>Common <ph id=\"ph1\">&amp;gt;</ph> Common <ph id=\"ph2\">&amp;gt;</ph> Office Integration <ph id=\"ph3\">&amp;gt;</ph> Excel workbook designer<ept id=\"p3\">**</ept>.","pos":[8365,8523],"source":" To open the **Workbook Designer** (**ExportToExcelWorkbookDesigner**) page, click **Common &gt; Common &gt; Office Integration &gt; Excel workbook designer**."},{"content":"Before you can publish data edits, all the key fields of the entity must be in the Excel table.","pos":[8524,8619]},{"content":"Key fields have a key symbol next to them.","pos":[8620,8662]},{"content":"To successfully create or update a record, must have all the mandatory fields in the Excel table.","pos":[8663,8760]},{"content":"Mandatory fields have an asterisk (<ph id=\"ph1\">\\*</ph>) next to them.","pos":[8761,8813],"source":" Mandatory fields have an asterisk (\\*) next to them."},{"pos":[8816,8874],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>3<ph id=\"ph2\">\\_</ph>Office<ept id=\"p1\">](./media/3_office.png)](./media/3_office.png)</ept>","source":"[![3\\_Office](./media/3_office.png)](./media/3_office.png)"},{"pos":[8877,8954],"content":"To retrieve the resulting workbook, click <bpt id=\"p1\">**</bpt>Create workbook<ept id=\"p1\">**</ept> in the app bar.","source":"To retrieve the resulting workbook, click **Create workbook** in the app bar."},{"content":"Click <bpt id=\"p1\">**</bpt>View related form<ept id=\"p1\">**</ept> to see the data that the entity exposes.","pos":[8957,9025],"source":"Click **View related form** to see the data that the entity exposes."},{"content":"This button is only enabled for entities that have a <bpt id=\"p1\">**</bpt>FormRef<ept id=\"p1\">**</ept> property value.","pos":[9026,9106],"source":" This button is only enabled for entities that have a **FormRef** property value."},{"pos":[9111,9121],"content":"Export API","linkify":"Export API","nodes":[{"content":"Export API","pos":[0,10]}]},{"pos":[9126,9178],"content":"The Open in Microsoft Office menu and static exports","linkify":"The Open in Microsoft Office menu and static exports","nodes":[{"content":"The Open in Microsoft Office menu and static exports","pos":[0,52]}]},{"content":"The <bpt id=\"p1\">**</bpt>Open in Microsoft Office<ept id=\"p1\">**</ept> menu is available on any page that has a data source.","pos":[9180,9266],"source":"The **Open in Microsoft Office** menu is available on any page that has a data source."},{"content":"The <bpt id=\"p1\">**</bpt>Open in Microsoft Office<ept id=\"p1\">**</ept> menu provides three types of options:","pos":[9267,9337],"source":" The **Open in Microsoft Office** menu provides three types of options:"},{"content":"<bpt id=\"p1\">**</bpt>Open in Excel<ept id=\"p1\">**</ept> options that are automatically added for entities and entity-based templates that share the same root data source as the current page.","pos":[9343,9495],"source":"**Open in Excel** options that are automatically added for entities and entity-based templates that share the same root data source as the current page."},{"content":"These options make it easier to read data into Excel and publish data changes back to the OData services for those entities.","pos":[9496,9620]},{"content":"<bpt id=\"p1\">**</bpt>Open in Excel<ept id=\"p1\">**</ept> options that are manually added via the Export API.","pos":[9625,9694],"source":"**Open in Excel** options that are manually added via the Export API."},{"content":"These options can be custom-generated exports or custom template exports.","pos":[9695,9768]},{"content":"<bpt id=\"p1\">**</bpt>Export to Excel<ept id=\"p1\">**</ept> options that are automatically added for all the visible grids on the page.","pos":[9773,9868],"source":"**Export to Excel** options that are automatically added for all the visible grids on the page."},{"content":"These options are static exports of data from a grid.","pos":[9869,9922]},{"pos":[9928,9938],"content":"Export API","linkify":"Export API","nodes":[{"content":"Export API","pos":[0,10]}]},{"content":"The Export API is used on a page to provide custom export options for that page.","pos":[9940,10020]},{"content":"The Export API consists of three parts that let a developer perform the following tasks:","pos":[10021,10109]},{"pos":[10115,10199],"content":"Provide a set of custom export options that appear on the <bpt id=\"p1\">**</bpt>Export<ept id=\"p1\">**</ept> menu on a page.","source":"Provide a set of custom export options that appear on the **Export** menu on a page."},{"content":"Provide the context for a custom-generated export.","pos":[10204,10254]},{"content":"Provide the template for a custom template export.","pos":[10259,10309]},{"pos":[10315,10339],"content":"Custom-generated exports","linkify":"Custom-generated exports","nodes":[{"content":"Custom-generated exports","pos":[0,24]}]},{"content":"To provide a custom-generated export, implement the ExporttoExcelIGeneratedCustomExport interface.","pos":[10341,10439]},{"content":"Here is an example.","pos":[10440,10459]},{"content":"Add an export option by implementing the <bpt id=\"p1\">**</bpt>getExportOptions<ept id=\"p1\">**</ept> method and adding an export option to the list that is returned.","pos":[10553,10679],"source":"Add an export option by implementing the **getExportOptions** method and adding an export option to the list that is returned."},{"content":"Here is an example.","pos":[10680,10699]},{"content":"Provide the export context by implementing the <bpt id=\"p1\">**</bpt>getDataEntityContext<ept id=\"p1\">**</ept> method and returning an <bpt id=\"p2\">**</bpt>ExportToExcelDataEntityContext<ept id=\"p2\">**</ept> for the appropriate <bpt id=\"p3\">**</bpt>exportOption<ept id=\"p3\">**</ept> after the <bpt id=\"p4\">**</bpt>ExportToExcelExportOption.id<ept id=\"p4\">**</ept> method is checked.","pos":[11086,11315],"source":"Provide the export context by implementing the **getDataEntityContext** method and returning an **ExportToExcelDataEntityContext** for the appropriate **exportOption** after the **ExportToExcelExportOption.id** method is checked."},{"content":"The context specifies the data entity and fields to include in the workbook that is generated.","pos":[11316,11410]},{"content":"Here is an example.","pos":[11411,11430]},{"pos":[11868,11891],"content":"Custom template exports","linkify":"Custom template exports","nodes":[{"content":"Custom template exports","pos":[0,23]}]},{"content":"To provide a custom template export, implement the ExportToExcelITemplateCustomExport interface.","pos":[11893,11989]},{"content":"Here is an example.","pos":[11990,12009]},{"content":"Add an export option by implementing the <bpt id=\"p1\">**</bpt>getExportOptions<ept id=\"p1\">**</ept> method and adding an export option to the list that is returned.","pos":[12137,12263],"source":"Add an export option by implementing the **getExportOptions** method and adding an export option to the list that is returned."},{"content":"Here is an example.","pos":[12264,12283]},{"content":"Provide the export template by implementing the <bpt id=\"p1\">**</bpt>getTemplate<ept id=\"p1\">**</ept> method and returning a <bpt id=\"p2\">**</bpt>System.IO.Stream<ept id=\"p2\">**</ept> for the appropriate <bpt id=\"p3\">**</bpt>exportOption<ept id=\"p3\">**</ept> after the <bpt id=\"p4\">**</bpt>ExportToExcelExportOption.id<ept id=\"p4\">**</ept> method is checked.","pos":[12691,12897],"source":"Provide the export template by implementing the **getTemplate** method and returning a **System.IO.Stream** for the appropriate **exportOption** after the **ExportToExcelExportOption.id** method is checked."},{"content":"Templates can be stored as Application Object Tree (AOT) resources and retrieved at run time by using the <bpt id=\"p1\">**</bpt>Microsoft.Dynamics.Ax.Xpp.MetadataSupport::GetResourceContentStream<ept id=\"p1\">**</ept> method.","pos":[12898,13083],"source":" Templates can be stored as Application Object Tree (AOT) resources and retrieved at run time by using the **Microsoft.Dynamics.Ax.Xpp.MetadataSupport::GetResourceContentStream** method."},{"content":"Here is an example.","pos":[13084,13103]},{"content":"You must also implement the <bpt id=\"p1\">**</bpt>updateTemplateSettings<ept id=\"p1\">**</ept> method to satisfy the interface.","pos":[13463,13550],"source":"You must also implement the **updateTemplateSettings** method to satisfy the interface."},{"content":"Eventually, this method will be used to provide filtering information, but that capability is still under development.","pos":[13551,13669]},{"content":"Here is an example.","pos":[13670,13689]},{"pos":[13886,13905],"content":"Document management","linkify":"Document management","nodes":[{"content":"Document management","pos":[0,19]}]},{"content":"Document management supports saving record attachments in Azure Blob storage and SharePoint Online.","pos":[13906,14005]},{"content":"Database storage is deprecated.","pos":[14006,14037]},{"content":"Azure Blob storage is equivalent to storage in the database since documents can only be accessed through the application and it provides the added benefit of providing storage that doesn't negatively affect the performance of the database.","pos":[14038,14277]},{"content":"Azure blob storage is the default and works immediately.","pos":[14278,14334]},{"content":"SharePoint storage will work immediately if you have an O365 license since we auto-discover the SharePoint tenant e.g. a user on the TenantA.onmicrosoft.com O365/AAD tenant gets TenantA.sharepoint.com as the SharePoint site.","pos":[14335,14559]},{"content":"If document management has been turned off by the user, turn it on by clicking <bpt id=\"p1\">**</bpt>Options <ph id=\"ph1\">&amp;gt;</ph> General <ph id=\"ph2\">&amp;gt;</ph> Miscellaneous<ept id=\"p1\">**</ept> and setting <bpt id=\"p2\">**</bpt>Document handling active<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>Yes<ept id=\"p3\">**</ept>.","pos":[14560,14735],"source":" If document management has been turned off by the user, turn it on by clicking **Options &gt; General &gt; Miscellaneous** and setting **Document handling active** to **Yes**."},{"pos":[14738,14796],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>4<ph id=\"ph2\">\\_</ph>Office<ept id=\"p1\">](./media/4_office.png)](./media/4_office.png)</ept>","source":"[![4\\_Office](./media/4_office.png)](./media/4_office.png)"},{"pos":[14799,14891],"content":"On any page that has data, an <bpt id=\"p1\">**</bpt>Attach<ept id=\"p1\">**</ept> button will be available in the upper-right corner.","source":"On any page that has data, an **Attach** button will be available in the upper-right corner."},{"pos":[14894,14952],"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>5<ph id=\"ph2\">\\_</ph>Office<ept id=\"p1\">](./media/5_office.png)](./media/5_office.png)</ept>","source":"[![5\\_Office](./media/5_office.png)](./media/5_office.png)"},{"content":"The <bpt id=\"p1\">**</bpt>Attachments<ept id=\"p1\">**</ept> page provides a view of the attachments (documents) that are associated with the record that was selected on the previous page.","pos":[14955,15102],"source":"The **Attachments** page provides a view of the attachments (documents) that are associated with the record that was selected on the previous page."},{"content":"You can add new attachments to the record by clicking the <bpt id=\"p1\">**</bpt>New<ept id=\"p1\">**</ept> button (<bpt id=\"p2\">**</bpt><ph id=\"ph1\">+</ph><ept id=\"p2\">**</ept>) in the app bar.","pos":[15103,15199],"source":" You can add new attachments to the record by clicking the **New** button (**+**) in the app bar."},{"content":"For the <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> and ****Image**** document types, you will be prompted to provide the associated file.","pos":[15200,15303],"source":" For the **File** and ****Image**** document types, you will be prompted to provide the associated file."},{"pos":[15309,15325],"content":"Document preview","linkify":"Document preview","nodes":[{"content":"Document preview","pos":[0,16]}]},{"content":"A preview for supported file types is provided on the <bpt id=\"p1\">**</bpt>Preview<ept id=\"p1\">**</ept> FastTab.","pos":[15327,15401],"source":"A preview for supported file types is provided on the **Preview** FastTab."},{"content":"Basic document types, such as PNG images and text files, are supported by default.","pos":[15402,15484]},{"content":"Office document types, such as Microsoft Word, Excel, and PowerPoint files, must use a production Office Web Apps Server, which might not be available in a OneBox configuration.","pos":[15485,15662]},{"pos":[15667,15693],"content":"Frequently asked questions","linkify":"Frequently asked questions","nodes":[{"content":"Frequently asked questions","pos":[0,26]}]},{"pos":[15698,15714],"content":"Office Licensing","linkify":"Office Licensing","nodes":[{"content":"Office Licensing","pos":[0,16]}]},{"pos":[15721,15760],"content":"What Office 365 licenses are available?","linkify":"What Office 365 licenses are available?","nodes":[{"content":"What Office 365 licenses are available?","pos":[0,39]}]},{"content":"There are lots of <bpt id=\"p1\">[</bpt>Office 365 license options<ept id=\"p1\">](https://products.office.com/en-us/business/compare-office-365-for-business-plans)</ept>.","pos":[15762,15891],"source":"There are lots of [Office 365 license options](https://products.office.com/en-us/business/compare-office-365-for-business-plans)."},{"content":"You should select the license that makes sense for your organization.","pos":[15892,15961]},{"pos":[15968,16075],"content":"After purchasing an Office 365 license, what needs to be done to set up SharePoint storage for attachments?","linkify":"After purchasing an Office 365 license, what needs to be done to set up SharePoint storage for attachments?","nodes":[{"content":"After purchasing an Office 365 license, what needs to be done to set up SharePoint storage for attachments?","pos":[0,107]}]},{"content":"Open the Document Parameters form and ensure that the SharePoint server has been automatically discovered and set.","pos":[16077,16191]},{"content":"Now open or create a Document Type, set the Document Type's location to \"SharePoint\" and select the folder that the files should be stored in.","pos":[16192,16334]},{"pos":[16336,16344],"content":"See also","linkify":"See also","nodes":[{"content":"See also","pos":[0,8]}]},{"pos":[16355,16428],"content":"<bpt id=\"p1\">[</bpt>Office Integration lab and walkthroughs<ept id=\"p1\">](office-integration-tutorial.md)</ept>","source":"[Office Integration lab and walkthroughs](office-integration-tutorial.md)"},{"pos":[16430,16505],"content":"<bpt id=\"p1\">[</bpt>Office Integration Troubleshooting<ept id=\"p1\">](office-integration-troubleshooting.md)</ept>","source":"[Office Integration Troubleshooting](office-integration-troubleshooting.md)"},{"pos":[16507,16605],"content":"<bpt id=\"p1\">[</bpt>Application stack and server architecture<ept id=\"p1\">](../dev-tools/application-stack-server-architecture.md)</ept>","source":"[Application stack and server architecture](../dev-tools/application-stack-server-architecture.md)"}]}