{"nodes":[{"pos":[32,75],"content":"Customize the Open in Microsoft Office menu","needQuote":true,"needEscape":true,"nodes":[{"content":"Customize the Open in Microsoft Office menu","pos":[0,43]}]},{"pos":[89,278],"content":"Most pages include an Open in Microsoft Office menu. This topics provides information about the Open in Office menu, and explains how customize it by adding, removing, and changing options.","needQuote":true,"needEscape":true,"nodes":[{"content":"Most pages include an Open in Microsoft Office menu. This topics provides information about the Open in Office menu, and explains how customize it by adding, removing, and changing options.","pos":[0,189],"nodes":[{"content":"Most pages include an Open in Microsoft Office menu.","pos":[0,52]},{"content":"This topics provides information about the Open in Office menu, and explains how customize it by adding, removing, and changing options.","pos":[53,189]}]}]},{"pos":[794,837],"content":"Customize the Open in Microsoft Office menu","linkify":"Customize the Open in Microsoft Office menu","nodes":[{"content":"Customize the Open in Microsoft Office menu","pos":[0,43]}]},{"content":"Most pages include an Open in Microsoft Office menu.","pos":[839,891]},{"content":"This topics provides information about the Open in Office menu, and explains how customize it by adding, removing, and changing options.","pos":[892,1028]},{"pos":[1030,1038],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"The <bpt id=\"p1\">**</bpt>Open in Microsoft Office<ept id=\"p1\">**</ept> menu button (<bpt id=\"p2\">**</bpt>Open in Office<ept id=\"p2\">**</ept> menu) is a system-defined button that appears on pages.","pos":[1049,1169],"source":"The **Open in Microsoft Office** menu button (**Open in Office** menu) is a system-defined button that appears on pages."},{"content":"The <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu contains menu items that let you export data to various Office products, such as Microsoft Excel and Microsoft Word.","pos":[1170,1314],"source":" The **Open in Office** menu contains menu items that let you export data to various Office products, such as Microsoft Excel and Microsoft Word."},{"content":"The following table describes the menu items on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu.","pos":[1315,1391],"source":" The following table describes the menu items on the **Open in Office** menu."},{"content":"Menu item","pos":[1395,1404]},{"content":"Description","pos":[1413,1424]},{"content":"Export to Excel","pos":[1945,1960]},{"content":"The data is exported to an Excel workbook.","pos":[1963,2005]},{"content":"The workbook contains no references back to Microsoft Dynamics 365 for Operations, and the data can't be refreshed.","pos":[2006,2121]},{"content":"Export to Word","pos":[2220,2234]},{"content":"The data is exported to a Word document.","pos":[2238,2278]},{"content":"The document contains no references back to Dynamics 365 for Operations, and the data can't be refreshed.","pos":[2279,2384]},{"content":"Open in Excel","pos":[2495,2508]},{"content":"A workbook is created that contains the Microsoft Dynamics Office add-in.","pos":[2513,2586]},{"content":"The workbook contains a reference back to Dynamics 365 for Operations, and the data can be refreshed, updated, and published from the Data Connector that is hosted in the add-in.","pos":[2587,2765]},{"pos":[2772,2823],"content":"How menu items are added to the Open in Office menu","linkify":"How menu items are added to the Open in Office menu","nodes":[{"content":"How menu items are added to the Open in Office menu","pos":[0,51]}]},{"pos":[2824,2908],"content":"The export options are added to the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu in the following manner:","source":"The export options are added to the **Open in Office** menu in the following manner:"},{"pos":[2914,2991],"content":"In the <bpt id=\"p1\">**</bpt>Export to Excel<ept id=\"p1\">**</ept> group, a menu item is added for each visible grid.","source":"In the **Export to Excel** group, a menu item is added for each visible grid."},{"content":"For each root data source on the page, the set of data entities that have the same root data source is determined.","pos":[2996,3110]},{"content":"For each of these data entities, the following menu items are added:","pos":[3111,3179]},{"pos":[3188,3281],"content":"In the <bpt id=\"p1\">**</bpt>Open in Excel<ept id=\"p1\">**</ept> group, a menu item is added for a default export of the data entity.","source":"In the **Open in Excel** group, a menu item is added for a default export of the data entity."},{"pos":[3290,3493],"content":"In the <bpt id=\"p1\">**</bpt>Open in Excel<ept id=\"p1\">**</ept> group, a menu item is added for each Document Template record of the <bpt id=\"p2\">**</bpt>Excel<ept id=\"p2\">**</ept> type that has the same root data entity and is marked for inclusion on the <bpt id=\"p3\">**</bpt>Open in Office<ept id=\"p3\">**</ept> menu.","source":"In the **Open in Excel** group, a menu item is added for each Document Template record of the **Excel** type that has the same root data entity and is marked for inclusion on the **Open in Office** menu."},{"pos":[3502,3705],"content":"In the <bpt id=\"p1\">**</bpt>Export to Word<ept id=\"p1\">**</ept> group, a menu item is added for each Document Template record of the <bpt id=\"p2\">**</bpt>Word<ept id=\"p2\">**</ept> type that has the same root data entity and is marked for inclusion on the <bpt id=\"p3\">**</bpt>Open in Office<ept id=\"p3\">**</ept> menu.","source":"In the **Export to Word** group, a menu item is added for each Document Template record of the **Word** type that has the same root data entity and is marked for inclusion on the **Open in Office** menu."},{"pos":[3710,3725],"content":"Default exports","linkify":"Default exports","nodes":[{"content":"Default exports","pos":[0,15]}]},{"content":"The <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu provides a default export for each data entity.","pos":[3726,3801],"source":"The **Open in Office** menu provides a default export for each data entity."},{"content":"This export includes all the fields in the <bpt id=\"p1\">**</bpt>AutoReport<ept id=\"p1\">**</ept> group on the data entity.","pos":[3802,3885],"source":" This export includes all the fields in the **AutoReport** group on the data entity."},{"content":"If <bpt id=\"p1\">**</bpt>SaveDataPerCompany<ept id=\"p1\">**</ept> is set to <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept> for the data entity, a filter is applied to limit the data to the current company.","pos":[3886,4012],"source":" If **SaveDataPerCompany** is set to **Yes** for the data entity, a filter is applied to limit the data to the current company."},{"pos":[4017,4035],"content":"Document templates","linkify":"Document templates","nodes":[{"content":"Document templates","pos":[0,18]}]},{"content":"Document templates can be added from the <bpt id=\"p1\">**</bpt>Document templates<ept id=\"p1\">**</ept> page.","pos":[4036,4105],"source":"Document templates can be added from the **Document templates** page."},{"content":"Several fields that are associated with each Document Template record control the behavior of that template on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu.","pos":[4106,4245],"source":" Several fields that are associated with each Document Template record control the behavior of that template on the **Open in Office** menu."},{"content":"Field","pos":[4249,4254]},{"content":"Description","pos":[4272,4283]},{"content":"Root data entity","pos":[4631,4647]},{"content":"The root data entity of the template.","pos":[4654,4691]},{"content":"The root data entity is used to determine which pages the template can be included on.","pos":[4692,4778]},{"content":"List in Office menu","pos":[4822,4841]},{"content":"If this field is selected, the template will be included on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu on applicable pages.","pos":[4845,4953],"source":"If this field is selected, the template will be included on the **Open in Office** menu on applicable pages."},{"content":"(The applicable pages depend on the root data entity).","pos":[4954,5008]},{"content":"Apply record filter","pos":[5013,5032]},{"content":"If this field is selected, the data will be filtered, based on the record that is currently selected on the page.","pos":[5036,5149]},{"content":"Apply company filter","pos":[5204,5224]},{"content":"If this field is selected, the data will be filtered, based on the current company.","pos":[5227,5310]},{"pos":[5398,5433],"content":"Trimmed template columns and fields","linkify":"Trimmed template columns and fields","nodes":[{"content":"Trimmed template columns and fields","pos":[0,35]}]},{"content":"For Excel templates that are included on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu, columns and fields will be trimmed from the workbook, based on the configuration keys that are applied to the system and the applicable country/region context.","pos":[5435,5664],"source":"For Excel templates that are included on the **Open in Office** menu, columns and fields will be trimmed from the workbook, based on the configuration keys that are applied to the system and the applicable country/region context."},{"content":"If a configuration key is associated with a column or field in the workbook, the column or field will be removed if the configuration key is disabled.","pos":[5665,5815]},{"content":"If a set of country/region codes is associated with the column or field in the workbook, the column or field will be removed if the country/region code isn't in scope.","pos":[5816,5983]},{"pos":[5988,6021],"content":"Open in Office menu customization","linkify":"Open in Office menu customization","nodes":[{"content":"Open in Office menu customization","pos":[0,33]}]},{"content":"There are several methods for customizing the content that appears on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu on a given page.","pos":[6022,6136],"source":"There are several methods for customizing the content that appears on the **Open in Office** menu on a given page."},{"content":"For example, you can customize the content statically through metadata properties on model element and code attributes.","pos":[6137,6256]},{"content":"However, customization via code gives you the finest level of control.","pos":[6257,6327]},{"content":"In code, you can either implement one or more interfaces on a page, or use extensions and event subscriptions.","pos":[6328,6438]},{"content":"The following sections describe the customization scenarios that are most often used.","pos":[6439,6524]},{"pos":[6530,6582],"content":"Modifying the Open in Office menu through interfaces","linkify":"Modifying the Open in Office menu through interfaces","nodes":[{"content":"Modifying the Open in Office menu through interfaces","pos":[0,52]}]},{"content":"If you must modify a page that you own, interfaces are the most appropriate customization method, because they give access to all private members of the page and allow for deeper customization.","pos":[6584,6777]},{"content":"You can apply the following interfaces to the code for a page.","pos":[6778,6840]},{"content":"Interface","pos":[6844,6853]},{"content":"Description","pos":[6885,6896]},{"content":"OfficeIMenuCustomizer","pos":[7156,7177]},{"content":"Use this interface to modify the set of data entities that is considered for a page and add custom menu items.","pos":[7197,7307]},{"content":"OfficeIGeneratedWorkbookCustomExporter","pos":[7312,7350]},{"content":"Use this interface to do a custom export of a workbook that is generated at run time.","pos":[7353,7438]},{"content":"OfficeITemplateCustomExporter","pos":[7468,7497]},{"content":"Use this interface to do a custom export that is based on a Document Template record.","pos":[7509,7594]},{"pos":[7627,7703],"content":"Modifying the Open in Office menu through extensions and event subscriptions","linkify":"Modifying the Open in Office menu through extensions and event subscriptions","nodes":[{"content":"Modifying the Open in Office menu through extensions and event subscriptions","pos":[0,76]}]},{"content":"If you must modify a page that you don't own, you should avoid using interfaces, because that approach will require over-layering.","pos":[7705,7835]},{"content":"Instead, you should do the customization through extensions and event subscriptions.","pos":[7836,7920]},{"content":"To use this approach, implement an extension class that subscribes to the <bpt id=\"p1\">**</bpt>OnIntializing<ept id=\"p1\">**</ept> event of the page that you're customizing.","pos":[7921,8055],"source":" To use this approach, implement an extension class that subscribes to the **OnIntializing** event of the page that you're customizing."},{"content":"From this event handler, get the <bpt id=\"p1\">**</bpt>OfficeFormRunHelper<ept id=\"p1\">**</ept> for the page, and subscribe to its <bpt id=\"p2\">**</bpt>OfficeMenuInitializing<ept id=\"p2\">**</ept> event.","pos":[8056,8181],"source":" From this event handler, get the **OfficeFormRunHelper** for the page, and subscribe to its **OfficeMenuInitializing** event."},{"content":"The following example shows sample code for this approach.","pos":[8182,8240]},{"pos":[9105,9136],"content":"Typical customization scenarios","linkify":"Typical customization scenarios","nodes":[{"content":"Typical customization scenarios","pos":[0,31]}]},{"pos":[9137,9271],"content":"The following examples assume that the <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\_</ph>menuOptions<ept id=\"p1\">**</ept> variable contains the <bpt id=\"p2\">**</bpt>OfficeMenuOptions<ept id=\"p2\">**</ept> instance that you're customizing.","source":"The following examples assume that the **\\_menuOptions** variable contains the **OfficeMenuOptions** instance that you're customizing."},{"pos":[9277,9341],"content":"Modifying the set of data entities that is considered for a page","linkify":"Modifying the set of data entities that is considered for a page","nodes":[{"content":"Modifying the set of data entities that is considered for a page","pos":[0,64]}]},{"content":"Many of the menu items on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu are added automatically, based on the data entities that are considered for the page.","pos":[9343,9482],"source":"Many of the menu items on the **Open in Office** menu are added automatically, based on the data entities that are considered for the page."},{"content":"However, in some cases, the algorithm that is used to determine the set of data entities might not determine the correct set.","pos":[9483,9608]},{"content":"To modify the set of data entities that is considered for the page, you can use the <bpt id=\"p1\">**</bpt>OfficeMenuOptions<ept id=\"p1\">**</ept> that is available from either the <bpt id=\"p2\">**</bpt>OfficeIMenuCustomizer.customizeMenuOptions<ept id=\"p2\">**</ept> method or the <bpt id=\"p3\">**</bpt>OfficeFormRunHelper.OfficeMenuInitializing<ept id=\"p3\">**</ept> delegate.","pos":[9609,9866],"source":" To modify the set of data entities that is considered for the page, you can use the **OfficeMenuOptions** that is available from either the **OfficeIMenuCustomizer.customizeMenuOptions** method or the **OfficeFormRunHelper.OfficeMenuInitializing** delegate."},{"pos":[10580,10648],"content":"Specifying the default data entity–related options that are included","linkify":"Specifying the default data entity–related options that are included","nodes":[{"content":"Specifying the default data entity–related options that are included","pos":[0,68]}]},{"pos":[10650,10815],"content":"The <bpt id=\"p1\">**</bpt>OfficeMenuDataEntityOptions<ept id=\"p1\">**</ept> class lets you specify whether to include a menu item for a default export or a menu item that is related to a document template.","source":"The **OfficeMenuDataEntityOptions** class lets you specify whether to include a menu item for a default export or a menu item that is related to a document template."},{"pos":[11417,11473],"content":"Adding a custom export menu item – Generating a workbook","linkify":"Adding a custom export menu item – Generating a workbook","nodes":[{"content":"Adding a custom export menu item – Generating a workbook","pos":[0,56]}]},{"content":"To explicitly add a menu item, you must add it to the <bpt id=\"p1\">**</bpt>OfficeMenuOptions.customMenuItems()<ept id=\"p1\">**</ept> list.","pos":[11475,11574],"source":"To explicitly add a menu item, you must add it to the **OfficeMenuOptions.customMenuItems()** list."},{"content":"To add a menu item that corresponds to a workbook that is generated at run time, use an <bpt id=\"p1\">**</bpt>OfficeGeneratedExportMenuItem<ept id=\"p1\">**</ept>.","pos":[11575,11697],"source":" To add a menu item that corresponds to a workbook that is generated at run time, use an **OfficeGeneratedExportMenuItem**."},{"content":"To define what is actually exported, use an <bpt id=\"p1\">**</bpt>ExportToExcelDataEntityContext<ept id=\"p1\">**</ept>.","pos":[11934,12013],"source":"To define what is actually exported, use an **ExportToExcelDataEntityContext**."},{"content":"The method for specifying the <bpt id=\"p1\">**</bpt>ExportToExcelDataEntityContext<ept id=\"p1\">**</ept> depends on whether you're using interfaces or extensions and event subscriptions to customize the <bpt id=\"p2\">**</bpt>Open in Office<ept id=\"p2\">**</ept> menu.","pos":[12014,12201],"source":" The method for specifying the **ExportToExcelDataEntityContext** depends on whether you're using interfaces or extensions and event subscriptions to customize the **Open in Office** menu."},{"pos":[12208,12224],"content":"Using interfaces","linkify":"Using interfaces","nodes":[{"content":"Using interfaces","pos":[0,16]}]},{"pos":[12226,12350],"content":"If you're using interfaces, you must implement the <bpt id=\"p1\">**</bpt>OfficeIGeneratedWorkbookCustomExporter.getDataEntityContext()<ept id=\"p1\">**</ept> method.","source":"If you're using interfaces, you must implement the **OfficeIGeneratedWorkbookCustomExporter.getDataEntityContext()** method."},{"pos":[12760,12800],"content":"Using extensions and event subscriptions","linkify":"Using extensions and event subscriptions","nodes":[{"content":"Using extensions and event subscriptions","pos":[0,40]}]},{"content":"If you're using extensions and event subscriptions, the <bpt id=\"p1\">**</bpt>OfficeGeneratedExportMenuItem.getDataEntityContext<ept id=\"p1\">**</ept> delegate should be subscribed to before you add the menu item to the <bpt id=\"p2\">**</bpt>OfficeMenuOptions.customMenuItems()<ept id=\"p2\">**</ept> list.","pos":[12802,13027],"source":"If you're using extensions and event subscriptions, the **OfficeGeneratedExportMenuItem.getDataEntityContext** delegate should be subscribed to before you add the menu item to the **OfficeMenuOptions.customMenuItems()** list."},{"content":"The code for the event handler should resemble the preceding code for the interface.","pos":[13028,13112]},{"content":"The following example shows how to do the event subscription.","pos":[13113,13174]},{"pos":[13279,13344],"content":"Adding a custom export menu item – Specifying a document template","linkify":"Adding a custom export menu item – Specifying a document template","nodes":[{"content":"Adding a custom export menu item – Specifying a document template","pos":[0,65]}]},{"content":"To explicitly add a menu item, you must add it to the <bpt id=\"p1\">**</bpt>OfficeMenuOptions.customMenuItems()<ept id=\"p1\">**</ept> list.","pos":[13346,13445],"source":"To explicitly add a menu item, you must add it to the **OfficeMenuOptions.customMenuItems()** list."},{"content":"To add a menu item that corresponds to a Document Template record, use an <bpt id=\"p1\">**</bpt>OfficeTemplateExportMenuItem<ept id=\"p1\">**</ept>.","pos":[13446,13553],"source":" To add a menu item that corresponds to a Document Template record, use an **OfficeTemplateExportMenuItem**."},{"content":"To modify the template at run time, you can supply a set of initial filters.","pos":[13771,13847]},{"content":"These filters will replace any filters in the template for the specified data entities.","pos":[13848,13935]},{"content":"Additionally, you can modify filters and specify many settings by using <bpt id=\"p1\">**</bpt>WorkbookSettingsManager<ept id=\"p1\">**</ept>.","pos":[13936,14036],"source":" Additionally, you can modify filters and specify many settings by using **WorkbookSettingsManager**."},{"content":"The following sections show examples.","pos":[14037,14074]},{"pos":[14081,14097],"content":"Using interfaces","linkify":"Using interfaces","nodes":[{"content":"Using interfaces","pos":[0,16]}]},{"pos":[14099,14283],"content":"If you're using interfaces, you must implement the <bpt id=\"p1\">**</bpt>OfficeITemplateCustomExporter.getInitialTemplateFilters()<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>OfficeITemplateCustomExporter.updateTemplateSettings()<ept id=\"p2\">**</ept> methods.","source":"If you're using interfaces, you must implement the **OfficeITemplateCustomExporter.getInitialTemplateFilters()** and **OfficeITemplateCustomExporter.updateTemplateSettings()** methods."},{"pos":[15852,15892],"content":"Using extensions and event subscriptions","linkify":"Using extensions and event subscriptions","nodes":[{"content":"Using extensions and event subscriptions","pos":[0,40]}]},{"content":"If you're using extensions and event subscriptions, the <bpt id=\"p1\">**</bpt>OfficeTemplateExportMenuItem.getInitialTemplateFilters<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>OfficeTemplateExportMenuItem.updateTemplateSettings<ept id=\"p2\">**</ept> delegates should be subscribed to before you add the menu item to the <bpt id=\"p3\">**</bpt>OfficeMenuOptions.customMenuItems()<ept id=\"p3\">**</ept> list.","pos":[15894,16184],"source":"If you're using extensions and event subscriptions, the **OfficeTemplateExportMenuItem.getInitialTemplateFilters** and **OfficeTemplateExportMenuItem.updateTemplateSettings** delegates should be subscribed to before you add the menu item to the **OfficeMenuOptions.customMenuItems()** list."},{"content":"The code for the event handlers should resemble the preceding code for the interface.","pos":[16185,16270]},{"content":"The following example shows how to do the event subscription.","pos":[16271,16332]},{"pos":[16547,16572],"content":"Additional customizations","linkify":"Additional customizations","nodes":[{"content":"Additional customizations","pos":[0,25]}]},{"pos":[16573,16730],"content":"The following customizations let you modify the contents of the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu for a page without using interfaces or extensions and event handlers.","source":"The following customizations let you modify the contents of the **Open in Office** menu for a page without using interfaces or extensions and event handlers."},{"pos":[16736,16784],"content":"Removing an Export to Excel menu item for a grid","linkify":"Removing an Export to Excel menu item for a grid","nodes":[{"content":"Removing an Export to Excel menu item for a grid","pos":[0,48]}]},{"content":"On the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu, the <bpt id=\"p2\">**</bpt>Export to Excel<ept id=\"p2\">**</ept> group will contain a menu item for each visible grid.","pos":[16786,16895],"source":"On the **Open in Office** menu, the **Export to Excel** group will contain a menu item for each visible grid."},{"content":"To remove a grid from the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu, set the <bpt id=\"p2\">**</bpt>ExportAllowed<ept id=\"p2\">**</ept> metadata property on the grid to <bpt id=\"p3\">**</bpt>No<ept id=\"p3\">**</ept>.","pos":[16896,17013],"source":" To remove a grid from the **Open in Office** menu, set the **ExportAllowed** metadata property on the grid to **No**."},{"content":"After you make this change, users won't be able to export the grid by using the shortcut menu for the grid.","pos":[17014,17121]},{"pos":[17127,17175],"content":"Renaming an Export to Excel menu item for a grid","linkify":"Renaming an Export to Excel menu item for a grid","nodes":[{"content":"Renaming an Export to Excel menu item for a grid","pos":[0,48]}]},{"pos":[17177,17327],"content":"To rename the <bpt id=\"p1\">**</bpt>Export to Excel<ept id=\"p1\">**</ept> menu item that is related to a grid, set the <bpt id=\"p2\">**</bpt>ExportLabel<ept id=\"p2\">**</ept> metadata property on the grid to the appropriate label.","source":"To rename the **Export to Excel** menu item that is related to a grid, set the **ExportLabel** metadata property on the grid to the appropriate label."},{"pos":[17333,17389],"content":"Removing all menu items for a data entity from all pages","linkify":"Removing all menu items for a data entity from all pages","nodes":[{"content":"Removing all menu items for a data entity from all pages","pos":[0,56]}]},{"content":"Integration scenarios require that some data entities be publicly available via the OData Service.","pos":[17391,17489]},{"content":"However, it isn't always appropriate that these data entities appear on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu by default.","pos":[17490,17601],"source":" However, it isn't always appropriate that these data entities appear on the **Open in Office** menu by default."},{"content":"In this scenario, you can add the <bpt id=\"p1\">**</bpt>OfficeMenuOmit<ept id=\"p1\">**</ept> code attribute to the entity declaration.","pos":[17602,17696],"source":" In this scenario, you can add the **OfficeMenuOmit** code attribute to the entity declaration."},{"content":"After you make this change, by default, the entity won't appear on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu on pages that have a matching root data source.","pos":[17797,17939],"source":"After you make this change, by default, the entity won't appear on the **Open in Office** menu on pages that have a matching root data source."},{"content":"However, if the entity should be added to a specific page, you can use other customization mechanisms to add it.","pos":[17940,18052]},{"pos":[18058,18142],"content":"Adding a menu item button to a page that corresponds to an Open in Office menu entry","linkify":"Adding a menu item button to a page that corresponds to an Open in Office menu entry","nodes":[{"content":"Adding a menu item button to a page that corresponds to an Open in Office menu entry","pos":[0,84]}]},{"content":"Sometimes, it's appropriate that the Action Pane of a page have a menu item button that corresponds to a custom menu item on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu.","pos":[18144,18297],"source":"Sometimes, it's appropriate that the Action Pane of a page have a menu item button that corresponds to a custom menu item on the **Open in Office** menu."},{"content":"In this case, you can model a menu item button that has the following properties:","pos":[18298,18379]},{"pos":[18385,18415],"content":"<bpt id=\"p1\">**</bpt>Menu Item Type:<ept id=\"p1\">**</ept> <bpt id=\"p2\">**</bpt>Action<ept id=\"p2\">**</ept>","source":"**Menu Item Type:** **Action**"},{"pos":[18420,18467],"content":"<bpt id=\"p1\">**</bpt>Menu Item Name:<ept id=\"p1\">**</ept> <bpt id=\"p2\">**</bpt>ExportToExcelExportForm<ept id=\"p2\">**</ept>","source":"**Menu Item Name:** **ExportToExcelExportForm**"},{"pos":[18472,18511],"content":"<bpt id=\"p1\">**</bpt>Parameters:<ept id=\"p1\">**</ept> The ID of the menu item","source":"**Parameters:** The ID of the menu item"},{"pos":[18513,18651],"content":"Then, a mouse click of this menu item button is equivalent to a mouse click of the corresponding menu item on the <bpt id=\"p1\">**</bpt>Open in Office<ept id=\"p1\">**</ept> menu.","source":"Then, a mouse click of this menu item button is equivalent to a mouse click of the corresponding menu item on the **Open in Office** menu."}],"content":"---\n# required metadata\n\ntitle: Customize the Open in Microsoft Office menu\ndescription: Most pages include an Open in Microsoft Office menu. This topics provides information about the Open in Office menu, and explains how customize it by adding, removing, and changing options.\nauthor: ChrisGarty\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \n# ms.reviewer: 71\nms.search.scope: Operations, Platform\n# ms.tgt_pltfrm: \nms.custom: 270774\nms.assetid: 3ff1184b-1a8a-4102-9600-f1776634d95f\nms.search.region: Global\n# ms.search.industry: \nms.author: cgarty\nms.search.validFrom: 2017-02-28\nms.dyn365.ops.version: Platform update 4\n\n---\n\n# Customize the Open in Microsoft Office menu\n\nMost pages include an Open in Microsoft Office menu. This topics provides information about the Open in Office menu, and explains how customize it by adding, removing, and changing options.\n\nOverview\n--------\n\nThe **Open in Microsoft Office** menu button (**Open in Office** menu) is a system-defined button that appears on pages. The **Open in Office** menu contains menu items that let you export data to various Office products, such as Microsoft Excel and Microsoft Word. The following table describes the menu items on the **Open in Office** menu.\n\n| Menu item       | Description                                                                                                                                                                                                                                                  |\n|-----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Export to Excel | The data is exported to an Excel workbook. The workbook contains no references back to Microsoft Dynamics 365 for Operations, and the data can't be refreshed.                                                                                               |\n| Export to Word  | The data is exported to a Word document. The document contains no references back to Dynamics 365 for Operations, and the data can't be refreshed.                                                                                                           |\n| Open in Excel   | A workbook is created that contains the Microsoft Dynamics Office add-in. The workbook contains a reference back to Dynamics 365 for Operations, and the data can be refreshed, updated, and published from the Data Connector that is hosted in the add-in. |\n\n## How menu items are added to the Open in Office menu\nThe export options are added to the **Open in Office** menu in the following manner:\n\n1.  In the **Export to Excel** group, a menu item is added for each visible grid.\n2.  For each root data source on the page, the set of data entities that have the same root data source is determined. For each of these data entities, the following menu items are added:\n    -   In the **Open in Excel** group, a menu item is added for a default export of the data entity.\n    -   In the **Open in Excel** group, a menu item is added for each Document Template record of the **Excel** type that has the same root data entity and is marked for inclusion on the **Open in Office** menu.\n    -   In the **Export to Word** group, a menu item is added for each Document Template record of the **Word** type that has the same root data entity and is marked for inclusion on the **Open in Office** menu.\n\n## Default exports\nThe **Open in Office** menu provides a default export for each data entity. This export includes all the fields in the **AutoReport** group on the data entity. If **SaveDataPerCompany** is set to **Yes** for the data entity, a filter is applied to limit the data to the current company.\n\n## Document templates\nDocument templates can be added from the **Document templates** page. Several fields that are associated with each Document Template record control the behavior of that template on the **Open in Office** menu.\n\n| Field                | Description                                                                                                                                                         |\n|----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Root data entity     | The root data entity of the template. The root data entity is used to determine which pages the template can be included on.                                        |\n| List in Office menu  | If this field is selected, the template will be included on the **Open in Office** menu on applicable pages. (The applicable pages depend on the root data entity). |\n| Apply record filter  | If this field is selected, the data will be filtered, based on the record that is currently selected on the page.                                                   |\n| Apply company filter | If this field is selected, the data will be filtered, based on the current company.                                                                                 |\n\n### Trimmed template columns and fields\n\nFor Excel templates that are included on the **Open in Office** menu, columns and fields will be trimmed from the workbook, based on the configuration keys that are applied to the system and the applicable country/region context. If a configuration key is associated with a column or field in the workbook, the column or field will be removed if the configuration key is disabled. If a set of country/region codes is associated with the column or field in the workbook, the column or field will be removed if the country/region code isn't in scope.\n\n## Open in Office menu customization\nThere are several methods for customizing the content that appears on the **Open in Office** menu on a given page. For example, you can customize the content statically through metadata properties on model element and code attributes. However, customization via code gives you the finest level of control. In code, you can either implement one or more interfaces on a page, or use extensions and event subscriptions. The following sections describe the customization scenarios that are most often used.\n\n### Modifying the Open in Office menu through interfaces\n\nIf you must modify a page that you own, interfaces are the most appropriate customization method, because they give access to all private members of the page and allow for deeper customization. You can apply the following interfaces to the code for a page.\n\n| Interface                              | Description                                                                                                    |\n|----------------------------------------|----------------------------------------------------------------------------------------------------------------|\n| OfficeIMenuCustomizer                  | Use this interface to modify the set of data entities that is considered for a page and add custom menu items. |\n| OfficeIGeneratedWorkbookCustomExporter | Use this interface to do a custom export of a workbook that is generated at run time.                          |\n| OfficeITemplateCustomExporter          | Use this interface to do a custom export that is based on a Document Template record.                          |\n\n### Modifying the Open in Office menu through extensions and event subscriptions\n\nIf you must modify a page that you don't own, you should avoid using interfaces, because that approach will require over-layering. Instead, you should do the customization through extensions and event subscriptions. To use this approach, implement an extension class that subscribes to the **OnIntializing** event of the page that you're customizing. From this event handler, get the **OfficeFormRunHelper** for the page, and subscribe to its **OfficeMenuInitializing** event. The following example shows sample code for this approach.\n\n    public static class MyForm_Extension\n    {\n        [FormEventHandler(formStr(MyForm), FormEventType::Initializing)]\n        public static void ExportToExcel_DataEntityCustom_OnInitializing(xFormRun sender, FormEventArgs e)\n        {\n            FormRun formRun = sender as FormRun;\n            if (formRun)\n            {\n                OfficeFormRunHelper officeHelper = formRun.officeHelper();\n                if (officeHelper)\n                {\n                    officeHelper.OfficeMenuInitializing += eventhandler(MyForm_Extension::officeMenuInitializingHandler);\n                }\n            }\n        }\n        private static void officeMenuInitializingHandler(FormRun _formRun, OfficeMenuEventArgs _eventArgs)\n        {\n            // Modify the OfficeMenuOptions available on the OfficeMenuEventArgs.menuOptions() as necessary.\n        }\n    }\n\n## Typical customization scenarios\nThe following examples assume that the **\\_menuOptions** variable contains the **OfficeMenuOptions** instance that you're customizing.\n\n### Modifying the set of data entities that is considered for a page\n\nMany of the menu items on the **Open in Office** menu are added automatically, based on the data entities that are considered for the page. However, in some cases, the algorithm that is used to determine the set of data entities might not determine the correct set. To modify the set of data entities that is considered for the page, you can use the **OfficeMenuOptions** that is available from either the **OfficeIMenuCustomizer.customizeMenuOptions** method or the **OfficeFormRunHelper.OfficeMenuInitializing** delegate.\n\n    // Add an entity to the list\n    OfficeMenuDataEntityOptions entityOptions  = OfficeMenuDataEntityOptions::construct(tableStr(MyEntity));\n    _menuOptions.dataEntityOptions().addEnd(entityOptions);\n    // Remove an entity from the list\n    ListIterator dataEntityOptionsIterator = new ListIterator(_menuOptions.dataEntityOptions());\n    while (dataEntityOptionsIterator.more())\n    {\n        OfficeMenuDataEntityOptions dataEntityOptions = dataEntityOptionsIterator.value();\n        if (dataEntityOptions.dataEntityName() == tableStr(MyOtherEntity))\n        {\n            dataEntityOptionsIterator.delete();\n        }\n        else\n        {\n            dataEntityOptionsIterator.next();\n        }\n    }\n\n### Specifying the default data entity–related options that are included\n\nThe **OfficeMenuDataEntityOptions** class lets you specify whether to include a menu item for a default export or a menu item that is related to a document template.\n\n    // Find the entity options if they were included by default.\n    OfficeMenuDataEntityOptions entityOptions = _menuOptions.getOptionsForEntity(tableStr(MyEntity));\n    if (!entityOptions)\n    {\n        // The entity options were not included. Add them.\n        entityOptions = OfficeMenuDataEntityOptions::construct(tableStr(MyEntity);\n        _menuOptions.dataEntityOptions().addEnd(entityOptions);\n    }\n    entityOptions.includeDefault(false); // Don't include the default export menu item.\n    entityOptions.includeTemplates(false); // Don’t include Document Template related menu items.\n\n### Adding a custom export menu item – Generating a workbook\n\nTo explicitly add a menu item, you must add it to the **OfficeMenuOptions.customMenuItems()** list. To add a menu item that corresponds to a workbook that is generated at run time, use an **OfficeGeneratedExportMenuItem**.\n\n    OfficeGeneratedExportMenuItem menuItem = OfficeGeneratedExportMenuItem::construct(tableStr(MyEntity), \"MyCustomGeneratedExportId\");\n    menuItem.setDisplayNameWithDataEntity();\n    _menuOptions.customMenuItems().addEnd(menuItem);\n\nTo define what is actually exported, use an **ExportToExcelDataEntityContext**. The method for specifying the **ExportToExcelDataEntityContext** depends on whether you're using interfaces or extensions and event subscriptions to customize the **Open in Office** menu.\n\n#### Using interfaces\n\nIf you're using interfaces, you must implement the **OfficeIGeneratedWorkbookCustomExporter.getDataEntityContext()** method.\n\n    public ExportToExcelDataEntityContext getDataEntityContext(OfficeGeneratedExportMenuItem _menuItem)\n    {\n        ExportToExcelDataEntityContext context = null;\n        if (_menuItem.id() == \"MyCustomGeneratedExportId\")\n        {\n            context = ExportToExcelDataEntityContext::construct(tableStr(MyEntity), tableFieldGroupStr(MyEntity, MyFieldGroup);\n        }\n        return context;\n    }\n\n#### Using extensions and event subscriptions\n\nIf you're using extensions and event subscriptions, the **OfficeGeneratedExportMenuItem.getDataEntityContext** delegate should be subscribed to before you add the menu item to the **OfficeMenuOptions.customMenuItems()** list. The code for the event handler should resemble the preceding code for the interface. The following example shows how to do the event subscription.\n\n    menuItem.getDataEntityContext += eventhandler(MyForm_Extension::getDataEntityContextHandler);\n\n### Adding a custom export menu item – Specifying a document template\n\nTo explicitly add a menu item, you must add it to the **OfficeMenuOptions.customMenuItems()** list. To add a menu item that corresponds to a Document Template record, use an **OfficeTemplateExportMenuItem**.\n\n    OfficeTemplateExportMenuItem menuItem = OfficeTemplateExportMenuItem::construct(OfficeAppApplicationType::Excel, \"MyTemplateId\", \"MyCustomTemplateExportId\");\n    _menuOptions.customMenuItems().addEnd(menuItem);\n\nTo modify the template at run time, you can supply a set of initial filters. These filters will replace any filters in the template for the specified data entities. Additionally, you can modify filters and specify many settings by using **WorkbookSettingsManager**. The following sections show examples.\n\n#### Using interfaces\n\nIf you're using interfaces, you must implement the **OfficeITemplateCustomExporter.getInitialTemplateFilters()** and **OfficeITemplateCustomExporter.updateTemplateSettings()** methods.\n\n    public Map getInitialTemplateFilters(OfficeTemplateExportMenuItem _menuItem)\n    {\n        Map initialFilters = new Map(Types::String, Types::Class);\n        if (_menuItem.id() == \"MyCustomTemplateExportId\")\n        {\n            // Add an initial filter.\n            ExportToExcelFilterTreeBuilder bldr = new ExportToExcelFilterTreeBuilder(_menuItem.dataEntityName());\n            FilterNode filter = // create the filter…\n            initialFilters.insert(_menuItem.dataEntityName(), filter);\n        }\n        return initialFilters;\n    }\n    public void updateTemplateSettings(OfficeTemplateExportMenuItem _menuItem, Microsoft.Dynamics.Platform.Integration.Office.SettingsManager _settingsManager)\n    {\n        if (_menuItem.id() == \"MyCustomTemplateExportId\")\n        {\n            // Set a new filter.\n            ExportToExcelFilterTreeBuilder bldr = new ExportToExcelFilterTreeBuilder(_menuItem.dataEntityName());\n            FilterNode filter = // create the filter…\n            Excel.WorkbookSettingsManager workbookSettingsManager = _settingsManager as Excel.WorkbookSettingsManager;\n            workbookSettingsManager.SetEntityFilter(entityMetadata.PublicEntityName, filter);\n            // Adjust settings.\n            DataConnectorAppletSettings settings = settingsManager.DataConnectorSettings;\n            DataConnectorAppletUserOptions options = settings.DataOptions;\n            options.RefreshOnOpen = true;\n            options.EnableDesign = false;\n            workbookSettingsManager.DataConnectorSettings = settings;\n        }\n    }\n\n#### Using extensions and event subscriptions\n\nIf you're using extensions and event subscriptions, the **OfficeTemplateExportMenuItem.getInitialTemplateFilters** and **OfficeTemplateExportMenuItem.updateTemplateSettings** delegates should be subscribed to before you add the menu item to the **OfficeMenuOptions.customMenuItems()** list. The code for the event handlers should resemble the preceding code for the interface. The following example shows how to do the event subscription.\n\n    menuItem.getInitialTemplateFilters += eventhandler(MyForm_Extension::getInitialTemplateFiltersHander);\n    menuItem.updateTemplateSettings += eventhandler(MyForm_Extension::updateTemplateSettingsHandler);\n\n## Additional customizations\nThe following customizations let you modify the contents of the **Open in Office** menu for a page without using interfaces or extensions and event handlers.\n\n### Removing an Export to Excel menu item for a grid\n\nOn the **Open in Office** menu, the **Export to Excel** group will contain a menu item for each visible grid. To remove a grid from the **Open in Office** menu, set the **ExportAllowed** metadata property on the grid to **No**. After you make this change, users won't be able to export the grid by using the shortcut menu for the grid.\n\n### Renaming an Export to Excel menu item for a grid\n\nTo rename the **Export to Excel** menu item that is related to a grid, set the **ExportLabel** metadata property on the grid to the appropriate label.\n\n### Removing all menu items for a data entity from all pages\n\nIntegration scenarios require that some data entities be publicly available via the OData Service. However, it isn't always appropriate that these data entities appear on the **Open in Office** menu by default. In this scenario, you can add the **OfficeMenuOmit** code attribute to the entity declaration.\n\n    [OfficeMenuOmit]\n    public class MyEntity extends common\n    {\n        // Entity code…\n    }\n\nAfter you make this change, by default, the entity won't appear on the **Open in Office** menu on pages that have a matching root data source. However, if the entity should be added to a specific page, you can use other customization mechanisms to add it.\n\n### Adding a menu item button to a page that corresponds to an Open in Office menu entry\n\nSometimes, it's appropriate that the Action Pane of a page have a menu item button that corresponds to a custom menu item on the **Open in Office** menu. In this case, you can model a menu item button that has the following properties:\n\n-   **Menu Item Type:** **Action**\n-   **Menu Item Name:** **ExportToExcelExportForm**\n-   **Parameters:** The ID of the menu item\n\nThen, a mouse click of this menu item button is equivalent to a mouse click of the corresponding menu item on the **Open in Office** menu.\n\n"}