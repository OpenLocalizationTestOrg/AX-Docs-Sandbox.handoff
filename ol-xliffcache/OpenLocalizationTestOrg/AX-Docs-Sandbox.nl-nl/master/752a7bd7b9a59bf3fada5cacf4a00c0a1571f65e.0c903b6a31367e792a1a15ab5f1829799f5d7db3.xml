{"nodes":[{"pos":[32,114],"content":"Upgrade Dynamics 365 for Operations to the latest platform update | Microsoft Docs","needQuote":true,"needEscape":true,"nodes":[{"content":"Upgrade Dynamics 365 for Operations to the latest platform update | Microsoft Docs","pos":[0,82]}]},{"pos":[128,254],"content":"This topic explains how to upgrade your Microsoft Dynamics 365 for Operations platform version to the latest platform release.","needQuote":true,"needEscape":true,"nodes":[{"content":"This topic explains how to upgrade your Microsoft Dynamics 365 for Operations platform version to the latest platform release.","pos":[0,126]}]},{"pos":[680,745],"content":"Upgrade Dynamics 365 for Operations to the latest platform update","linkify":"Upgrade Dynamics 365 for Operations to the latest platform update","nodes":[{"content":"Upgrade Dynamics 365 for Operations to the latest platform update","pos":[0,65]}]},{"content":"This topic explains how to upgrade your Microsoft Dynamics 365 for Operations platform version to the latest platform release.","pos":[747,873]},{"pos":[875,883],"content":"Overview","linkify":"Overview","nodes":[{"content":"Overview","pos":[0,8]}]},{"content":"The Microsoft Dynamics 365 for Operations platform consists of the following components:","pos":[894,982]},{"content":"Dynamics 365 for Operations platform binaries such as Application Object Server (AOS), the data management framework, the reporting and business intelligence (BI) framework, development tools, and analytics services","pos":[988,1203]},{"content":"The following Application Object Tree (AOT) packages:","pos":[1208,1261]},{"content":"Application Platform","pos":[1270,1290]},{"content":"Application Foundation","pos":[1299,1321]},{"content":"Test Essentials","pos":[1330,1345]},{"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept> To move to the latest Dynamics 365 for Operations platform, your Dynamics 365 for Operations implementation <bpt id=\"p2\">**</bpt>cannot<ept id=\"p2\">**</ept> have any customizations (overlayering) of any of the AOT packages that belong to the platform.","pos":[1347,1575],"source":"**Important:** To move to the latest Dynamics 365 for Operations platform, your Dynamics 365 for Operations implementation **cannot** have any customizations (overlayering) of any of the AOT packages that belong to the platform."},{"content":"This restriction was introduced in platform update 3, so that seamless continuous updates can be made to the platform.","pos":[1576,1694]},{"content":"For more information see the <bpt id=\"p1\">[</bpt>Upgrading to platform update 3 from an earlier build<ept id=\"p1\">](http://ax.help.dynamics.com/en/upgrade-latest-platform-upgrade#earlier)</ept> section at the end of this topic.","pos":[1695,1884],"source":" For more information see the [Upgrading to platform update 3 from an earlier build](http://ax.help.dynamics.com/en/upgrade-latest-platform-upgrade#earlier) section at the end of this topic."},{"pos":[1889,1901],"content":"Overall flow","linkify":"Overall flow","nodes":[{"content":"Overall flow","pos":[0,12]}]},{"content":"The following illustration shows the overall process for upgrading the Microsoft Dynamics AX platform to the latest update.","pos":[1902,2025]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Upgrade process for implementations that have no customization of the platform<ept id=\"p1\">](./media/flownocustomisations.jpg)](./media/flownocustomisations.jpg)</ept>","pos":[2026,2177],"source":"[![Upgrade process for implementations that have no customization of the platform](./media/flownocustomisations.jpg)](./media/flownocustomisations.jpg)"},{"pos":[2182,2224],"content":"Create a copy of a platform update package","linkify":"Create a copy of a platform update package","nodes":[{"content":"Create a copy of a platform update package","pos":[0,42]}]},{"content":"Platform update packages are released by Microsoft and can be downloaded from the Shared asset library in Microsoft Dynamics Lifecycle Services (LCS), on the <bpt id=\"p1\">**</bpt>Software deployable package<ept id=\"p1\">**</ept> tab.","pos":[2225,2419],"source":"Platform update packages are released by Microsoft and can be downloaded from the Shared asset library in Microsoft Dynamics Lifecycle Services (LCS), on the **Software deployable package** tab."},{"content":"Dynamics 365 packages are currently prefixed with <bpt id=\"p1\">*</bpt>Dynamics 365 for Operations Platform Update<ept id=\"p1\">*</ept> (for example, Dynamics 365 for Operations Platform Update 3)<bpt id=\"p2\">*</bpt>.<ept id=\"p2\">*</ept>","pos":[2420,2579],"source":" Dynamics 365 packages are currently prefixed with *Dynamics 365 for Operations Platform Update* (for example, Dynamics 365 for Operations Platform Update 3)*.*"},{"content":"You must create a copy of the platform package.","pos":[2580,2627]},{"content":"This step is required because update packages must be applied from local asset libraries.","pos":[2628,2717]},{"content":"Go to your LCS project's Asset library.","pos":[2723,2762]},{"content":"On the <bpt id=\"p1\">**</bpt>Software deployable package<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>Import<ept id=\"p2\">**</ept> to create a reference to the platform update package.","pos":[2767,2881],"source":"On the **Software deployable package** tab, click **Import** to create a reference to the platform update package."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Import button<ept id=\"p1\">](./media/importupgradepackage.png)](./media/importupgradepackage.png)</ept>","pos":[2882,2968],"source":"[![Import button](./media/importupgradepackage.png)](./media/importupgradepackage.png)"},{"content":"Select the correct platform package.","pos":[2973,3009]},{"content":"Click <bpt id=\"p1\">**</bpt>Copy <ept id=\"p1\">**</ept>to create a local copy of the package that you can apply to the environments in your projects.","pos":[3014,3123],"source":"Click **Copy **to create a local copy of the package that you can apply to the environments in your projects."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Copy button<ept id=\"p1\">](./media/platformassetlibrary.jpg)](./media/platformassetlibrary.jpg)</ept>","pos":[3124,3208],"source":"[![Copy button](./media/platformassetlibrary.jpg)](./media/platformassetlibrary.jpg)"},{"pos":[3213,3259],"content":"Choose the correct package deployment strategy","linkify":"Choose the correct package deployment strategy","nodes":[{"content":"Choose the correct package deployment strategy","pos":[0,46]}]},{"content":"From a process perspective, a platform upgrade package resembles a binary hotfix deployable package.","pos":[3260,3360]},{"content":"To apply a package to your development or build environment, follow the instructions that follow.","pos":[3366,3463]},{"pos":[3468,3808],"content":"To apply a package to your demo, tier-2 sandbox, or production environment, follow the instructions for applying a binary hotfix in <bpt id=\"p1\">[</bpt>Apply a deployable package on a Microsoft Dynamics 365 for Operations system<ept id=\"p1\">](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/deployment/apply-a-deployable-package-on-a-dynamics-ax-system)</ept>.","source":"To apply a package to your demo, tier-2 sandbox, or production environment, follow the instructions for applying a binary hotfix in [Apply a deployable package on a Microsoft Dynamics 365 for Operations system](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/deployment/apply-a-deployable-package-on-a-dynamics-ax-system)."},{"pos":[3813,3878],"content":"Apply the platform update package on your development environment","linkify":"Apply the platform update package on your development environment","nodes":[{"content":"Apply the platform update package on your development environment","pos":[0,65]}]},{"pos":[3883,3943],"content":"Delete any platform metadata hotfixes from your VSTS project","linkify":"Delete any platform metadata hotfixes from your VSTS project","nodes":[{"content":"Delete any platform metadata hotfixes from your VSTS project","pos":[0,60]}]},{"content":"Before you install the new platform update, you must clean up your Microsoft Visual Studio Team Services (VSTS) source control project.","pos":[3945,4080]},{"content":"Remove any X++ or metadata hotfixes that you've installed on your existing platform.","pos":[4081,4165]},{"content":"If you have any X++ or metadata hotfixes that are checked in to your VSTS project for any of the following Microsoft models, delete them from your project by using the Microsoft Visual Studio Source Control Explorer.","pos":[4166,4382]},{"content":"Application Platform","pos":[4388,4408]},{"content":"Application Foundation","pos":[4413,4435]},{"content":"TestEssentials","pos":[4440,4454]},{"content":"Directory","pos":[4459,4468]},{"content":"You can find these hotfixes by browsing the check-in history of these Microsoft models.","pos":[4470,4557]},{"content":"For example, use Source Control Explorer to browse the check-in history of the Trunk<ph id=\"ph1\">\\\\</ph>Main<ph id=\"ph2\">\\\\</ph>Metadata<ph id=\"ph3\">\\\\</ph>ApplicationFoundation<ph id=\"ph4\">\\\\</ph>ApplicationFoundation folder, and delete all XML files that have been checked in to it.","pos":[4558,4770],"source":" For example, use Source Control Explorer to browse the check-in history of the Trunk\\\\Main\\\\Metadata\\\\ApplicationFoundation\\\\ApplicationFoundation folder, and delete all XML files that have been checked in to it."},{"content":"View History","pos":[4773,4785]},{"pos":[4820,4850],"content":"Install the deployable package","linkify":"Install the deployable package","nodes":[{"content":"Install the deployable package","pos":[0,30]}]},{"content":"Download the platform update package (AXPlatformUpdate.zip) to your virtual machine (VM).","pos":[4856,4945]},{"content":"Unzip the contents to a local directory.","pos":[4950,4990]},{"pos":[4995,5165],"content":"Depending on the type of environment that you're upgrading, open the PlatformUpdatePackages.Config file under <ph id=\"ph1\">\\\\</ph>AOSService<ph id=\"ph2\">\\\\</ph>Scripts, and change the <bpt id=\"p1\">**</bpt>MetaPackage<ept id=\"p1\">**</ept> value:","source":"Depending on the type of environment that you're upgrading, open the PlatformUpdatePackages.Config file under \\\\AOSService\\\\Scripts, and change the **MetaPackage** value:"},{"pos":[5174,5332],"content":"If you're upgrading a development or demo environment that contains source code, change the <bpt id=\"p1\">**</bpt>MetaPackage<ept id=\"p1\">**</ept> value to <bpt id=\"p2\">**</bpt>dynamicsax-meta-platform-development<ept id=\"p2\">**</ept>.","source":"If you're upgrading a development or demo environment that contains source code, change the **MetaPackage** value to **dynamicsax-meta-platform-development**."},{"pos":[5341,5546],"content":"If you're upgrading a runtime environment, such as a tier-2 sandbox environment or another environment that doesn't contain source code, the default value, <bpt id=\"p1\">**</bpt>dynamicsax-meta-platform-runtime<ept id=\"p1\">**</ept>, is correct.","source":"If you're upgrading a runtime environment, such as a tier-2 sandbox environment or another environment that doesn't contain source code, the default value, **dynamicsax-meta-platform-runtime**, is correct."},{"content":"Follow the standard instructions for installing a deployable package.","pos":[5552,5621]},{"content":"See <bpt id=\"p1\">[</bpt>Install a deployable package<ept id=\"p1\">](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/deployment/installing-deployable-package-in-ax7)</ept>.","pos":[5622,5772],"source":" See [Install a deployable package](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/deployment/installing-deployable-package-in-ax7)."},{"content":"If you're working in a development environment, rebuild your application’s code.","pos":[5777,5857]},{"pos":[5859,5976],"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept> Apply this update in a runtime environment only if you first validate it in a development environment.","source":"**Important:** Apply this update in a runtime environment only if you first validate it in a development environment."},{"pos":[5983,5990],"content":"Example","linkify":"Example","nodes":[{"content":"Example","pos":[0,7]}]},{"pos":[6305,6348],"content":"Install the Visual Studio development tools","linkify":"Install the Visual Studio development tools","nodes":[{"content":"Install the Visual Studio development tools","pos":[0,43]}]},{"pos":[6350,6591],"content":"Update the Visual Studio development tools as described in <bpt id=\"p1\">[</bpt>Updating the Visual Studio development tools<ept id=\"p1\">](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/dev-tools/updating-the-dynamics-ax7-visual-studio-development-tools)</ept>.","source":"Update the Visual Studio development tools as described in [Updating the Visual Studio development tools](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/dev-tools/updating-the-dynamics-ax7-visual-studio-development-tools)."},{"pos":[6597,6627],"content":"Regenerate form adaptor models","linkify":"Regenerate form adaptor models","nodes":[{"content":"Regenerate form adaptor models","pos":[0,30]}]},{"content":"Form adaptor models are required for test automation.","pos":[6629,6682]},{"content":"Regenerate the platform form adaptor models, based on the newly updated platform models.","pos":[6683,6771]},{"content":"Use the xppfagen.exe tool to generate the form adaptor models.","pos":[6772,6834]},{"content":"This tool is located in the package's bin folder (typically, j:<ph id=\"ph1\">\\\\</ph>AosService<ph id=\"ph2\">\\\\</ph>PackagesLocalDirectory<ph id=\"ph3\">\\\\</ph>bin).","pos":[6835,6941],"source":" This tool is located in the package's bin folder (typically, j:\\\\AosService\\\\PackagesLocalDirectory\\\\bin)."},{"content":"Here is a list of the platform form adaptor models:","pos":[6942,6993]},{"content":"ApplicationPlatformFormAdaptor","pos":[6999,7029]},{"content":"ApplicationFoundationFormAdaptor","pos":[7034,7066]},{"content":"DirectoryFormAdaptor","pos":[7071,7091]},{"content":"The following examples show how to generate the form adaptor models.","pos":[7093,7161]},{"pos":[7555,7594],"content":"Install the new Data Management service","linkify":"Install the new Data Management service","nodes":[{"content":"Install the new Data Management service","pos":[0,39]}]},{"content":"After the deployable package is installed, follow these instructions to install the new Data Management service.","pos":[7596,7708]},{"content":"Open a <bpt id=\"p1\">**</bpt>Command Prompt<ept id=\"p1\">**</ept> window as an administrator, and run the following commands from the .<ph id=\"ph1\">\\\\</ph>DIXFService<ph id=\"ph2\">\\\\</ph>Scripts folder.","pos":[7709,7834],"source":" Open a **Command Prompt** window as an administrator, and run the following commands from the .\\\\DIXFService\\\\Scripts folder."},{"content":"If you're connected to Microsoft SQL Server Integration Services 2016 (13.0), run the following command.","pos":[7923,8027]},{"content":"If you're connected to an earlier release of Microsoft SQL Server Integration Services, run the following command.","pos":[8164,8278]},{"pos":[8413,8469],"content":"Apply the platform update package on a build environment","linkify":"Apply the platform update package on a build environment","nodes":[{"content":"Apply the platform update package on a build environment","pos":[0,56]}]},{"content":"If the build machine has been used for one or more builds, you should restore the metadata packages folder from the metadata backup folder before you upgrade the VM to a newer Dynamics 365 for Operations platform.","pos":[8470,8683]},{"content":"You should then delete the metadata backup.","pos":[8684,8727]},{"content":"These steps help guarantee that the platform update will be applied on a clean environment.","pos":[8728,8819]},{"content":"The next build process will then detect that no metadata backup exists and will automatically create a new one.","pos":[8820,8931]},{"content":"This new metadata backup will include the updated platform.","pos":[8932,8991]},{"content":"To find out whether a complete metadata backup exists, look for a BackupComplete.txt file in I:<ph id=\"ph1\">\\\\</ph>DynamicsBackup<ph id=\"ph2\">\\\\</ph>Packages (or C:<ph id=\"ph3\">\\\\</ph>DynamicsBackup<ph id=\"ph4\">\\\\</ph>Packages on a downloadable virtual hard disk <ph id=\"ph5\">\\[</ph>VHD<ph id=\"ph6\">\\]</ph>).","pos":[8992,9192],"source":" To find out whether a complete metadata backup exists, look for a BackupComplete.txt file in I:\\\\DynamicsBackup\\\\Packages (or C:\\\\DynamicsBackup\\\\Packages on a downloadable virtual hard disk \\[VHD\\])."},{"content":"If this file is present, a metadata backup exists, and the file will contain a timestamp that indicates when it was created.","pos":[9193,9317]},{"content":"To restore the deployment's metadata packages folder from the metadata backup, open an elevated Windows PowerShell <bpt id=\"p1\">**</bpt>Command Prompt<ept id=\"p1\">**</ept> window, and run the following command.","pos":[9318,9490],"source":" To restore the deployment's metadata packages folder from the metadata backup, open an elevated Windows PowerShell **Command Prompt** window, and run the following command."},{"content":"This command will run the same script that is used in the first step of the build process.","pos":[9491,9581]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> Run the preceding command only if a complete metadata backup exists.","pos":[9696,9774],"source":"**Note:** Run the preceding command only if a complete metadata backup exists."},{"content":"If a complete metadata backup doesn't exist, the command will create a new backup.","pos":[9775,9857]},{"content":"This command will stop the Dynamics AX deployment services and Internet Information Services (IIS) before it restores the files from the metadata backup to the deployment's metadata packages folder.","pos":[9858,10056]},{"content":"You should see output that resembles the following example.","pos":[10057,10116]},{"content":"<bpt id=\"p1\">*</bpt>6:17:52 PM: Preparing build environment...<ept id=\"p1\">*</ept> <bpt id=\"p2\">*</bpt>6:17:53 PM: Updating Dynamics SDK registry key with specified values...<ept id=\"p2\">*</ept> <bpt id=\"p3\">*</bpt>6:17:53 PM: Updating Dynamics SDK registry key with values from AOS web config...<ept id=\"p3\">*</ept> <bpt id=\"p4\">*</bpt>6:17:53 PM: Stopping Dynamics AX deployment...<ept id=\"p4\">*</ept> <bpt id=\"p5\">*</bpt>6:18:06 PM: <ept id=\"p5\">*</ept><bpt id=\"p6\">*</bpt>A backup already exists at: I:<ph id=\"ph1\">\\\\</ph>DynamicsBackup<ph id=\"ph2\">\\\\</ph>Packages. No new backup will be created<ept id=\"p6\">*</ept><bpt id=\"p7\">*</bpt>.<ept id=\"p7\">*</ept>","pos":[10117,10475],"source":"*6:17:52 PM: Preparing build environment...* *6:17:53 PM: Updating Dynamics SDK registry key with specified values...* *6:17:53 PM: Updating Dynamics SDK registry key with values from AOS web config...* *6:17:53 PM: Stopping Dynamics AX deployment...* *6:18:06 PM: **A backup already exists at: I:\\\\DynamicsBackup\\\\Packages. No new backup will be created**.*"},{"content":"<bpt id=\"p1\">*</bpt>6:18:06 PM: <ept id=\"p1\">*</ept><bpt id=\"p2\">*</bpt>Restoring metadata packages from backup...<ept id=\"p2\">*</ept><bpt id=\"p3\">*</bpt><bpt id=\"p4\">*</bpt> <ept id=\"p4\">*</ept>6:22:56 PM: <ept id=\"p3\">*</ept><bpt id=\"p5\">*</bpt>Metadata packages successfully restored from backup<ept id=\"p5\">*</ept><bpt id=\"p6\">*</bpt>.<ept id=\"p6\">*</ept>","pos":[10476,10607],"source":"*6:18:06 PM: **Restoring metadata packages from backup...*** *6:22:56 PM: **Metadata packages successfully restored from backup**.*"},{"content":"<bpt id=\"p1\">*</bpt>6:22:57 PM: Preparing build environment complete.<ept id=\"p1\">*</ept>","pos":[10608,10659],"source":"*6:22:57 PM: Preparing build environment complete.*"},{"content":"<bpt id=\"p1\">*</bpt>6:22:57 PM: Script completed with exit code: 0<ept id=\"p1\">*</ept> After the metadata backup has been restored, delete (or rename) the metadata backup folder (DynamicsBackup<ph id=\"ph1\">\\\\</ph>Packages), so that it will no longer be found by the build process.","pos":[10660,10884],"source":"*6:22:57 PM: Script completed with exit code: 0* After the metadata backup has been restored, delete (or rename) the metadata backup folder (DynamicsBackup\\\\Packages), so that it will no longer be found by the build process."},{"pos":[10890,10923],"content":"Apply the platform update package","linkify":"Apply the platform update package","nodes":[{"content":"Apply the platform update package","pos":[0,33]}]},{"content":"After you've prepared your build environment for this update, apply the platform update package by using the same method that you use to apply it on a development environment.","pos":[10925,11100]},{"content":"See the \"Apply the platform update package on your development environment\" section earlier in this topic.","pos":[11101,11207]},{"pos":[11212,11264],"content":"Upgrading to platform update 3 from an earlier build","linkify":"Upgrading to platform update 3 from an earlier build","nodes":[{"content":"Upgrading to platform update 3 from an earlier build","pos":[0,52]}]},{"content":"When upgrading to platform update 3 from an earlier build, there are some very important considerations, this is because of two key changes in update 3:","pos":[11265,11417]},{"content":"It is no longer possible to overlayer platform models (Application Platform, Application Foundation, Test Essentials).","pos":[11423,11541]},{"content":"The Directory model is no longer in platform, it has moved to the application in the Dynamics 365 for Operations release 1611.","pos":[11546,11672]},{"content":"This means two things:","pos":[11674,11696]},{"content":"If taking only platform update 3 and not taking the application update (Dynamics 365 for Operations version 1611) then you cannot have overlayering on any of the below models.","pos":[11702,11877]},{"content":"All overlayering on these models must be removed before attempting to install update 3:","pos":[11878,11965]},{"content":"Application Platform","pos":[11974,11994]},{"content":"Application Foundation","pos":[12003,12025]},{"content":"Test Essentials","pos":[12034,12049]},{"content":"Directory","pos":[12058,12067]},{"pos":[12073,12452],"content":"If you cannot remove over-layering from the Directory model, and you still want to upgrade, you will have to do a complete upgrade of the platform and the application (Dynamics 365 for Operations version 1611) as described in this <bpt id=\"p1\">[</bpt>topic<ept id=\"p1\">](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/migration-upgrade/process-for-upgrading-to-the-latest-dynamics-ax-update)</ept>.","source":"If you cannot remove over-layering from the Directory model, and you still want to upgrade, you will have to do a complete upgrade of the platform and the application (Dynamics 365 for Operations version 1611) as described in this [topic](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/migration-upgrade/process-for-upgrading-to-the-latest-dynamics-ax-update)."}],"content":"---\n# required metadata\n\ntitle: Upgrade Dynamics 365 for Operations to the latest platform update | Microsoft Docs\ndescription: This topic explains how to upgrade your Microsoft Dynamics 365 for Operations platform version to the latest platform release.\nauthor: MargoC\nmanager: AnnBe\nms.date: 2016-11-04 00:14:31\nms.topic: \nms.prod: \nms.service: \nms.technology: \n\n# optional metadata\n\n# keywords: \n# ROBOTS: \naudience: Developer, IT Pro\n# ms.devlang: \nms.reviewer: 11\nms.suite: Released- Dynamics 365 for Operations platform update 3\n# ms.tgt_pltfrm: \nms.custom: 253274\nms.assetid: a050d7cf-24ac-48ec-8575-1ea143086377\nms.region: Global\n# ms.industry: \nms.author: tabell\n\n---\n\n# Upgrade Dynamics 365 for Operations to the latest platform update\n\nThis topic explains how to upgrade your Microsoft Dynamics 365 for Operations platform version to the latest platform release.\n\nOverview\n--------\n\nThe Microsoft Dynamics 365 for Operations platform consists of the following components:\n\n-   Dynamics 365 for Operations platform binaries such as Application Object Server (AOS), the data management framework, the reporting and business intelligence (BI) framework, development tools, and analytics services\n-   The following Application Object Tree (AOT) packages:\n    -   Application Platform\n    -   Application Foundation\n    -   Test Essentials\n\n**Important:** To move to the latest Dynamics 365 for Operations platform, your Dynamics 365 for Operations implementation **cannot** have any customizations (overlayering) of any of the AOT packages that belong to the platform. This restriction was introduced in platform update 3, so that seamless continuous updates can be made to the platform. For more information see the [Upgrading to platform update 3 from an earlier build](http://ax.help.dynamics.com/en/upgrade-latest-platform-upgrade#earlier) section at the end of this topic.\n\n## Overall flow\nThe following illustration shows the overall process for upgrading the Microsoft Dynamics AX platform to the latest update. [![Upgrade process for implementations that have no customization of the platform](./media/flownocustomisations.jpg)](./media/flownocustomisations.jpg)\n\n## Create a copy of a platform update package\nPlatform update packages are released by Microsoft and can be downloaded from the Shared asset library in Microsoft Dynamics Lifecycle Services (LCS), on the **Software deployable package** tab. Dynamics 365 packages are currently prefixed with *Dynamics 365 for Operations Platform Update* (for example, Dynamics 365 for Operations Platform Update 3)*.* You must create a copy of the platform package. This step is required because update packages must be applied from local asset libraries.\n\n1.  Go to your LCS project's Asset library.\n2.  On the **Software deployable package** tab, click **Import** to create a reference to the platform update package. [![Import button](./media/importupgradepackage.png)](./media/importupgradepackage.png)\n3.  Select the correct platform package.\n4.  Click **Copy **to create a local copy of the package that you can apply to the environments in your projects. [![Copy button](./media/platformassetlibrary.jpg)](./media/platformassetlibrary.jpg)\n\n## Choose the correct package deployment strategy\nFrom a process perspective, a platform upgrade package resembles a binary hotfix deployable package.\n\n-   To apply a package to your development or build environment, follow the instructions that follow.\n-   To apply a package to your demo, tier-2 sandbox, or production environment, follow the instructions for applying a binary hotfix in [Apply a deployable package on a Microsoft Dynamics 365 for Operations system](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/deployment/apply-a-deployable-package-on-a-dynamics-ax-system).\n\n## Apply the platform update package on your development environment\n### Delete any platform metadata hotfixes from your VSTS project\n\nBefore you install the new platform update, you must clean up your Microsoft Visual Studio Team Services (VSTS) source control project. Remove any X++ or metadata hotfixes that you've installed on your existing platform. If you have any X++ or metadata hotfixes that are checked in to your VSTS project for any of the following Microsoft models, delete them from your project by using the Microsoft Visual Studio Source Control Explorer.\n\n-   Application Platform\n-   Application Foundation\n-   TestEssentials\n-   Directory\n\nYou can find these hotfixes by browsing the check-in history of these Microsoft models. For example, use Source Control Explorer to browse the check-in history of the Trunk\\\\Main\\\\Metadata\\\\ApplicationFoundation\\\\ApplicationFoundation folder, and delete all XML files that have been checked in to it. ![View History](./media/checkinhistory.png)\n\n### Install the deployable package\n\n1.  Download the platform update package (AXPlatformUpdate.zip) to your virtual machine (VM).\n2.  Unzip the contents to a local directory.\n3.  Depending on the type of environment that you're upgrading, open the PlatformUpdatePackages.Config file under \\\\AOSService\\\\Scripts, and change the **MetaPackage** value:\n    -   If you're upgrading a development or demo environment that contains source code, change the **MetaPackage** value to **dynamicsax-meta-platform-development**.\n    -   If you're upgrading a runtime environment, such as a tier-2 sandbox environment or another environment that doesn't contain source code, the default value, **dynamicsax-meta-platform-runtime**, is correct.\n\n4.  Follow the standard instructions for installing a deployable package. See [Install a deployable package](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/deployment/installing-deployable-package-in-ax7).\n5.  If you're working in a development environment, rebuild your application’s code.\n\n**Important:** Apply this update in a runtime environment only if you first validate it in a development environment.\n\n#### Example\n\n    AXUpdateInstaller.exe generate -runbookid=\"OneBoxDev\" -topologyfile=\"DefaultTopologyData.xml\" -servicemodelfile=\"DefaultServiceModelData.xml\" -runbookfile=\"OneBoxDev-runbook.xml\"\n\n    AXUpdateInstaller.exe import -runbookfile=OneBoxDev-runbook.xml\n\n    AXUpdateInstaller.exe execute -runbookid=OneBoxDev\n\n### Install the Visual Studio development tools\n\nUpdate the Visual Studio development tools as described in [Updating the Visual Studio development tools](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/dev-tools/updating-the-dynamics-ax7-visual-studio-development-tools).\n\n### Regenerate form adaptor models\n\nForm adaptor models are required for test automation. Regenerate the platform form adaptor models, based on the newly updated platform models. Use the xppfagen.exe tool to generate the form adaptor models. This tool is located in the package's bin folder (typically, j:\\\\AosService\\\\PackagesLocalDirectory\\\\bin). Here is a list of the platform form adaptor models:\n\n-   ApplicationPlatformFormAdaptor\n-   ApplicationFoundationFormAdaptor\n-   DirectoryFormAdaptor\n\nThe following examples show how to generate the form adaptor models.\n\n    xppfagen.exe -metadata=j:\\AosService\\PackagesLocalDirectory -model=\"ApplicationPlatformFormAdaptor\" -xmllog=\"c:\\temp\\log1.xml\"\n\n    xppfagen.exe -metadata=j:\\AosService\\PackagesLocalDirectory -model=\"ApplicationFoundationFormAdaptor\" -xmllog=\"c:\\temp\\log2.xml\"\n\n    xppfagen.exe -metadata=j:\\AosService\\PackagesLocalDirectory -model=\"DirectoryFormAdaptor\" -xmllog=\"c:\\temp\\log3.xml\"\n\n### Install the new Data Management service\n\nAfter the deployable package is installed, follow these instructions to install the new Data Management service. Open a **Command Prompt** window as an administrator, and run the following commands from the .\\\\DIXFService\\\\Scripts folder.\n\n    msiExec.exe /uninstall {5C74B12A-8583-4B4F-B5F5-8E526507A3E0} /passive /qn /quiet\n\nIf you're connected to Microsoft SQL Server Integration Services 2016 (13.0), run the following command.\n\n    msiexec /i \"DIXF_Service_x64.msi\" ISSQLSERVERVERSION=\"Bin\\2012\" SERVICEACCOUNT=\"NT AUTHORITY\\NetworkService\" /qb /lv DIXF_log.txt\n\nIf you're connected to an earlier release of Microsoft SQL Server Integration Services, run the following command.\n\n    msiexec /i \"DIXF_Service_x64.msi\" ISSQLSERVERVERSION=\"Bin\" SERVICEACCOUNT=\"NT AUTHORITY\\NetworkService\" /qb /lv DIXF_log.txt\n\n## Apply the platform update package on a build environment\nIf the build machine has been used for one or more builds, you should restore the metadata packages folder from the metadata backup folder before you upgrade the VM to a newer Dynamics 365 for Operations platform. You should then delete the metadata backup. These steps help guarantee that the platform update will be applied on a clean environment. The next build process will then detect that no metadata backup exists and will automatically create a new one. This new metadata backup will include the updated platform. To find out whether a complete metadata backup exists, look for a BackupComplete.txt file in I:\\\\DynamicsBackup\\\\Packages (or C:\\\\DynamicsBackup\\\\Packages on a downloadable virtual hard disk \\[VHD\\]). If this file is present, a metadata backup exists, and the file will contain a timestamp that indicates when it was created. To restore the deployment's metadata packages folder from the metadata backup, open an elevated Windows PowerShell **Command Prompt** window, and run the following command. This command will run the same script that is used in the first step of the build process.\n\n    if (Test-Path -Path \"I:\\DynamicsBackup\\Packages\\BackupComplete.txt\") { C:\\DynamicsSDK\\PrepareForBuild.ps1 }\n\n**Note:** Run the preceding command only if a complete metadata backup exists. If a complete metadata backup doesn't exist, the command will create a new backup. This command will stop the Dynamics AX deployment services and Internet Information Services (IIS) before it restores the files from the metadata backup to the deployment's metadata packages folder. You should see output that resembles the following example. *6:17:52 PM: Preparing build environment...* *6:17:53 PM: Updating Dynamics SDK registry key with specified values...* *6:17:53 PM: Updating Dynamics SDK registry key with values from AOS web config...* *6:17:53 PM: Stopping Dynamics AX deployment...* *6:18:06 PM: **A backup already exists at: I:\\\\DynamicsBackup\\\\Packages. No new backup will be created**.* *6:18:06 PM: **Restoring metadata packages from backup...*** *6:22:56 PM: **Metadata packages successfully restored from backup**.* *6:22:57 PM: Preparing build environment complete.* *6:22:57 PM: Script completed with exit code: 0* After the metadata backup has been restored, delete (or rename) the metadata backup folder (DynamicsBackup\\\\Packages), so that it will no longer be found by the build process.\n\n### Apply the platform update package\n\nAfter you've prepared your build environment for this update, apply the platform update package by using the same method that you use to apply it on a development environment. See the \"Apply the platform update package on your development environment\" section earlier in this topic.\n\n## Upgrading to platform update 3 from an earlier build\nWhen upgrading to platform update 3 from an earlier build, there are some very important considerations, this is because of two key changes in update 3:\n\n1.  It is no longer possible to overlayer platform models (Application Platform, Application Foundation, Test Essentials).\n2.  The Directory model is no longer in platform, it has moved to the application in the Dynamics 365 for Operations release 1611.\n\nThis means two things:\n\n1.  If taking only platform update 3 and not taking the application update (Dynamics 365 for Operations version 1611) then you cannot have overlayering on any of the below models. All overlayering on these models must be removed before attempting to install update 3:\n    -   Application Platform\n    -   Application Foundation\n    -   Test Essentials\n    -   Directory\n\n2.  If you cannot remove over-layering from the Directory model, and you still want to upgrade, you will have to do a complete upgrade of the platform and the application (Dynamics 365 for Operations version 1611) as described in this [topic](https://docs.microsoft.com/en-us/dynamics365/operations/dev-itpro/migration-upgrade/process-for-upgrading-to-the-latest-dynamics-ax-update).\n\n\n"}