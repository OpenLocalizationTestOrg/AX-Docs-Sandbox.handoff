{"content":"---\n# required metadata\n\ntitle: Reset the financial reporting data mart after restoring a database\ndescription: This topic describes how to reset the financial reporting data mart after restoring a Microsoft Dynamics 365 for Operations database. \nauthor: ShylaThompson\nmanager: AnnBe\nms.date: 04/04/2017\nms.topic: article\nms.prod: \nms.service: dynamics-ax-platform\nms.technology: \n\n# optional metadata\n\n# ms.search.form: \n# ROBOTS: \naudience: Application User, IT Pro\n# ms.devlang: \n# ms.reviewer: ShylaThompson\nms.search.scope: Operations, Core\n# ms.tgt_pltfrm: \nms.custom: 261824\nms.assetid: d0784b2c-fe10-428d-8d07-fd474ca50fcc\nms.search.region: Global\n# ms.search.industry: \nms.author: kweekley\nms.search.validFrom: 2016-11-30\nms.dyn365.ops.version: Version 1611\n\n---\n\n# Reset the financial reporting data mart after restoring a database\n\n[!include[banner](../includes/banner.md)]\n\n\nThis topic describes how to reset the financial reporting data mart after restoring a Microsoft Dynamics 365 for Operations database. \n\nThere are several scenarios where you may need to restore your Dynamics 365 for Operations database from a backup or copy the database from another environment. When this occurs, you also need to follow the appropriate steps to ensure that the financial reporting data mart is correctly using the restored Dynamics 365 for Operations database. If you have questions about resetting the financial reporting data mart for a reason outside of restoring a Dynamics 365 for Operations database, refer to the [Resetting the Management Reporter data mart](https://blogs.msdn.microsoft.com/dynamics_financial_reporting/2016/06/28/resetting-the-management-reporter-data-mart/) for more information. Note that the steps in this process are supported for Dynamics 365 for Operation May 2016 release (App build 7.0.1265.23014 and financial reporting build 7.0.10000.4) and newer releases. If you have an earlier release of Dynamics 365 for Operations, please contact our Support team for assistance.\n\n## Export report definitions\nFirst, export the report designs located in the Report Designer, using the following steps:\n\n1.  In the Report Designer, go to **Company** &gt; **Building Block Groups**.\n2.  Select the building block group to export, and click **Export**. **Note:** For Dynamics 365 for Operations, only one building block group is supported, **Default**.\n3.  Select the report definitions to export:\n    -   To export all your report definitions and the associated building blocks, click **Select All**.\n    -   To export specific reports, rows, columns, trees, or dimension sets, click the appropriate tab, and then select the items to export. Press and hold the Ctrl key to select multiple items in a tab. When you select reports to export, the associated rows, columns, trees, and dimension sets are selected.\n\n4.  Click **Export**.\n5.  Enter a file name and select a secure location where you want to save the exported report definitions.\n6.  Click **Save**.\n\nThe file can be copied or uploaded to a secure location, allowing it to be imported into a different environment at another time. Information about using a Microsoft Azure storage account can be found in [Transfer data with the AzCopy Command-Line Utility](https://docs.microsoft.com/en-gb/azure/storage/storage-use-azcopy). \n> [!NOTE]\n> Microsoft doesn’t provide a storage account as part of your Dynamics 365 for Operations agreement. You must either purchase a storage account or use a storage account from a separate Azure subscription. \n> [!WARNING]\n> Be aware of the behavior of the D drive on Azure Virtual Machines. Do not keep your exported building block groups here permanently. For more information about temporary drives, see [Understanding the temporary drive on Windows Azure Virtual Machines](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).\n\n## Stop services\nUse Remote Desktop to connect to all the computers in the environment and stop the following Windows services by using services.msc:\n\n-   World wide web publishing service (on all AOS computers)\n-   Microsoft Dynamics 365 for Operations Batch Management Service (on non-private AOS computers only)\n-   Management Reporter 2012 Process Service (on BI computers only)\n\nThese services will have open connections to the Dynamics 365 for Operations database.\n\n## Reset\n#### Locate the latest DataUpgrade.zip package\n\nLocate the latest DataUpgrade.zip package using the directions found in [Download the DataUpgrade.zip script](..\\migration-upgrade\\upgrade-data-to-latest-update.md). The directions explain how to locate the correct version of the data upgrade package for your environment.\n\n#### Execute scripts against Dynamics 365 for Operations database\n\nRun the following scripts against the Dynamics 365 for Operations database (not against the financial reporting database).\n\n-   DataUpgrade.zip\\\\AosService\\\\Scripts\\\\ConfigureAxReportingIntegration.sql\n-   DataUpgrade.zip\\\\AosService\\\\Scripts\\\\GrantAzViewChangeTracking.sql\n\nThese scripts ensure that the users, roles, and change tracking settings are correct.\n\n#### Execute PowerShell command to reset database\n\nExecute the following command, directly on the AOS computer, to reset the integration between Dynamics 365 for Operations and financial reporting:\n\n1.  Open Windows PowerShell as Administrator.\n2.  Execute: F:\n3.  Execute: cd F:\\\\MRApplicationService\\\\MRInstallDirectory\n4.  Execute: Import-Module .\\\\Server\\\\MRDeploy\\\\MRDeploy.psd1\n5.  Execute: Reset-DatamartIntegration -Reason OTHER -ReasonDetail “&lt;my reason for resetting&gt;”\n    -   You will be asked to enter “Y” to confirm.\n\nExplanation of parameters:\n\n-   The valid values for -Reason are: SERVICING, BADDATA, OTHER.\n-   The -ReasonDetail parameter is free text.\n-   The reason and reasonDetail will be recorded in telemetry/environment monitoring.\n\n## Start services\nUse services.msc to restart the services that you stopped earlier:\n\n-   World wide web publishing service (on all AOS computers)\n-   Microsoft Dynamics 365 for Operations Batch Management Service (on non-private AOS computers only)\n-   Management Reporter 2012 Process Service (on BI computers only)\n\n## Import report definitions\nImport your report designs from the Report Designer, using the file created during the export:\n\n1.  In the Report Designer, go to **Company** &gt; **Building Block Groups**.\n2.  Select the building block group to export, and click **Export**. \n    > [!NOTE]\n    > For Dynamics 365 for Operations, only one building block group is supported, **Default**.\n3.  Select the **Default** building block and click **Import**.\n4.  Select the file containing the exported report definitions and click **Open**.\n5.  In the Import dialog box, select the report definitions to import:\n    -   To import all the report definitions and the supporting building blocks, click **Select All**.\n    -   To import specific reports, rows, columns, trees, or dimension sets, select the reports, rows, columns, trees, or dimension sets to import.\n\n6.  Click **Import**.\n\n\n\n\n","nodes":[{"pos":[32,98],"content":"Reset the financial reporting data mart after restoring a database","needQuote":true,"needEscape":true,"nodes":[{"content":"Reset the financial reporting data mart after restoring a database","pos":[0,66]}]},{"pos":[112,245],"content":"This topic describes how to reset the financial reporting data mart after restoring a Microsoft Dynamics 365 for Operations database.","needQuote":true,"needEscape":true,"nodes":[{"content":"This topic describes how to reset the financial reporting data mart after restoring a Microsoft Dynamics 365 for Operations database.","pos":[0,133]}]},{"pos":[775,841],"content":"Reset the financial reporting data mart after restoring a database","linkify":"Reset the financial reporting data mart after restoring a database","nodes":[{"content":"Reset the financial reporting data mart after restoring a database","pos":[0,66]}]},{"content":"This topic describes how to reset the financial reporting data mart after restoring a Microsoft Dynamics 365 for Operations database.","pos":[887,1020]},{"content":"There are several scenarios where you may need to restore your Dynamics 365 for Operations database from a backup or copy the database from another environment.","pos":[1023,1183]},{"content":"When this occurs, you also need to follow the appropriate steps to ensure that the financial reporting data mart is correctly using the restored Dynamics 365 for Operations database.","pos":[1184,1366]},{"content":"If you have questions about resetting the financial reporting data mart for a reason outside of restoring a Dynamics 365 for Operations database, refer to the <bpt id=\"p1\">[</bpt>Resetting the Management Reporter data mart<ept id=\"p1\">](https://blogs.msdn.microsoft.com/dynamics_financial_reporting/2016/06/28/resetting-the-management-reporter-data-mart/)</ept> for more information.","pos":[1367,1712],"source":" If you have questions about resetting the financial reporting data mart for a reason outside of restoring a Dynamics 365 for Operations database, refer to the [Resetting the Management Reporter data mart](https://blogs.msdn.microsoft.com/dynamics_financial_reporting/2016/06/28/resetting-the-management-reporter-data-mart/) for more information."},{"content":"Note that the steps in this process are supported for Dynamics 365 for Operation May 2016 release (App build 7.0.1265.23014 and financial reporting build 7.0.10000.4) and newer releases.","pos":[1713,1899]},{"content":"If you have an earlier release of Dynamics 365 for Operations, please contact our Support team for assistance.","pos":[1900,2010]},{"pos":[2015,2040],"content":"Export report definitions","linkify":"Export report definitions","nodes":[{"content":"Export report definitions","pos":[0,25]}]},{"content":"First, export the report designs located in the Report Designer, using the following steps:","pos":[2041,2132]},{"pos":[2138,2211],"content":"In the Report Designer, go to <bpt id=\"p1\">**</bpt>Company<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Building Block Groups<ept id=\"p2\">**</ept>.","source":"In the Report Designer, go to **Company** &gt; **Building Block Groups**."},{"content":"Select the building block group to export, and click <bpt id=\"p1\">**</bpt>Export<ept id=\"p1\">**</ept>.","pos":[2216,2280],"source":"Select the building block group to export, and click **Export**."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept> For Dynamics 365 for Operations, only one building block group is supported, <bpt id=\"p2\">**</bpt>Default<ept id=\"p2\">**</ept>.","pos":[2281,2380],"source":"**Note:** For Dynamics 365 for Operations, only one building block group is supported, **Default**."},{"content":"Select the report definitions to export:","pos":[2385,2425]},{"pos":[2434,2529],"content":"To export all your report definitions and the associated building blocks, click <bpt id=\"p1\">**</bpt>Select All<ept id=\"p1\">**</ept>.","source":"To export all your report definitions and the associated building blocks, click **Select All**."},{"content":"To export specific reports, rows, columns, trees, or dimension sets, click the appropriate tab, and then select the items to export.","pos":[2538,2670]},{"content":"Press and hold the Ctrl key to select multiple items in a tab.","pos":[2671,2733]},{"content":"When you select reports to export, the associated rows, columns, trees, and dimension sets are selected.","pos":[2734,2838]},{"pos":[2844,2861],"content":"Click <bpt id=\"p1\">**</bpt>Export<ept id=\"p1\">**</ept>.","source":"Click **Export**."},{"content":"Enter a file name and select a secure location where you want to save the exported report definitions.","pos":[2866,2968]},{"pos":[2973,2988],"content":"Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept>.","source":"Click **Save**."},{"content":"The file can be copied or uploaded to a secure location, allowing it to be imported into a different environment at another time.","pos":[2990,3119]},{"content":"Information about using a Microsoft Azure storage account can be found in <bpt id=\"p1\">[</bpt>Transfer data with the AzCopy Command-Line Utility<ept id=\"p1\">](https://docs.microsoft.com/en-gb/azure/storage/storage-use-azcopy)</ept>.","pos":[3120,3314],"source":" Information about using a Microsoft Azure storage account can be found in [Transfer data with the AzCopy Command-Line Utility](https://docs.microsoft.com/en-gb/azure/storage/storage-use-azcopy)."},{"pos":[3318,3918],"content":"[!NOTE]\nMicrosoft doesn’t provide a storage account as part of your Dynamics 365 for Operations agreement. You must either purchase a storage account or use a storage account from a separate Azure subscription. \n[!WARNING]\nBe aware of the behavior of the D drive on Azure Virtual Machines. Do not keep your exported building block groups here permanently. For more information about temporary drives, see [Understanding the temporary drive on Windows Azure Virtual Machines](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).","leadings":["","> ","> ","> "],"nodes":[{"content":"Microsoft doesn’t provide a storage account as part of your Dynamics 365 for Operations agreement. You must either purchase a storage account or use a storage account from a separate Azure subscription. \n[!WARNING]","pos":[8,222],"nodes":[{"content":"Microsoft doesn’t provide a storage account as part of your Dynamics 365 for Operations agreement.","pos":[0,98]},{"content":"You must either purchase a storage account or use a storage account from a separate Azure subscription.","pos":[99,202]}]},{"content":"Be aware of the behavior of the D drive on Azure Virtual Machines. Do not keep your exported building block groups here permanently. For more information about temporary drives, see [Understanding the temporary drive on Windows Azure Virtual Machines](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).","pos":[223,594],"nodes":[{"content":"Be aware of the behavior of the D drive on Azure Virtual Machines.","pos":[0,66]},{"content":"Do not keep your exported building block groups here permanently.","pos":[67,132]},{"content":"For more information about temporary drives, see <bpt id=\"p1\">[</bpt>Understanding the temporary drive on Windows Azure Virtual Machines<ept id=\"p1\">](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/)</ept>.","pos":[133,371],"source":" For more information about temporary drives, see [Understanding the temporary drive on Windows Azure Virtual Machines](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/)."}]}]},{"pos":[3923,3936],"content":"Stop services","linkify":"Stop services","nodes":[{"content":"Stop services","pos":[0,13]}]},{"content":"Use Remote Desktop to connect to all the computers in the environment and stop the following Windows services by using services.msc:","pos":[3937,4069]},{"content":"World wide web publishing service (on all AOS computers)","pos":[4075,4131]},{"content":"Microsoft Dynamics 365 for Operations Batch Management Service (on non-private AOS computers only)","pos":[4136,4234]},{"content":"Management Reporter 2012 Process Service (on BI computers only)","pos":[4239,4302]},{"content":"These services will have open connections to the Dynamics 365 for Operations database.","pos":[4304,4390]},{"pos":[4395,4400],"content":"Reset","linkify":"Reset","nodes":[{"content":"Reset","pos":[0,5]}]},{"pos":[4406,4447],"content":"Locate the latest DataUpgrade.zip package","linkify":"Locate the latest DataUpgrade.zip package","nodes":[{"content":"Locate the latest DataUpgrade.zip package","pos":[0,41]}]},{"content":"Locate the latest DataUpgrade.zip package using the directions found in <bpt id=\"p1\">[</bpt>Download the DataUpgrade.zip script<ept id=\"p1\">](..\\migration-upgrade\\upgrade-data-to-latest-update.md)</ept>.","pos":[4449,4614],"source":"Locate the latest DataUpgrade.zip package using the directions found in [Download the DataUpgrade.zip script](..\\migration-upgrade\\upgrade-data-to-latest-update.md)."},{"content":"The directions explain how to locate the correct version of the data upgrade package for your environment.","pos":[4615,4721]},{"pos":[4728,4788],"content":"Execute scripts against Dynamics 365 for Operations database","linkify":"Execute scripts against Dynamics 365 for Operations database","nodes":[{"content":"Execute scripts against Dynamics 365 for Operations database","pos":[0,60]}]},{"content":"Run the following scripts against the Dynamics 365 for Operations database (not against the financial reporting database).","pos":[4790,4912]},{"content":"DataUpgrade.zip<ph id=\"ph1\">\\\\</ph>AosService<ph id=\"ph2\">\\\\</ph>Scripts<ph id=\"ph3\">\\\\</ph>ConfigureAxReportingIntegration.sql","pos":[4918,4991],"source":"DataUpgrade.zip\\\\AosService\\\\Scripts\\\\ConfigureAxReportingIntegration.sql"},{"content":"DataUpgrade.zip<ph id=\"ph1\">\\\\</ph>AosService<ph id=\"ph2\">\\\\</ph>Scripts<ph id=\"ph3\">\\\\</ph>GrantAzViewChangeTracking.sql","pos":[4996,5063],"source":"DataUpgrade.zip\\\\AosService\\\\Scripts\\\\GrantAzViewChangeTracking.sql"},{"content":"These scripts ensure that the users, roles, and change tracking settings are correct.","pos":[5065,5150]},{"pos":[5157,5201],"content":"Execute PowerShell command to reset database","linkify":"Execute PowerShell command to reset database","nodes":[{"content":"Execute PowerShell command to reset database","pos":[0,44]}]},{"content":"Execute the following command, directly on the AOS computer, to reset the integration between Dynamics 365 for Operations and financial reporting:","pos":[5203,5349]},{"content":"Open Windows PowerShell as Administrator.","pos":[5355,5396]},{"content":"Execute: F:","pos":[5401,5412]},{"content":"Execute: cd F:<ph id=\"ph1\">\\\\</ph>MRApplicationService<ph id=\"ph2\">\\\\</ph>MRInstallDirectory","pos":[5417,5473],"source":"Execute: cd F:\\\\MRApplicationService\\\\MRInstallDirectory"},{"content":"Execute: Import-Module .<ph id=\"ph1\">\\\\</ph>Server<ph id=\"ph2\">\\\\</ph>MRDeploy<ph id=\"ph3\">\\\\</ph>MRDeploy.psd1","pos":[5478,5535],"source":"Execute: Import-Module .\\\\Server\\\\MRDeploy\\\\MRDeploy.psd1"},{"content":"Execute: Reset-DatamartIntegration -Reason OTHER -ReasonDetail “<ph id=\"ph1\">&amp;lt;</ph>my reason for resetting<ph id=\"ph2\">&amp;gt;</ph>”","pos":[5540,5636],"source":"Execute: Reset-DatamartIntegration -Reason OTHER -ReasonDetail “&lt;my reason for resetting&gt;”"},{"content":"You will be asked to enter “Y” to confirm.","pos":[5645,5687]},{"content":"Explanation of parameters:","pos":[5689,5715]},{"content":"The valid values for -Reason are: SERVICING, BADDATA, OTHER.","pos":[5721,5781]},{"content":"The -ReasonDetail parameter is free text.","pos":[5786,5827]},{"content":"The reason and reasonDetail will be recorded in telemetry/environment monitoring.","pos":[5832,5913]},{"pos":[5918,5932],"content":"Start services","linkify":"Start services","nodes":[{"content":"Start services","pos":[0,14]}]},{"content":"Use services.msc to restart the services that you stopped earlier:","pos":[5933,5999]},{"content":"World wide web publishing service (on all AOS computers)","pos":[6005,6061]},{"content":"Microsoft Dynamics 365 for Operations Batch Management Service (on non-private AOS computers only)","pos":[6066,6164]},{"content":"Management Reporter 2012 Process Service (on BI computers only)","pos":[6169,6232]},{"pos":[6237,6262],"content":"Import report definitions","linkify":"Import report definitions","nodes":[{"content":"Import report definitions","pos":[0,25]}]},{"content":"Import your report designs from the Report Designer, using the file created during the export:","pos":[6263,6357]},{"pos":[6363,6436],"content":"In the Report Designer, go to <bpt id=\"p1\">**</bpt>Company<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Building Block Groups<ept id=\"p2\">**</ept>.","source":"In the Report Designer, go to **Company** &gt; **Building Block Groups**."},{"pos":[6441,6505],"content":"Select the building block group to export, and click <bpt id=\"p1\">**</bpt>Export<ept id=\"p1\">**</ept>.","source":"Select the building block group to export, and click **Export**."},{"pos":[6513,6616],"content":"[!NOTE]\nFor Dynamics 365 for Operations, only one building block group is supported, **Default**.","leadings":["","    > "],"nodes":[{"content":"For Dynamics 365 for Operations, only one building block group is supported, <bpt id=\"p1\">**</bpt>Default<ept id=\"p1\">**</ept>.","pos":[8,97],"source":"For Dynamics 365 for Operations, only one building block group is supported, **Default**."}]},{"pos":[6621,6680],"content":"Select the <bpt id=\"p1\">**</bpt>Default<ept id=\"p1\">**</ept> building block and click <bpt id=\"p2\">**</bpt>Import<ept id=\"p2\">**</ept>.","source":"Select the **Default** building block and click **Import**."},{"pos":[6685,6763],"content":"Select the file containing the exported report definitions and click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>.","source":"Select the file containing the exported report definitions and click **Open**."},{"content":"In the Import dialog box, select the report definitions to import:","pos":[6768,6834]},{"pos":[6843,6937],"content":"To import all the report definitions and the supporting building blocks, click <bpt id=\"p1\">**</bpt>Select All<ept id=\"p1\">**</ept>.","source":"To import all the report definitions and the supporting building blocks, click **Select All**."},{"content":"To import specific reports, rows, columns, trees, or dimension sets, select the reports, rows, columns, trees, or dimension sets to import.","pos":[6946,7085]},{"pos":[7091,7108],"content":"Click <bpt id=\"p1\">**</bpt>Import<ept id=\"p1\">**</ept>.","source":"Click **Import**."}]}