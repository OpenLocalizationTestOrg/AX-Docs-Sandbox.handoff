{"nodes":[{"pos":[32,65],"content":"Date effectivity | Microsoft Docs","needQuote":true,"needEscape":true,"nodes":[{"content":"Date effectivity | Microsoft Docs","pos":[0,33]}]},{"pos":[79,288],"content":"This topic provides information about date-effective data entities and data sources, and shows how to create a date-effective entity. It also explains how date effectivity applies to read and write activities.","needQuote":true,"needEscape":true,"nodes":[{"content":"This topic provides information about date-effective data entities and data sources, and shows how to create a date-effective entity. It also explains how date effectivity applies to read and write activities.","pos":[0,209],"nodes":[{"content":"This topic provides information about date-effective data entities and data sources, and shows how to create a date-effective entity.","pos":[0,133]},{"content":"It also explains how date effectivity applies to read and write activities.","pos":[134,209]}]}]},{"pos":[711,727],"content":"Date effectivity","linkify":"Date effectivity","nodes":[{"content":"Date effectivity","pos":[0,16]}]},{"content":"This topic provides information about date-effective data entities and data sources, and shows how to create a date-effective entity.","pos":[729,862]},{"content":"It also explains how date effectivity applies to read and write activities.","pos":[863,938]},{"content":"There are different design patterns for date-effective features that involve data entities.","pos":[940,1031]},{"content":"The patterns are classified into two main categories:","pos":[1032,1085]},{"pos":[1091,1222],"content":"<bpt id=\"p1\">**</bpt>Date-effective entities<ept id=\"p1\">**</ept> – The entity has at least one date-effective data source, and the entity itself is also date effective.","source":"**Date-effective entities** – The entity has at least one date-effective data source, and the entity itself is also date effective."},{"pos":[1227,1350],"content":"<bpt id=\"p1\">**</bpt>Non-date-effective entities<ept id=\"p1\">**</ept> – The entity itself is not date effective, but it does contain date-effective data sources.","source":"**Non-date-effective entities** – The entity itself is not date effective, but it does contain date-effective data sources."},{"content":"The next sections describe the small list of properties and methods that control the date-effective behavior of entities and their date-effective data sources.","pos":[1352,1511]},{"pos":[1516,1538],"content":"Dateeffective entities","linkify":"Dateeffective entities","nodes":[{"content":"Dateeffective entities","pos":[0,22]}]},{"content":"The following table describes the properties that control the date-effective behavior of a data entity.","pos":[1539,1642]},{"content":"Property name of the entity","pos":[1646,1673]},{"content":"Node of the property","pos":[1676,1696]},{"content":"Value","pos":[1734,1739]},{"content":"Description","pos":[1748,1759]},{"content":"ValidTimeStateEnabled","pos":[2556,2577]},{"content":"Data entity node in the designer","pos":[2586,2618]},{"content":"Yes (or No)","pos":[2644,2655]},{"content":"The value <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> makes the entity date effective.","pos":[2658,2708],"source":"The value **Yes** makes the entity date effective."},{"content":"The entity must have <bpt id=\"p1\">**</bpt>ValidFrom<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>ValidTo<ept id=\"p2\">**</ept> fields.","pos":[2709,2767],"source":" The entity must have **ValidFrom** and **ValidTo** fields."},{"content":"These fields are mapped to the <bpt id=\"p1\">**</bpt>ValidFrom<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>ValidTo<ept id=\"p2\">**</ept> fields of a date-effective data source.","pos":[2768,2868],"source":" These fields are mapped to the **ValidFrom** and **ValidTo** fields of a date-effective data source."},{"content":"The value <bpt id=\"p1\">**</bpt>No<ept id=\"p1\">**</ept> does <bpt id=\"p2\">*</bpt>not<ept id=\"p2\">*</ept> disable the enforcement of date effectivity on any date-effective tables that are data sources of the entity.","pos":[2869,3006],"source":" The value **No** does *not* disable the enforcement of date effectivity on any date-effective tables that are data sources of the entity."},{"content":"ValidTimeStateKey","pos":[3011,3028]},{"pos":[3041,3096],"content":"Under the data entity node, <bpt id=\"p1\">**</bpt>Keys<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>EntityKey<ept id=\"p2\">**</ept>","source":"Under the data entity node, **Keys** &gt; **EntityKey**"},{"content":"Yes (or No)","pos":[3099,3110]},{"pos":[3113,3230],"content":"The value <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> identifies the key that is required to enforce the date-effective values on this particular entity.","source":"The value **Yes** identifies the key that is required to enforce the date-effective values on this particular entity."},{"pos":[3468,3483],"content":"Read activities","linkify":"Read activities","nodes":[{"content":"Read activities","pos":[0,15]}]},{"content":"When date effectivity is set at the data entity level, reads from the entity behave the same way as reads from a table.","pos":[3484,3603]},{"content":"The entity has <bpt id=\"p1\">**</bpt>ValidFrom<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>ValidTo<ept id=\"p2\">**</ept> fields that the system applies date filters to during reads.","pos":[3604,3709],"source":" The entity has **ValidFrom** and **ValidTo** fields that the system applies date filters to during reads."},{"pos":[3715,3775],"content":"Query modes and the validtimestate keyword of X++ SQL select","linkify":"Query modes and the validtimestate keyword of X++ SQL select","nodes":[{"content":"Query modes and the validtimestate keyword of X++ SQL select","pos":[0,60]}]},{"pos":[3777,3907],"content":"A date-effective entity supports the following three <bpt id=\"p1\">*</bpt>query modes<ept id=\"p1\">*</ept>, which vary in their use of the X++ <bpt id=\"p2\">**</bpt>validtimestate<ept id=\"p2\">**</ept> keyword:","source":"A date-effective entity supports the following three *query modes*, which vary in their use of the X++ **validtimestate** keyword:"},{"pos":[3913,4015],"content":"<bpt id=\"p1\">**</bpt>Default mode<ept id=\"p1\">**</ept> – Current records are returned using <ph id=\"ph1\">`select * from FMVehicleRateEntity; // X++ SQL.`</ph>","source":"**Default mode** – Current records are returned using `select * from FMVehicleRateEntity; // X++ SQL.`"},{"pos":[4020,4151],"content":"<bpt id=\"p1\">**</bpt>AsOfDate mode<ept id=\"p1\">**</ept> – Records valid for the specified date are returned using <ph id=\"ph1\">`select validtimestate(d1) * from FMVehicleRateEntity;`</ph>","source":"**AsOfDate mode** – Records valid for the specified date are returned using `select validtimestate(d1) * from FMVehicleRateEntity;`"},{"pos":[4156,4301],"content":"<bpt id=\"p1\">**</bpt>AsOfDateRange mode<ept id=\"p1\">**</ept> – Records valid for the specified date range are returned using <ph id=\"ph1\">`select validtimestate(d1,d2) * from FMVehicleRateEntity;`</ph>","source":"**AsOfDateRange mode** – Records valid for the specified date range are returned using `select validtimestate(d1,d2) * from FMVehicleRateEntity;`"},{"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept> For data entities that aren't themselves date effective, but that have a data-effective data source, only the default query mode is available.","pos":[4303,4460],"source":"**Important:** For data entities that aren't themselves date effective, but that have a data-effective data source, only the default query mode is available."},{"content":"This concept is discussed later in this article.","pos":[4461,4509]},{"pos":[4515,4562],"content":"Applying a date filter at the data source level","linkify":"Applying a date filter at the data source level","nodes":[{"content":"Applying a date filter at the data source level","pos":[0,47]}]},{"content":"There are scenarios where date-effective filtering is required outside the data entity, at the data source level.","pos":[4564,4677]},{"content":"For example, the customer entity (CustTableTestEntity) contains CustTable and LogisticsPostalAddress as data sources, where LogisticsPostalAddress is a date-effective table and CustTable is a regular table.","pos":[4678,4884]},{"content":"The purpose of a customer entity is to have a list of customers and their active primary addresses, if they have primary addresses.","pos":[4885,5016]},{"content":"Therefore, the customer entity itself isn't date effective, but it requires date filters on one of the data sources.","pos":[5017,5133]},{"content":"In this case, the entity isn't marked <bpt id=\"p1\">**</bpt>ValidTimeStateEnabled<ept id=\"p1\">**</ept>.","pos":[5134,5198],"source":" In this case, the entity isn't marked **ValidTimeStateEnabled**."},{"content":"Instead, an <bpt id=\"p1\">**</bpt>Apply Date Filter<ept id=\"p1\">**</ept> property is added on the data source.","pos":[5199,5270],"source":" Instead, an **Apply Date Filter** property is added on the data source."},{"content":"If the value of <bpt id=\"p1\">**</bpt>Apply Date Filter<ept id=\"p1\">**</ept> is set to <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>, date filters are automatically applied to that data source.","pos":[5271,5387],"source":" If the value of **Apply Date Filter** is set to **Yes**, date filters are automatically applied to that data source."},{"content":"The following table describes the properties that control the date-effective behavior of a date-effective data source of a data entity.","pos":[5388,5523]},{"content":"Property name of the data source","pos":[5527,5559]},{"content":"Node of the property","pos":[5562,5582]},{"content":"Value","pos":[5613,5618]},{"content":"Description","pos":[5627,5638]},{"content":"Apply Date Filter","pos":[6341,6358]},{"content":"Node of any particular data source of the entity","pos":[6376,6424]},{"content":"Yes (or No)","pos":[6427,6438]},{"content":"For <bpt id=\"p1\">*</bpt>reads<ept id=\"p1\">*</ept>, this property controls whether date filters are applied on the entity data source.","pos":[6441,6536],"source":"For *reads*, this property controls whether date filters are applied on the entity data source."},{"content":"In this case, the data source should be marked <bpt id=\"p1\">**</bpt>ValidTimeStateEnabled<ept id=\"p1\">**</ept>.","pos":[6537,6610],"source":" In this case, the data source should be marked **ValidTimeStateEnabled**."},{"content":"This property value has effect regardless of whether the entity itself is date effective.","pos":[6611,6700]},{"content":"For <bpt id=\"p1\">*</bpt>writes<ept id=\"p1\">*</ept>, this property has no effect.","pos":[6701,6743],"source":" For *writes*, this property has no effect."},{"content":"This article describes the use of these date-effective properties and the interactions between them.","pos":[6747,6847]},{"pos":[6853,6877],"content":"State matrixes for reads","linkify":"State matrixes for reads","nodes":[{"content":"State matrixes for reads","pos":[0,24]}]},{"content":"This section concerns only reads from the data entity.","pos":[6879,6933]},{"content":"The following pair of reference matrixes describe the combinations of date-effective states that can exist between a data entity and its data source.","pos":[6934,7083]},{"content":"Each table contains four cases, and each case discusses two distinct targets.","pos":[7084,7161]},{"content":"Here are the primary points that you should understand:","pos":[7162,7217]},{"content":"On any given read from the entity, the query mode is the same for both the entity and date-effective data sources.","pos":[7223,7337]},{"content":"If the entity is not date effective, the query mode is limited to the default mode.","pos":[7342,7425]},{"content":"Therefore, the date-effective data source is accessed only for the current date.","pos":[7426,7506]},{"pos":[7511,7670],"content":"On the date-effective data source, the <bpt id=\"p1\">**</bpt>Apply Date Filter<ept id=\"p1\">**</ept> property can be set to <bpt id=\"p2\">**</bpt>No<ept id=\"p2\">**</ept> to make the data source return all data – past, current, and future.","source":"On the date-effective data source, the **Apply Date Filter** property can be set to **No** to make the data source return all data – past, current, and future."},{"content":"For OData, date-effective filters are not applied to the data entity.","pos":[7675,7744]},{"content":"However, filters on the data source are applied at all code paths.","pos":[7745,7811]},{"content":"A.","pos":[7813,7815]},{"content":"Entity <bpt id=\"p1\">*</bpt>is<ept id=\"p1\">*</ept> date effective, because ValidTimeStateEnabled = Yes","pos":[7816,7879],"source":" Entity *is* date effective, because ValidTimeStateEnabled = Yes"},{"pos":[7881,7916],"content":"<bpt id=\"p1\">*</bpt><bpt id=\"p2\">*</bpt>Data source <ept id=\"p2\">*</ept>is<ept id=\"p1\">*</ept> date effective**","source":"**Data source *is* date effective**"},{"pos":[7918,7957],"content":"<bpt id=\"p1\">*</bpt><bpt id=\"p2\">*</bpt>Data source is <ept id=\"p2\">*</ept>not<ept id=\"p1\">*</ept> date effective**","source":"**Data source is *not* date effective**"},{"pos":[7959,7986],"content":"<bpt id=\"p1\">**</bpt>Apply Date Filter = Yes<ept id=\"p1\">**</ept>","source":"**Apply Date Filter = Yes**"},{"content":"<bpt id=\"p1\">**</bpt>Entity:<ept id=\"p1\">**</ept> Date filters are applied.","pos":[7992,8029],"source":"**Entity:** Date filters are applied."},{"content":"Any query mode is supported.","pos":[8030,8058]},{"content":"<bpt id=\"p1\">**</bpt>Data source:<ept id=\"p1\">**</ept> Filters are applied.","pos":[8063,8100],"source":"**Data source:** Filters are applied."},{"content":"Any query mode is supported, but the mode is the same as is coded for the entity.","pos":[8101,8182]},{"content":"Non-date-effective data sources aren't affected.","pos":[8184,8232]},{"pos":[8234,8260],"content":"<bpt id=\"p1\">**</bpt>Apply Date Filter = No<ept id=\"p1\">**</ept>","source":"**Apply Date Filter = No**"},{"content":"<bpt id=\"p1\">**</bpt>Entity:<ept id=\"p1\">**</ept> Date filters are applied.","pos":[8266,8303],"source":"**Entity:** Date filters are applied."},{"content":"Any query mode is supported.","pos":[8304,8332]},{"pos":[8337,8382],"content":"<bpt id=\"p1\">**</bpt>Data source:<ept id=\"p1\">**</ept> No date filters are applied.","source":"**Data source:** No date filters are applied."},{"content":"Non-date-effective data sources aren't affected.","pos":[8384,8432]},{"content":"B.","pos":[8437,8439]},{"content":"Entity is <bpt id=\"p1\">*</bpt>not<ept id=\"p1\">*</ept> date effective, because ValidTimeStateEnabled = No","pos":[8440,8506],"source":" Entity is *not* date effective, because ValidTimeStateEnabled = No"},{"pos":[8508,8543],"content":"<bpt id=\"p1\">*</bpt><bpt id=\"p2\">*</bpt>Data source <ept id=\"p2\">*</ept>is<ept id=\"p1\">*</ept> date effective**","source":"**Data source *is* date effective**"},{"pos":[8545,8584],"content":"<bpt id=\"p1\">*</bpt><bpt id=\"p2\">*</bpt>Data source is <ept id=\"p2\">*</ept>not<ept id=\"p1\">*</ept> date effective**","source":"**Data source is *not* date effective**"},{"pos":[8586,8613],"content":"<bpt id=\"p1\">**</bpt>Apply Date Filter = Yes<ept id=\"p1\">**</ept>","source":"**Apply Date Filter = Yes**"},{"pos":[8619,8659],"content":"<bpt id=\"p1\">**</bpt>Entity:<ept id=\"p1\">**</ept> No date filters are applied.","source":"**Entity:** No date filters are applied."},{"content":"<bpt id=\"p1\">**</bpt>Data source:<ept id=\"p1\">**</ept> Date filters are applied.","pos":[8664,8706],"source":"**Data source:** Date filters are applied."},{"content":"Only the default query mode is supported, where the X++ <bpt id=\"p1\">**</bpt>validtimestate<ept id=\"p1\">**</ept> keyword is omitted.","pos":[8707,8801],"source":" Only the default query mode is supported, where the X++ **validtimestate** keyword is omitted."},{"content":"Non-date-effective data sources aren't affected.","pos":[8803,8851]},{"pos":[8853,8879],"content":"<bpt id=\"p1\">**</bpt>Apply Date Filter = No<ept id=\"p1\">**</ept>","source":"**Apply Date Filter = No**"},{"pos":[8885,8925],"content":"<bpt id=\"p1\">**</bpt>Entity:<ept id=\"p1\">**</ept> No date filters are applied.","source":"**Entity:** No date filters are applied."},{"pos":[8930,8975],"content":"<bpt id=\"p1\">**</bpt>Data source:<ept id=\"p1\">**</ept> No date filters are applied.","source":"**Data source:** No date filters are applied."},{"content":"Non-date-effective data sources aren't affected.","pos":[8977,9025]},{"content":"The following screen shot shows the <bpt id=\"p1\">**</bpt>Apply Date Filter<ept id=\"p1\">**</ept> property set to <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>.","pos":[9027,9109],"source":"The following screen shot shows the **Apply Date Filter** property set to **Yes**."},{"content":"Therefore, date filters will be applied to reads of the <bpt id=\"p1\">**</bpt>Address<ept id=\"p1\">**</ept> data source.","pos":[9110,9190],"source":" Therefore, date filters will be applied to reads of the **Address** data source."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Apply Date Filter = Yes<ept id=\"p1\">](./media/date1.png)](./media/date1.png)</ept>","pos":[9191,9257],"source":"[![Apply Date Filter = Yes](./media/date1.png)](./media/date1.png)"},{"pos":[9262,9278],"content":"Write activities","linkify":"Write activities","nodes":[{"content":"Write activities","pos":[0,16]}]},{"content":"This section describes your options for configuring the behavior of date-effective entities and their date-effective data sources.","pos":[9279,9409]},{"content":"We will start by reviewing the concept of date-effective tables and contrasting them with date-effective entities.","pos":[9410,9524]},{"content":"<bpt id=\"p1\">**</bpt>Date-effective table:<ept id=\"p1\">**</ept> When data is inserted or updated in a date-effective table, the process has the option of calling the <bpt id=\"p2\">**</bpt>xRecord.validTimeStateUpdateMode<ept id=\"p2\">**</ept> method on the table buffer.","pos":[9525,9717],"source":"**Date-effective table:** When data is inserted or updated in a date-effective table, the process has the option of calling the **xRecord.validTimeStateUpdateMode** method on the table buffer."},{"content":"The method accepts an element of the <bpt id=\"p1\">**</bpt>ValidTimeStateUpdate<ept id=\"p1\">**</ept> enumeration.","pos":[9718,9792],"source":" The method accepts an element of the **ValidTimeStateUpdate** enumeration."},{"content":"Here are the available element values:","pos":[9793,9831]},{"content":"CreateNewTimePeriod","pos":[9837,9856]},{"content":"Correction","pos":[9861,9871]},{"content":"EffectiveBased","pos":[9876,9890]},{"content":"<bpt id=\"p1\">**</bpt>Date-effective entity:<ept id=\"p1\">**</ept> By contrast, when data is inserted or updated in a date-effective data entity, the <bpt id=\"p2\">**</bpt>validTimeStateUpdateMode<ept id=\"p2\">**</ept> method isn't used at the entity level.","pos":[9892,10069],"source":"**Date-effective entity:** By contrast, when data is inserted or updated in a date-effective data entity, the **validTimeStateUpdateMode** method isn't used at the entity level."},{"content":"For writes, the data entity leaves the date-effective processing to the table level.","pos":[10070,10154]},{"content":"You can use the <bpt id=\"p1\">**</bpt>Valid Time State Update<ept id=\"p1\">**</ept> property on the entity data source to specify the <bpt id=\"p2\">**</bpt>validTimeStateUpdateMode<ept id=\"p2\">**</ept> method to use for each data source of the data entity.","pos":[10155,10332],"source":" You can use the **Valid Time State Update** property on the entity data source to specify the **validTimeStateUpdateMode** method to use for each data source of the data entity."},{"pos":[10337,10368],"content":"Creating a dateeffective entity","linkify":"Creating a dateeffective entity","nodes":[{"content":"Creating a dateeffective entity","pos":[0,31]}]},{"content":"This section shows how to create a date-effective entity.","pos":[10369,10426]},{"pos":[10433,10453],"content":"Create a new project","linkify":"Create a new project","nodes":[{"content":"Create a new project","pos":[0,20]}]},{"pos":[10459,10566],"content":"Click <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Project<ept id=\"p3\">**</ept> to create a new Microsoft Dynamics 365 for Operations project.","source":"Click **File** &gt; **New** &gt; **Project** to create a new Microsoft Dynamics 365 for Operations project."},{"content":"In Solution Explorer, right-click your project, and then click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>.","pos":[10571,10649],"source":"In Solution Explorer, right-click your project, and then click **Properties**."},{"content":"The <bpt id=\"p1\">**</bpt>Property Pages<ept id=\"p1\">**</ept> dialog box for your project opens.","pos":[10650,10707],"source":" The **Property Pages** dialog box for your project opens."},{"content":"Change the value of the <bpt id=\"p1\">**</bpt>Synchronize database on build<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>True<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[10712,10814],"source":"Change the value of the **Synchronize database on build** property to **True**, and then click **OK**."},{"content":"You must set this property only one time per project.","pos":[10815,10868]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Synchronize database on build = True<ept id=\"p1\">](./media/date3.png)](./media/date3.png)</ept>","pos":[10869,10948],"source":"[![Synchronize database on build = True](./media/date3.png)](./media/date3.png)"},{"pos":[10955,10992],"content":"Add a new data entity to your project","linkify":"Add a new data entity to your project","nodes":[{"content":"Add a new data entity to your project","pos":[0,37]}]},{"pos":[10994,11079],"content":"Create a new entity that is named <bpt id=\"p1\">**</bpt>FMVehicleRateEntity<ept id=\"p1\">**</ept>, and add it to the project.","source":"Create a new entity that is named **FMVehicleRateEntity**, and add it to the project."},{"pos":[11085,11215],"content":"In the left pane, select <bpt id=\"p1\">**</bpt>Microsoft Dynamics 365 Artifacts<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Data Entity<ept id=\"p2\">**</ept> in the left column of the main pane.","source":"In the left pane, select **Microsoft Dynamics 365 Artifacts**, and then click **Data Entity** in the left column of the main pane."},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","pos":[11220,11234],"source":"Click **Add**."},{"content":"The <bpt id=\"p1\">**</bpt>Data Entity View<ept id=\"p1\">**</ept> wizard starts.","pos":[11235,11274],"source":" The **Data Entity View** wizard starts."},{"content":"Specify the property values for the data entity that you are creating, as shown in the following screen shot.","pos":[11279,11388]},{"content":"The most important field is <bpt id=\"p1\">**</bpt>Primary data source<ept id=\"p1\">**</ept>, where you select <bpt id=\"p2\">**</bpt>FMVehicleRate<ept id=\"p2\">**</ept>.","pos":[11389,11477],"source":" The most important field is **Primary data source**, where you select **FMVehicleRate**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Primary data source = FMVehicleRate<ept id=\"p1\">](./media/date5.png)](./media/date5.png)</ept> Click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","pos":[11478,11572],"source":"[![Primary data source = FMVehicleRate](./media/date5.png)](./media/date5.png) Click **Next**."},{"pos":[11577,11650],"content":"Add fields to the entity from the primary data source, <bpt id=\"p1\">**</bpt>FMVehicleRate<ept id=\"p1\">**</ept>.","source":"Add fields to the entity from the primary data source, **FMVehicleRate**."},{"content":"Select all fields, and then click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","pos":[11655,11700],"source":"Select all fields, and then click **Finish**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Selecting all the newly added fields<ept id=\"p1\">](./media/date6.png)](./media/date6.png)</ept> The items are added to the project in Solution Explorer.","pos":[11701,11837],"source":"[![Selecting all the newly added fields](./media/date6.png)](./media/date6.png) The items are added to the project in Solution Explorer."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>The project in Solution Explorer<ept id=\"p1\">](./media/date7.png)](./media/date7.png)</ept>","pos":[11838,11913],"source":"[![The project in Solution Explorer](./media/date7.png)](./media/date7.png)"},{"pos":[11920,11938],"content":"Build your project","linkify":"Build your project","nodes":[{"content":"Build your project","pos":[0,18]}]},{"pos":[11944,12006],"content":"Click <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Build Solution<ept id=\"p2\">**</ept> to build your project.","source":"Click **Build** &gt; **Build Solution** to build your project."},{"content":"Verify that the build has no errors.","pos":[12011,12047]},{"content":"Warnings should be tolerated at this stage in the process.","pos":[12048,12106]},{"pos":[12113,12141],"content":"Validate the property values","linkify":"Validate the property values","nodes":[{"content":"Validate the property values","pos":[0,28]}]},{"content":"In Solution Explorer, select the <bpt id=\"p1\">**</bpt>FMVehicleRateEntity<ept id=\"p1\">**</ept> node, and validate the properties of the <bpt id=\"p2\">**</bpt>FMVehicleRateEntity<ept id=\"p2\">**</ept> entity by comparing them to the values in the <bpt id=\"p3\">**</bpt>Properties<ept id=\"p3\">**</ept> pane.","pos":[12147,12335],"source":"In Solution Explorer, select the **FMVehicleRateEntity** node, and validate the properties of the **FMVehicleRateEntity** entity by comparing them to the values in the **Properties** pane."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Values in the Properties pane<ept id=\"p1\">](./media/date8.png)](./media/date8.png)</ept>","pos":[12336,12408],"source":"[![Values in the Properties pane](./media/date8.png)](./media/date8.png)"},{"pos":[12415,12446],"content":"Make your entity date effective","linkify":"Make your entity date effective","nodes":[{"content":"Make your entity date effective","pos":[0,31]}]},{"content":"In Solution Explorer, right-click the <bpt id=\"p1\">**</bpt>FMVehicleRateEntity<ept id=\"p1\">**</ept> node, and then click <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>.","pos":[12452,12544],"source":"In Solution Explorer, right-click the **FMVehicleRateEntity** node, and then click **Open**."},{"content":"The designer for the entity opens in the middle pane.","pos":[12545,12598]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Designer for the FMVehicleRateEntity entity<ept id=\"p1\">](./media/date9.png)](./media/date9.png)</ept>","pos":[12599,12685],"source":"[![Designer for the FMVehicleRateEntity entity](./media/date9.png)](./media/date9.png)"},{"content":"Change the value of the <bpt id=\"p1\">**</bpt>Validate Time State Enabled<ept id=\"p1\">**</ept> property to <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>.","pos":[12690,12766],"source":"Change the value of the **Validate Time State Enabled** property to **Yes**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Validate Time State Enabled = Yes<ept id=\"p1\">](./media/date10.png)](./media/date10.png)</ept>","pos":[12767,12845],"source":"[![Validate Time State Enabled = Yes](./media/date10.png)](./media/date10.png)"},{"pos":[12852,12933],"content":"Configure the Valid Time State Update property for the date-effective data source","linkify":"Configure the Valid Time State Update property for the date-effective data source","nodes":[{"content":"Configure the Valid Time State Update property for the date-effective data source","pos":[0,81]}]},{"content":"Select the <bpt id=\"p1\">**</bpt>FMVehicleRate<ept id=\"p1\">**</ept> data source, and then set the <bpt id=\"p2\">**</bpt>Valid Time State Update<ept id=\"p2\">**</ept> property to <bpt id=\"p3\">**</bpt>CreateNewTimePeriod<ept id=\"p3\">**</ept>.","pos":[12939,13062],"source":"Select the **FMVehicleRate** data source, and then set the **Valid Time State Update** property to **CreateNewTimePeriod**."},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Valid Time State Update = CreateNewTimePeriod<ept id=\"p1\">](./media/date11.png)](./media/date11.png)</ept>","pos":[13063,13153],"source":"[![Valid Time State Update = CreateNewTimePeriod](./media/date11.png)](./media/date11.png)"},{"pos":[13160,13177],"content":"Test your project","linkify":"Test your project","nodes":[{"content":"Test your project","pos":[0,17]}]},{"content":"Build your project again, and run the following X++ job to test your project.","pos":[13183,13260]},{"content":"<bpt id=\"p1\">[</bpt><ph id=\"ph1\">![</ph>Testing the project<ept id=\"p1\">](./media/capa-504x1024.png)](./media/capa.png)</ept>","pos":[13261,13330],"source":"[![Testing the project](./media/capa-504x1024.png)](./media/capa.png)"}],"content":"---\n# required metadata\n\ntitle: Date effectivity | Microsoft Docs\ndescription: This topic provides information about date-effective data entities and data sources, and shows how to create a date-effective entity. It also explains how date effectivity applies to read and write activities.\nauthor: RobinARH\nmanager: AnnBe\nms.date: 2015-12-12 19:32:05\nms.topic: article\nms.prod: \nms.service: Dynamics365Operations\nms.technology: \n\n# optional metadata\n\n# keywords: \n# ROBOTS: \naudience: Developer\n# ms.devlang: \nms.reviewer: 2051\nms.suite: Released- Dynamics AX 7.0.0\n# ms.tgt_pltfrm: \nms.custom: 24861\nms.assetid: 8e2d1745-08e7-4c78-bf93-8ec400a7501d\nms.region: Global\n# ms.industry: \nms.author: kuntalme\n\n---\n\n# Date effectivity\n\nThis topic provides information about date-effective data entities and data sources, and shows how to create a date-effective entity. It also explains how date effectivity applies to read and write activities.\n\nThere are different design patterns for date-effective features that involve data entities. The patterns are classified into two main categories:\n\n-   **Date-effective entities** – The entity has at least one date-effective data source, and the entity itself is also date effective.\n-   **Non-date-effective entities** – The entity itself is not date effective, but it does contain date-effective data sources.\n\nThe next sections describe the small list of properties and methods that control the date-effective behavior of entities and their date-effective data sources.\n\n## Dateeffective entities\nThe following table describes the properties that control the date-effective behavior of a data entity.\n\n| Property name of the entity | Node of the property                                    | Value       | Description                                                                                                                                                                                                                                                                                                                                                  |\n|-----------------------------|---------------------------------------------------------|-------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| ValidTimeStateEnabled       | Data entity node in the designer                        | Yes (or No) | The value **Yes** makes the entity date effective. The entity must have **ValidFrom** and **ValidTo** fields. These fields are mapped to the **ValidFrom** and **ValidTo** fields of a date-effective data source. The value **No** does *not* disable the enforcement of date effectivity on any date-effective tables that are data sources of the entity. |\n| ValidTimeStateKey           | Under the data entity node, **Keys** &gt; **EntityKey** | Yes (or No) | The value **Yes** identifies the key that is required to enforce the date-effective values on this particular entity.                                                                                                                                                                                                                                        |\n\n## Read activities\nWhen date effectivity is set at the data entity level, reads from the entity behave the same way as reads from a table. The entity has **ValidFrom** and **ValidTo** fields that the system applies date filters to during reads.\n\n### Query modes and the validtimestate keyword of X++ SQL select\n\nA date-effective entity supports the following three *query modes*, which vary in their use of the X++ **validtimestate** keyword:\n\n-   **Default mode** – Current records are returned using `select * from FMVehicleRateEntity; // X++ SQL.`\n-   **AsOfDate mode** – Records valid for the specified date are returned using `select validtimestate(d1) * from FMVehicleRateEntity;`\n-   **AsOfDateRange mode** – Records valid for the specified date range are returned using `select validtimestate(d1,d2) * from FMVehicleRateEntity;`\n\n**Important:** For data entities that aren't themselves date effective, but that have a data-effective data source, only the default query mode is available. This concept is discussed later in this article.\n\n### Applying a date filter at the data source level\n\nThere are scenarios where date-effective filtering is required outside the data entity, at the data source level. For example, the customer entity (CustTableTestEntity) contains CustTable and LogisticsPostalAddress as data sources, where LogisticsPostalAddress is a date-effective table and CustTable is a regular table. The purpose of a customer entity is to have a list of customers and their active primary addresses, if they have primary addresses. Therefore, the customer entity itself isn't date effective, but it requires date filters on one of the data sources. In this case, the entity isn't marked **ValidTimeStateEnabled**. Instead, an **Apply Date Filter** property is added on the data source. If the value of **Apply Date Filter** is set to **Yes**, date filters are automatically applied to that data source. The following table describes the properties that control the date-effective behavior of a date-effective data source of a data entity.\n\n| Property name of the data source | Node of the property                             | Value       | Description                                                                                                                                                                                                                                                                                                    |\n|----------------------------------|--------------------------------------------------|-------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Apply Date Filter                | Node of any particular data source of the entity | Yes (or No) | For *reads*, this property controls whether date filters are applied on the entity data source. In this case, the data source should be marked **ValidTimeStateEnabled**. This property value has effect regardless of whether the entity itself is date effective. For *writes*, this property has no effect. |\n\nThis article describes the use of these date-effective properties and the interactions between them.\n\n### State matrixes for reads\n\nThis section concerns only reads from the data entity. The following pair of reference matrixes describe the combinations of date-effective states that can exist between a data entity and its data source. Each table contains four cases, and each case discusses two distinct targets. Here are the primary points that you should understand:\n\n-   On any given read from the entity, the query mode is the same for both the entity and date-effective data sources.\n-   If the entity is not date effective, the query mode is limited to the default mode. Therefore, the date-effective data source is accessed only for the current date.\n-   On the date-effective data source, the **Apply Date Filter** property can be set to **No** to make the data source return all data – past, current, and future.\n-   For OData, date-effective filters are not applied to the data entity. However, filters on the data source are applied at all code paths.\n\nA. Entity *is* date effective, because ValidTimeStateEnabled = Yes\n\n**Data source *is* date effective**\n\n**Data source is *not* date effective**\n\n**Apply Date Filter = Yes**\n\n-   **Entity:** Date filters are applied. Any query mode is supported.\n-   **Data source:** Filters are applied. Any query mode is supported, but the mode is the same as is coded for the entity.\n\nNon-date-effective data sources aren't affected.\n\n**Apply Date Filter = No**\n\n-   **Entity:** Date filters are applied. Any query mode is supported.\n-   **Data source:** No date filters are applied.\n\nNon-date-effective data sources aren't affected.\n\n \n\nB. Entity is *not* date effective, because ValidTimeStateEnabled = No\n\n**Data source *is* date effective**\n\n**Data source is *not* date effective**\n\n**Apply Date Filter = Yes**\n\n-   **Entity:** No date filters are applied.\n-   **Data source:** Date filters are applied. Only the default query mode is supported, where the X++ **validtimestate** keyword is omitted.\n\nNon-date-effective data sources aren't affected.\n\n**Apply Date Filter = No**\n\n-   **Entity:** No date filters are applied.\n-   **Data source:** No date filters are applied.\n\nNon-date-effective data sources aren't affected.\n\nThe following screen shot shows the **Apply Date Filter** property set to **Yes**. Therefore, date filters will be applied to reads of the **Address** data source. [![Apply Date Filter = Yes](./media/date1.png)](./media/date1.png)\n\n## Write activities\nThis section describes your options for configuring the behavior of date-effective entities and their date-effective data sources. We will start by reviewing the concept of date-effective tables and contrasting them with date-effective entities. **Date-effective table:** When data is inserted or updated in a date-effective table, the process has the option of calling the **xRecord.validTimeStateUpdateMode** method on the table buffer. The method accepts an element of the **ValidTimeStateUpdate** enumeration. Here are the available element values:\n\n-   CreateNewTimePeriod\n-   Correction\n-   EffectiveBased\n\n**Date-effective entity:** By contrast, when data is inserted or updated in a date-effective data entity, the **validTimeStateUpdateMode** method isn't used at the entity level. For writes, the data entity leaves the date-effective processing to the table level. You can use the **Valid Time State Update** property on the entity data source to specify the **validTimeStateUpdateMode** method to use for each data source of the data entity.\n\n## Creating a dateeffective entity\nThis section shows how to create a date-effective entity.\n\n#### Create a new project\n\n1.  Click **File** &gt; **New** &gt; **Project** to create a new Microsoft Dynamics 365 for Operations project.\n2.  In Solution Explorer, right-click your project, and then click **Properties**. The **Property Pages** dialog box for your project opens.\n3.  Change the value of the **Synchronize database on build** property to **True**, and then click **OK**. You must set this property only one time per project. [![Synchronize database on build = True](./media/date3.png)](./media/date3.png)\n\n#### Add a new data entity to your project\n\nCreate a new entity that is named **FMVehicleRateEntity**, and add it to the project.\n\n1.  In the left pane, select **Microsoft Dynamics 365 Artifacts**, and then click **Data Entity** in the left column of the main pane.\n2.  Click **Add**. The **Data Entity View** wizard starts.\n3.  Specify the property values for the data entity that you are creating, as shown in the following screen shot. The most important field is **Primary data source**, where you select **FMVehicleRate**. [![Primary data source = FMVehicleRate](./media/date5.png)](./media/date5.png) Click **Next**.\n4.  Add fields to the entity from the primary data source, **FMVehicleRate**.\n5.  Select all fields, and then click **Finish**. [![Selecting all the newly added fields](./media/date6.png)](./media/date6.png) The items are added to the project in Solution Explorer. [![The project in Solution Explorer](./media/date7.png)](./media/date7.png)\n\n#### Build your project\n\n1.  Click **Build** &gt; **Build Solution** to build your project.\n2.  Verify that the build has no errors. Warnings should be tolerated at this stage in the process.\n\n#### Validate the property values\n\n-   In Solution Explorer, select the **FMVehicleRateEntity** node, and validate the properties of the **FMVehicleRateEntity** entity by comparing them to the values in the **Properties** pane. [![Values in the Properties pane](./media/date8.png)](./media/date8.png)\n\n#### Make your entity date effective\n\n1.  In Solution Explorer, right-click the **FMVehicleRateEntity** node, and then click **Open**. The designer for the entity opens in the middle pane. [![Designer for the FMVehicleRateEntity entity](./media/date9.png)](./media/date9.png)\n2.  Change the value of the **Validate Time State Enabled** property to **Yes**. [![Validate Time State Enabled = Yes](./media/date10.png)](./media/date10.png)\n\n#### Configure the Valid Time State Update property for the date-effective data source\n\n-   Select the **FMVehicleRate** data source, and then set the **Valid Time State Update** property to **CreateNewTimePeriod**. [![Valid Time State Update = CreateNewTimePeriod](./media/date11.png)](./media/date11.png)\n\n#### Test your project\n\n-   Build your project again, and run the following X++ job to test your project. [![Testing the project](./media/capa-504x1024.png)](./media/capa.png)\n\n\n"}